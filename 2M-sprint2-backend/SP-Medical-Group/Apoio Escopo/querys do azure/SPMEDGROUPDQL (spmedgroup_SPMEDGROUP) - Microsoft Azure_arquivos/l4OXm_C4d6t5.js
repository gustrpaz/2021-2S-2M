define("MsPortalImpl.Controls/Controls/Visualization/MonitorChartV2/AI/ME/Utilities/FilterTreeHelper",["require","exports","MsPortalImpl.Controls/Controls/Visualization/MonitorChartV2/AI/ME/Telemetry","MsPortalImpl.Controls/Controls/Visualization/MonitorChartV2/AI/ME/Utilities/Util"],(function(n,t,i,r){"use strict";function l(n){var t=o(n);return t.reduce((function(n,t){var i=t.OperandSelectedKey.dimensionName.id,u=r.find(n,(function(n){return n.dimensionId===i}));return u?u.value.concat(t.OperandSelectedValues):n.push({dimensionId:i,value:t.OperandSelectedValues,operator:t.ComparisonOperator||0}),n}),[])}function s(){return{filterType:0,id:r.GUID(),OperandFilters:[],LogicalOperator:0}}function a(){return{filterType:1,id:r.GUID(),OperandSelectedKey:undefined,OperandSelectedValues:[],ComparisonOperator:0}}function v(n){var t=r.cloneProperties(n),i=t&&t.OperandFilters;return i&&i.length>0?(t.id=t.id||r.GUID(),t.filterType||(t.filterType=0),i.forEach((function(t){t.id=t.id||r.GUID();n.filterType||(t.filterType=1)})),t):s()}function y(n,t){var r=n&&t&&e(n.id,t),o,s;return r&&(r.filterType===1?(o=r,s=n,o.ComparisonOperator=s.ComparisonOperator,o.OperandSelectedKey=s.OperandSelectedKey,o.OperandSelectedValues=s.OperandSelectedValues):i.logWarning("UpdateFilter only supports updating leaf filter objects.",u,{FilterId:n.id,ContainerName:f})),r}function p(n,t,o,s){var l,c,h;return s===void 0&&(s=!0),n&&o&&t&&(e(n.id,o)?i.logWarning("addFilter: id should not already exist",u,{FilterId:n.id}):(h=e(t,o),h?h.filterType===0?(c=h,n.id=s?r.GUID():n.id,l=n.id,c.OperandFilters.push(n)):i.logWarning("addFilter: adding to leaf filter unsupported",u,{ParentFilterId:t,ContainerName:f}):i.logWarning("addFilter: parent filter was not found",u,{ParentFilterId:t,ContainerName:f}))),{newId:l,parent:c}}function w(n,t){var r,e;return n&&t&&(e=h(n,t,null),e?(r=e,r.OperandFilters=r.OperandFilters.filter((function(t){return t.id!==n}))):i.logWarning("removeFilter: parent filter was not found.",u,{FilterId:n,ContainerName:f})),r}function o(n){if(n){if(n.filterType===1)return[n];var t=n.OperandFilters.map((function(n){return o(n)}));return[].concat.apply([],t)}return[]}function e(n,t){if(n===t.id)return t;if(t.filterType===0){var i=t.OperandFilters.map((function(t){return e(n,t)})).filter((function(n){return!!n}));if(i.length===1)return i[0]}}function h(n,t,i){if(n===t.id)return i;if(t.filterType===0){var r=t,u=r.OperandFilters.map((function(t){return h(n,t,r)})).filter((function(n){return!!n}));if(u.length===1)return u[0]}}function c(n,t){return n&&t?n.filterType!==t.filterType?!1:n.filterType===1?k(n,t):d(n,t):!n&&!t}function b(n,t,i){return r.isEqualWrapper(n,t,(function(n,t){return n.dimensionName||t.dimensionName?n.dimensionName&&!t.dimensionName||t.dimensionName&&!n.dimensionName?!1:n.dimensionName.id===t.dimensionName.id&&(i||n.dimensionName.displayName===t.dimensionName.displayName&&n.description===t.description&&n.category===t.category):!0}))}function k(n,t){var i,r,u;if(!b(n.OperandSelectedKey,t.OperandSelectedKey,!0)||n.ComparisonOperator!==t.ComparisonOperator)return!1;if(!n.OperandSelectedValues&&!t.OperandSelectedValues)return!0;if(n.OperandSelectedValues&&t.OperandSelectedValues){if(n.OperandSelectedValues.length!==t.OperandSelectedValues.length)return!1;for(i=0;i<n.OperandSelectedValues.length;i++)if(r=n.OperandSelectedValues[i],u=t.OperandSelectedValues[i],r!==u)return!1;return!0}return!1}function d(n,t){var i,r,u;if(n.LogicalOperator!==t.LogicalOperator)return!1;if(!n.OperandFilters&&!t.OperandFilters)return!0;if(n.OperandFilters&&t.OperandFilters){if(n.OperandFilters.length!==t.OperandFilters.length)return!1;for(i=0;i<n.OperandFilters.length;i++)if(r=n.OperandFilters[i],u=t.OperandFilters[i],!c(r,u))return!1;return!0}return!1}Object.defineProperty(t,"__esModule",{value:!0});t.FiltersEqual=t.getLeafNodes=t.removeFilter=t.addFilter=t.updateFilter=t.hydrateFilter=t.createEmptyLeaf=t.createRootFilter=t.createFilterQueryData=void 0;var u=i.getOrCreateTelemetryContext(),f="FilterTreeHelper";t.createFilterQueryData=l;t.createRootFilter=s;t.createEmptyLeaf=a;t.hydrateFilter=v;t.updateFilter=y;t.addFilter=p;t.removeFilter=w;t.getLeafNodes=o;t.FiltersEqual=c}))