define("MsPortalImpl.Controls/Controls/Base/WidgetBinding",["require","exports"],(function(n,t){"use strict";function e(n,t){var r;return i(n)||(r=ko.unwrap(n)),i(r)?t:r}function o(n,t){var i=c([n.$disabled,t.$disabled]),r=l([n.$enabledTabIndex,t.$enabledTabIndex]),u=a(r,i);return{$disabled:i,$enabledTabIndex:r,$tabIndex:u}}function r(n){return ko.contextFor($(n)[0])}function u(n){return new ko.bindingContext(n)}function v(n,t){return u(n).extend({$dicontainer:t.$dicontainer,$disabled:t.$disabled,$enabledTabIndex:t.$enabledTabIndex,$tabIndex:t.$tabIndex})}function s(n,t,i,f){var e=f||r(n);return e=e?e.createChildContext(t):u(t),i&&(e=e.extend(i)),e}function h(n,t){var i=o(n,t);return n.extend(i)}function y(n){var t=r(n);return t||(t=u(null)),i(t.$disabled)&&(t=t.extend({$disabled:ko.pureComputed(MsPortalFx.wrap(!1))})),i(t.$tabIndex)&&(t=t.extend({$tabIndex:ko.pureComputed(MsPortalFx.wrap(0))})),i(t.$enabledTabIndex)&&(t=t.extend({$enabledTabIndex:ko.pureComputed(MsPortalFx.wrap(0))})),t}function c(n){return ko.pureComputed((function(){for(var r,t=!1,i=0;i<n.length;i++)r=e(n[i],!1),t=t||r;return t}))}function l(n){return ko.pureComputed((function(){for(var i,t=0,r=0;r<n.length;r++)i=e(n[r],0),t===null||i===null?t=null:t<0||(t=i<0?i:i);return t}))}function a(n,t){return ko.pureComputed((function(){return t()?-1:n()}))}var i,f;Object.defineProperty(t,"__esModule",{value:!0});t.makeTabIndexProperty=t.chainEnabledTabIndexProperties=t.chainDisabledProperties=t.contextFor=t.createChainedContext=t.createChildContext=t.createIsolatedContext=t.getContext=void 0;i=MsPortalFx.isUndefined;t.getContext=r;t.createIsolatedContext=v;t.createChildContext=s;t.createChainedContext=h;t.contextFor=y;t.chainDisabledProperties=c;t.chainEnabledTabIndexProperties=l;t.makeTabIndexProperty=a;ko.bindingHandlers.context={init:function(n,t,i,r,u){var f=t(),e=o(u,{$disabled:f.$disabled,$enabledTabIndex:f.$tabIndex}),h;return f.$dicontainer&&(e.$dicontainer=f.$dicontainer),h=s(n,r,e,u),ko.applyBindingsToDescendants(h,n),{controlsDescendantBindings:!0}}};ko.virtualElements.allowedBindings.context=!0;f=ko.bindingHandlers.template;ko.bindingHandlers.template={init:function(n,t,i,r,u){return f.init(n,t,i,r,u)},update:function(n,t,i,r,u){var l=t(),e=ko.unwrap(l),o,s,c;return e=typeof e=="string"?{name:l}:ko.utils.extend({},e),o=e.context,o&&(u=ko.ignoreDependencies((function(){return typeof o=="function"&&(o=o(e.data||r)),h(u,{$disabled:o.$disabled,$enabledTabIndex:o.$tabIndex})})),delete e.context),s=u.$ctl,c=s&&s.templateEngine,c&&e.name&&!e.templateEngine&&(e.templateEngine=c),t=function(){return e},f.update(n,t,i,r,u)}}}));
define("MsPortalImpl/Base/Base.ElementWidgetMap",["require","exports"],(function(n,t){"use strict";function r(n,t){if(n&&t){var r=i.get(n);r?r.push(t):i.set(n,[t])}}function u(n,t){if(n&&t){var r=i.get(n);r&&(r=r.filter((function(n){return n!==t})),r.length>0?i.set(n,r):i.delete(n))}}function f(n,t){if(n){var r=i.get(n);return r&&r.filter((function(n){return n instanceof t}))}}function e(n){var t=n&&i.get(n);return t&&t.slice()}Object.defineProperty(t,"__esModule",{value:!0});t.getAll=t.getAllMatch=t.remove=t.set=void 0;var i=new WeakMap;t.set=r;t.remove=u;t.getAllMatch=f;t.getAll=e}));
define("MsPortalImpl/Extension/CachedManifestClient",["require","exports","Fx/DependencyInjection"],(function(n,t,i){"use strict";function o(n){return Q(MsPortalEarly.getCachedManifestUri(n)).then((function(n){return r.Net2.ajax({uri:n,performRetry:!0,type:"GET",dataType:"json",contentType:"application/json",useRawAjax:!0}).catch((function(n){return e.error(n),null}))}))}var u;Object.defineProperty(t,"__esModule",{value:!0});t.CachedManifestClient=void 0;var r=MsPortalFx.Base,f=r.Diagnostics,e=f.createLog(n);u=(function(){function t(n,t){this.getManifests=function(t){var i=t==="assetTypes"?Q(n):o(t);return i.then((function(n){return n.manifest||{}}))};this.getMetadata=function(){return t}}return t.create=function(){return Q(MsPortalEarly.manifestCachePromise).then((function(n){var i={},r=fx.bootParameters.environment.extensionsPageVersion;return Object.keys(r).forEach((function(t){var u=n.manifest[t]||{},f=MsPortalEarly.pickExtensionStamp(r[t]).split("/");u.pageVersion=f[0];u.prewarmerScript=f[1]&&[f[1],null];i[t]=u})),new t({manifest:i},n.metadata)})).catch((function(n){MsPortalEarly.navigateError("NoExtensions",[["stack",encodeURIComponent(n&&n.stack).substr(0,1e3)]]);throw n;}))},__decorate([__metadata("fx:diagnostics",[n,"CachedManifestClient"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Object)],t,"create",null),t})();t.CachedManifestClient=u}));
define("MsPortalImpl/Extension/Extension.DefinitionValidator",["require","exports"],(function(n,t){"use strict";function f(n,t){MsPortalFx.forEachKey(n,(function(n,i){i!==undefined&&t(n,i)}))}function w(n,t){return t=t||[],n?f(n,(function(u,f){switch(u){case"name":r("Extension name",f,t);break;case"version":case"hash":case"schemaVersion":case"sdkVersion":case"buildDescription":r(u,f,t);break;case"isPreview":h(u,f,t);break;case"assetTypes":i(u,f,t);break;case"blades":b(n,f,t);break;case"startBoardParts":tt(f,t);break;case"partsCatalog":st(f,t);break;case"commandsCatalog":ot(f,t);break;case"commandGroups":ft(f,t);break;case"htmlTemplates":rt(f,t);break;case"styleSheets":ut(f,t);break;case"galleryService":case"bladeMap":case"partTypeMap":case"requireConfig":case"dashboardProvider":break;default:t.push("Unexpected attribute '{0}' on definition.".format(u))}})):t.push("Definition is null or undefined."),!t.length}function r(n,t,i){typeof t!="string"&&i.push("{0} is not a valid string.".format(n))}function h(n,t,i){typeof t!="boolean"&&i.push("{0} is not a valid boolean.".format(n))}function i(n,t,i){var r=Array.isArray(t);return r||i.push("The '{0}' property is not a valid array.".format(n)),r}function b(n,t,r){t&&i("blades",t,r)&&t.forEach((function(t,i){c(n,t,i,r)}))}function c(n,t,r,u){var f=t.name;t.inputs&&i("Blade: {0}. Property: blades[{1}].inputs".format(f,r),t.inputs,u);t.optionalInputs&&i("Blade: {0}. Property: blades[{1}].optionalInputs".format(f,r),t.optionalInputs,u);i("Blade: {0}. Property: blades[{1}].lenses".format(f,r),t.lenses,u)&&t.lenses.forEach((function(n,t){var e="Blade: {0}. Lens: {1}. Property: blades[{2}].lenses[{3}].".format(f,n.name,r,t);n.partInstances&&i(e,n.partInstances,u)&&n.partInstances.forEach((function(i,e){var o="Blade: {0}. Lens: {1}. Part: {2}. Property: blades[{3}].lenses[{4}].partInstances[{5}]".format(f,n.name,i.name,r,t,e);a(o,i,u)}))}));t.permissions&&i("Blade: {0}. Property: blades[{1}].permissions".format(f,r),t.permissions,u)&&t.permissions.forEach((function(n,t){e("Blade: {0}. Property: blades[{1}].permissions[{2}]".format(f,r,t),n,u)}));k(t.toolbar,"Blade: {0}. Property: blades[{1}].toolbar".format(f,r),u);d(t.actionBar,"Blade: {0}. Property: blades[{1}].actionBar".format(f,r),u)}function k(n,t,i){n&&(n.source?l(n.source,t+".source",i):i.push("Source not specified for toolbar. "+t))}function d(n,t,i){n&&n.source&&l(n.source,t+".source",i)}function l(n,t,u){n.property&&r(t+".property",n.property,u);n.optional&&typeof n.optional!="boolean"&&u.push("The attribute 'optional' should be of type boolean. "+t);n.isIdentityInput&&typeof n.isIdentityInput!="boolean"&&u.push("The attribute 'isIdentityInput' should be of type boolean. "+t);i(t+".valuesFrom",n.valuesFrom,u)&&n.valuesFrom.forEach((function(n,i){g(t+".valuesFrom[{0}]".format(i),n,u)}))}function g(n,t,i){switch(t.referenceType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:break;default:i.push("Unknown reference type '{0}' found for {1}.referenceType.".format(t.referenceType,n))}r(n+".property",t.property,i);t.part&&r(n+".part",t.part,i)}function nt(n,t,i){switch(t.sourceType){case 0:t.providerKey&&i.push("Asset ID source source type of FromInput with provider key (should be null) found for {0}.sourceType.".format(n));break;case 1:t.providerKey||i.push("Asset ID source source type of FromProvider with missing provider key found for {0}.sourceType.".format(n));r(n+".providerKey",t.providerKey,i);break;case 2:t.providerKey||i.push("Asset ID source source type of FromSourceProvider with missing provider key found for {0}.sourceType.".format(n));r(n+".providerKey",t.providerKey,i);break;default:i.push("Unknown asset ID source source type '{0}' found for {1}.sourceType.".format(t.sourceType,n))}r(n+".property",t.property,i)}function e(n,t,f){var o,s;switch(t.permissionType){case 0:o=t;o.extensionName&&r(n+".extensionName",o.extensionName,f);r(n+".assetType",o.assetType,f);o.assetId?nt(n+".assetId",o.assetId,f):f.push("Permission missing assetId found for {0}.assetId.".format(n));r(n+".action",o.action,f);break;case 1:s=t;switch(s.requirement){case u.All:case u.Any:break;default:f.push("Unknown permission set requirement '{0}' found for {1}.requirement.".format(s.requirement,n))}i(n+".permissions",s.permissions,f)&&s.permissions.forEach((function(t,i){e("{0}.permissions[{1}]".format(n,i),t,f)}));break;default:f.push("Unknown permission type '{0}' found for {1}.permissionType.".format(t.permissionType,n))}}function tt(n,t){i("startBoardParts",n,t)&&n.forEach((function(n,i){a("startBoardParts[{0}]".format(i),n,t)}))}function a(n,t,i){t.reference||t.inline?t.reference&&t.inline?i.push("'reference' and 'inline' properties cannot be set at the same time on PartInstanceDefinition. Property: {0}".format(n)):t.reference&&!t.reference.partTypeName?i.push("'partTypeName' property is required on part reference. Property: {0}".format(n)):t.inline&&v(n,t.inline,i):i.push("'reference' or 'inline' property required on PartInstanceDefinition. Property: {0}".format(n))}function v(n,t,r){t&&(it(n,t.partState,r),t.permissions&&i("{0}.permissions".format(n),t.permissions,r)&&t.permissions.forEach((function(t,i){e("{0}.permissions[{1}]".format(n,i),t,r)})))}function it(n,t,i){if(t){var e=t.inputIdentityProperties||[],f=t.sharedProperties||[],o=e.concat(f.map((function(n){return n.property}))),s=f.map((function(n){return n.key})),r=y(o),u=y(s);r&&r.length>0&&i.push("Part view model properties cannot be used in multiple part settings. Duplicated properties: '{0}'. Path: '{1}'.".format(JSON.stringify(r),n));u&&u.length>0&&i.push("Shared key settings cannot be used in multiple part settings. Duplicated keys: '{0}'. Path: '{1}'.".format(JSON.stringify(u),n))}}function y(n){var t={},i=[];return(n||[]).forEach((function(n){t[n]&&i.push(n);t[n]=!0})),i}function rt(n,t){f(n,(function(n,i){typeof i!="string"&&(r("htmlTemplates['{0}'].file".format(n),i.file,t),r("htmlTemplates['{0}'].content".format(n),i.content,t))}))}function ut(n,t){Array.isArray(n)?n.forEach((function(n,i){r("StyleSheet at position {0}".format(i),n,t)})):t.push("Invalid type for 'styleSheets' property on definition.")}function ft(n,t){n&&i("commandGroups",n,t)&&MsPortalFx.mapMany(n,(function(n){return n.commands})).forEach((function(n){n.reference&&et(n,t)}))}function et(n,t){if(n&&n.reference){var i=!1;f(n,(function(n){n!=="name"&&n!=="bindings"&&n!=="reference"&&(i=!0)}));i?t.push("Command reference can only define 'name' and 'bindings' properties. Definition: {0}".format(ko.toJSON(n))):n.reference.commandType||t.push("Command reference must specify the 'commandType' property. Definition: {0}".format(ko.toJSON(n)))}}function ot(n,t){n&&i("commandsCatalog",n,t)&&n.forEach((function(n){var i="Commands in 'commandsCatalog' ";n.name||t.push(i+"must have names.");n.reference&&t.push(i+"cannot specify a 'reference' property.")}))}function st(n,t){n&&i("partsCatalog",n,t)&&n.forEach((function(n){p(n,t)}))}function p(n,t){n.inputDefinitions&&i("PartType: {0}. Property: inputDefinitions".format(n.name),n.inputDefinitions,t);n.reference&&ht(n,t);v("PartType: {0}".format(n.name),n,t)}function ht(n,t){(n.reference.bindings||[]).forEach((function(i){(i.valuesFrom||[]).forEach((function(i){i.referenceType!==7&&i.referenceType!==9&&i.referenceType!==5&&t.push("Adapted Part: {0} can only have Adapter, AdapterInput and Constant bindings for its referenced part.".format(n.name))}))}))}var o,u,s;Object.defineProperty(t,"__esModule",{value:!0});t.validatePartType=t.validateBlade=t.validateIsArray=t.validateIsBoolean=t.validateIsString=t.validateDefinition=t.ValidationResult=void 0;o=MsPortalFx.Extension;u=o.SetRequirement;s=(function(){function n(){this.errors=[]}return n.prototype.valid=function(){return!this.errors.length},n})();t.ValidationResult=s;t.validateDefinition=w;t.validateIsString=r;t.validateIsBoolean=h;t.validateIsArray=i;t.validateBlade=c;t.validatePartType=p}));
define("MsPortalImpl/Extension/ExtensionManagerOptions",["require","exports","FxInternal/AsyncLoader","Fx/DependencyInjection","MsPortalImpl/Extension/CachedManifestClient"],(function(n,t,i,r,u){"use strict";function f(n,t,i,r){return n.replace(a,t).replace(v,r?MsPortalEarly.hostingServiceSuffix:"").replace(c,i||"")}function y(n,t,i){var r=i||n.hostingServiceName,u=n.flags&16?h.hostingServiceConfiguration.thirdParty:h.hostingServiceConfiguration.default,o=f(u.uriFormat,r,t,!0),s=f(u.prewarmUriFormat,r,"",!0),c=f(u.uriFormat,r,"",!1),l=(u.baseDomains||[]).map((function(n){return f(n,r,t,!0)})),e=!i&&!t;return{name:n.name,flags:n.flags,redirectTo:n.redirectTo,uri:o,prewarmUri:s,homePageUri:c,baseDomains:l,isTestExtension:!1,stamp:t,useBootProvidedVersion:e,isSideloaded:n.missingCachedManifest||!e,azBaseUri:n.azBaseUri,serviceTreeId:n.serviceTreeId}}function p(n,t){var i=t&&n.uriFormat?n.uriFormat.replace(c,t):n.uri,u=n.azExtension?256:0,r=!n.isTestExtension&&!t;return{name:n.name,flags:n.flags|u,redirectTo:n.redirectTo,uri:i,prewarmUri:i,homePageUri:i,baseDomains:[],isTestExtension:n.isTestExtension,stamp:t,useBootProvidedVersion:r,isSideloaded:n.missingCachedManifest||!r,azBaseUri:n.azBaseUri,serviceTreeId:n.serviceTreeId,armResourceId:n.armResourceId}}function w(n){return n.hostingServiceName!==undefined}function b(n,t,i){var f=!n.isEnabled("disableextensions"),r=[],u={};return t.forEach((function(t){if(!u[t.name]){u[t.name]=!0;var s=t.name.toLowerCase(),e=(/^[a-z0-9_\-]+$/i.exec(n.getValue(s)||"")||[""])[0],h=e||f&&!(t.flags&1)&&!i.includes(t.name);if(e==="false"&&(h=!1),h){var c=e!=="true"&&e!=="false"?e:"",o=n.getValue(s+"_urlredirect"),l=typeof o=="string"&&/^[a-z0-9]+$/i.test(o)?o:null,a=w(t)?y(t,c,l):p(t,c);r.push(a)}}})),r}var e,o,s;Object.defineProperty(t,"__esModule",{value:!0});t.postBoot=t.getCatalogApiCacheContent=t.listTestExtensions=t.unregisterTestExtensions=t.registerTestExtensions=t.getExtensionRegistration=t.PostBootCache=t.ExtensionManagerOptions=t.TestExtensionsSource=void 0;var h=fx.environment,a=/\{extName\}/g,v=/\{envSuffix\}/g,c=/\{0\}/g,l="feature.canmodifyextensions=true";e=(function(){function t(n){this.value=n}return t.create=function(n,r){var f=n.isEnabled("canmodifyextensions"),u=function(){return r.getAsync(i.get("MsPortalImpl/Extension/ExtensionMetadataSource","ExtensionMetadataSource"))},e=f&&r.getAsync(i.get("MsPortalImpl/Extension/ExtensionPatch","PatchMetadataSource")),o=f&&u().then((function(n){return n.getCodeComponentsMetadata()}));return MsPortalImpl.Extension={registerTestExtension:function(n,t){return u().then((function(i){return i.registerTestExtension(n,t)}))},unregisterAll:function(){return u().then((function(n){return n.unregisterAll()}))},listTestExtensions:function(){return u().then((function(n){return n.listTestExtensions()}))}},Q.spread([o,e,],(function(n){return new t(n||[])}))},__decorate([__metadata("fx:diagnostics",[n,"TestExtensionsSource"]),r.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[FxImpl.Features,r.Container]),__metadata("design:returntype",Object)],t,"create",null),t})();t.TestExtensionsSource=e;o=(function(){function t(n,t,i){this._normalizedNameMap={};var f=(n.getValue("disabledextensionredirects")||"").toLowerCase().split(","),r=b(n,t,i||[]),u=FxImpl.partition(r,(function(n){return n.redirectTo&&!f.includes(n.name.toLowerCase())}));this.extensionRedirectMap=MsPortalFx.convertArrayToMap(u[0],(function(n){return n.name}),(function(n){return n.redirectTo}));this.extensionsAsArray=u[1];this.extensionsAsMap=MsPortalFx.convertArrayToMap(this.extensionsAsArray,(function(n){return n.name}));this._normalizedNameMap=MsPortalFx.convertArrayToMap(r,(function(n){return n.name.toLowerCase()}),(function(n){return n.name}))}return t.create=function(n,i,r){return new t(i,n.value.concat(r.getMetadata()),fx.environment.disabledExtensions)},t.prototype.getNormalizedMetadata=function(n,t){var i=n?this._normalizedNameMap[n.toLowerCase()]:n;if(t&&!i)throw new Error("The extension name '"+n+"' is not valid");return i&&this.extensionsAsMap[this.resolveExtensionName(i)]},t.prototype.resolveExtensionName=function(n){return this.extensionRedirectMap[n]||n},__decorate([__metadata("fx:diagnostics",[n,"ExtensionManagerOptions"]),r.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[e,FxImpl.Features,u.CachedManifestClient]),__metadata("design:returntype",t)],t,"create",null),t})();t.ExtensionManagerOptions=o;s=(function(){function t(){this._value={}}return t.prototype.get=function(n){return this._getEntry(n).promise},t.prototype.set=function(n,t){this._getEntry(n).resolve(t)},t.prototype._getEntry=function(n){return this._value[n]||(this._value[n]=FxImpl.defer())},__decorate([__metadata("fx:diagnostics",[n,"PostBootCache"]),r.Class()],t)})();t.PostBootCache=s;t.getExtensionRegistration=i.defineHandler(FxImpl.Extension.getExtensionRegistrationEndPoint,(function(n){var t=n.diContainer.get(o).extensionsAsMap[n.messageArg];return{baseUri:MsPortalEarly.ExtensionLoader.getUri(t),resourceId:t.armResourceId}}));t.registerTestExtensions=i.defineHandler(FxImpl.Extension.CreateUiDef.registerTestExtensionsEndPoint,(function(n){return __awaiter(void 0,void 0,void 0,(function(){var r,u,t;return __generator(this,(function(f){switch(f.label){case 0:return[4,n.diContainer.getAsync(i.get("MsPortalImpl/Extension/ExtensionMetadataSource","ExtensionMetadataSource"))];case 1:return r=f.sent(),u=n.messageArg.map((function(n){return r.registerTestExtension(n)})),[4,Promise.all(u)];case 2:return f.sent(),t=globalThis.location,t.search=t.search?t.search.concat("&"+l):"?"+l,[2]}}))}))}));t.unregisterTestExtensions=i.defineHandler(FxImpl.Extension.CreateUiDef.unregisterTestExtensionsEndPoint,(function(n){return __awaiter(void 0,void 0,void 0,(function(){var t,r;return __generator(this,(function(u){switch(u.label){case 0:return[4,n.diContainer.getAsync(i.get("MsPortalImpl/Extension/ExtensionMetadataSource","ExtensionMetadataSource"))];case 1:return t=u.sent(),r=n.messageArg.map((function(n){return t.unregisterTestExtension(n)})),[4,Promise.all(r)];case 2:return u.sent(),globalThis.location.reload(),[2]}}))}))}));t.listTestExtensions=i.defineHandler(FxImpl.Extension.CreateUiDef.listTestExtensionsEndPoint,(function(n){return __awaiter(void 0,void 0,void 0,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return[4,n.diContainer.getAsync(i.get("MsPortalImpl/Extension/ExtensionMetadataSource","ExtensionMetadataSource"))];case 1:return t=r.sent(),[2,t.listTestExtensions()]}}))}))}));t.getCatalogApiCacheContent=i.defineHandler(FxImpl.Extension.getCatalogApiCacheContentEndPoint,(function(){return Q(MsPortalEarly.manifestCachePromise).then((function(n){return n.catalogApi}))}));t.postBoot=i.defineHandler(FxImpl.Extension.postBootEndPoint,(function(n){n.diContainer.get(s).set(n.messageContext.srcWindowId,n.messageArg)}))}));
define("MsPortalImpl/Extension/Extension.Manifest",["require","exports","Fx/DependencyInjection","FxHubs/ResourceManagement","FxInternal/AsyncLoader","MsPortalImpl/Extension/CachedManifestClient","MsPortalImpl/Extension/Extension.DefinitionValidator","MsPortalImpl/Extension/ExtensionManagerOptions"],(function(n,t,i,r,u,f,e,o){"use strict";function a(n,t,i,r,u){return("["+n+"]"+t+"-"+i+"-"+r+"-"+u).toLowerCase()}function v(n,t){return(n+"-"+t).toLowerCase()}function b(n,t,i){return(n+"_"+t+(i?"."+i:"")).toLowerCase()}function k(n){if(!n)return undefined;var i={hideassettype:1,hideinstances:2},r=function(n,t,r){if(typeof r=="number")n[t]={options:r};else if(typeof r=="string"){var u=0;(r||"").toLowerCase().split(",").forEach((function(n){n=(n||"").trim();i[n]&&(u=u|i[n])}));n[t]={options:u}}},u=function(n,t,i){typeof i=="boolean"&&(n[t]?n[t].hideBrowseInfoBox=i:n[t]={hideBrowseInfoBox:i})},t=Object.create(null);return MsPortalFx.forEachKey(n,(function(n,i){i&&(r(t,n,i.options),u(t,n,i.hidebrowseinfobox),i.kinds&&(t[n]=t[n]||Object.create(null),t[n].kinds=Object.create(null),MsPortalFx.forEachKey(i.kinds,(function(i,f){f&&(r(t[n].kinds,i,f.options),u(t[n].kinds,i,f.hidebrowseinfobox))}))))})),t}function s(n,t,i,r){n.push(t.format(i,r))}function it(n,t,i,r){var u=n.name;if(l(u)&&s(i,"The name for the asset type in manifest '{0}' was not specified.",t),n.options!==undefined&&typeof n.options!="number"&&s(i,"The asset type options property present for the asset type '{0}' in manifest '{1}' was not a number.",u,t),n.browseType!==undefined&&typeof n.browseType!="number"&&s(i,"The browse type for the asset type '{0}' in manifest '{1}' was not a number.",u,t),n.browseLinkUri&&typeof n.browseLinkUri!="string"&&s(i,"The browse link URI for the asset type '{0}' in manifest '{1}' was not a string.",u,t),n.privateBrowse!==undefined&&typeof n.privateBrowse!="boolean"&&s(i,"The private browse flag present for the asset type '{0}' in manifest '{1}' was not a boolean.",u,t),n.browseRequiresRdfe!==undefined&&typeof n.browseRequiresRdfe!="boolean"&&s(i,"The requires RDFE browse flag was present for the asset type '{0}' in manifest '{1}' was not a boolean.",u,t),n.browseRequirements!==undefined&&typeof n.browseRequirements!="number"&&s(i,"The browse requirements was present for the asset type '{0}' in manifest '{1}' was not a number.",u,t),n.browseType!==undefined){switch(n.browseType){case 1:case 2:case 3:case 999:break;default:t.toLowerCase()!=="internalsamplesextension"&&t.toLowerCase()!=="samplesextension"&&s(r,"The browse for the asset type '{0}' in manifest '{1}' is deprecated: '"+n.browseType+"'.",u,t)}l(n.pluralDisplayName)&&l(n.text)&&s(i,"The pluralDisplayName for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.",u,t);MsPortalFx.isNullOrUndefined(n.icon)&&s(i,"The icon for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.",u,t)}else n.privateBrowse!==undefined&&s(i,"The asset type '{0}' in manifest '{1}' has a private blade flag but no browse type.",u,t);n.propertyProviderServiceViewModel&&typeof n.propertyProviderServiceViewModel!="string"&&s(i,"The property provider service view model for the asset type '{0}' in manifest '{1}' was not a string.",u,t)}function rt(n){var t=function(n,t){n&&n.split(",").forEach(t)},i;t(n.getValue("assettypeapiversion"),(function(n){var t=n.split(":");t.length===2&&t[0]&&(h[t[0].toLowerCase()]=t[1])}));i=function(n){return function(t){t&&(c[t.toLowerCase()]=n)}};t(n.getValue("showassettypes"),i(!0));t(n.getValue("hideassettypes"),i(!1))}var y,p,h,c,d;Object.defineProperty(t,"__esModule",{value:!0});t.ManifestCache=t.RedirectMap=t.assetRedirectKey=t.bladeRedirectKey=t.partRedirectKey=void 0;var w=MsPortalFx.Extension,g=MsPortalFx.Base,nt=g.Diagnostics,l=MsPortalFx.isNullOrWhiteSpace,ut=MsPortalFx.Extension.BrowseType,tt=window;t.partRedirectKey=a;t.bladeRedirectKey=v;t.assetRedirectKey=b;y=nt.createLog(n);p=(function(){function t(){this._partRedirectsMap={};this._bladeRedirectsMap={};this._assetRedirectsMap={}}return t.prototype.addPartRedirect=function(n){this._partRedirectsMap[a(n.type,n.fromExtension,n.fromPart,n.fromBlade,n.fromLens)]=n},t.prototype.addBladeRedirect=function(n){this._bladeRedirectsMap[v(n.fromExtension,n.fromBlade)]=n},t.prototype.addAssetRedirect=function(n){this._assetRedirectsMap[b(n.fromExtension,n.fromAsset,n.fromKind)]=n},t.prototype.getPartRedirect=function(n,t,i,r,u){var f=a(n,t,i,r,u);return{key:f,definition:this._partRedirectsMap[f]}},t.prototype.getBladeRedirect=function(n,t){var i=v(n,t);return{key:i,definition:this._bladeRedirectsMap[i]}},t.prototype.getAssetRedirect=function(n){return this._assetRedirectsMap[n.toLowerCase()]},__decorate([__metadata("fx:diagnostics",[n,"RedirectMap"]),i.Class()],t)})();t.RedirectMap=p;h={};c={};d=(function(){function t(n,t,i,r,f){var o=this;this._redirectMap=t;this._cachedManifestClient=r;this._features=f;this._cachedManifestsLoaded={};this._cache={};this._asyncCache={};this._extensionBlockBladeRedirect=(f.getValue("blockbladeredirect")||"").toLowerCase();rt(this._features);f.isEnabled("prefetchbrowsequerymanifest")&&this._cachedManifestClient.getManifests("assetTypesBrowse");var s=FxImpl.partition(i.extensionsAsArray,(function(n){return n.isSideloaded})),e=FxImpl.partition(s[0],(function(n){return!!(n.flags&256)})),h=e[0].map((function(t){return n.getAsync(u.get("MsPortalImpl/AzFramework/SideloadAzMetadataClient","SideloadAzMetadataClient")).then((function(n){return n.loadMetadataAsManifest(t.name,t.uri).then((function(n){o.trySetAllManifest(t.name,n)}))}))}));e[1].length&&h.push(n.getAsync(u.get("MsPortalImpl/Extension/SideloadManifestClient","SideloadManifestClient")).then((function(n){return n.getManifests(e[1])})).then((function(n){MsPortalFx.forEachKey(n,(function(n,t){o.trySetAllManifest(n,t)}))})));this._sideloadManifestsLoaded=Q.all(h).then((function(){return s[1]}))}return t.prototype.getManifests=function(n,t){var i=this,u=Object.create(null),r;return t&&Object.keys(this._cache).forEach((function(r){var f=i.getManifest(r,n);f&&(u[r]=!0,t(r,f))})),r=this._cachedManifestsLoaded[n]||(this._cachedManifestsLoaded[n]=Q.spread([this._sideloadManifestsLoaded,this._cachedManifestClient.getManifests(n),],(function(t,r){t.forEach((function(t){i.trySetManifest(t.name,n,r[t.name]||{})}))}))),t&&(r=MsPortalFx.tryImmediateResolve(r,(function(){Object.keys(i._cache).forEach((function(r){u[r]||t(r,i.getManifest(r,n))}))}))),r},t.prototype.getManifest=function(n,t){return this._getCache(n)[t]},t.prototype.getManifestAsync=function(n,t){var i=this;return MsPortalFx.tryImmediateResolve(MsPortalFx.tryImmediateResolve(this.getManifests(t),(function(){return i._getAsyncCache(n)[t].promise})),(function(){return i._getCache(n)[t]}))},t.prototype.trySetManifest=function(n,t,i,r){if(this._validateAndProcessManifest(n,i,r))return this._setManifest(n,t,i),!0},t.prototype.trySetAllManifest=function(n,t,i){var r=this;if(this._validateAndProcessManifest(n,t,i))return MsPortalEarly.cachedManifestTypes.forEach((function(i){r._setManifest(n,i,t)})),!0},t.prototype.getVersion=function(n){var t=this.getManifest(n,"assetTypes");return t&&t.pageVersion},t.prototype.getHostOverride=function(){return this._features.getValue("manifesthost")},t.prototype._setManifest=function(n,t,i){this._getCache(n)[t]||(this._getCache(n)[t]=i,this._getAsyncCache(n)[t].resolve())},t.prototype._getCache=function(n){return this._cache[n]||(this._cache[n]={})},t.prototype._getAsyncCache=function(n){return this._asyncCache[n]||(this._asyncCache[n]={assetTypes:Q.defer(),assetTypesBrowse:Q.defer(),assetTypesMenu:Q.defer(),galleryParts:Q.defer(),surveys:Q.defer(),uiDefinition:Q.defer(),extensionConfiguration:Q.defer(),sourceMappings:Q.defer()})},t.prototype._validateAndProcessManifest=function(n,t,i){var o=this,s=i||[],nt=[],ct,f,kt,dt;if(t||(ct="Manifest was not specified for the extension. Ensure that you passing a valid manifest to the MsPortalFx.Extension.register/FxExtension.registerAmd call that is used to register your extension with the portal.",s.push(ct)),f=t.assetTypes,f){e.validateIsArray("manifest.assetTypes",f,s)&&f.forEach((function(t){it(t,n,s,nt)}));var lt=this._features.getValue(n+"_hideassettypes"),at=this._features.getValue(n+"_showassettypes"),vt=this._features.getValue(n+"_assettypeoptions"),yt=this._features.getValue(n+"_resourcetypeapiversions"),pt=this._features.getValue(n+"_argbrowseoptions"),wt=this._features.getValue("manifesthost"),bt=this._features.getValue(n+"_hideassettypecommands"),v,rt=lt&&lt.toLowerCase().split(","),ut=at&&at.toLowerCase().split(","),p,ft=vt&&k(JSON.parse(vt.toLowerCase())),b,et=yt&&JSON.parse(yt.toLowerCase()),d,ot=pt&&JSON.parse(pt.toLowerCase()),g,st=bt&&JSON.parse(bt.toLowerCase()),l,a=t.environmentConfiguration;if(a){var ht=/([^:]*)/.exec(tt.location.host)[1],gt=a[wt]&&wt||a[ht]&&ht||MsPortalFx.find(Object.keys(a),(function(n){return ht.endsWith(n)}))||"*",u=a[gt];u&&(v=u.hideAssetTypes,p=k(u.assetTypeOptions),b=u.resourceTypeApiVersions,d=u.argBrowseOptions,g=u.hideAssetTypeCommands,l=u.assetTypeBrowseCommandsExperiments)}(ut||rt||v||ft||p||et||b||ot||d||st||g||l)&&f.forEach((function(n){var t=n.name.toLowerCase(),e=function(i){var u=i[t];u&&(u.options!==undefined&&(n.options=u.options),n.hideBrowseInfoBox=u.hideBrowseInfoBox,n.privateBrowse=r.supportsOption(n.options,1),n.resourceType&&n.resourceType.kinds&&n.resourceType.kinds.forEach((function(n){var i=n.name.toLowerCase(),t;u.kinds&&(t=u.kinds[i],t&&(t.options!==undefined&&(n.options=t.options),n.hideBrowseInfoBox=t.hideBrowseInfoBox))})))},o=function(i){var r=i[t];r&&(n.hiddenCommands=r)},a=function(i){i.includes(t)&&(n.privateBrowse=!1,n.options=n.options&-2)},s=function(i){i.includes(t)&&(n.privateBrowse=!0,n.options=n.options|1)},i,u,f,h,c;p?e(p):v&&s(v);ft?e(ft):ut?a(ut):rt&&s(rt);i=n.resourceType;i&&(u=b&&b[i.resourceTypeName.toLowerCase()],u&&(i.apiVersion=u),f=et&&et[i.resourceTypeName.toLowerCase()],f&&(i.apiVersion=f));d&&(h=(d[t]||"").toLowerCase(),n.argBrowseOption=w.ArgBrowseFeatureValueToEnumMap[h]);ot&&(c=(ot[t]||"").toLowerCase(),n.argBrowseOption=w.ArgBrowseFeatureValueToEnumMap[c]);g&&o(g);st&&o(st);n.browseCommandExperiments=l===null||l===void 0?void 0:l[t]}));(h||c)&&(kt=(n||"").toLowerCase()+"_",f.forEach((function(n){var t=kt+(n.name||"").toLowerCase(),i=n.resourceType;h[t]!==undefined&&i&&(i.apiVersion=h[t]);c[t]!==undefined&&(n.privateBrowse=!c[t],n.options=n.privateBrowse?n.options|1:n.options&-2)})))}if(!s.length)return dt=t,(dt.redirects||[]).forEach((function(t){if(t.toExtension=t.toExtension||(t.type!==3?n:""),t.fromExtension=t.fromExtension||n,t.toExtension===n||t.fromExtension===n)switch(t.type){case 2:case 3:var i=t;i.fromBlade&&(o._extensionBlockBladeRedirect&&i.toExtension.toLowerCase()===o._extensionBlockBladeRedirect||o._redirectMap.addBladeRedirect(i));break;case 4:case 5:o._redirectMap.addPartRedirect(t);break;case 6:o._redirectMap.addAssetRedirect(t)}})),!0;i||y.error("The manifest for '"+n+"' has validation errors. Errors: "+JSON.stringify(s));nt.length&&y.error("The manifest for '"+n+"' has non-fatal validation errors. Errors: "+JSON.stringify(nt))},__decorate([__metadata("fx:diagnostics",[n,"ManifestCache"]),i.Class(),__metadata("design:paramtypes",[i.Container,p,o.ExtensionManagerOptions,f.CachedManifestClient,FxImpl.Features])],t)})();t.ManifestCache=d}));
define("MsPortalImpl/UI/Compositions/UI.Composition",["require","exports"],(function(n,t){"use strict";function h(n){return function(t){return t.id===n}}function c(n,t,i){if(n)if(t){if(!i)throw new Error("Command container name is required.");}else throw new Error("Command name is required.");else throw new Error("Commands list is required.");return MsPortalFx.find(n,(function(n){return n.commandName===t}))}function l(n){var t=n.locator&&n.locator.type;return t===5||t===6||t===7}function a(n,t){return Object.keys(t).every((function(i){return n.hasOwnProperty(i)&&MsPortalFx.deepEquals(t[i],n[i])}))}function v(n){var t=n&&n.assetTypeId;if(typeof t=="string")return t}function y(n){var t=n;return t&&t.beforeActivateCommandMenuItems&&typeof t.beforeActivateCommandMenuItems=="function"}function p(n){return!!r[u(n)]}function u(n){return n.style===12?4:n.templateBlade?1:n.frameBlade?2:n.menuBlade?3:n.reactView?6:n.azBlade?5:0}var i,s,r;Object.defineProperty(t,"__esModule",{value:!0});t.getBladeType=t.bladeImplementedWithVirtualPart=t.isContextMenuContainer=t.tryGetAssetType=t.deepSubset=t.isPartComposition=t.findCommand=t.getIdMatchFunc=t.CompositionType=t.fxreplacedpartcomposing=t.CompositionInstanceDataName=t.PartContainerModelIdProperty=t.EditScopeIdPropertyName=t.referenceTypeMap=void 0;var f=MsPortalFx.Base,e=f.Constants,o=e.BladeParameterNames;t.referenceTypeMap={};t.referenceTypeMap[0]="Part";t.referenceTypeMap[1]="BladeInput";t.referenceTypeMap[2]="BladeActionBar";t.referenceTypeMap[3]="BladeProperty";t.referenceTypeMap[4]="Command";t.referenceTypeMap[5]="Constant";t.referenceTypeMap[6]="SelectedItem";t.referenceTypeMap[7]="Adapter";t.referenceTypeMap[8]="Dashboard";t.referenceTypeMap[9]="AdapterInput";t.EditScopeIdPropertyName=o.EditScopeId;t.PartContainerModelIdProperty="##SnapshotContainerId##";t.CompositionInstanceDataName="MsPortalImplCompositionInstance";t.fxreplacedpartcomposing="fxreplacedpartcomposing",(function(n){n[n.Unknown=0]="Unknown";n[n.Part=1]="Part";n[n.StartboardPart=2]="StartboardPart";n[n.Lens=3]="Lens";n[n.BladeActionBar=4]="BladeActionBar";n[n.Blade=5]="Blade";n[n.Journey=6]="Journey";n[n.Startboard=7]="Startboard"})(s=t.CompositionType||(t.CompositionType={}));t.getIdMatchFunc=h;t.findCommand=c;t.isPartComposition=l;t.deepSubset=a;t.tryGetAssetType=v;t.isContextMenuContainer=y;r=(i={},i[1]=!0,i[3]=!0,i[4]=!0,i[2]=!0,i[5]=!0,i[6]=!0,i);t.bladeImplementedWithVirtualPart=p;t.getBladeType=u}));
define("MsPortalImpl/Services/Services.Tenants",["require","exports","FxHubs/ArmHelpers/ArmApisStartup","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","FxHubs/RpcEndPoints","Fx/Ajax","FxInternal/AsyncLoader"],(function(n,t,i,r,u,f,e,o){"use strict";var h;Object.defineProperty(t,"__esModule",{value:!0});t.DEV=t.getHomeTenantsCountHandler=t.TenantsService=void 0;var v=MsPortalFx.Base,y=v.Diagnostics,s=y.Telemetry,k=v.Resources,a="home",d=y.createLog(n),c="Services.Tenants",l=(h={},h.home=0,h.projectedby=0,h.managedby=0,h),g=MsPortalFx.memoizeQ((function(n){var t=s.startTrace({source:c,action:n});return Q(e.ajax({uri:k.getAppRelativeUri("/api/directories/List"),type:"POST",dataType:"json",contentType:"application/json",performRetry:!0})).then((function(n){return s.completeTrace(t,{tenantsCount:(n.tenants||[]).length,failure:n.failure}),n.tenants.forEach((function(n){return n.tenantCategory=n.tenantCategory||a})),n})).catch((function(n){s.cancelTrace(t);throw n;}))})),p=MsPortalFx.memoizeQ((function(){var n=s.start({source:c,action:"_getTenantsMemo"});return Q(e.batch({uri:i.listTenantsApi(),setTelemetryHeader:c+".getTenants"}).then((function(t){var r=t.content.value||[],i,u;return(s.completeTrace(n,{tenantsCount:r.length}),i={failure:!1,tenants:[]},u={},r.forEach((function(n){var r=n.displayName||"",o=n.domains||[],f=n.tenantId,t=(n.tenantCategory||"").toLowerCase(),e;t||(d.warning("Tenant "+r+"("+f+") received from ARM with missing tenantCategory. Treating it as 'Home' tenant."),t=a);e={displayName:r,domainName:n.defaultDomain||o[0]||"",id:f,tenantCategory:t};t.split(",").forEach((function(n){l[n]++}));(n.defaultDomain||o.length===1)&&r?i.tenants.push(e):u[f]=e})),s.trace({source:c,action:"tenantsInfo",data:{allTenantsCount:r.length,tenantsWithInfoCount:i.tenants.length,homeTenantsCount:l.home,projectedTenantsCount:l.projectedby,managedByTenantsCount:l.managedby}}),i.tenants.length!==r.length)?g("GetTenantsFromArmFallback").then((function(n){return n.tenants.forEach((function(n){var t=u[n.id];t&&(t.displayName=n.displayName||n.id,t.domainName=n.domainName||n.id)})),MsPortalFx.forEachKey(u,(function(n,t){i.tenants.push(t)})),i})):i})).catch((function(t){return s.cancelTrace(n,MsPortalFx.getLogFriendlyMessage(t)),MsPortalFx.Hubs.Notifications.ClientNotification.publish({title:u.tenantErrorTitle,description:u.tenantErrorDescription.format(location.hostname),status:MsPortalFx.Hubs.Notifications.NotificationStatus.Error}),{tenants:[],failure:!0}})))})),w=MsPortalFx.memoizeQ((function(){return p().then((function(n){return n.tenants.filter((function(n){return n.tenantCategory.toLowerCase().includes(a)}))}))})),b=(function(){function t(){}return t.prototype.getHomeTenantsCount=function(){return w().then((function(n){return n.length}))},t.prototype.getTenants=function(){return p()},t.prototype.getHomeTenants=function(){return w()},__decorate([__metadata("fx:diagnostics",[n,"TenantsService"]),r.Class()],t)})();t.TenantsService=b;t.getHomeTenantsCountHandler=o.defineHandler(f.Directories.getHomeTenantsCountEndPoint,(function(n){return n.diContainer.get(b).getHomeTenantsCount()}))}));
define("MsPortalImpl/UI/UI.AuthStateManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Tenants"],(function(n,t,i,r,u){"use strict";function o(n,t){return(n&t)===t}function g(){if(!e){var n=Q.defer();p.updateSubscriptionInfoEndPoint.register(v.client,"HubsExtension",(function(t){n.resolve(t)}));e=n.promise}return e}var e;Object.defineProperty(t,"__esModule",{value:!0});t.getSubscriptions=t.AuthStateManager=t.hasFlag=void 0;var s=MsPortalFx.Base,a=s.Diagnostics,v=FxImpl.Rpc,y=FxImpl,p=HubsExtension.Internal.Azure,f=a.Telemetry,w=s.Resources,h=window,c=r.Services.PortalIdentity.tenantNameAndDomainFormat,b=MsPortalFx.ensureSuffix(w.getAppRelativeUri("/"),"/")+"SignOut";t.hasFlag=o;var l=MsPortalFx.isFeatureEnabled("persistcachedtokensonrefresh"),k={isAnonymous:!0},d=(function(){function t(n,t){var i=this,r,e;if(this._diContainer=n,this.bootstrapState=t,this.tokenCache={},this.persist=function(){i.bootstrapState&&MsPortalImpl.sessionStorage.setItem("authState",JSON.stringify(i.bootstrapState));l&&i.tokenCache&&Object.keys(i.tokenCache).length&&(f.trace({source:"UIAuthStateManager",action:"persistedTokenCache",data:{extensions:Object.keys(i.tokenCache)}}),MsPortalImpl.sessionStorage.setItem("extensionTokenCache",btoa(JSON.stringify(i.tokenCache))))},this._loadCurrentDirectoryDetailsMemo=MsPortalFx.memoizeQ((function(){var n=i.getCurrentUser(),e=MsPortalFx.isFeatureEnabled("tenants2020")&&!!n.tenantDisplayName,t,r;return e?(t=n.tenantDisplayName,r=n.tenantDomain,Q({directoryName:t,domainName:r,uniqueDirectoryName:c.format(t,r)})):i._diContainer.get(u.TenantsService).getHomeTenants().then((function(t){var o=(n.tenantId||"").toLowerCase(),e={},i="",r="",u="";return t.forEach((function(t){if(o===(t.id||"").toLowerCase()){var s=n.tenantDomain||n.tenantId;t.displayName&&t.displayName!==t.id||(t.displayName=s);t.domainName&&t.domainName!==t.id||(t.domainName=s);i=u=t.displayName;r=t.domainName}else t.displayName?e[t.displayName.toLocaleLowerCase()]=!0:f.trace({source:"UIAuthStateManager",action:"getUserInfo",data:t})})),e[i.toLocaleLowerCase()]&&(u=c.format(i,r)),{directoryName:i,domainName:r,uniqueDirectoryName:u}}))})),MsPortalFx.isFeatureEnabled("singlesignout")&&h.addEventListener("storage",(function(n){n.key==="signOutAll"&&(i.clear(),h.location.href=b)})),MsPortalImpl.localStorage.getItem("authState")&&(f.trace({source:"UIAuthStateManager",action:"clearAuthState"}),this.clear(!0)),l&&(r=MsPortalImpl.sessionStorage.getItem("extensionTokenCache"),r)){try{this.tokenCache=JSON.parse(atob(r));f.trace({source:"UIAuthStateManager",action:"loadedTokenCache",data:{extensions:Object.keys(this.tokenCache)}})}catch(o){f.trace({source:"UIAuthStateManager",action:"errorLoadingTokenCache",data:{error:MsPortalFx.sanitizeMessage(JSON.stringify(o))}})}MsPortalImpl.localStorage.removeItem("extensionTokenCache")}this.isMicrosoftOrAmeTenant=["72f988bf-86f1-41af-91ab-2d7cd011db47","33e01921-4d64-4f8c-a055-5bdaffd5e33d",].includes((this.getCurrentUser().tenantId||"").toLowerCase());e=[];this.onTokensUpdated=function(n){e.push(n)};this._notifyTokensUpdated=function(){e.forEach((function(n){return n(i)}))}}return t.prototype.updateRefreshToken=function(n,t){f.trace({source:"UIAuthStateManager",action:"updateRefreshToken"});var i=this.bootstrapState||{},u=i.refreshToken,r=__rest(i,["refreshToken"]);this.updateBootstrapState(__assign(__assign({},r),{refreshToken:n,altRefreshToken:t}),"updateRefreshToken")},t.prototype.clear=function(n){n||this.updateBootstrapState(null,"clear");MsPortalImpl.localStorage.removeItem("authState")},t.prototype.getUserInfo=function(n){var t=this,i=MsPortalFx.isNullOrUndefined(n)?7:n;return MsPortalFx.memoizeQ((function(n){return Q.spread([t.getCurrentUser(),t._loadCurrentDirectoryDetailsMemo(),],(function(t,i){var r={};return o(n,3)&&(r=__assign(__assign({},r),{email:t.emailAddress,preferredUsername:t.preferredUsername,givenName:t.firstName,surname:t.lastName})),o(n,4)&&(r=__assign(__assign({},r),{directoryId:t.tenantId,directoryName:i&&i.directoryName,domainName:i&&i.domainName,isOrgId:t.isOrgId,objectId:t.objectId,principalId:t.principalId,uniqueDirectoryName:i&&i.uniqueDirectoryName,isTenantAdmin:t.isTenantAdmin,countryCode:t.countryCode,isTenantParityDependent:t.isTenantParityDependent})),r}))}))(i)},t.prototype.getSignedInUserTenant=function(){return this.getCurrentUser().tenantDomain||""},t.prototype.getCurrentUser=function(){return this.bootstrapState&&this.bootstrapState.user||k},t.prototype.updateBootstrapState=function(n,t){f.trace({source:"UIAuthStateManager",action:"updateBootstrapState",data:{caller:t,isBootstrapStateNull:!n}});this.bootstrapState=n;this._notifyTokensUpdated()},t.prototype.updateExtensionTokens=function(n,t){if(n===null||n===void 0?void 0:n.length){var i=this.tokenCache;n.forEach((function(n){var r,f=(r=n.resource)!==null&&r!==void 0?r:"",u=n.name,e=i[u]||(i[u]={});e[f]=t}));this._notifyTokensUpdated()}},t.prototype.clearExtensionTokens=function(n){var t=this.tokenCache;delete t[n];this._notifyTokensUpdated()},t.create=function(n){return Q(MsPortalEarly.authBootstrapStatePromise).then((function(i){return new t(n,i)}))},__decorate([__metadata("fx:diagnostics",[n,"AuthStateManager"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.Container]),__metadata("design:returntype",Object)],t,"create",null),t})();t.AuthStateManager=d;y.registerGlobalState({reset:function(){e=null}});t.getSubscriptions=g}));
define("MsPortalImpl/Base/JQueryHelper",["require","exports"],(function(n,t){"use strict";function o(n,t){return n.find("."+t)}function f(n){return n.addClass(i)}function r(n){return n.removeClass(i)}function s(n,t){var i=t?r:f;return i(n)}function e(n){return!!n.offsetParent}function h(n){return n.toArray().some(e)}function c(){return u}function l(n,t){return $(n).find(t+u).filter((function(t,r){var u=$(r).parentsUntil(n,"."+i);return!u.length}))}function a(n,t){return r(n),n.show(t)}Object.defineProperty(t,"__esModule",{value:!0});t.forceShow=t.filterVisible=t.getUnhideSelector=t.isVisible=t.isElementVisible=t.toggle=t.unhide=t.hide=t.findByClassName=t.jBody=void 0;var i="fxs-display-none",u=":not(.fxs-display-none)";t.jBody=$(document.body);t.findByClassName=o;t.hide=f;t.unhide=r;t.toggle=s;t.isElementVisible=e;t.isVisible=h;t.getUnhideSelector=c;t.filterVisible=l;t.forceShow=a}));
define("MsPortalImpl/UI/UI.NavigationManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Base/JQueryHelper","FxInternal/AsyncLoader","FxInternal/Redirect","Fx/Ajax"],(function(n,t,i,r,u,f,e,o){"use strict";function y(n){return function(t){t?u.unhide(n):u.hide(n)}}var p,a,w;Object.defineProperty(t,"__esModule",{value:!0});t.DEV=t.forceSignInHandler=t.WindowManager=t.RootElements=t.Browser=void 0;var h=MsPortalFx.Base,v=h.UriBuilder,b=h.Diagnostics,k=h.Resources,d=b.Telemetry,c;(function(n){function i(){if(t){var n=MsPortalFx.Helpers.Deferred();return{promise:n.promise(),resolve:function(t){n.resolve(t)},reject:function(t){n.reject(t)}}}return Q.defer()}var t=FxImpl.features.isEnabled("jquerypromises",!1);n.defer=i})(c||(c={}));var s=window,g=d.trace,nt=MsPortalFx.pathJoin,tt="Shell",l=MsPortalFx.ensureSuffix,it=l(k.getAppRelativeUri("/"),"/"),rt=it+"signout/clearstate",ut=function(n){window.location.href=n};p=(function(){function t(){}return t.prototype.confirm=function(n){return s.confirm(n)},__decorate([__metadata("fx:diagnostics",[n,"Browser"]),i.Class()],t)})();t.Browser=p;a=(function(){function t(n,t){this.portal=n;this.splashScreen=t;[n,t].forEach((function(n){var t=n.length;if(t!==1)throw new Error("Unexpected length '"+n.selector+"': "+t);}));this.showPortal=y(n);this.showSplash=y(t)}return t.create=function(){return new t($(s.document.getElementById("web-container")),$(s.document.querySelectorAll("body>.fxs-splashscreen")))},t.prototype.dispose=function(){this.showPortal(!1)},__decorate([__metadata("fx:diagnostics",[n,"RootElements"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",t)],t,"create",null),t})();t.RootElements=a;w=(function(){function t(n,t){var u=this,r,f,i;this.unloadCallbacks=[];this.unloadCallbacks.push(n.persist);r=function(){u.unloadCallbacks.forEach((function(n){return n()}))};s.addEventListener("unload",r);this.location=s.location;f=n.getCurrentUser();i=n.bootstrapState;this.redirect=function(r){var h=r.uri||"",l=c.defer(),e=r.redirectAction||0,s;e&1&&n.clear();e&2&&MsPortalImpl.localStorage.removeItem("LastValidSessionTs");e&4&&MsPortalImpl.sessionStorage.clear();e&8&&o.postJSON({uri:rt},{portalAuthorization:i.refreshToken,altPortalAuthorization:i.altRefreshToken,tenant:i.user.tenantId});t.showSplash(!0);g({source:tt,action:"PortalRedirect",actionModifier:"Redirect",data:r});s=function(){l.resolve()};r.skipFlushBuffers?s():(Q.all(u.unloadCallbacks.map((function(n){return n()}))).finally(s),setTimeout(s,5e3));Q.allSettled([r.delayPromise,l.promise]).finally((function(){if(!h){var n=new v(location.href);n.path=nt("/",n.path,f.tenantId||"","/");h=n.toString()}ut(h)}))};this.openWindow=function(t){var i,r=MsPortalFx.tryImmediateResolve(Q(t),(function(t){var u;if(t){var r=new v(t),f=r.path,e=l(f,"/");MsPortalFx.localeCompareIgnoreCase(e,l(location.protocol+"//"+location.host,"/"))||(u=r.fragment,u.startsWith("#@")||(r.fragment="#@"+n.getSignedInUserTenant()+(u[0]==="#"?"/"+u.slice(1):""),t=r.toString()))}i?i.location.href=t:i=s.open(t)}));return i||(i=s.open()),r};this.dispose=function(){s.removeEventListener("unload",r)}}return __decorate([__metadata("fx:diagnostics",[n,"WindowManager"]),i.Class(),__metadata("design:paramtypes",[r.AuthStateManager,a])],t)})();t.WindowManager=w;t.forceSignInHandler=f.defineHandler(e.forceSignInEndPoint,(function(t){return MsPortalFx.require(n.normalize("./UI.NavigationManager.ForceSignIn")).then((function(n){return n.forceSignIn(t.diContainer,t.messageArg,t.messageContext.srcWindowId)}))}))}));
define("MsPortalImpl/Base/Base.ImplUtils",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Extension/Extension.Manifest"],(function(n,t,i,r,u,f,e){"use strict";function lt(n,t){t=t||{};var i=t.requireHttps||!1,r=i?st:ot;return r.test(n)}function at(n){var t="data-extensionname",i="["+t+"]["+t+"!='']";return $(n).closest(i).attr(t)||"fx"}function vt(n){var u=$(n),t=u.closest(".fxs-blade-content-container-details,.fxs-blade").data(r.CompositionInstanceDataName),i;return t&&r.bladeImplementedWithVirtualPart(t.bladeDefinition)?t.locator:(i=u.closest(".fxs-tile").data(r.CompositionInstanceDataName),i&&i.locator)}function l(n,t){var r,u,i;return n&&!n.isDisposed()&&n.scope==="composition"&&(i=n.get(d).locator,u=i.name,r=i.getExtensionName()),r||(typeof t=="string"?r=t:t&&(i=vt(t),i?(u=i.name,r=i.getExtensionName()):r=at(t))),{bladeOrPartName:u,extension:r||"fx"}}function g(n,t,r,u,f){var h,a,y,w;f===void 0&&(f={});var s=f.rpcClient,v=f.contextData,o=f.diContainer;v&&(u+=" "+JSON.stringify(v));try{if(s||(s=(o===null||o===void 0?void 0:o.get(p.Client))||p.client),h=l(o,t),a=h.bladeOrPartName,(a||"").toLowerCase().endsWith("_dx")){y=(o||i.container).get(e.ManifestCache);y.getManifestAsync(h.extension,"uiDefinition").then((function(n){try{var t=n.declarativeDefinitions[a],i=t.kind.toLowerCase();s.log("Microsoft_Azure_CreateUIDef",{level:r,code:0,area:i,message:MsPortalFx.getLogFriendlyMessage(u)})}catch(f){c.error(MsPortalFx.getLogFriendlyMessage(f))}}));return}w=a||n.normalize();s.log(h.extension,{level:r,code:0,area:w,message:MsPortalFx.getLogFriendlyMessage(u)})}catch(b){c.error(MsPortalFx.getLogFriendlyMessage(b))}}function yt(n,t,i,r){r=r?MsPortalFx.extend2(n.contextData,r):n.contextData;g(n.localRequire,n.windowContext,t,i,{contextData:r,diContainer:n.diContainer})}function pt(n,t,r){try{r=r||{windowContext:null,localRequire:null,diContainer:i.container};var e=r.windowContext,u=l(r.diContainer,e),f=r.localRequire&&r.localRequire.normalize(),o=MsPortalFx.extend2(r.contextData||{},{extensionName:u.extension,bladeOrPartName:u.bladeOrPartName,area:f}),s=MsPortalFx.getLogFriendlyMessage(t);new w.Log(f||u.bladeOrPartName||u.extension).writeEntry(n,s,null,[o])}catch(h){c.error(MsPortalFx.getLogFriendlyMessage(h))}}function h(n){n===void 0&&(n="");var t={},i=n.indexOf("?"),r=i>-1?n.substr(i+1):n,u=r.split("&");return u.forEach((function(n){if(n&&!n.match(/^\=+$/)){var i=n.split("="),r=i.shift(),u=i.length>0?i.join("="):"";t[r]=u}})),t}function a(n){var i="",t="";return ht(n,(function(n,r){i+="{0}{1}={2}".format(t,n,r);t||(t="&")})),i}function o(n){var t=n.toString().match(/^([^\:\/]+)\:\/\//);return t?t[1]+":":""}function s(n){var t;if(n=n.toString(),t=o(n),!t)return"";var i=n.substr(t.length+2),u=i.indexOf("/"),r=u>0?i.substr(0,u):i;return!r||r.indexOf("@")>0?"":r.replace(/\:.*/,"")}function tt(n){var t=it(n),r=s(t),u=v(t),i=o(t),f=(i?i.length+2:0)+r.length+(u?u.length+1:0);return!r||!i?"":t.substr(f)}function v(n){var i=o(n),r=s(n),u,t;return!i||!r?"":(u=i.length+2+r.length,t=n.toString().substring(u).match(/^\:([0-9]+)/),!t)?"":t[1]}function it(n){var t=n.toString().replace(/\#.*/g,"").replace(/\?.*/,"");return!s(t)||!o(t)?"":t}function rt(n){return(n=n.toString().replace(/\#.*/g,""),!n.match(/\?/))?"":n.replace(/.*\?/,"?")}function ut(n){return(n=n.toString(),!n.match(/\#/))?"":n.replace(/[^\#]*\#/,"#").replace(/\?.*/,"")}function ft(n){var t=n.indexOf("#"),i=t===-1?-1:n.substr(t).indexOf("?");return t===-1||i===-1?"":n.substr(t+i)}function wt(n,t){var i=new y.UriBuilder(t.uri+location.search+MsPortalFx.ensurePrefix(t.hash,"#")),r=i.query,e;MsPortalFx.forEachKey(et,(function(n,t){return r.setParameter(n,t)}));MsPortalFx.forEachKey(t.parameters,(function(n,t){return r.setParameter(n,t)}));e=n.get(f.AuthStateManager);e.clear(!0);n.get(u.WindowManager).redirect({uri:i.toString(),redirectAction:t.redirectAction||0})}var nt,et;Object.defineProperty(t,"__esModule",{value:!0});t.redirectWithCdn=t.getHashQueryStringSegment=t.getHashSegment=t.getQueryStringSegment=t.getPathSegment=t.getPort=t.getPathnameSegment=t.getHost=t.getProtocol=t.mapToQueryString=t.queryStringToMap=t.Uri=t.logIncludingProvenance=t.log=t.logToExtension=t.getLocationFromContext=t.validateAbsoluteHttpUri=t.CompositionProvenance=void 0;var y=MsPortalFx.Base,p=FxImpl.Rpc,w=y.Diagnostics,c=w.createLog(n),b="^([Hh][Tt][Tt][Pp][Ss]",k="://(?::)?@?(([dw.-]+)(?::(d+))?)?)([/\\w.()-]*)?(?:([?][^#]*)?(#.*)?).*$",ot=new RegExp(b+"?"+k),st=new RegExp(b+k),ht=MsPortalFx.forEachKey,ct=MsPortalFx.isEmpty,d=(function(){function t(n,t){this.locator=n;this.instanceId=t}return __decorate([__metadata("fx:diagnostics",[n,"CompositionProvenance"]),i.Value("composition"),__metadata("design:paramtypes",[Object,String])],t)})();t.CompositionProvenance=d;t.validateAbsoluteHttpUri=lt;t.getLocationFromContext=l;t.logToExtension=g;t.log=yt;t.logIncludingProvenance=pt;nt=(function(){function n(n){this._hashQs={};this._qs={};n=n&&n.toString()||"";this._protocol=o(n);this._host=s(n);this._port=v(n);this._pathname=tt(n);this._hash=ut(n);this._qsPart=rt(n);this._qs=h(this._qsPart);this._hashQsPart=ft(n);this._hashQs=h(this._hashQsPart)}return n.prototype.getQueryStringValue=function(n){return this._qs[n]||""},n.prototype.setHashQueryStringValue=function(n,t){return this._hashQs[n]=t,this},n.prototype.setHashQueryString=function(n){return this._hashQs=h(n),this},n.prototype.deleteHashQueryStringValue=function(n){return delete this._hashQs[n],this},n.prototype.clearHashQueryStringIfEmpty=function(){return ct(this._hashQs)&&(this._hashQsPart=""),this},n.prototype.getHashQueryStringValue=function(n){return this._hashQs[n]||""},n.prototype.setHash=function(n){return this._hash=n.toString().replace(/\?.*/,""),this},n.prototype.isHashEmpty=function(){return this.hash===""||this.hash==="#"},n.prototype.toString=function(){return this.href},Object.defineProperty(n.prototype,"href",{get:function(){return this.path+this.queryString+this.hash+this.hashQueryString},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"host",{get:function(){return this._host},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"path",{get:function(){return(this.protocol?this.protocol+"//":"")+this.host+(this.port?":"+this.port:"")+this.pathname},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pathname",{get:function(){return this._pathname},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"port",{get:function(){return this._port},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"protocol",{get:function(){return this._protocol},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"queryString",{get:function(){var n=a(this._qs);return n||this._qsPart?"?"+n:""},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hash",{get:function(){return this._hash||this.hashQueryString?"#"+(this._hash||"").replace(/^\#/,""):""},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hashQueryString",{get:function(){var n=a(this._hashQs);return this._hashQsPart||n?"?"+n:""},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hashWithHashQueryString",{get:function(){return this.hash+this.hashQueryString},enumerable:!1,configurable:!0}),n.prototype.getHashParts=function(){return this._cachedHashParts&&this._partsBasedHash===this.hash||(this._partsBasedHash=this.hash,this._cachedHashParts=MsPortalEarly.getHashParts(this.hash)),this._cachedHashParts},n})();t.Uri=nt;t.queryStringToMap=h;t.mapToQueryString=a;t.getProtocol=o;t.getHost=s;t.getPathnameSegment=tt;t.getPort=v;t.getPathSegment=it;t.getQueryStringSegment=rt;t.getHashSegment=ut;t.getHashQueryStringSegment=ft;et=["cloudsimpleextbearer","tokencaching","internalgraphapiversion","cae",].reduce((function(n,t){var i=MsPortalFx.getFeatureValue(t);return i&&(n["feature."+t]=i),n}),{});t.redirectWithCdn=wt}));
define("MsPortalImpl/Base/Base.BrowserDetection",["require","exports"],(function(n,t){"use strict";function a(){var n=/AppleWebKit\/([\d.]+)/.exec(i);if(n)return parseFloat(n[1])}function v(n){return window.matchMedia(n).matches}function y(){var t="-webkit- -moz- -o- -ms-".split(" "),n;return"ontouchstart"in window?!0:(n="("+t.join("touch-enabled),(")+"touch-enabled)",v(n))}Object.defineProperty(t,"__esModule",{value:!0});t.isTouch=t.webKitVersion=t.isMac=t.isIPadOS=t.isIOS=t.isAndroidOrMobile=t.isSafari=t.isIe11=t.isIe=t.isChromiumEdge=t.isEdge=t.isChrome=t.isFirefox=t.safari_11_webKitVersion=void 0;var i=window.navigator.userAgent,o=/Firefox\//i.test(i),u=/(Chrome)|(CriOS)[ /]/i.test(i),r=/Edge\//i.test(i),f=/MSIE /i.test(i),e=/Trident\//i.test(i),s=/Safari/i.test(i),h=/ip(hone|od|ad)/i.test(i),c=/ipad/i.test(i),l=/Edg\//i.test(i);t.safari_11_webKitVersion=604;t.isFirefox=o;t.isChrome=u&&!r;t.isEdge=r;t.isChromiumEdge=l;t.isIe=f||e||r;t.isIe11=!f&&e&&!r;t.isSafari=s&&!u&&!r;t.isAndroidOrMobile=/Mobile|Android/.test(i)||MsPortalFx.getFeatureValue("skipautofocus")==="true";t.isIOS=h;t.isIPadOS=c;t.isMac=/Mac/.test(window.navigator.platform);t.webKitVersion=a()||0;t.isTouch=y()}));
define("MsPortalImpl/Base/Base.CssSelectorParser",["require","exports"],(function(n,t){"use strict";function e(n){return n=n.replace("::after",":after").replace("::before",":before"),u=function(n,t){return t},a(n||"",!1)}function o(n){var t=n.map((function(n){return n.value}));return t.join("")}var v;Object.defineProperty(t,"__esModule",{value:!0});t.subselectorToString=t.parseCssSelector=void 0;t.parseCssSelector=e;t.subselectorToString=o;var r=jQuery.find,f=r.selectors,s=r.selectors.match,u;
/*!
     * -----------------------------------------------------------------------------
     * The portion of this file from here until "End of jQuery code snippet" is code
     * derived from the jQuery JavaScript Library v2.0.3 - http://jquery.com/
     * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors
     * Released under the MIT license - http://jquery.org/license
     * Date: 2013-07-03T13:30Z
     */
var i="[\\x20\\t\\r\\n\\f]",h=new RegExp("^"+i+"+|((?:^|[^\\\\])(?:\\\\.)*)"+i+"+$","g"),c=new RegExp("^"+i+"*,"+i+"*"),l=new RegExp("^"+i+"*([>+~]|"+i+")"+i+"*"),a=function(n,t){var o,e,v,i,w=u[n+" "],y,p,a;if(w)return t?0:w.slice(0);for(i=n,y=[],p=f.preFilter;i;){(!o||(e=c.exec(i)))&&(e&&(i=i.slice(e[0].length)||i),y.push(v=[]));o=!1;(e=l.exec(i))&&(o=e.shift(),v.push({value:o,type:e[0].replace(h," ")}),i=i.slice(o.length));for(a in f.filter)(e=s[a].exec(i))&&(!p[a]||(e=p[a](e)))&&(o=e.shift(),v.push({value:o,type:a,matches:e}),i=i.slice(o.length));if(!o)break}return t?i.length:i?r.error(n):u(n,y).slice(0)};
/*!
     * End of jQuery code snippet
     * -----------------------------------------------------------------------------
     */
v=undefined}));
define("MsPortalImpl/Base/Base.CssSanitizer",["require","exports","MsPortalImpl/Base/Base.CssSelectorParser","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u){"use strict";function c(n){return n==="cssFloat"?"float":(n||"").replace(/([A-Z])/g,"-$1").toLowerCase()}function l(n){return"css-scope-"+n.replace(nt,"")}function it(t){var r="."+l(t.name),i=[];return t.styleSheets=(t.styleSheets||[]).map((function(n){return v(n,r,i)})),i.forEach((function(i){var r="Sanitization error found in style sheet in extension: "+t.name+"\n"+y(i);u.logToExtension(n,t.name,2,r)})),!i.length}function rt(n,t,i){t.insertRule(".ignored1 { {0} }".format(n),0);t.insertRule(".ignored2 {}",1);var r=t.cssRules[0],u=t.cssRules[1];return r.type===CSSRule.STYLE_RULE?(b(r.style,u,i),u.style.cssText):(i.push("Not a style rule: "+n),null)}function a(n){var t=n.type==="MINWIDTH"?"min":"max";return"fxt-mq-"+t+"w-"+n.pixels}function v(n,t,i,r){var u=document.implementation.createHTMLDocument(""),e=u.createElement("style");u.body.appendChild(e);var o=vt(n,u),s=o.filter((function(n){return n.type===CSSRule.MEDIA_RULE})).reduce((function(n,t){var f=ot(t.media).map((function(n){return MsPortalFx.replaceAll(n,"all and ","").replace(/\((.*):\s*(.*)\)/,"($1: $2)").trim()})),u,e;return(f.filter((function(n){return!p(n)})).forEach((function(n){st(["Media query is not allowed"],n,i)})),u=f.filter((function(n){return p(n)})).map((function(n){var t=ut(n),i=a(t);return r&&r.push({mediaClass:i,mediaQuery:t}),"."+i})),u.length===0)?n:(e=et(t.cssRules).filter(k).map((function(n){return{selectorText:u.join()+" "+n.selectorText,cssText:n.cssText,style:n.style,type:n.type}})),__spreadArray(__spreadArray([],n),e))}),[]),h=__spreadArray(__spreadArray([],o),s).filter(k),c=h.map((function(n){var r=ht(n,e.sheet,t,i);return r?r.cssText:null})),f=c.join("\n");return["ext-mode-light","ext-mode-dark","ext-mode-standardcontrast","ext-mode-highcontrast","ext-highcontrast-light","ext-highcontrast-dark"].forEach((function(n){var i=["{0} {1}","{1} {0}"].map((function(i){return i.format(t,"."+n)}));f=MsPortalFx.replaceAll(f,i[0],i[1])})),f}function y(n){var t;switch(n.type){case e.StyleRule:t="Invalid CSS property - "+n.errorMessage+"\nCSS rule: "+n.rule.cssText;break;default:t="Invalid CSS Media Query - "+n.mediaQuery+"\nMedia Query: "+n.errorMessage}return t}function ut(n){var t=g.exec(n);return{type:t[1]==="min"?"MINWIDTH":"MAXWIDTH",pixels:Number(t[2])}}function ft(n){var t=n.toLowerCase().match(tt).reduce((function(n,t,i){return i>0?(t=t.charAt(0).toUpperCase()+t.slice(1),n+t):n+t}));return t==="float"&&(t="cssFloat"),t}function et(n){for(var i=[],t=0;t<n.length;t++)i[t]=n[t];return i}function p(n,t){return t===void 0&&(t=[d]),Boolean(t.some((function(t){return n.match(t)})))}function ot(n){return r.isIe?n.mediaText.split(",").map((function(n){return n.trim()})):Array.from(n)}function w(n,t,i){i.push.apply(i,n.map((function(n){return{type:e.StyleRule,rule:t,errorMessage:n}})))}function st(n,t,i){i.push.apply(i,n.map((function(n){return{type:e.MediaQuery,mediaQuery:t,errorMessage:n}})))}function ht(n,t,i,r){var e=[],o=ct(n.selectorText,i,e).replace(" .fxt-mq-",".fxt-mq-"),u,f;return w(e,n,r),o?(t.insertRule(o+" {}",0),u=t.cssRules[0],f=[],b(n.style,u,f),w(f,n,r),u):null}function b(n,i,r){for(var e,h,c=wt(n),s=0,a=c.length;s<a;s++){var u=c[s],f=n.getPropertyValue(u),v=n.getPropertyPriority(u);if(f!=="initial"){var y=at(v,r),l=null,o=null;t.stylePolicy.hasOwnProperty(u)?(l=u,e=t.stylePolicy[u],e===1?o=f:e instanceof Array?(h=e.indexOf(f),h>=0&&(o=e[h])):typeof e=="function"&&e(f)&&(o=f),o?i.style.setProperty(u,f,y):r.push("Disallowed style value. Property name: {0}, value: {1}".format(l,f))):r.push("Disallowed style property. Property name: "+u)}}}function ct(n,t,r){var u,f=[];try{u=i.parseCssSelector(n)}catch(e){return r.push("Malformed selector: "+n+"\nException: "+e.toString()),null}return u.forEach((function(n){lt(n,r)&&f.push(t+" "+i.subselectorToString(n))})),f.join(", ")}function lt(n,t){return!n.some((function(n){if(n.type==="CLASS"){if(n.value&&!MsPortalFx.startsWith(n.value,".ext-")&&!MsPortalFx.startsWith(n.value,".fxt-"))return t.push("Selectors can only refer to extension-specific class names (those starting with .ext- or .fxt-)"),!0}else if(n.type==="ID")return t.push("Selectors cannot refer to elements by ID"),!0}))}function at(n,t){return n?(t.push("Disallowed CSS priority value: "+n),""):n}function vt(n,t){var i=t.createElement("style");t.body.appendChild(i);i.textContent=n;var r=i.sheet,u=r&&r.cssRules;return u?Array.prototype.slice.call(u,0):[]}function yt(n){return n==="none"||n==="uppercase"||n==="lowercase"}function pt(n){return parseInt(n,10)>=0}function o(n,t){t.forEach((function(t){n[t]=1}))}function wt(n){for(var i,u=[],r=0,e=n.length;r<e;r++){if(i=n[r],f[i]&&!(i in t.stylePolicy))return bt(n);u.push(i)}return u}function bt(n){for(var i,r=[],t=h.length-1;t>=0;t--)i=h[t],n[i]&&r.push(c(i));return r}function k(n){return n.type===CSSRule.STYLE_RULE}var s,f;Object.defineProperty(t,"__esModule",{value:!0});t.generateErrorMessage=t.sanitizeStyleSheetText=t.mediaQueryToClass=t.sanitizeStyleDeclarationString=t.sanitizeDefinition=t.getScopeName=t.domStylePropertyToCssProperty=t.CssSanitizerErrorTypes=t.stylePolicy=void 0;s=["align-content","align-items","align-self","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-left","border-left-color","border-left-style","border-left-width","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-shadow","box-sizing","break-after","break-before","break-inside","clear","clip-path","color","content","counter-increment","counter-reset","cursor","display","enable-background","fill","fill-rule","fill-opacity","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","font-size","font-stretch","font-style","font-variant","font-weight","gap","row-gap","column-gap","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-gap","grid-column-start","grid-column-end","grid-gap","grid-row","grid-row-end","grid-row-gap","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","height","justify-content","left","line-height","list-style-position","list-style-type","margin","margin-left","margin-top","margin-right","margin-bottom","max-height","max-width","min-height","min-width","opacity","order","orphans","outline","outline-color","outline-style","outline-width","overflow","overflow-x","overflow-y","padding","padding-top","padding-left","padding-right","padding-bottom","pointer-events","right","scroll-snap-align","scroll-snap-type","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","table-layout","text-align","text-decoration","text-transform","text-overflow","top","transform","transform-origin","transition","transition-delay","transition-duration","transition-property","transition-timing-function","vertical-align","visibility","white-space","widows","width","word-break","word-wrap",];t.stylePolicy={};s.forEach((function(n){t.stylePolicy[n]=1}));t.stylePolicy.position=["relative","absolute","static","inherit"];t.stylePolicy["list-style-image"]=["none","inherit","initial"];t.stylePolicy["text-transform"]=yt;t.stylePolicy["z-index"]=pt;var d=/\(min-width: ([0-9]+)px\)/,g=/\((min|max)-width: ([0-9]+)px\)/,nt=/\W/g,tt=/[a-z|A-Z]+/g,h=Object.keys(t.stylePolicy).map(ft),e;(function(n){n[n.MediaQuery=0]="MediaQuery";n[n.StyleRule=1]="StyleRule"})(e=t.CssSanitizerErrorTypes||(t.CssSanitizerErrorTypes={}));t.domStylePropertyToCssProperty=c;t.getScopeName=l;t.sanitizeDefinition=it;t.sanitizeStyleDeclarationString=rt;t.mediaQueryToClass=a;t.sanitizeStyleSheetText=v;t.generateErrorMessage=y;f={};o(f,["background-position-x","background-position-y"]);r.isChrome||r.isSafari?o(f,["background-repeat-x","background-repeat-y","font-variant-alternate","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","overflow-wrap","text-decoration-color","text-decoration-line","text-decoration-style","-webkit-border-horizontal-spacing","-webkit-border-vertical-spacing",]):r.isFirefox?o(f,["-moz-border-top-colors","-moz-border-right-colors","-moz-border-bottom-colors","-moz-border-left-colors","font-variant-caps","font-variant-ligatures","font-variant-numeric","font-variant-position","overflow-wrap","text-decoration-color","text-decoration-line","text-decoration-style",]):r.isEdge&&o(f,["overflow-wrap",])}));
define("MsPortalImpl/Base/Base.KnockoutBindingSanitizer",["require","exports","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.CssSanitizer"],(function(n,t,i,r){"use strict";function g(n){return d[n]||n}function a(n,t,i,r,f){var o=[],s=ko.expressionRewriting.parseObjectLiteral(t),e=!0;return s.forEach((function(t){var c=(t.key||t.unknown||"").trim(),l=g(c),s=k[l],a,y;s||l.substring(0,h.length)!==h||(s=u);s?(a=(t.value||"").trim(),y=s(a,r,n.windowContext),y!==null?o.push(v(l)+": "+y):(e=!1,f.push({provenanceContext:n,reason:6,tag:i,binding:c,val:a}))):(e=!1,f.push({provenanceContext:n,reason:5,tag:i,binding:c}))})),e?o.join(", "):null}function tt(n,t,i,r){var f=/^\s*ko\s([\s\S]*)/.exec(t),u;return f?(u=a(n,f[1],"comment",i,r),u===null?" ko ":" ko "+u+" "):/^\s *\/ko/.test(t)?" /ko ":null}function v(n){return n&&!l.exec(n)&&(nt.exec(n)||(n="'"+n.replace("'","\\'")+"'")),n}function u(n){var r=e(n),t,i;if(r!==null)return r;for(t=0;t<c.length;t++)if(i=n.split(c[t]),i.length===2&&e(i[0].trim())&&e(i[1].trim()))return n;return null}function it(t,r,f){return i.logToExtension(n,f,1,b),u(t)}function rt(n,t,i){var h=r.domStylePropertyToCssProperty(n),f=i.style[h],e=l.exec(t),s=e?t.slice(1,-1):null,o=!1;return f===1?o=!!e||u(t)===t:f instanceof Array?o=!!e&&f.includes(s):typeof f=="function"&&(o=!!e&&f(s)),o}function e(n){return/^\!?([\$_a-z0-9\.'\-"\[\]]|\(\))+$/i.test(n)||/^\{\s*\}$/.test(n)?n:null}function o(n){return y(n,(function(n,t){return!!u(t)}))}function y(n,t){return function(i,r){var e=ko.expressionRewriting.parseObjectLiteral(i),u=[],f=!0;return e.forEach((function(i){var e=(i.key||"").trim(),o=(i.value||"").trim();n(e,r)&&t(e,o,r)?u.push(v(e)+": "+o):f=!1})),f?"{ "+u.join(", ")+" }":null}}function p(n){return o((function(t){return n.includes(t)}))}function w(n){return/^"[^"]*"$/.test(n)||/^'[^']*'$/.test(n)?n:null}function ut(n){return function(t){var i=n.some((function(n){return t==='"'+n+'"'||t==="'"+n+"'"}));return i?t:null}}function s(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(n,i){for(var u,r=0;r<t.length;r++)if(u=t[r](n,i),u!==null)return u;return null}}Object.defineProperty(t,"__esModule",{value:!0});t.sanitizeBindingComment=t.sanitizeBindingAttribute=void 0;var f=s(u,o((function(){return!0}))),b="Support for the 'click' binding will soon be removed. Replace uses of 'click' with 'fxclick'. Find 'fxclick' samples at: https://aka.ms/portalfx/fxclicklink.",k={checked:u,click:it,clickBubble:u,commands:s(u,o((function(){return!0}))),disable:u,disableAutoDispose:u,enable:u,event:p(["click","keypress","afterkeypress"]),foreach:s(u,p(["data","as"])),formElement:f,fxclick:u,fxParameterCollector:u,htmlTemplate:f,"if":u,ifnot:u,image:u,options:u,optionsText:w,optionsValue:w,sanitizedAttr:f,sanitizedCss:f,sanitizedHtml:u,selectedOptions:u,style:y((function(n,t){return t.style.hasOwnProperty(r.domStylePropertyToCssProperty(n))}),rt),submit:u,text:u,uniqueName:u,visible:u,value:u,valueUpdate:ut(["afterkeyup"]),vtext:u,"with":u},d={attr:"sanitizedAttr",css:"sanitizedCss",html:"sanitizedHtml"};var h="pc",c=["===","==","!==","!=","<=","<",">=",">","&&","||","-","+","*","/"],l=/^("([^"\\]|\\.)*"|'([^'\\]|\\.)*')$/,nt=/^[a-z_$][a-z0-9_$]*$/i;t.sanitizeBindingAttribute=a;t.sanitizeBindingComment=tt}));
define("MsPortalImpl/Base/Base.LruMap",["require","exports"],(function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LruMap=void 0;var i=(function(){function n(n){this._map=Object.create(null);this._count=0;this._lastAccessed=0;this._capacity=n}return n.prototype.count=function(){return this._count},n.prototype.contains=function(n){return!!this._map[n]},n.prototype.trim=function(n){var r=this,t,i;(typeof n!="number"&&(n=this._capacity),t=this.count()-n,typeof n!="number"||t<1)||(i=this._lastAccessed-n+1,MsPortalFx.forEachKey(this._map,(function(n,t,r){t.lastAccessed<i&&r.push(t)}),[]).sort((function(n,t){return t.lastAccessed-n.lastAccessed})).some((function(n){return delete r._map[n.key],t--,t<1})),this._count=n)},n.prototype.getOrAdd=function(n,t){var r=this._map[n],i;if(r)r.lastAccessed=++this._lastAccessed,i=r.data;else if(t)i=t(n),this.addOrUpdate(n,i);else throw new Error("Unable to find item with key: '"+n+"'.");return i},n.prototype.addOrUpdate=function(n,t,i){var r=this._map[n];return r?(r.data=t,r.lastAccessed=++this._lastAccessed):(this._map[n]={key:n,data:t,lastAccessed:++this._lastAccessed},this._count++,i||this.trim()),!r},n.prototype.remove=function(n){this._map[n]&&(this._count--,delete this._map[n])},n})();t.LruMap=i}));
define("MsPortalImpl/Base/Base.Sanitization",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.ImplUtils","FxInternal/Utils/LinkSanitizer"],(function(n,t,i,r,u){"use strict";function o(n,t,i){return n===""||r.validateAbsoluteHttpUri(n)||f.test(n)||"_self"===t&&l.test(n)?(h(n,i),!0):!1}function s(n){return((n===null||n===void 0?void 0:n.diContainer)||i.container).get(u.LinkSanitizer)}function h(n,t){var u=r.getLocationFromContext(t===null||t===void 0?void 0:t.diContainer,t===null||t===void 0?void 0:t.windowContext).extension,i;FxImpl.features.isEnabled("logexternaldomainlinks")&&!s(t).isTrustedDomainLink(n,u)&&(i=MsPortalFx.sanitizeMessage(n),r.logIncludingProvenance(1,"Link is external to the known valid domains: "+i,t))}function v(n,t){return n===""||e.test(n)||r.validateAbsoluteHttpUri(n)||f.test(n)?(h(n,t),!0):!1}function y(n){return n===""||e.test(n)}function p(n){return n===""||a.test(n)}function w(t,i,u){var f=o(t,i,u);return f||r.logToExtension(u&&u.localRequire||n,u&&u.windowContext||null,2,"Disallowed URI: "+t),f}function b(n,t){if(n===""||e.test(n))return n;if(r.validateAbsoluteHttpUri(n)||f.test(n)){var i=r.getLocationFromContext(t.diContainer,t.windowContext).extension;return s(t).getSafeLink(n,i)}return!1}function k(){return c}var c;Object.defineProperty(t,"__esModule",{value:!0});t.getAllowListedAttr=t.sanitizeLinkUri=t.sanitizeUri=t.validateDataImage=t.validateLocalUriOnly=t.validateLinkUri=t.validateUriOrBlank=void 0;var d=MsPortalFx.Base.Diagnostics,f=/^(vstfs:|ftp:|ftps:|sftp:|storageexplorer:|adlalink:|adl:|asalink:|vscode:|vsweb:|azuredatastudio:|bfcomposer:|ms-quick-assist:|ms-remote-assist:|)\/\/|^mailto:/,l=/^#(allservices|asset|blade|create|dashboard|home|menu|resource)\b/,e=/^#/,a=/^(data:image)\//;t.validateUriOrBlank=o;t.validateLinkUri=v;t.validateLocalUriOnly=y;t.validateDataImage=p;t.sanitizeUri=w;t.sanitizeLinkUri=b;c=["alt","border","colspan","rowspan","span","disabled","height","width","lang","spellcheck","title","value","dx-content-path","dx-content-property","cx","cy","d","rx","ry","x","y","x1","x2","y1","y2","fill","fill-rule","opacity","points","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-width","transform","vector-effect","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-current","aria-disabled","aria-expanded","aria-haspopup","aria-hidden","aria-invalid","aria-label","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","role",];t.getAllowListedAttr=k}));
define("MsPortalImpl/Base/Base.KnockoutTemplateSanitizer",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.KnockoutBindingSanitizer","MsPortalImpl/Base/Base.CssSanitizer","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.LruMap"],(function(n,t,i,r,u,f,e,o){"use strict";function b(n,t,i,r,u){var f=r&&r.htmlTemplateInline;f&&k(n,t,i,f,u,(function(){f.content=null}))}function ut(n,t,i,r){i.isWeave||(i.lenses||[]).forEach((function(u){(u.partInstances||[]).forEach((function(u){b(n,t,i.name+"/"+u.name,u.inline,r)}))}))}function ft(n,t,r){r===void 0&&(r=i.container);var u=n.name;MsPortalFx.forEachKey(n.htmlTemplates,(function(i,f){k(r,u,i,f,t,(function(){delete n.htmlTemplates[i]}))}))}function k(t,i,r,u,f,e){var o=t.get(a).sanitize({contextData:{File:u.file,TemplateKey:r},diContainer:t,localRequire:n,value:u.content,windowContext:i}),s=!o.errors.length,h=s||f===0;h?u.content=o.sanitizedMarkup:e()}function et(n,t){var i=h[n.reason]||"Unknown";r.log(n.provenanceContext,t,"Sanitization error found: "+i,{Tag:n.tag,Attribute:n.attr,Binding:n.binding,Value:n.val})}function ot(n,t,i){function ft(i,r,u,f,e,o){if(!t&&i===s.validateKOBindingString)return null;if(i===1)return r;if(typeof i=="object")return r in i?r:null;if(i instanceof Function){var h=i(r,u,f,e,c,o,n);return typeof h=="boolean"?h===!0?r:null:typeof h=="string"?h:null}return null}function ot(t,i,r,u){if(r.hasAttribute(t)&&!u.hasAttribute(t)){var s=r.getAttribute(t),f=[],e=ft(i,s,r.nodeName.toUpperCase(),t,u,f);e!==null&&u.setAttribute(t,e);f.length>0?f.forEach((function(n){o.push(n)})):e===null&&o.push({provenanceContext:n,reason:1,tag:r.nodeName.toUpperCase(),attr:t,val:s})}}function tt(n,t,i){var r;if(typeof i=="object")for(var u=0,f=n.attributes,e=f.length;u<e;u++)r=f[u].name,r in i&&ot(r,i[r],n,t)}function it(i,r){var l=i.nodeName.toUpperCase(),s,p,w,rt,a,v,st,y,nt;if(i.nodeType===Node.ELEMENT_NODE&&(d||(d=i!==h.body)))if(k[l]){if(s=FxImpl.createElement(l),tt(i,s,k[l]),tt(i,s,ut),p=i.getAttribute("style"),p&&(w=[],rt=f.sanitizeStyleDeclarationString(p,g,w),w.forEach((function(t){o.push({provenanceContext:n,reason:3,tag:l,attr:"style",val:t})})),s.setAttribute("style",rt)),l==="A"){var ft=i.getAttribute("href"),et=i.getAttribute("target"),ht=!MsPortalFx.isNullOrWhiteSpace(ft)&&e.validateUriOrBlank(ft,null,n);ht&&((MsPortalFx.isNullOrWhiteSpace(et)||et==="_self")&&s.setAttribute("target","_blank"),s.setAttribute("rel","noopener"))}r.appendChild(s);r=s}else if(o.push({provenanceContext:n,reason:4,tag:l}),!MsPortalFx.isFeatureEnabled("oldsanitizer"))return r;for(var b=0,ot=i.childNodes,ct=ot.length;b<ct;b++){a=ot[b];switch(a.nodeType){case Node.TEXT_NODE:r.appendChild(document.createTextNode(a.textContent));break;case Node.ELEMENT_NODE:it(a,r);break;case Node.COMMENT_NODE:v=c.comments;st=!t&&v===u.sanitizeBindingComment;!st&&v&&v instanceof Function&&(y=[],nt=v(n,a.textContent,c,y),nt!==null&&r.appendChild(document.createComment(nt)),y.length>0&&y.forEach((function(n){o.push(n)})))}}return r}var h=document.implementation.createHTMLDocument(""),rt=document.createDocumentFragment(),p=FxImpl.createElement("div"),b=c.elements,k=b.tags,ut=b.global,o=[],d=!1,l=n.value||"",a,g,v;return rt.appendChild(p),w.forEach((function(t){try{l=nt(l,t,y+t)}catch(u){r.log(n,i,"An error occured processing the untrustedHTMLString '"+l+"'.\nuntrustedHTMLString is now set to empty string to prevent further errors.\nError message was: '"+u.message+"'.\nReview binding and any other context provided.");l=""}})),h.body.innerHTML=l,a=h.createElement("style"),a.setAttribute("type","text/css"),h.head.appendChild(a),g=a.sheet,it(h.body,p),o.forEach((function(n){return et(n,i)})),v=p.innerHTML,w.forEach((function(n){v=nt(v,y+n,n)})),{sanitizedMarkup:v,errors:o}}function st(n,t,r,u){return i.container.get(a).sanitize({value:n,localRequire:t,windowContext:r,diContainer:i.container},u)}function nt(n,t,i){if(!n)return n;var r=new RegExp("(\\s+)"+t+"(\\s*\\=)","g");return n.replace(r,"$1"+i+"$2")}function v(n,t){var i={};return i[y+n]=t,i}function tt(n){return rt.test(n)}function ht(t,i,u,f){ko.ignoreDependencies((function(){var e=ko.unwrap(i);e&&typeof e=="string"&&tt(e)&&r.logToExtension(n,u,2,FxImpl.createError("Html injections in string text properties are not accepted anymore. Please make use of an alternative HtmlContent value"+(f?' for your "'+f+'" field':"")+'. The injected property in question is "'+e+'".'),{diContainer:t})}))}var d,c,h,l,a,g;Object.defineProperty(t,"__esModule",{value:!0});t.checkStringForHtmlInjection=t.looksLikeAnHtmlFragment=t.sanitizeHTML=t.KODeniedTemplateSanitizer=t.KOAllowedTemplateSanitizer=t.TemplateSanitizer=t.isAllowedCssClassName=t.sanitizeDefinition=t.sanitizeBladeDefinition=t.sanitizeInlineTemplate=void 0;var ct=MsPortalFx.Base.Diagnostics,it=/^(az-|ms-|msportalfx|ext-|lang-|fxt-)[_\-a-zA-Z0-9]+$/,p=MsPortalFx.getUniqueId().toLowerCase(),rt=/(&.*?;)|(<.*?>)/,s={sanitizeLinkUri:function(n,t,i,r,u,f,o){return e.sanitizeLinkUri(n,o)},validateUriOrBlank:function(n,t,i,r,u,f,o){return e.validateUriOrBlank(n,null,o)},validateLocalUriOnly:e.validateLocalUriOnly,validateClassNames:function(n,i,r,u,f,e,o){for(var l=/[_\-a-z0-9]+/ig,h,c=[],s;h=l.exec(n);)s=h[0],t.isAllowedCssClassName(s)?c.push(s):e.push({provenanceContext:o,reason:2,tag:i,val:s});return c.join(" ")||null},validateKOBindingString:function(n,t,i,r,f,e,o){return u.sanitizeBindingAttribute(o,n,t,f,e)},mapName:function(n,t,i,r){return r.setAttribute(i,"TemplateSanitizer"+p+"_"+n),!1}},w=["src",],y="data-sanitizer-"+p+"-";t.sanitizeInlineTemplate=b;t.sanitizeBladeDefinition=ut;t.sanitizeDefinition=ft;d=function(n){return typeof n=="string"&&it.test(n)};t.isAllowedCssClassName=d;c=(function(){function i(t){return t.length?n(t):1}function n(n){var t={};return n.forEach((function(n){var u,r;if(typeof n=="string")t[n]=1;else for(u in n)r=n[u],t[u]=r instanceof Function?r:i(r)})),t}var t,r=["ABBR","ADDRESS","ARTICLE","B","BLOCKQUOTE","BR","CAPTION","CITE","CODE","COL","COLGROUP","DD","DEL","DFN","DIV","DL","DT","EM","FIELDSET","FIGURE","FIGCAPTION","FONT","FOOTER","HEADER","H1","H2","H3","H4","H5","H6","HR","I","INS","LABEL","LEGEND","MARK","OL","P","PRE","Q","S","SECTION","SMALL","SPAN","STRONG","SUB","SUP","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","U","UL",{A:[{href:s.sanitizeLinkUri},"target"]},{BUTTON:["value"]},{IMG:[v("src",s.validateUriOrBlank)]},{INPUT:[{type:["text","password","radio","checkbox","submit"]},"checked","maxlength","value"]},{LI:["value"]},{OPTION:["label","selected","value"]},{SELECT:["multiple","size"]},{TEXTAREA:["rows","cols"]},{TIME:["datetime"]},{SVG:["viewBox","focusable",{"xmlns:xlink":s.validateUriOrBlank},{"xmlns:svg":s.validateUriOrBlank},{xmlns:s.validateUriOrBlank}]},{CIRCLE:["r"]},"DEFS","DESC",{ELLIPSE:["id"]},{G:["id"]},{LINE:["id"]},"METADATA",{PATH:["id"]},{POLYGON:["id"]},{POLYLINE:["id"]},{RECT:["id"]},{STOP:["offset"]},{TEXT:["id","font-size"]},"TITLE",{USE:["id",{"xlink:href":s.validateLocalUriOnly}]},{AUDIO:[v("src",s.validateUriOrBlank),"controls","currentTime","duration","preload"]},{VIDEO:[v("src",s.validateUriOrBlank),"controls","poster","preload","autoplay"]},{SOURCE:[v("src",s.validateUriOrBlank),"type"]},],o=(t=[{"data-bind":s.validateKOBindingString},{"class":s.validateClassNames},{name:s.mapName},"dx-content-path","dx-content-property","data-click-telemetry",{"data-activatable":["true","false"]},"data-activate-info",]).concat.apply(t,e.getAllowListedAttr());return{style:f.stylePolicy,elements:{tags:n(r),global:n(o)},comments:u.sanitizeBindingComment}})();h=[];h[1]="Invalid attribute";h[2]="Invalid CSS class name";h[3]="Invalid CSS property";h[4]="Invalid tag";h[5]="Unknown or prohibited binding";h[6]="Invalid binding value";l=(function(){function n(n){this._allowKnockoutBindings=n;this._templateCache=new o.LruMap(100);this.executionCount=0}return n.prototype.sanitize=function(n,t){var i=this,r;return t===void 0&&(t=2),r=n.value||"",this._templateCache.getOrAdd(r,(function(){return i.executionCount++,ot(n,i._allowKnockoutBindings,t)}))},n})();t.TemplateSanitizer=l;a=(function(t){function r(){return t.call(this,!0)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"KOAllowedTemplateSanitizer"]),i.Class(),__metadata("design:paramtypes",[])],r)})(l);t.KOAllowedTemplateSanitizer=a;g=(function(t){function r(){return t.call(this,!1)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"KODeniedTemplateSanitizer"]),i.Class(),__metadata("design:paramtypes",[])],r)})(l);t.KODeniedTemplateSanitizer=g;t.sanitizeHTML=st;t.looksLikeAnHtmlFragment=tt;t.checkStringForHtmlInjection=ht}));
define("MsPortalImpl/Controls/ControlBindings",["require","exports"],(function(n,t){"use strict";function i(n,i){t.controlBindingMap[n]=i}function f(n,t){var i=ko.unwrap(n()),u;if(i){if(u=t[i.controlType],!u)throw new Error("Unsupported ControlType in formControl binding handler: "+i.controlType+".");return r[u]}}function e(n,t,i,r,u,e){var s=f(t,e),o;if(s)return o=$(n),o.attr("data-formelement",o.attr("data-bind")),s.init(n,t,i,r,u)}function o(n,t,i,r,u,e){if(n){var o=f(t,e);if(o)return o.update(n,t,i,r,u)}}var r,u;Object.defineProperty(t,"__esModule",{value:!0});t.controlBindingMap=void 0;r=ko.bindingHandlers;t.controlBindingMap={};i(127,"pcAccordion");i(20,"pcArtifactLinks");i(106,"pcAsyncFileUpload");i(16,"pcAttachment");i(63,"pcChart");i(7,"pcCheckBoxField");i(208,"pcClipboardButton");i(75,"pcConsole");i(40,"pcCopyableLabel");i(85,"pcCreatorAndSelectorV2");i(23,"pcCustomHtmlField");i(91,"pcCustomValueSlider");i(111,"pcCustomRangeSlider");i(25,"pcDatePickerField");i(26,"pcDateTimePickerField");i(27,"pcDateTimeRangePickerField");i(92,"pcDayPickerField");i(76,"pcDeleteAssetConfirmation");i(33,"pcDiffEditor");i(32,"pcDockedBalloon");i(65,"pcDonut");i(3,"pcDropDownField");i(99,"pcDurationPickerField");i(15,"pcSection");i(37,"pcEditor");i(120,"pcEssentials");i(82,"pcFileDownloadButton");i(12,"pcFilterComboField");i(55,"pcGallery");i(67,"pcGraph");i(125,"pcEditableGrid");i(130,"pcArrayGrid");i(131,"pcDataGrid");i(132,"pcPagedDataGrid");i(133,"pcSequentialDataGrid");i(98,"pcGroupDropDownField");i(77,"pcHeroBanner");i(19,"pcHistory");i(84,"pcHotSpot");i(108,"pcIFrame");i(113,"pcIFrame2");i(78,"pcInfoBox");i(121,"pcIntuneAppFileUpload");i(118,"pcLegend");i(88,"pcHotSpot");i(87,"pcInfoBox");i(58,"pcLogStream");i(68,"pcMap");i(109,"pcMediaPlayer");i(115,"pcMenu");i(69,"pcMetrics");i(126,"pcMonitorChart");i(126,"pcMonitorChartV2");i(204,"pcMetricGrid");i(13,"pcMultiLineTextField");i(79,"pcNotice");i(10,"pcNumericTextBoxField");i(29,"pcOAuthButtonField");i(4,"pcOptionsGroupField");i(209,"pcPager");i(70,"pcPairedTimeline");i(94,"pcPairedTimelineBadges");i(5,"pcPasswordField");i(39,"pcCheckBox");i(42,"pcDropDown");i(43,"pcFilterCombo");i(54,"pcGrid");i(56,"pcListView");i(110,"pcMarkdown");i(45,"pcMultiLineTextBox");i(46,"pcMultiselectDropDown");i(47,"pcNumericTextBox");i(48,"pcOptionPicker");i(49,"pcPassword");i(50,"pcRangeSlider");i(52,"pcSlider");i(57,"pcTreeView");i(112,"pcPartPinner");i(80,"pcPicker");i(128,"pcPill");i(129,"pcPillCollection");i(123,"pcPillList");i(89,"pcPreviewTag");i(71,"pcProgressBar");i(31,"pcQueryBuilder");i(72,"pcQuotaGauge");i(9,"pcRangeSliderField");i(93,"pcSearchBox");i(86,"pcRangeSelection");i(114,"pcResourceFilter");i(1,"pcFormSection");i(11,"pcSelectorField");i(100,"pcSimpleButton");i(206,"pcRecommendations");i(97,"pcChart");i(73,"pcSingleValueGauge");i(6,"pcSliderField");i(95,"pcSpecComparisonTable");i(21,"pcSplitter");i(207,"pcSplitter2");i(134,"pcSummary");i(135,"pcPricingControl");i(124,"pcResourceDropDown");i(136,"pcTagsByResource");i(101,"pcTextBlock");i(2,"pcTextField");i(24,"pcTimePickerField");i(62,"pcToolbar");i(22,"pcTriStateCheckBox");i(116,"pcVideo");i(107,"pcWizard");i(119,"pcHeatMap");i(137,"pcArmErrorList");i(138,"pcDocsControl");i(201,"pcFileShareDropDown");i(202,"pcStorageAccountDropDown");i(205,"pcToggle");i(104,"pcList2");i(203,"pcBlobContainerDropDown");u={};[127,20,16,7,208,85,23,91,111,25,26,27,92,138,3,99,15,120,201,12,98,124,19,108,113,110,13,8,10,29,4,112,5,128,129,123,135,89,9,1,11,6,21,207,202,134,136,2,24,22,].forEach((function(n){return u[n]=t.controlBindingMap[n]}));r.pcControl={init:function(n,i,r,u,f){return e(n,i,r,u,f,t.controlBindingMap)},update:function(n,i,r,u,f){return o(n,i,r,u,f,t.controlBindingMap)}};r.formElement={init:function(n,t,i,r,f){return e(n,t,i,r,f,u)},update:function(n,t,i,r,f){return o(n,t,i,r,f,u)}}}));
define("Viva.Controls/Controls/Base/Viva.KnockoutExtensions",["require","exports","MsPortalImpl.Controls/Controls/Base/WidgetBinding"],(function(n,t,i){"use strict";var r;return (function(){function u(t){return function(i,r,u,f,e){var s=ko.unwrap(r()),h,a,c,l,o;if(s&&(h=s.text,a=s.visible,c=s.disabled,l=s.handler),!s||!h||!a||!c||!l||!s.execute)throw new Error("Command");o=n.text[t];o&&o(i,(function(){return h}),u,f,e);o=n.value[t];o&&o(i,(function(){return h}),u,f,e);o=n.visible[t];o&&o(i,(function(){return a}),u,f,e);o=n.disable[t];o&&o(i,(function(){var r=c()||ko.unwrap(e.$disabled||!1),n=l(),u=n?n.canExecute():!1,t=r||!u;return i&&$(i).toggleClass("azc-command-disabled",t),t}),u,f,e);o=n.click[t];o&&o(i,(function(){return function(){var n=l();n&&!c()&&n.canExecute()&&s.execute()}}),u,f,e)}}function e(n){var t=i.createIsolatedContext(n.$data,n);return t.createChildContext=function(t){return i.createIsolatedContext(t,n)},t}var n=ko.bindingHandlers,r,f,t;n.azcCommand={init:u("init"),update:u("update")};n.stopBindings={init:function(n,t){var i=ko.unwrap(t());return{controlsDescendantBindings:i}}};r="__ko__disableAutoDispose";f=ko.utils.domNodeIsAttachedToDocument;ko.utils.domNodeIsAttachedToDocument=function(n){var t=$(n).data(r);return t?!0:f.call(this,n)};n.disableAutoDispose={init:function(n){$(n).data(r,!0)}};n.privateTemplate={init:function(t,i,r,u,f){return n.template.init(t,i,r,u,e(f))},update:function(t,i,r,u,f){return n.template.update(t,i,r,u,e(f))}};t={};n.vivaControl={registerCallback:function(n){var i=MsPortalFx.getUniqueId();return t[i]=n,i},unregisterGuid:function(n){delete t[n]},init:function(i,r,u,f,e){var o=ko.unwrap(r()),s=t[o];return ko.utils.domNodeDisposal.addDisposeCallback(i,(function(){var t=s().ltm;n.vivaControl.unregisterGuid(o);MsPortalFx.disposeDisposable(t)})),n.privateTemplate.init(i,s,u,f,e)},update:function(i,r,u,f,e){var o=ko.unwrap(r()),s=t[o];return n.privateTemplate.update(i,s,u,f,e)}}})(r||(r={})),r}));
define("Viva.Controls/Util/Viva.Util.Private",["require","exports"],(function(){"use strict";var n;return (function(n){var t=null,i,r=window,u=(function(){function n(n){this._prefixCode=";;;";this._dataTransfer=n}return Object.defineProperty(n.prototype,"dropEffect",{get:function(){return this._dataTransfer.dropEffect},set:function(n){if(n!=="none"&&n!=="copy"&&n!=="link"&&n!=="move")throw new Error("Drop effect must be either none, copy, link, or move.");this._dataTransfer.dropEffect=n},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"effectAllowed",{get:function(){return this._dataTransfer.effectAllowed},set:function(n){if(n!=="none"&&n!=="copy"&&n!=="copyLink"&&n!=="copyMove"&&n!=="link"&&n!=="linkMove"&&n!=="move"&&n!=="all"&&n!=="uninitialized")throw new Error("Effect allowed must be either none, copy, copyLink, copyMove, link, linkMove, move, all, or uninitialized.");this._dataTransfer.effectAllowed=n},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"types",{get:function(){var n=this._dataTransfer.types,r,u,f,e;if(t===null&&this.getData(""),t)return u=this._getLegacyData(),e=Object.keys(u).some((function(n){return u[n]!==""})),Object.keys(e?u:i);if(n&&!n.forEach)for(f=n,n=[],r=0;r<f.length;r++)n.push(f[r]);return n},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"files",{get:function(){return this._dataTransfer.files},enumerable:!1,configurable:!0}),n.isLegacyDataTransfer=function(){if(t===null){var n=r.DataTransfer||r.Clipboard;return!n.prototype.setDragImage}return t},n.prototype.setDragImage=function(n,t,i){this._dataTransfer.setDragImage&&this._dataTransfer.setDragImage(n,t,i)},n.prototype.addElement=function(n){this._dataTransfer.addElement&&this._dataTransfer.addElement(n)},n.prototype.getData=function(n){if(this._checkFormat(n),t)return this._getLegacyDataTransfer(n);try{return t=!1,this._dataTransfer.getData(n)}catch(i){return t=!0,this.getData(n)}},n.prototype.setData=function(n,i){if(this._checkFormat(n),t)this._setLegacyDataTransfer(n,i);else try{t=!1;this._dataTransfer.setData(n,i)}catch(r){t=!0;this.setData(n,i)}},n.prototype.clearData=function(n){if(this._checkFormat(n),t)this._clearLegacyDataTransfer(n);else try{t=!1;this._dataTransfer.clearData(n)}catch(i){t=!0;this.clearData(n)}},n.prototype._checkFormat=function(n){if(n&&n.toLowerCase()!==n)throw new Error("Format must be in lowercase.");},n.prototype._getLegacyData=function(){var n=this._dataTransfer.getData("Text");return n&&n.substr(0,this._prefixCode.length)===this._prefixCode?JSON.parse(n.substr(this._prefixCode.length)):{Text:n}},n.prototype._stringifyLegacyData=function(n){return this._prefixCode+JSON.stringify(n)},n.prototype._getLegacyDataTransfer=function(n){return this._getLegacyData()[n]||""},n.prototype._setLegacyDataTransfer=function(n,t){var r=this._getLegacyData();r[n]=t;i=r;this._dataTransfer.setData("Text",this._stringifyLegacyData(r))},n.prototype._clearLegacyDataTransfer=function(n){if(i={},n){var t=this._getLegacyData();delete t[n];i=t}this._dataTransfer.setData("Text",this._stringifyLegacyData(i))},n})();n.DataTransfer2=u;document.addEventListener("dragend",(function(){i={}}),!1)})(n||(n={})),n}));
define("Viva.Controls/Util/Viva.Util",["require","exports","Viva.Controls/Util/Viva.Util.Private"],(function(n,t,i){"use strict";function o(n,t){var f=n.tagName,i,r,u;switch(f){case"TABLE":i="tr";break;case"TR":i="td";break;case"UL":i="li";break;default:i="span"}t&&(r=n.getAttribute("aria-live"),n.setAttribute("aria-live","assertive"));u=FxImpl.createElement(i);n.appendChild(u);n.removeChild(u);t&&(r?n.setAttribute("aria-live",r):n.removeAttribute("aria-live"))}function s(n,t){var i=n.parents().filter((function(n,t){var i=$(t),r=i.css("overflow-x"),u=i.css("overflow-y");return(r!=="hidden"||u!=="hidden")&&(r!=="visible"||u!=="visible")}));return t&&(i=i.add(window)),i}function h(n){if(n){var i=$(n),t=void 0;if(i.attr("data-control"))return n;if(t=i.closest("[data-control='true']"),t.length>0)return t[0]}return null}function e(n){var i=$(n),t;return i.attr("data-canfocus")&&(t=n["data-canfocus"],t)?t():!1}function r(n,t,i){var o=0,r,s,u;do{if(r=null,u=n.find(t+":eq("+o+")"),u.length>0&&(r=u[0],s=i(r),s&&e(r)))return!0;o++}while(!f(r));return!1}function c(n,t){t===void 0&&(t=!0);var i=Object.keys(n);return t?i.sort((function(n,t){return n<t?1:-1})):i}function l(n,t){var i,f,r,u;if(t.length<=n.length){for(i=-1,f=function(r){var u=t[r];return i=MsPortalFx.findIndex(n,(function(n){return n===u}),i+1),i<0?{value:!1}:void 0},r=0;r<t.length;r++)if(u=f(r),typeof u=="object")return u.value;return!0}return!1}function a(n,t){var f="[data-focus-first='true']",e=":not("+f+")",u="[data-canfocus='true']",o=function(n){return n},i=!1;return t&&(i=r(n,u+f,t),i||(i=r(n,u+e,t))),i||(i=r(n,u+f,o),i||(i=r(n,u+e,o))),i}function v(n,t){var i=t||n.type;return $.Event(n,{type:i,target:n.target,ctrlKey:n.ctrlKey,shiftKey:n.shiftKey,metaKey:n.metaKey,currentTarget:n.currentTarget,isImmediatePropagationStopped:n.isImmediatePropagationStopped,isPropagationStopped:n.isPropagationStopped,preventDefault:n.preventDefault,stopImmediatePropagation:n.stopImmediatePropagation,stopPropagation:n.stopPropagation})}function y(n,t,i){for(var o=i?i.length:0,r,f,u,e=0;e<o;e++)r=i[e],f=t[r]||ko.observable(),u=n[r],f(ko.isObservable(u)?u.peek():u),t[r]||(t[r]=f)}function p(n,t){var i=n.indexOf(t)<0;return i&&n.push(t),!i}function w(n){var t=n.getAttribute("class");return t?new u(t):new u}function b(n,t){n.setAttribute("class",t._fields.join(" "))}var f,u;Object.defineProperty(t,"__esModule",{value:!0});t.DataTransfer=t.setClassList=t.getClassList=t.DOMTokenListShim=t.existsOrRegisterId=t.fillObserableFields=t.cloneEvent=t.setFocusToFirstFocusableChild=t.shapeContains=t.getObjectBasicShape=t.executeSetFocusOn=t.findContainingControl=t.getScrollableParents=t.forceScreenRead=void 0;f=MsPortalFx.isNullOrUndefined;t.forceScreenRead=o;t.getScrollableParents=s;t.findContainingControl=h;t.executeSetFocusOn=e;t.getObjectBasicShape=c;t.shapeContains=l;t.setFocusToFirstFocusableChild=a;t.cloneEvent=v;t.fillObserableFields=y;t.existsOrRegisterId=p;u=(function(){function n(n){n===void 0&&(n=null);this._fields=n?n.split(" "):[]}return n.prototype.add=function(n){this._fields.indexOf(n)<0&&this._fields.push(n)},n.prototype.remove=function(n){while(this._fields.indexOf(n)>=0)this._fields.splice(this._fields.indexOf(n),1)},n.prototype.contains=function(n){return this._fields.indexOf(n)>=0},Object.defineProperty(n.prototype,"length",{get:function(){return this._fields.length},enumerable:!1,configurable:!0}),n.prototype.toggle=function(n){return this._fields.indexOf(n)>=0?(this.remove(n),!1):(this.add(n),!0)},n.prototype.item=function(n){return this._fields[n]},n.prototype.toString=function(){return this._fields.toString()},n})();t.DOMTokenListShim=u;t.getClassList=w;t.setClassList=b;t.DataTransfer=i.DataTransfer2}));
define("_generated/Less/MsPortalImpl.Controls/Controls/Base.css",["module"],(function(n){"use strict";return{css:".fxc-base-fill-container-width{width:100%}.fxc-base-fill-container-height{height:100%}.fxc-base-loading{position:relative;height:100%}.fxc-base-loading .fxc-base-loadingImage{position:absolute;top:calc(50% - 30px/2);left:calc(50% - 30px/2)}",moduleId:n.id}}));
define("MsPortalImpl.Controls/Controls/Base/Base",["require","exports","Fx/DependencyInjection","Viva.Controls/Util/Viva.Util","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl.Controls/Controls/Base/WidgetBinding","FxInternal/ProxiedObservables","MsPortalImpl/Base/Base.ElementWidgetMap","FxInternal/Css","_generated/Less/MsPortalImpl.Controls/Controls/Base.css","MsPortalImpl/Controls/ControlBindings","MsPortalImpl/UI/Compositions/UI.Composition","Viva.Controls/Controls/Base/Viva.KnockoutExtensions"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";function nt(n,t){return MsPortalFx.first(b(n,t))||null}function b(n,t){return(t?s.getAllMatch(n[0],t):s.getAll(n[0]))||[]}function tt(n){return n._isTrusted=!0,n}function k(n){return!!n._isTrusted}var w,v,y,p,d,g;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.WidgetUIState=t.isViewModelTrusted=t.setTrustedViewModel=t.getWidgets=t.getWidget=void 0;w=MsPortalFx.Base;v=w.Diagnostics.Telemetry;h.injectCss(c);y="remove.fxWidget";p="fxs-display-none";t.getWidget=nt;t.getWidgets=b;t.setTrustedViewModel=tt;t.isViewModelTrusted=k;d=(function(){function n(){this.tabIndex=ko.observable(0);this.disabled=ko.observable(!1);this._ltm=new FxImpl.TriggerableLifetimeManager}return n.prototype.dispose=function(){this._ltm.dispose()},n})();t.WidgetUIState=d;g=(function(){function t(t,r,h,c){var l=this,a,v,b,y,d,w,tt,g,nt;if(h===void 0&&(h={}),this._destroyIds=[],this._cssClassMap={},!t||!t.length)throw new Error("You must specify an element to associate a control to it. Your element is either null or an empty collection.");o.setPoUndefined(this);this.isTrusted=h.isTrusted||k(r);this.element=t;this.vm=r;this.state=c;a=this.weaveContext=h.weaveContext;v=this.ltm=new FxImpl.TriggerableLifetimeManager;this.vmBasicOption={ltm:v};c&&v.registerForDispose(c);this._bindingContext=a?null:h.bindingContext;b=a?null:this._bindingContext||e.contextFor(t);this._diContainer=h.diContainer||a&&a.diContainer||b&&b.$dicontainer||i.container;s.set(t[0],this);y=r.controlType;y!==0&&y!==94&&(d=void 0,w=t.attr("data-bind")||"",w.length&&w.indexOf("visible")>=0&&(tt=ko.expressionRewriting.parseObjectLiteral(w)||[],d=tt.some((function(n){return n.key==="visible"}))),d||(g=r.visible,g&&g.subscribeAndRun(this.ltm,(function(n){MsPortalFx.isNullOrUndefined(n)||t.toggleClass(p,!n)}))));nt=r&&r.cssClass;nt&&nt.subscribeAndRun(v,(function(i){var r,e,o;i=i||"";r=l._cssClassMap;l._cssClassMap={};i.split(/\s+/).forEach((function(i){i&&(l.isTrusted||f.isAllowedCssClassName(i)?(l._cssClassMap[i]=i,delete r[i]):u.logToExtension(n,t,2,"Invalid control css class name: "+i))}));e=Object.keys(r);e.length&&l.element.removeClass(e.join(" "));o=Object.keys(l._cssClassMap);o.length&&l.element.addClass(o.join(" "))}));this._registerDispose();MsPortalFx.isFeatureEnabled("controlstelemetry")&&y!==0&&(this._initializeTelemetry(),this._attachTelemetryEvents(),this._trace({action:"ControlInitialized"}))}return t.prototype.isDisposed=function(){return this._destroyIds.length>0},t.prototype.dispose=function(){if(!this._checkExistsOrRegisterDestroyId(null)){this.ltm&&this.ltm.dispose();var n=this.element;n.removeClass(p+" "+Object.keys(this._cssClassMap).join(" "));s.remove(n[0],this);this._disposeCallback&&(this._unregisterDispose(),this._disposeCallback=null)}},t.prototype._checkExistsOrRegisterDestroyId=function(n){return r.existsOrRegisterId(this._destroyIds,n)},t.prototype._cleanDescendants=function(){ko.utils.cleanDescendantNodes(this.element)},t.prototype._cleanElement=function(){for(var i,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];i=this.element;this.weaveContext||this._cleanDescendants();t.length&&i.removeClass(t.join(" "));this.weaveContext||i.empty()},t.prototype._registerDispose=function(){var n=this,t=this.element;if(this._bindingContext)ko.utils.domNodeDisposal.addDisposeCallback(t[0],this._disposeCallback=function(){n.dispose()});else t.on(y,this._disposeCallback=function(i){i.target!==t[0]||n._destroyTriggered||(n._destroyTriggered=!0,n.dispose())})},t.prototype._unregisterDispose=function(){var n=this.element,t=this._disposeCallback;this._bindingContext?ko.utils.domNodeDisposal.removeDisposeCallback(n[0],t):n.off(y,t)},t.prototype._trace=function(n){this._telemetryInfo||this._initializeTelemetry();var t=ko.unwrap(this.vm.telemetryName);v.trace({source:this._telemetryInfo.telemetrySource,extension:this._telemetryInfo.extensionName,name:t?t:FxImpl.Po.getMetadataId(this.vm),action:n.action,actionModifier:n.actionModifier,data:__assign({controlType:this._telemetryInfo.controlType,vmKind:this._telemetryInfo.vmKind},n.data),lowPriority:!0})},t.prototype._startTrace=function(n){this._telemetryInfo||this._initializeTelemetry();var t=ko.unwrap(this.vm.telemetryName);return v.startTrace({source:this._telemetryInfo.telemetrySource,extension:this._telemetryInfo.extensionName,name:t?t:FxImpl.Po.getMetadataId(this.vm),action:n.action,actionModifier:n.actionModifier,data:__assign({controlType:this._telemetryInfo.controlType,vmKind:this._telemetryInfo.vmKind},n.data),lowPriority:!0})},t.prototype._initializeTelemetry=function(){var t=this.vm.controlType,i=this.element.closest(".fxs-blade")[0],r=i&&$.data(i,a.CompositionInstanceDataName),n=r&&r.locator,u=n&&n.toFriendlyString(),f=n&&n.getExtensionName(),e=l.controlBindingMap[t]||t||"UNKNOWN",o=this.vm.vmKind||"INVALID";this._telemetryInfo={telemetrySource:u,extensionName:f,controlType:e,vmKind:o}},t.prototype._attachTelemetryEvents=function(){var n=this,t=this.element,i=function(){n._trace({action:"ControlClicked",actionModifier:"click"})},r=function(){n._focusTrace&&(v.cancelTrace(n._focusTrace),n._focusTrace=null);n._focusTrace=n._startTrace({action:"ControlFocused",actionModifier:"focusout"});n._trace({action:"ControlFocused",actionModifier:"focusin"})},u=function(){n._focusTrace?(v.endTrace(n._focusTrace,"focusout"),n._focusTrace=null):n._trace({action:"ControlFocused",actionModifier:"focusout"})};t.on("focusin",r);t.on("focusout",u);t.get(0).addEventListener("click",i,!0);this.ltm.registerForDispose((function(){t.off("focusin",r);t.off("focusout",u);t.get(0).removeEventListener("click",i,!0);n._focusTrace&&v.cancelTrace(n._focusTrace)}))},t})();t.Widget=g}));
define("MsPortalImpl.Controls/Controls/Base/OptionsBase",["require","exports","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl.Controls/Controls/Base/WidgetBinding","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","Fx/Weave","FxInternal/Css","_generated/Less/MsPortalImpl.Controls/Controls/Base.css"],(function(n,t,i,r,u,f,e,o){"use strict";function b(n){return n&&!!n.htmlTemplate}var v;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.isHtmlContent=void 0;e.injectCss(o);var l=MsPortalFx.Base,y=l.Promises.CancelationToken,p=l.Promises.makeCancelable,w=MsPortalFx.Errors,a="fxc-base",h="fxc-base-fill-container-width",c="fxc-base-fill-container-height",s=[];t.isHtmlContent=b;v=(function(t){function i(n,i,u,e){var o=t.call(this,n,i,u,e)||this,p,v,w;o._addDisposablesToCleanUp=function(n){return o.ltm.registerForDispose(n)};u=u||{};o._options=i;o._widgets=[];o._waitToken=new y;n.addClass(a);p=u.fillBehavior||0;switch(p){case 1:n.addClass(h);break;case 2:n.addClass(c);break;case 3:n.addClass(h+" "+c)}v=s.length;v&&(w=s[v-1],w.push(o));var k=o.tabindex=o.state?o.state.tabIndex:ko.observable(0),d=o.disabled=o.state?o.state.disabled:ko.observable(!1),l=o.weaveContext,b=l?null:o._bindingContext||r.getContext(n)||{},g=l?f.toObservable(o.ltm,l.disabled):b.$disabled,nt=l?f.toObservable(o.ltm,l.enabledTabIndex):b.$enabledTabIndex;return o.$disabled=r.chainDisabledProperties([g,d,i.disabled]),o.$enabledTabIndex=r.chainEnabledTabIndexProperties([nt,k]),o.$tabIndex=r.makeTabIndexProperty(o.$enabledTabIndex,o.$disabled),o}return __extends(i,t),i.prototype.dispose=function(){var n,i;this._checkExistsOrRegisterDestroyId(t.prototype.dispose)||(this._waitToken.cancel(new w.DisposedCanceledError),this._widgets&&(this._widgets.forEach((function(n){n&&n.dispose()})),this._widgets=null),this.element.removeClass(a+" "+h+" "+c).removeAttr("role"),n=s.length,n&&(i=s[n-1],MsPortalFx.remove(i,this)),t.prototype.dispose.call(this))},Object.defineProperty(i.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),i.prototype.widget=function(){return this.element},Object.defineProperty(i.prototype,"widgets",{get:function(){return this._widgets},enumerable:!1,configurable:!0}),i.prototype.awaitContentRevealed=function(){return Q(!1)},i.beginTracking=function(n){n===void 0&&(n=[]);s.push(n)},i.endTracking=function(){return s.pop()},i.prototype.trigger=function(n,t,i,r){var f=this.options[n],u=this.element;return i=i||{},t=t||$.Event(n),t.type=n,t.target=r||u[0],u.trigger(t,i),!($.isFunction(f)&&f.apply(u[0],[t].concat(i))===!1||t.isDefaultPrevented())},i.prototype.waitFor=function(n){return p(n,this._waitToken)},i.prototype.sanitizeTemplate=function(t){return t&&!this.isTrusted?u.sanitizeHTML(t,n,this.element).sanitizedMarkup:t},i.prototype._bindDescendants=function(n,t){var i,r,u;n===void 0&&(n={});i=this.options;r=$(t||this.element)[0];ko.utils.extend(n,{data:i});u=this._createBindingContext(n,i,r);ko.applyBindingsToDescendants(u,r)},i.prototype._bindElement=function(n,t){var i=$(t)[0],r=this._createBindingContext(n,n,i);ko.applyBindings(r,i)},i.prototype._createBindingContext=function(n,t,i){return r.createChildContext(i,n,{$ctl:this,$vm:t,$disabled:this.$disabled,$enabledTabIndex:this.$enabledTabIndex,$tabIndex:this.$tabIndex,$dicontainer:this._diContainer},this._bindingContext)},i.prototype._isRtl=function(){return $.querySelectorAll("html").attr("dir")==="rtl"},i})(i.Widget);t.Widget=v}));
define("MsPortalImpl.Controls/Controls/ResourceFilterHelper",["require","exports","FxHubs/ResourceManagement"],(function(n,t,i){"use strict";function o(n){t.Internal.assetTypeService=n}function s(n){var e=[],o;return n&&n.length?(e=n.map((function(n){return{name:n.compositeDisplayName.plural,key:n.resourceType.toLowerCase(),keywords:n.keywords}})),MsPortalFx.stableSort(e,(function(n,t){return MsPortalFx.localeCompareIgnoreCase(n.name,t.name)}))):(u||(o=t.Internal.assetTypeService.assetTypes||[],e=o.filter((function(n){var u=n.assetTypeManifest,t=u.resourceType,e=u.browseType===1&&!i.supportsOption(u.options,1)&&n.lowerCaseResourceType!==f.Constants.ResourceTypes.ResourceGroups.toLowerCase();return e&&!(t&&(t.routingType===r.Tenant||t.routingType===r.ProviderProxy||t.routingType===r.Extension))})).map((function(n){return{name:n.compositeDisplayName.plural,key:n.lowerCaseResourceType,keywords:n.assetTypeManifest.keywords&&n.assetTypeManifest.keywords.split(",")}})),u=MsPortalFx.stableSort(e,(function(n,t){return MsPortalFx.localeCompareIgnoreCase(n.name,t.name)}))),u)}var u;Object.defineProperty(t,"__esModule",{value:!0});t.getLocations=t.getResourceTypes=t.initialize=t.Internal=void 0;var f=MsPortalFx.Base,e=MsPortalFx.Extension,r=e.ResourceRoutingType;t.Internal={};t.initialize=o;t.getResourceTypes=s;t.getLocations=MsPortalFx.memoizeQ((function(){return MsPortalFx.Azure.getLocations().then((function(n){var t=MsPortalFx.forEachKey(n,(function(n,t,i){i.push({displayName:t,name:n})}),[]);return MsPortalFx.stableSort(t,(function(n,t){return MsPortalFx.localeCompareIgnoreCase(n.displayName,t.displayName)}))}))}))}));
define("MsPortalImpl.Controls/Controls/SimpleButton",["require","exports","Weave/DirectMode","MsPortalImpl.Controls/Controls/Base/OptionsBase","FxInternal/WeaveControls/Button.Component.Internal","Fx/Weave"],(function(n,t,i,r,u,f){"use strict";function s(n){var t=n.vm;return i(u.ButtonInner,{onClick:t.onClick,text:f.toComputation(t.text),style:f.toComputation(t.style),disabled:f.toComputation(t.disabled),ariaLabel:f.toComputation(t.ariaLabel),loading:f.toComputation(t.loading),loadingText:f.toComputation(t.loadingText),icon:f.toComputation(t.icon)})}var e,o;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.InnerTsxComponent=void 0;e="fxc-simplebutton";t.InnerTsxComponent=s;o=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u.element.addClass(e),u}return __extends(t,n),t.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this._cleanElement(e),n.prototype.dispose.call(this))},t})(r.Widget);t.Widget=o}));
define("MsPortalImpl.Controls/Fields/Base/FormValidation",["require","exports","MsPortalImpl/Base/JQueryHelper"],(function(n,t,i){"use strict";function v(n,t,i){t===void 0&&(t=!0);i===void 0&&(i=!1);var r=o(n,i),u=r.map((function(n){return n.field})),f=r.map((function(n){return n.viewmodel})).filter(MsPortalFx.identity);return(t&&h(f),u.length===0)?Q(!0):l(u)}function h(n){n.forEach((function(n){var t=n&&n.rowMetadata;t&&t.editState&&t.editState()&&n.performValidation&&!n.performValidation()&&n.performValidation(!0)}))}function y(n,t,i,s){var h=$(n),v,c,l,a;if(h.attr(u,"true"),h.data(r,s),h.data(f,t),h.data(e,i),v=!!s.fieldsData,c=(v?h.parent():h).closest(".fxs-validationContainer"),c.length&&c.hasClass("fxs-part-content")){var w=c.parent(),y=ko.dataFor(w[0]),p=y&&y.context;l=p&&p.validateElements;l&&l.push(n)}else c.length&&(a=c.data(r),a&&a.fieldsData&&a.fieldsData(o(c,!0)));s.ltm.registerForDispose((function(){l&&l.remove(n);h.data(r,null);h.data(f,null);h.data(e,null)}))}function c(n,t,o){return n.filter((function(n){var f=$(n);return n&&n.hasAttribute(u)&&f.closest(".fxs-suppresschildvalidation").length<1&&f.data(r)&&(!t||t(n))&&(o||i.isElementVisible(n))})).map((function(n){var t=$(n);return{viewmodel:t.data(f),widgetviewmodel:t.data(e),field:t.data(r)}}))}function o(n,t,i){t===void 0&&(t=!1);var f=function(n){var t=$(n).data(r);return t&&(!i||i(n))};return n.length?c(n.find("["+u+"]").toArray(),f,t):[]}function l(n){var t=[];return n.filter((function(n){return n.triggerValidation})).map((function(n){t.push(n.triggerValidation())})),Q.all(t).then((function(n){return n.every(s)}))}function p(n){n.findByClassName("fxs-bg-error").eq(0).closest("[data-validatable='true']").findByClassName("azc-input").focus()}var s,a;Object.defineProperty(t,"__esModule",{value:!0});t.focusOnFirstInvalidField=t.performFieldValidation=t.gatherFormFields=t.gatherFormFieldsFromElements=t.markFormFieldElement=t.gridEnableValidation=t.ensureFormFieldValidation=void 0;s=MsPortalFx.identity;a=MsPortalFx.Base.Diagnostics.createLog(n);t.ensureFormFieldValidation=v;t.gridEnableValidation=h;var u="data-validatable",r="field",f="viewmodel",e="widgetviewmodel";t.markFormFieldElement=y;t.gatherFormFieldsFromElements=c;t.gatherFormFields=o;t.performFieldValidation=l;t.focusOnFirstInvalidField=p}));
define("MsPortalImpl/AzFramework/AzBladeViewModel",["require","exports"],(function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ViewModel=void 0;var i=(function(){function n(n){var t=this;this.title=ko.observable();this.subtitle=ko.observable();this.icon=ko.observable();this.statusBar=ko.observable();this.menuContent={title:ko.observable(),subtitle:ko.observable()};this._initializedPromiseDeferred=Q.defer();this._onInputsSetCalledDeferred=Q.defer();this._onPinHandler=ko.observable();this._msPortalFxV2ShellApi=ko.computed(n,(function(){return{onPin:t._onPinHandler()}}))}return n.prototype.configure=function(n){return this._initializedPromiseDeferred.resolve(n),this._onInputsSetCalledDeferred.promise},n.prototype.setOnPinHandler=function(n){this._onPinHandler(n)},n.prototype.onInputsSet=function(n){return this._onInputsSetCalledDeferred.resolve({parameters:n.bladeParameters}),this._initializedPromiseDeferred.promise.then((function(n){return n}))},n})();t.ViewModel=i}));
define("MsPortalImpl/ViewModels/ViewModels.BladeCaller",["require","exports"],(function(){"use strict";var n;return (function(n){function r(t,r,u){var e=r.additionalInputArguments=r.additionalInputArguments||[],f;r.outputArguments=r.outputArguments||[];f=t+i;e.push({property:n.bindingName_bladeCallId,valuesFrom:[{referenceType:u,property:f+n.bindingName_bladeCallId}]});e.push({property:n.bindingName_bladeCallerParams,valuesFrom:[{referenceType:u,property:f+n.bindingName_bladeCallerParams}]});r.outputArguments.push({property:n.bindingName_bladeCallerResult,valuesFrom:[{referenceType:1,property:n.bindingName_bladeCallerResult}]})}function u(t){t.inputs=t.inputs||[];t.inputs.push(n.bindingName_bladeCallId,n.bindingName_bladeCallerParams)}function f(t,r,u,f){var o=r.inputs=r.inputs||[],e;if(r.outputs=r.outputs||[],r.bindings=r.bindings||[],f.inline)e=f.inline.bindings=f.inline.bindings||[];else if(f.reference)e=f.reference.bindings=f.reference.bindings||[];else throw new Error("Part is neither inline nor a reference, so cannot add blade callable bindings");o.push(n.bindingName_bladeCallId);e.push({property:n.bindingName_bladeCallId,valuesFrom:[{referenceType:1,property:n.bindingName_bladeCallId}]});o.push(n.bindingName_bladeCallerParams);e.push({property:n.bindingName_bladeCallerParams,valuesFrom:[{referenceType:1,property:n.bindingName_bladeCallerParams}]});r.outputs.push(n.bindingName_bladeCallerResult);r.bindings.push({property:n.bindingName_bladeCallerResult,valuesFrom:[{referenceType:0,property:t+i+n.bindingName_bladeCallerResult,part:u}]})}var t="internal_",i=".";n.bindingName_bladeCallId=t+"bladeCallId";n.bindingName_bladeCallerParams=t+"bladeCallerParams";n.bindingName_bladeCallerResult=t+"bladeCallerResult";n.addCallerBindings=r;n.addCallablePartInputs=u;n.addCallableBindings=f})(n||(n={})),n}));
define("MsPortalImpl/Extension/DefinitionPreprocessor",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/ViewModels/ViewModels.BladeCaller","FxInternal/Utils/LinkSanitizer"],(function(n,t,i,r,u,f){"use strict";function ft(n,t){var i=n;return i.partTypeMap=i.partTypeMap||{},i.bladeMap=i.bladeMap||{},(i.partsCatalog||[]).forEach((function(n){return k(i,t,n,{})})),(i.blades||[]).forEach((function(n){return d(i,t,n,{})})),ht(n),i}function w(n,t){n&&n.extension&&(n.extension=t[n.extension]||n.extension)}function b(n,t){n&&n.length&&n.forEach((function(n){n.bladeExtension&&(n.bladeExtension=t[n.bladeExtension]||n.bladeExtension)}))}function k(n,t,u,e){if(u.processed)return u;e=e||{};w(u.reference,e);b(u.details,e);n.partTypeMap[u.name.toLowerCase()]=u;u.assetTypeDefinition=MsPortalFx.find(t.assetTypes,(function(n){return n.partName===u.name&&!n.partExtensionName}));o(u.details,0);u.parameterProvider&&nt(u);vt(n,u);var s=i.container;return u.trustedLinkedDomains&&s.get(f.LinkSanitizer).processTrustedLinkedDomains(n.name,u.trustedLinkedDomains),r.sanitizeInlineTemplate(s,n.name,u.name,u,a),u.processed=!0,u}function d(n,t,u,e){var o,s;return(e=e||{},u.processed)?u:(MsPortalFx.isNullOrUndefined(u.pinnable)&&(u.pinnable=!!u.pinnedPart),u.attributes&2&&(u.optionalInputs=u.optionalInputs||[],u.optionalInputs.push("_provisioningContext")),u.templateBlade&&at(u),u.menuBlade&&ot(u),u.frameBlade&&st(u),(u.lenses||[]).forEach((function(n){(n.partInstances||[]).forEach((function(n){w(n.reference,e);b(n.inline&&n.inline.details,e)}))})),n.bladeMap[u.name.toLowerCase()]=u,u.assetTypeDefinition=MsPortalFx.find(t.assetTypes,(function(n){return n.bladeName===u.name})),ct(u),u.effectiveInputs||(u.effectiveInputs=u.viewModelInputs||[]),o=et(u),n.partTypeMap[o.name.toLowerCase()]=o,s=i.container,u.trustedLinkedDomains&&s.get(f.LinkSanitizer).processTrustedLinkedDomains(n.name,u.trustedLinkedDomains),r.sanitizeBladeDefinition(s,n.name,u,a),u.processed=!0,u)}function et(n){var r=t.PinPrefix+n.name,i;return n.pinnedPart||(n.pinnedPart=r),i={name:r,viewModel:"Shell.InferredBladePinPart"+n.name,partKind:s.Button,inputs:n.inputs,initialSize:2,details:[{blade:n.name,invocationInputArguments:[{valuesFrom:[{property:"container.selectable.value",referenceType:0}]}],additionalInputArguments:[]}],bindings:[],viewStateProperties:["container.selectable.isSelected"],commandGroup:n.commandGroup,commandGroupReference:n.commandGroupReference,assetIdInputProperty:n.assetIdInputProperty,assetType:n.assetType},(n.inputs||[]).forEach((function(n){i.bindings.push({property:t.collisionPrefix+n,valuesFrom:[{property:n,referenceType:1}]})})),(n.optionalInputs||[]).forEach((function(n){n!==tt.ReferrerInfo&&i.bindings.push({property:t.collisionPrefix+n,optional:!0,valuesFrom:[{property:n,referenceType:1}]})})),n.viewModelInputs&&n.viewModelInputs.forEach((function(t){t.property===n.assetIdInputProperty&&i.bindings.push(t)})),i}function e(n,t,i,r,u){t&&t.forEach((function(t){var f=!r&&i&&i.indexOf(t)>-1;n.inputs.push(t);n.bindings.push(u&&MsPortalFx.find(u,(function(n){return n.property===t}))||{property:t,optional:r,isIdentityInput:f,valuesFrom:[{referenceType:1,property:t}]})}))}function h(n,t,i,r,u,f,e,o,h,c,l){return{name:n,inline:{bindings:[],details:[],inputs:[],partKind:c||s.Custom,viewModelLocator:t.viewModelLocator,viewModel:t.viewModelName,htmlTemplate:i,htmlTemplateInline:r,assetType:t.assetType,assetIdInputProperty:t.assetIdInputProperty,initialSize:u,viewStateProperties:[],shareVmWithParentBlade:!0,partState:f,styleSheets:o,permissions:h,noFxContentPadding:l},parameterProvider:e}}function ot(n){var i=n.name,u=n.menuBlade.isV2,t=h(i,n,undefined,{content:"<div data-bind='pcControl: "+(u?"viewModel && viewModel._msPortalFxMenu":"menu")+"' class='ext-menublade-part'><\/div>",file:i+MsPortalFx.getUniqueId()},9,undefined,!1,[],undefined),r;e(t.inline,n.inputs,n.templateKeyInputs,undefined,n.effectiveInputs);e(t.inline,n.optionalInputs,[],!0,n.effectiveInputs);r={name:i,partInstances:[t]};n.lenses.splice(0,0,r);n.effectiveInputs=t.inline.bindings;MsPortalFx.isNullOrUndefined(n.pinnable)&&(n.pinnable=!0)}function st(n){var i=n.name,t=h(i,n,undefined,undefined,9,n.frameBlade.partState,!1,[],n.permissions,s.Frame),r;e(t.inline,n.inputs,n.templateKeyInputs,undefined,n.effectiveInputs);e(t.inline,n.optionalInputs,[],!0,n.effectiveInputs);n.toolbar={source:{valuesFrom:[{referenceType:0,part:i,property:"content.commandBar"}]}};r={name:i,partInstances:[t]};n.lenses.splice(0,0,r);n.effectiveInputs=t.inline.bindings}function ht(n){n.startBoardParts&&n.startBoardParts.forEach((function(n){n.inline&&o(n.inline.details,0)}));g(n)}function g(n){n.commandsCatalog&&n.commandsCatalog.forEach((function(n){o([n.details],4)}));n.commandGroups&&n.commandGroups.forEach((function(n){n.commands&&n.commands.forEach((function(n){o([n.details],4)}))}))}function ct(n){n.lenses&&n.lenses.forEach((function(t){t.partInstances&&t.partInstances.forEach((function(t){t.inline&&(t.parameterProvider&&nt(t.inline),o(t.inline.details,0));lt(n,t.name,t)}))}))}function o(n,t){n&&n.filter((function(n){return n&&!!n.parameterCollector})).forEach((function(n){u.addCallerBindings(n.parameterCollector+".bladeCaller",n,t)}))}function nt(n){n.editScopeType=n.editScopeType||"PDLEditScope";n.inputs=n.inputs||[];n.inputs.push(c);u.addCallablePartInputs(n)}function lt(n,t,i){if(i.parameterProvider&&(n.attributes|=1,u.addCallableBindings(l+".bladeCallable",n,t,i),n.actionBar)){n.actionBar.bindings=n.actionBar.bindings||[];var r=n.actionBar.bindings.some((function(n){return n.property==="input"}));r||n.actionBar.bindings.push({property:"input",valuesFrom:[{referenceType:0,part:t,property:l+".defaultActionBarInput"}]});n.templateBlade||(i.inline||i.reference).bindings.push({property:c,valuesFrom:[{referenceType:2,property:"content.output"}]})}}function at(n){var t=n.templateBlade,u=t.isV2,o=t.isV2?9:t.partSize||8,i=h(n.name,n,t.htmlTemplate,t.htmlTemplateInline,o,t.partState,t.parameterProvider,t.styleSheets,n.permissions,n.style===12?s._Internal_App:null,u),r,f;n.lenses=n.lenses||[];n.lenses.push({name:"TemplateBladeVirtualLens",partInstances:[i]});n.locked=!0;u&&(n.style=8);r=i.inline;e(r,n.inputs,n.templateKeyInputs,undefined,n.effectiveInputs);e(r,n.optionalInputs,[],!0,n.effectiveInputs);f=n.effectiveInputs=r.bindings;n.outputs&&n.outputs.forEach((function(t){n.bindings=n.bindings||[];n.bindings.push({property:t,valuesFrom:[{referenceType:0,property:"content."+t,part:i.name}]})}));n.editScopeType&&f.push({property:"editScopeId",valuesFrom:[{referenceType:1,property:"editScopeId"}]});n.actionBar&&(n.actionBar.source={valuesFrom:[{referenceType:0,part:i.name,property:"content.actionBar"}]});n.toolbar&&(n.toolbar.source={valuesFrom:[{referenceType:0,part:i.name,property:"content.commandBar"}]});r.details=t.details}function vt(n,t){var i=t.reference,u,r,f;i&&(u=i.partTypeName===ut&&(i.extension===v||!i.extension&&n.name===v),u&&(r=i.bindings,f=MsPortalFx.find(r,(function(n){return n.property===y})),f||(r.push({property:y,valuesFrom:[{referenceType:9,property:p}],optional:!0}),t.inputDefinitions.push({name:p,type:rt.TimeRangeValueType,optional:!0}))))}Object.defineProperty(t,"__esModule",{value:!0});t.processCommands=t.processBlade=t.processPart=t.preprocessDefinition=t.collisionPrefix=t.PinPrefix=void 0;var tt=MsPortalFx.Base.Constants.BladeParameterNames,it=MsPortalFx.Parts,s=it.PartKind,rt=MsPortalFx.Composition.Configuration,c="internal_parameterProviderActionBarOutput",l="content.parameterProvider",a=MsPortalFx.isDevelopmentMode?1:0;t.PinPrefix="InferredBladePinPart";t.collisionPrefix="inferredBladePinPartInputs.";var v="Microsoft_Azure_Insights",ut="MetricsSummaryPart",y="timeRange",p="_msPortalFxTimeRange";t.preprocessDefinition=ft;t.processPart=k;t.processBlade=d;t.processCommands=g}));
define("MsPortalImpl/Extension/ShellPart",["require","exports"],(function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.shellParts=void 0;t.shellParts={ResourcePart:{viewModelName:"ResourcePartViewModel",shellModule:"MsPortalImpl/UI/UI.ResourcePart"}}}));
define("MsPortalImpl/Extension/Extension",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/Extension.Manifest"],(function(n,t,i,r){"use strict";var f,u,e;Object.defineProperty(t,"__esModule",{value:!0});t.ShellWorkerExtension=t.ExtensionFactory=t.InitializedManifestCache=void 0;var o=FxImpl.Extension,s=FxImpl.Rpc,h=(function(){function t(){}return t.create=function(n){return n.getManifests("assetTypes").then((function(){return null}))},__decorate([__metadata("fx:diagnostics",[n,"InitializedManifestCache"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[r.ManifestCache]),__metadata("design:returntype",Object)],t,"create",null),t})();t.InitializedManifestCache=h;f=(function(){function t(n,t){this.createExtension=function(i){var r=t.getManifest(i.name,"assetTypes")||{};return i.flags&256?new e(i.name,i.serviceTreeId):new u(i,r.flags&32?null:n)}}return __decorate([__metadata("fx:diagnostics",[n,"ExtensionFactory"]),i.Class(),__metadata("design:paramtypes",[s.Client,r.ManifestCache])],t)})();t.ExtensionFactory=f;u=(function(){function n(n,t){var i=this,r,u;this.isLoaded=ko.observable();this.lastError=ko.observable();this.refCount=ko.observable(0);r=n.name;u=n.serviceTreeId;this.name=r;this.serviceTreeId=u;this.processMessages=t?function(){return o.pingEndPoint.invoke(t,r,undefined)}:function(){return Q()};this.waitForIdle=t?function(n,i){return FxImpl.Extension.waitForExtensionIdleEndPoint.invoke(t,r,{bladeName:n,bladeInstanceId:i})}:function(){return Q()};this.onStateChange=function(n){var t=n.loadTime,r=n.error,u=n.refCount;t!==undefined&&(i.isLoaded(!!t),t&&(i.loadTime=t));r&&i.lastError(r);MsPortalFx.isNullOrUndefined(u)||i.refCount(u)}}return n})();t.ShellWorkerExtension=u;e=(function(){function n(n,t){this.name=n;this.serviceTreeId=t;this.lastError=ko.observable();this.isLoaded=ko.observable(!0)}return n.prototype.processMessages=function(){return Q()},n.prototype.waitForIdle=function(){return Promise.resolve({pendingOperationsCount:0,waitDuration:0,interruptedByChild:!1})},n})()}));
define("MsPortalImpl/Extension/ExtensionManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/Extension","MsPortalImpl/Extension/ExtensionManagerOptions","ShellWorker/ExtensionManager"],(function(n,t,i,r,u,f){"use strict";var e,h;Object.defineProperty(t,"__esModule",{value:!0});t.ExtensionManager=t.ExtensionManagerImpl=t.ExtensionLoader=t.ExtensionManagerOptions=void 0;Object.defineProperty(t,"ExtensionManagerOptions",{enumerable:!0,get:function(){return u.ExtensionManagerOptions}});var c=MsPortalFx.Base,l=c.Diagnostics,a=FxImpl.Rpc,o=l.createLog(n),v=(function(){function t(n,t){this._options=n;this._rpcClient=t}return t.prototype.startRpc=function(n){this._rpcClient.start({instanceIndex:0,loadChannelFunction:undefined,originId:"fx",shellChannel:new FxImpl.Rpc.RpcChannel(FxImpl.localRpcPort),windowRedirectMap:this._options.extensionRedirectMap});f.onExtensionStateChangeEndPoint.register(this._rpcClient,"fxw",(function(t){var i=n[t.name];i.onStateChange(t)}))},t.prototype.setRequestedBlade=function(n,t){f.setRequestedBladeEndPoint.invoke(this._rpcClient,"fxw",{extensionName:n,bladeName:t})},__decorate([__metadata("fx:diagnostics",[n,"ExtensionLoaderImpl"]),i.Class(),__metadata("design:paramtypes",[u.ExtensionManagerOptions,a.Client])],t)})(),s=(function(){function t(){}return t.create=function(n,t){return t},__decorate([__metadata("fx:diagnostics",[n,"ExtensionLoader"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[r.InitializedManifestCache,v]),__metadata("design:returntype",t)],t,"create",null),t})();t.ExtensionLoader=s;e=(function(){function t(n,t,i){var r=this;this._options=i;this.lastExtensionError=ko.observable();this.initializedExtensions=[];this._callbacks=$.Callbacks();this._unloadCallbacks=$.Callbacks();this._ltm=new FxImpl.TriggerableLifetimeManager;this._extensionsMap=FxImpl.mapValues(i.extensionsAsMap,(function(t){var i=n.createExtension(t);return i.lastError.subscribeAndRun(r._ltm,(function(n){n&&r.lastExtensionError(i)})),i.isLoaded.subscribeAndRun(r._ltm,(function(n){n?(r.initializedExtensions.push(i),r._callbacks.fire(i.name)):(MsPortalFx.remove(r.initializedExtensions,i),r._unloadCallbacks.fire(i.name))})),i}));t.startRpc(this._extensionsMap)}return t.prototype.getExtension=function(n){var t=this._options.getNormalizedMetadata(n);return t&&this._extensionsMap[t.name]},t.prototype.onLoad=function(n){var i=this,r=this.initializedExtensions.slice(0),t=function(r){try{n(r)||i._callbacks.remove(t)}catch(u){o.error("onLoad event callback has thrown an exception.",2,u)}};this._callbacks.add(t);r.forEach((function(t){n(t.name)}))},t.prototype.onUnload=function(n){var i=this,t=function(r){try{n(r)||i._unloadCallbacks.remove(t)}catch(u){o.error("onUnload event callback has thrown an exception.",3,u)}};this._unloadCallbacks.add(t)},t.prototype.dispose=function(){this._ltm.dispose()},t.prototype.getExtensions=function(){var n=this;return Object.keys(this._extensionsMap).map((function(t){return n._extensionsMap[t]}))},__decorate([__metadata("fx:diagnostics",[n,"ExtensionManagerImpl"]),i.Class(),__metadata("design:paramtypes",[r.ExtensionFactory,s,u.ExtensionManagerOptions])],t)})();t.ExtensionManagerImpl=e;h=(function(){function t(){}return t.create=function(n){return n},__decorate([__metadata("fx:diagnostics",[n,"ExtensionManager"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[e]),__metadata("design:returntype",t)],t,"create",null),t})();t.ExtensionManager=h}));
define("MsPortalImpl/Services/Services.ExtensionStorageManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/ExtensionManager"],(function(n,t,i,r){"use strict";function y(n){var i,t=(i={},i.sessionStorage=s(n,"sessionStorage"),i.localStorage=s(n,"localStorage"),i),r;return{setItem:function(n){t[n.storage].setItem(n.keyName,n.keyValue)},removeItem:function(n){t[n.storage].removeItem(n.keyName)},clear:function(n){t[n.storage].clear()},registerChangeListener:function(n){var i=Object.keys(t).map((function(i){return t[i].registerChangeListener(n)}));return function(){i.forEach((function(n){n()}))}},serialize:function(){return{sessionStorage:t.sessionStorage.serialize(),localStorage:t.localStorage.serialize()}},ready:t.localStorage.ready,forceReady:function(){if(t.localStorage.isReady)return Promise.resolve();var i=fx.getTimestamp();return Promise.race([t.localStorage.ready,new Promise(function(f){r=setTimeout((function(){u.warning("initializing localStorage for extension "+n+" exceeded limit");t.localStorage.ready.then((function(){u.warning("initializing localStorage for extension "+n+" exceeded actually took "+(fx.getTimestamp()-i))}));f()}),500)})]).then((function(){clearTimeout(r)}))}}}var h;Object.defineProperty(t,"__esModule",{value:!0});t.ExtensionStorageManager=void 0;var c=MsPortalFx.Base.Diagnostics,u=c.createLog(n),f="LocalStorage",l="readwrite",e=function(n){u.error("error creating store transaction: "+JSON.stringify(n.target))},o=function(n){return n.transaction(f,l).objectStore(f)},a=function(n,t){var i=indexedDB.open(n,1),r=function(n){var u=o(n),f=u.openCursor(),i=[];f.onsuccess=function(n){var r=n.target.result;r?(i.push({key:r.key,value:r.value.value}),r.continue()):t(i.reduce((function(n,t){var i;return __assign(__assign({},n),(i={},i[t.key]=t.value,i))}),{}))};r=MsPortalFx.noop};i.onsuccess=function(){r(i.result)};i.onerror=function(n){u.warning("unable to initialize LocalStorage indexeddb: "+JSON.stringify(n)+", expected in incognito");t(Object.create(null))};i.onupgradeneeded=function(n){var t=n.target.result,i=t.createObjectStore(f,{keyPath:"key"});i.transaction.oncomplete=function(){r(t)}}},v=function(n,t){var i=indexedDB.open(n,1);i.onsuccess=function(){var n=i.result,r=o(n),u=t(r);u.onerror=e};i.onerror=e},s=function(n,t){var o="ExtensionStorage"+n,u=new Set,i=Object.create(null),s=t==="localStorage"&&indexedDB?"localStorage":"sessionStorage",f=s==="sessionStorage",h=new Promise(function(n){f?n():a(o,(function(t){i=t;f=!0;r();n()}))}),r=function(){u.forEach((function(n){return n({storage:t,serializedStorage:i})}))},e=function(n){s==="localStorage"&&h.then((function(){v(o,n)}))};return{setItem:function(n,t){i[n]=t;e((function(i){return i.put({key:n,value:t})}));r()},removeItem:function(n){delete i[n];e((function(t){return t.delete(n)}));r()},clear:function(){i=Object.create(null);e((function(n){return n.clear()}));r()},serialize:function(){return i},registerChangeListener:function(n){u.add(n);return function(){u.delete(n)}},ready:h,isReady:f}};h=(function(){function t(n){var t=this;this._storageByExtension=new Map;n.extensionsAsArray.forEach((function(n){var i=y(n.name);t._storageByExtension.set(n.name,i)}))}return t.prototype.getStorageForExtension=function(n){return this._storageByExtension.get(n)},__decorate([__metadata("fx:diagnostics",[n,"ExtensionStorageManager"]),i.Class(),__metadata("design:paramtypes",[r.ExtensionManagerOptions])],t)})();t.ExtensionStorageManager=h}));
define("MsPortalImpl/Extension/DefinitionCache",["require","exports","Fx/DependencyInjection","Fx/Experimentation","FxInternal/AsyncLoader","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/Extension.DefinitionValidator","Fx/Ajax","MsPortalImpl/Extension/ShellPart","FxHubs/RpcEndPoints","MsPortalImpl/Services/Services.ExtensionStorageManager"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";function w(n){return{commandsCatalog:MsPortalFx.convertArrayToMap(n.commandsCatalog,(function(n){return n.name})),commandGroups:MsPortalFx.convertArrayToMap(n.commandGroups,(function(n){return n.name}))}}function it(n,t){return t.getAsync(u.get("MsPortalImpl/Services/Services.ExtensionTokensManager","ExtensionTokensManager")).then((function(t){return t.createAuthTokenCache(n).getToken()}))}function rt(n){return h.ajax({uri:n,useRawAjax:!0,ignoreUnknownNetworkError:!0,dataType:"text"})}var v,y;Object.defineProperty(t,"__esModule",{value:!0});t.doesBladeDefinitionExist=t.DefinitionCache=t.DefinitionSource=void 0;var b=MsPortalFx.Base,p=FxImpl.Extension,k=b.UriBuilder,d=window,g=d.fx.environment,nt=new RegExp("^[\\w$]*(\\"+".ReactView".toLowerCase()+")?$"),tt=MsPortalFx.memoizeQ((function(){return Q.all([rt(new k(g.azFrameworkBundles.blade).path),MsPortalFx.require("MsPortalImpl/AzFramework/Parts.Az"),])}));v=(function(){function t(){}return t.prototype.getDefinition=function(){return null},__decorate([__metadata("fx:diagnostics",[n,"DefinitionSource"]),i.Class()],t)})();t.DefinitionSource=v;y=(function(){function t(n,t,i,r,u){this._diContainer=n;this._definitionSource=t;this._extensionManagerOptions=i;this._manifestCache=r;this._rpcClient=u;this._cache={};this._azCache={}}return t.prototype.getDefinition=function(n){return this._extensionManagerOptions.getNormalizedMetadata(n,!0).flags&256?this._getAzDefinition(n):this._getEntry(n).definition},t.prototype.getCommandGroup=function(n,t){return this._getCommandDefinitions(n,t,(function(n){return n.commandGroups}))},t.prototype.getCommand=function(n,t){return this._getCommandDefinitions(n,t,(function(n){return n.commandsCatalog}))},t.prototype.getBladeDefinition=function(n,t,i){var o=this._extensionManagerOptions.getNormalizedMetadata(n,!0),u;if(o.flags&256)return tt(),it(n,this._diContainer),this._getAzBladeDefinition(t,n,MsPortalFx.Parts.PartKind._Internal_Az);var f=this._getEntry(n),s=f.definition,r=t.toLowerCase(),e=s.bladeMap[r];return e?Q(e):(u=f.bladeDefMap,!nt.test(t===null||t===void 0?void 0:t.toLowerCase()))?Q.reject(FxImpl.createError("Blade name is invalid identifier")):(this._diContainer.get(a.ExtensionStorageManager).getStorageForExtension(n),t.toLowerCase().endsWith(".ReactView".toLowerCase())?this._getAzBladeDefinition(t,n,MsPortalFx.Parts.PartKind._Internal_React):r.endsWith("_dx")?Q(u[r]||this.setDxBladeDefinition(n,t)):Q(u[r]||!i&&this.setBladeDefinition(n,t,p.getBladeDefinitionEndPoint.invoke(this._rpcClient,n,t))))},t.prototype.doesBladeDefinitionExist=function(n,t){var i=this,r,f;if(t.toLowerCase().endsWith("_dx"))return r=this._extensionManagerOptions.getNormalizedMetadata(n,!0),f=u.get("MsPortalImpl/Extension/DxDefinitionCache","getDxBladeDefinition").then((function(u){return u(n,t,r,i._manifestCache,i._rpcClient,!0)})),f.then((function(n){return!!n}));throw new Error("Not implemented");},t.prototype.setDxBladeDefinition=function(n,t){return __awaiter(this,void 0,void 0,(function(){var i,r,f=this;return __generator(this,(function(){return i=this._extensionManagerOptions.getNormalizedMetadata(n,!0),r=u.get("MsPortalImpl/Extension/DxDefinitionCache","getDxBladeDefinition").then((function(r){return r(n,t,i,f._manifestCache,f._rpcClient)})),[2,this.setBladeDefinition(n,t,r)]}))}))},t.prototype.setBladeDefinition=function(n,t,i){var r=this,u=this._getEntry(n),f=u.definition,e=t.toLowerCase(),h=u.bladeDefMap;return h[e]=i.then((function(t){return o.processBlade(f,r._manifestCache.getManifest(n,"assetTypes"),t,r._extensionManagerOptions.extensionRedirectMap)})).then((function(n){var t=[];if(s.validateBlade(f,n,null,t),t.length)throw new Error("Invalid blade definition. Errors: "+t.join("\n"));return n})).finally((function(){delete h[e]}))},t.prototype.loadPartDefinition=function(n,t){var u=this,i;return n==="HubsExtension"&&(i=c.shellParts[t],i)?MsPortalFx.tryImmediateResolve(MsPortalFx.require(i.shellModule),(function(n){return u._diContainer.get(r.Experimentation).getAssignments().then((function(i){return t.toLowerCase()==="resourcepart"&&i.getBooleanValue("AzurePortal_NewResourcePart")&&(n.partDefinition.resizeMode=2),n.partDefinition}))})):p.getPartDefinitionEndPoint.invoke(this._rpcClient,n,t)},t.prototype.getPartDefinition=function(n,t){var u=this,f=this._getEntry(n),e=f.definition,i=t.toLowerCase(),h=e.partTypeMap[i],r;return h?Q(h):(r=f.partDefMap,r[i]||(r[i]=this.loadPartDefinition(n,t).then((function(t){t=o.processPart(e,u._manifestCache.getManifest(n,"assetTypes"),t,u._extensionManagerOptions.extensionRedirectMap);var i=[];if(s.validatePartType(t,i),i.length)throw new Error("Invalid part type definition. Errors: "+i.join("\n"));return t})).finally((function(){delete r[i]}))))},t.prototype._getAzBladeDefinition=function(n,t,i){var r=this;return this._diContainer.getAsync(u.get("MsPortalImpl/AzFramework/AzExtensionCore","AzDefinitionCache")).then((function(u){return u.getBladeDefinition(r._getAzDefinition(t),n,t,i)}))},t.prototype._getCommandDefinitions=function(n,t,i){var r,u;return t?(r=this._getEntry(n),r.commandDefMap||(u=r.definition,r.commandDefMap=u.commandGroups||u.commandsCatalog?Q(w(u)):FxImpl.Extension.getCommandsDefinitionEndPoint.invoke(this._rpcClient,n,undefined).then((function(n){return o.processCommands(n),w(n)}))),MsPortalFx.tryImmediateResolve(r.commandDefMap,(function(n){return i(n)[t]}))):Q()},t.prototype._getAzDefinition=function(n){return this._azCache[n]||(this._azCache[n]={name:n,bladeMap:{},partTypeMap:{}})},t.prototype._getEntry=function(n){return this._cache[n]||(this._cache[n]={definition:this._definitionSource.getDefinition(n)||{name:n,bladeMap:{},partTypeMap:{}},bladeDefMap:{},partDefMap:{},commandDefMap:null})},__decorate([__metadata("fx:diagnostics",[n,"DefinitionCache"]),i.Class(),__metadata("design:paramtypes",[i.Container,v,e.ExtensionManagerOptions,f.ManifestCache,FxImpl.Rpc.Client])],t)})();t.DefinitionCache=y;t.doesBladeDefinitionExist=u.defineHandler(l.Provisioning.doesBladeDefinitionExistEndPoint,(function(n){var t=n.messageArg;return Q(n.diContainer.get(y).doesBladeDefinitionExist(t.extensionName,t.bladeName))}))}));
define("MsPortalImpl/Services/Services.SecurityTokens",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u){"use strict";function bt(n){var r={extensionName:n.extensionName,resourceName:n.resourceName,tenant:n.tenant,portalAuthorization:n.portalAuthorization,wwwAuthHeader:n.wwwAuthHeader,authConfigStamp:n.authConfigStamp,altPortalAuthorization:n.altPortalAuthorization},u=f.start({source:"Services.SecurityTokens",action:"Get",name:n.extensionName}),t="",i="",e=n.skipCache?ht:st;return Q(p.postJSON({uri:e,dataType:"json",setAuthorizationHeader:!1,performRetry:!1},r)).catchError(MsPortalFx.Errors.AjaxError,(function(r){var f,e,o,s,u;return t="Failed to get tokens for extension '{0}' resource '{1}'. {2} {3} {4}".format(n.extensionName,n.resourceName,(e=(f=r===null||r===void 0?void 0:r.jqXHR)===null||f===void 0?void 0:f.status)!==null&&e!==void 0?e:"",(o=r===null||r===void 0?void 0:r.textStatus)!==null&&o!==void 0?o:"",(s=r===null||r===void 0?void 0:r.errorThrown)!==null&&s!==void 0?s:""),u="",r?r.jqXHR?r.jqXHR.responseText||(u="response.jqXHR.responseText"):u="response.jqXHR":u="response",i=u?u+" was undefined.":r.jqXHR.responseText.slice(0,20),Q.reject(r)})).finally((function(){f.endTrace(u,!t,{error:t,resourceName:n.resourceName,skipCache:n.skipCache,errorResponseText:i})}))}var c,tt;Object.defineProperty(t,"__esModule",{value:!0});t.SecurityTokensManager=void 0;var s=MsPortalFx.Base,p=s.Net2,it=s.Constants,w=s.Diagnostics,f=w.Telemetry,rt=s.Resources,ut=s.Security,ft=FxImpl.Security,b=it.Shell,et=window,e=w.createLog(n),k=["cloudsimpleextbearer","cacheextensionapp","internalgraphapiversion","cae","prefetchtokensinparallel",].reduce((function(n,t){var i=MsPortalFx.getFeatureValue(t);return i&&n.push("feature."+t+"="+i),n}),[]).join("&"),ot=k.length?"&":"",d=rt.getAppRelativeUri("/api/DelegationToken?"+k+ot),st=d+"feature.tokencaching="+MsPortalFx.isFeatureEnabled("tokencaching"),ht=d+"feature.tokencaching=false",o=ft.tokenErrors,l=fx.environment.auth.portalClientId,g=fx.environment.auth.armAadResource,ct=/\{(.*?)\}/,lt=new Map([["{graph}",FxImpl.internalEnv.fxGraphEndpoint],["{msgraph}",FxImpl.internalEnv.fxMsGraphEndpoint],]),a=o.unknown,v=o.sessionEnded,nt=o.credentialsExpired,at=o.networkError,vt=o.badRequest,yt=MsPortalFx.isFeatureEnabled("cae"),pt=(c={},c[o.requiresMFA.toLowerCase()]=!0,c[o.tooManyRequests.toLowerCase()]=!0,c),y=Object.create(null),h=Date.now,wt=["","self"];tt=(function(){function t(n){var o=this,i,r,u,t,f,e;this._authStateManager=n;this.saveMruTokenFunc=MsPortalFx.noop;this.sessionEndedHandler=MsPortalFx.noop;this.tokenFailedHandler=MsPortalFx.noop;this.unauthorizedTokenHandler=MsPortalFx.noop;this.tokenMfaErrorHandler=MsPortalFx.noop;this.tokenClaimsErrorHandler=MsPortalFx.noop;this._sessionEnded=!1;MsPortalFx.isFeatureEnabled("msaljs")&&(this._portalAuthHandlerPromise=MsPortalFx.require("MsPortalImpl/Services/PortalAuthHandler").then((function(t){return new t.MsalClientAuth(n)})),this._extensionsAuthMetadataLoadPromise=this._initializeExtensionsAuthMetadata());t=(i=n.bootstrapState)!==null&&i!==void 0?i:{};f=(r=t.createdOn)!==null&&r!==void 0?r:h();this._userUsedMfa=n.getCurrentUser().isMfa;e=this._user=(u=t.user)!==null&&u!==void 0?u:{};this._tenantId=e.tenantId;this._ongoingTokenRequest=Q();this.shellTokenCache=this._createShellTokenCache(t.oAuthToken,t.selfOAuthToken,f);this.getTokenFunc=function(n){return o.shellTokenCache.getToken(n).then((function(n){return n&&n.header}))};p.initialize(this.getTokenFunc)}return t.prototype.isSessionEnded=function(){return this._sessionEnded},t.prototype.getDiagnosticsData=function(){return{user:this._user}},t.prototype.getToken=function(n){var ut=this,s,y;n=n||{};var c=n.skipCache||!!n.wwwAuthHeader,tt=n.isBackground,t=n.extensionName,i=n.resourceName,r=n.audience;if(i=i||"",t==="fx"?"HubsExtension":t,i.toLowerCase()==="telemetrytoken"&&(t="HubsExtension",i=yt?"self":""),!c&&(y=this._authStateManager.tokenCache[t],y)){var p=(s=y[i])!==null&&s!==void 0?s:{},w=p.header,k=p.expiresAt;if(k>h())return f.trace({source:"Services.SecurityTokens",action:w?"GetCachedToken":"GetCachedErrorResponse",name:t,data:{resourceName:i,cacheEntryExpirationTicks:k}}),Q(__assign(__assign({},p),{token:w?{header:w,expiresAt:k}:null}));this._authStateManager.clearExtensionTokens(t)}var it=this.shellTokenCache,d=1,rt=function(){return __awaiter(ut,void 0,void 0,(function(){var s,at,w,ot,k,st,ut,ft,vt,p,ht,y=this;return __generator(this,(function(yt){switch(yt.label){case 0:return(s="",!MsPortalFx.isFeatureEnabled("msaljs"))?[3,2]:[4,this._extensionsAuthMetadataLoadPromise];case 1:if(at=yt.sent(),w=at[t.toLowerCase()],!w){if(e.warning("The extension '"+t+"' was not found in the list of extensions registered with the portal. The portal's ARM token will be returned by default."),ot=this._authStateManager.tokenCache.HubsExtension,k=ot&&ot[""],k)return[2,Q(__assign(__assign({},k),{token:k||null}))];r=g;s=l}if(s=s||w.oAuthClientId,s||(e.warning("The extension '"+t+"' does not have an oAuthClientId specified. The portal's client ID will be used to make this request."),s=l),i||(r=g,s=l),!r){if(st=w.resourceAccessMap,!st)return f.trace({source:"Services.SecurityTokens",action:"EmptyAudienceInPortalConfig",name:t,data:{resourceName:i}}),[2,Q.reject("The extension '"+t+"' has not defined any resource access in the portal's configuration.")];if(ut=st[i],!ut)return f.trace({source:"Services.SecurityTokens",action:"MissingResourceInPortalConfig",name:t,data:{resourceName:i}}),[2,Q.reject("The extension '"+t+"' has not defined the resource access for resource '"+i+"' in the extension's configuration, or in the portal's configuration.")];if(r=ut.resource,s=ut.overrideClientId||s,!r)return f.trace({source:"Services.SecurityTokens",action:"MissingAudienceInPortalConfig",name:t,data:{resourceName:i}}),[2,Q.reject("The extension '"+t+"' has an invalid audience for the resource '"+i+"' in the extension's configuration or portal's configuration.")]}if(ft=ct.exec(r),ft&&ft.length&&(vt=r,r=lt.get(ft[0]),!r))return[2,Q.reject("The extension '"+t+"' has an unsupported placeholder '"+vt+"' as the audience for the resource '"+i+"' in the extension's configuration or portal's configuration.")];f.trace({source:"Services.SecurityTokens",action:"ExtensionTokenRequestSummary",name:t,data:{resourceName:i,audience:r,extensionClientId:s}});yt.label=2;case 2:return p=h(),ht=__assign(__assign({},n),{extensionName:t,resourceName:i,skipCache:c,extensionClientId:s,audience:r}),[2,(MsPortalFx.isFeatureEnabled("msaljs")?this._getTokenFromMsalJs(ht):this._getTokenFromServer(ht)).then((function(r){var g,ft,ot,at,st,vt,yt,ht;r=r||{};var k=r.value||{},s=k.status,l=k.errorMessage,ut=k.missingClaims,ct=k.authHeader,w,lt=((g=r.relatedExtensionMetadata)===null||g===void 0?void 0:g.length)?r.relatedExtensionMetadata:[{name:t,resource:i}];if(f.trace({source:"Services.SecurityTokens",action:"GetTokenResult",data:{extensionName:t,resourceName:i,status:s,errorMessage:l,missingClaimsReceived:!!ut,authHeaderReceived:!!ct}}),ut)return y.tokenClaimsErrorHandler(t,i,ut,l),null;if(ct)if(s)e.warning("Received malformed token with non-null 'authHeader' and 'status' values. If the token has a valid authHeader, the status must be null and vice-versa. Extension: "+t+", resource: "+i+", status: "+s);else if(ft=h(),w=p+k.expiresInMs,w<=ft)if(d>3)e.error("Unable to get token after {0} retry attempts.".format(d)),s=a;else return e.warning("Token fetch took longer than token lifetime, retrying operation. Retry attempt: "+d+++", Token expiration: "+w+", Current time: "+ft,null,{extensionName:t,resourceName:i,isBackground:tt,skipCache:c}),rt();else return ot={header:k.authHeader,expiresAt:w},y._persistResponseInCache(lt,ot),{token:ot};return s||(s="NullTokenNullError",e.warning('Token missing both authHeader and status. The token must contain a valid status if the authHeader could not be obtained. Setting status to "'+s+'". Extension: '+t+", resource: "+i)),pt[s.toLowerCase()]&&(at={header:null,expiresAt:p+6e4,error:s,errorMessage:l},y._persistResponseInCache(lt,at)),st=s===nt,s===v&&["UnauthorizedRefreshToken","AccountIdentifierMismatch"].includes(l)?y.unauthorizedTokenHandler(t,i,l):s===v||st?(y._sessionEnded=!0,st||!it?w=p:(vt=t===b?i:"",w=it.getTokenExpiresAt(vt)),y.sessionEndedHandler(t,w||p)):s===o.requiresMFA?(yt=y._userUsedMfa?u.mfaFailureUserHasMfa:u.mfaFailureUserHasNoMfa.format(et.fx.environment.links.mfa),y.tokenMfaErrorHandler(t,i,yt)):tt||(n.extensionIsSideloaded&&(l+=" Testing extension authorization configuration changes by sideloading is not supported. Please deploy your changes to test."),y.tokenFailedHandler(t,i,l),ht="Failed to get token for {0} & {1}. Error:{2}. Message:{3}".format(t,i,s,l),s===a?e.error(ht):e.verbose(ht)),{token:null,error:s,errorMessage:l}}))]}}))}))};return Q(rt())},t.prototype._getTokenFromMsalJs=function(n){if(!MsPortalFx.isFeatureEnabled("msaljs"))throw"No calls should be made to MSAL.js at this time.";var t=[MsPortalFx.ensureSuffix(n.audience,"/")+".default"],i=n.extensionClientId,r;return r=i.toLowerCase()===l?this._portalAuthHandlerPromise.then((function(n){return n.acquireTokenForPortal({scopes:t})})):this._portalAuthHandlerPromise.then((function(n){return n.acquireTokenForExtension({scopes:t,extensionClientId:i})})),r.then((function(n){return{value:n,portalAuthorization:"",altPortalAuthorization:""}}))},t.prototype._getTokenFromServer=function(n){var r=this;if(MsPortalFx.isFeatureEnabled("paralleltokens")){var u=n.extensionName,f=n.resourceName,t=(u+"_"+f).toLowerCase(),i=y[t];return(!i||n.skipCache)&&(y[t]=i=this._getToken(n)),i.finally((function(){y[t]=null}))}return this._ongoingTokenRequest=this._ongoingTokenRequest.then((function(){return r._getToken(n)})),this._ongoingTokenRequest},t.prototype._getToken=function(n){var u=this,f=n.extensionName,t=n.resourceName,i=this._authStateManager.bootstrapState.refreshToken,r=this._authStateManager.bootstrapState.altRefreshToken,e=bt({extensionName:f,tenant:this._tenantId,resourceName:t!==null&&t!==void 0?t:"",portalAuthorization:i,skipCache:n.skipCache,wwwAuthHeader:n.wwwAuthHeader,authConfigStamp:n.authConfigStamp,altPortalAuthorization:r}).catch((function(n){var u,f,e,o,s,h=(u=n.data)!==null&&u!==void 0?u:{},t=h.status,c,l,v;return c=t===401?nt:t===400?vt:t?a:at,l=(o=(e=(f=n===null||n===void 0?void 0:n.jqXHR)===null||f===void 0?void 0:f.responseJSON)===null||e===void 0?void 0:e.message)!==null&&o!==void 0?o:n.message,v=(s=n===null||n===void 0?void 0:n.stack)!==null&&s!==void 0?s:"",{portalAuthorization:i,value:{authHeader:null,expiresInMs:0,refreshToken:null,status:c,errorMessage:"code: "+t+", statusText: "+h.statusText+", message: "+l+", stack: "+v},altPortalAuthorization:r}}));return e.then((function(n){return n.value.authHeader&&MsPortalFx.isFeatureEnabled("prefetchtokens")&&u.saveMruTokenFunc({extension:f,resource:t}),u._authStateManager.updateRefreshToken(n.portalAuthorization||i,n.altPortalAuthorization||r),n}))},t.prototype._persistResponseInCache=function(n,t){this._authStateManager.updateExtensionTokens(n,t)},t.prototype._createShellTokenCache=function(n,t,i){var u=this,f,e,o=Object.create(null),r;return n&&(r=(f=n.expiresInMs)!==null&&f!==void 0?f:1,o[""]={header:n.authHeader,expiresAt:r>0?i+r:-1}),t&&(r=(e=t.expiresInMs)!==null&&e!==void 0?e:1,o.self={header:t.authHeader,expiresAt:r>0?i+r:-1}),ut.createAuthTokenCache((function(i){return u._sessionEnded?Q({error:v}):u.getToken(__assign(__assign({},i),{extensionName:b,resourceName:i?i.resourceName:"",skipCache:i.skipCache})).then((function(r){var o,f=(r!==null&&r!==void 0?r:{}).token,a;if(!!f&&wt.includes(i.resourceName)){var s=h(),e=(o=u._authStateManager.bootstrapState)!==null&&o!==void 0?o:{},c=void 0,l=void 0;i.resourceName===""?(c={authHeader:f.header,expiresInMs:f.expiresAt-s},l=t):(c=n,l={authHeader:f.header,expiresInMs:f.expiresAt-s});a={aadSessionId:e.aadSessionId,refreshToken:e.refreshToken,user:e.user,createdOn:s,oAuthToken:c,selfOAuthToken:l,idleTimeoutSeconds:e.idleTimeoutSeconds,altRefreshToken:e.altRefreshToken};u._authStateManager.updateBootstrapState(a,"getTokenFunc")}return r}))}),o)},t.prototype._initializeExtensionsAuthMetadata=function(){return __awaiter(this,void 0,void 0,(function(){var n;return __generator(this,(function(t){switch(t.label){case 0:return[4,MsPortalEarly.preload];case 1:return n=t.sent(),[2,n.extensionsAuthMetadata]}}))}))},__decorate([__metadata("fx:diagnostics",[n,"SecurityTokensManager"]),i.Class(),__metadata("design:paramtypes",[r.AuthStateManager])],t)})();t.SecurityTokensManager=tt}));
define("MsPortalImpl/Services/Services.ExtensionTokensManager",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Services/Services.SecurityTokens"],(function(n,t,i,r,u,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getAuthorizationTokenEndPoint=t.ExtensionTokensManager=void 0;var s=FxImpl.Extension,h=MsPortalFx.Base,c=h.Security,l=FxImpl.Security,e=l.tokenErrors,a=e.accessDenied,v=e.sessionEnded,o=(function(){function t(n,t){var i=this;this._shellTokenManager=n;this._extensions=t;this.createAuthTokenCache=MsPortalFx.memoize((function(n){var t=c.createAuthTokenCache((function(t){return i.getSecurityToken(__assign(__assign({},t),{extensionName:n,resourceName:t.resourceName||"",skipCache:t.skipCache}))}));return{getToken:function(n){return Q(t.getToken(n))}}}))}return t.prototype.getSecurityToken=function(n){var t,e=n.extensionName,i=n.resourceName,o=n.skipCache,s=n.wwwAuthHeader,r=(t=this._extensions[e])!==null&&t!==void 0?t:{},u=r.flags,f=this._shellTokenManager.shellTokenCache;return i&&u&16?Q({error:a}):this._shellTokenManager.isSessionEnded()?Q({error:v}):f&&!i&&u&8&&!o?f.getToken({resourceName:"",wwwAuthHeader:s}).then((function(n){return{token:n}})):this._shellTokenManager.getToken(__assign(__assign({},n),{extensionIsSideloaded:r.isSideloaded}))},t.create=function(n,i){return new t(n,FxImpl.mapValues(i.extensionsAsMap,(function(n){return{flags:n.flags,isSideloaded:n.isSideloaded}})))},__decorate([__metadata("fx:diagnostics",[n,"ExtensionTokensManager"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[f.SecurityTokensManager,u.ExtensionManagerOptions]),__metadata("design:returntype",t)],t,"create",null),t})();t.ExtensionTokensManager=o;t.getAuthorizationTokenEndPoint=r.defineHandler(s.getAuthorizationTokenEndPoint,(function(n){var t=n.messageArg;return n.diContainer.get(o).getSecurityToken({extensionName:n.messageContext.srcWindowId,resourceName:t.resourceName||"",isBackground:t.isBackground,skipCache:t.skipCache,wwwAuthHeader:t.wwwAuthHeader,authConfigStamp:t.authConfigStamp,audience:t.audience})}))}));
define("MsPortalImpl/Widgets/ReactFrame.Prewarmer",["require","exports","MsPortalImpl/Services/Services.ExtensionStorageManager","MsPortalImpl/Services/Services.ExtensionTokensManager","MsPortalImpl/Extension/ExtensionManagerOptions"],(function(n,t,i,r,u){"use strict";function b(){var n=o?fx.environment.reactViewSameOriginEndpoints:fx.environment.reactViewEndpoints,t=n.length&&n[Number(y)]||FxImpl.trustedParentOrigin,i=""+t+fx.environment.applicationPath+"/React/Index?reactView=true"+tt+"#postParams/";return i.replace("{subdomain}","sandbox-"+MsPortalFx.sessionId+"-"+it+"-"+a)}function rt(){if(!l)throw new Error("No root element has been defined yet, cannot create any frames");}function ut(){return"_react_frame_"+a++}function k(n){var i=document.createElement("iframe"),u=ut(),r;return i.setAttribute("id",u),i.classList.add("fxs-part-frame"),i.classList.add("fxs-portal-bg-txt-br"),i.setAttribute("sandbox",o?"allow-scripts allow-popups allow-modals allow-forms allow-popups-to-escape-sandbox allow-downloads allow-same-origin":"allow-scripts allow-popups allow-modals allow-forms allow-popups-to-escape-sandbox allow-downloads"),i.setAttribute("allow","microphone *; encrypted-media *;clipboard-read;"),i.setAttribute("role","presentation"),i.setAttribute("allowfullscreen","true"),i.classList.add("fxs-extension-frame"),r=function(n){var t;return n.source===i.contentWindow&&((t=n.data)===null||t===void 0?void 0:t.signature)===c},new Promise(function(t){var u=function(n){if(r(n)){var i=n.data;i.kind===0?(t(),h.removeEventListener("message",u)):nt.warning("Received other react view message before FrameReady message",null,{kind:i.kind})}};h.addEventListener("message",u);w.then((function(){return i.src=b()}));n.appendChild(i)}).then((function(){return Q.all([MsPortalFx.require("_generated/Less/MsPortalImpl/Base/Base.Images.css"),MsPortalFx.require("_generated/Less/MsPortalImpl/Widgets/Widgets.Portal.css"),]).then((function(n){var f=new MessageChannel;i.contentWindow.postMessage({signature:c,kind:3,data:{requireConfig:FxImpl.internalEnv.fxRequireConfig,initModules:["@fluentui/react/lib/Fabric","@fluentui/react/lib/DetailsList","@microsoft/azureportal-reactview/ReactView","@microsoft/azureportal-reactview/Environment"],css:n.map((function(n){return n.css})).join("\n"),isMenuBlade:!0,profile:MsPortalFx.isFeatureEnabled("reactprofile"),portalUri:FxImpl.internalEnv.portalApplicationUri,type:"prewarm"}},t.reactOrigin,[f.port1]);var e=[],o=function(n,t){e.push({kind:n,data:t})},s=function(n){if(r(n)){var t=n.data;o(t.kind,t.data)}};return h.addEventListener("message",s),{id:u,element:i,port:f.port2,setMessageListener:function(n){for(var t;t=e.shift();)n(t.kind,t.data);o=n},clearMessageListener:function(){h.removeEventListener("message",s)},latestSet:!1}}))}))}function ft(n){var v=Date.now(),a=[{name:"reactBoot",eventName:"setLatest",timeStamp:v},],e=n.extensionName,t=n.viewName,y=n.parameters,h=n.frame,l=n.diContainer,p=n.inContextPane,o=l.get(FxImpl.Rpc.Client);(o.acquireWindow(e,90),!p||h)&&(h||f||s(),Promise.all([l.get(u.PostBootCache).get(e),MsPortalFx.require("MsPortalImpl/Parts/Parts.ReactFrame"),h?Promise.resolve(h):f,]).then((function(u){var w=u[0],s=u[1],f=u[2],k;if(f===null||f===void 0?!void 0:!f.latestSet){var rt=l.get(i.ExtensionStorageManager).getStorageForExtension(e).serialize(),ut=s.loadModel(o,e).port,d=ko.toJS(y),h=w.requireConfig,ft=t&&s.getModuleIdAndUrl(t,h).id,nt=t&&""+t.substring(0,t.length-10)+".DataFetcher",et=nt&&s.getModuleIdAndUrl(nt,h).id,p=[];if(MsPortalFx.isFeatureEnabled("reacttokenfetch")){var tt=l.get(r.ExtensionTokensManager).createAuthTokenCache(e).getToken,b=t===null||t===void 0?void 0:t.replace(".ReactView",".TokenFetcher."),it=b&&s.getModuleIdAndUrl(b,h,!0).id;it&&(p=it.replace(b,"").split("!"));tt();p.length&&(p.forEach((function(n){return tt({resourceName:n})})),g.trace({source:"ReactViewPrewarmer",action:"PrefetchCustomToken",name:t,data:{resourceNames:p}}))}a.push.apply(a,[{name:"reactBoot",eventName:"setLatest",details:"Finish loading reactBootPayload reactFramePart reactFrame",timeStamp:Date.now()},{name:"reactBoot",eventName:"early",timeStamp:Date.now()},]);n.bladeSequenceNumber&&(k={viewName:t,sequenceNumber:n.bladeSequenceNumber},FxImpl.Extension.onNewReactViewEndPoint.invoke(o,e,k),f.onDisposed=function(){f.onDisposed=null;FxImpl.Extension.onReactViewDisposed.invoke(o,e,k)});f.port.postMessage({signature:c,kind:3,data:{requireConfig:t&&h,initModules:[ft],parameters:d,type:"early",environment:w.extensionEnvironment,features:w.features,fetcherId:et,serializedStorage:rt,tokenResourceNames:p,isMenuBlade:n.isMenuBladeContent,perfLogEntries:a,renderStart:v}},[ut]);f.model=s.loadModelForView(o,h,e,t,d);f.latestSet=!0}})))}function d(){return rt(),k(l)}function et(n){var i=(n===1?k(document.querySelector(".fxs-portal-contextpane-right")):f).then((function(n){var t,i;return(t=e[e.length-1])===null||t===void 0?void 0:t.classList.remove("fxs-reactview-frame-active"),i=n.element,i.classList.add("fxs-reactview-frame-active"),e.push(i),n})),t,r;return n===0&&(f=null),t=function(){s===t&&(f||(f=d()),s=MsPortalFx.noop)},s=t,r=function(){i.then((function(n){var t,i,r=n.element;r.remove();MsPortalFx.remove(e,r);(t=e[e.length-1])===null||t===void 0?void 0:t.classList.add("fxs-reactview-frame-active");(i=n.onDisposed)===null||i===void 0?void 0:i.call(n)}))},{frame:i,completed:t,dispose:r}}function ot(n){l=n;f=d()}var a,s;Object.defineProperty(t,"__esModule",{value:!0});t.setFrameRoot=t.getFrame=t.setLatest=t.reactOrigin=void 0;var v=MsPortalFx.Base.Diagnostics,g=v.Telemetry,nt=v.createLog(n),h=window,o=MsPortalFx.isFeatureEnabled("reactorigin"),y=MsPortalFx.getFeatureValue("reactviewendpointindex")||"0";t.reactOrigin="*";var c="Az",p={l:FxImpl.Intl.effectiveLocale,preorderperf:MsPortalFx.getFeatureValue("preorderPerf"),trustedAuthority:FxImpl.trustedParentOrigin,contentHash:fx.environment.reactFrameContentHashes[0],reactIndex:y},tt=Object.keys(p).reduce((function(n,t){var i=p[t];return i?n+("&"+t+"="+i):n}),""),f,l,e=[],it=Math.floor(Math.random()*100),w=Promise.resolve();o&&(w=fetch(b()).then((function(n){var t=String(n.status).substring(0,1);t!=="2"&&t!=="3"&&(o=!1)})).catch((function(){o=!1})));a=1;t.setLatest=ft;s=MsPortalFx.noop;t.getFrame=et;t.setFrameRoot=ot}));
define("MsPortalImpl/Extension/ViewModelManager",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","FxInternal/Composition/ViewModelComposer","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Widgets/ReactFrame.Prewarmer","MsPortalImpl/Extension/ShellPart","MsPortalImpl/Extension/DefinitionCache","MsPortalImpl/Extension/ExtensionManager"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function v(){return nt++}function y(n,t,i){var r=typeof t=="object"?t:{name:t};return{type:n,locator:r,createSelectable:i.createSelectable,telemetryContext:d.getState(),partSize:i.partSize,contentSize:i.contentSize,partLocation:i.partLocation,onInputsSetParameters:i.onInputsSetParameters,collapsed:i.collapsed,flags:i.flags,menuId:i.menuId}}function it(n,t,i){c[n]={name:n,modulePath:t,factoryWithState:i}}function w(n,t,i){l[n]={name:t,modulePath:i}}function rt(n){return n in l||n in c||n.startsWith("Shell.InferredBladePinPart")}function b(n,t,i,r){var f=null,e=null,u=i.locator.name,o;return u in l?(o=n.get(tt),i.locator={name:u,module:l[u].modulePath,"export":l[u].name},o.getObservable(n.createChildContainer("viewModel"),null,i,r)):(u in c?(f=c[u].modulePath,e=function(n){return c[u].factoryWithState(n)}):u.startsWith("Shell.InferredBladePinPart")&&(f="MsPortalImpl/Extension/PinBladeInferred",e=function(i){return i.createViewModel(u,n.get(a),n.get(s.DefinitionCache),t)}),f?MsPortalFx.require(f).then((function(n){return e(n)})).then((function(n){return r&&r(n),typeof i.partSize=="number"&&n&&n.content&&ko.isObservable(n.content.size)&&n.content.size(i.partSize),i.onInputsSetParameters&&n&&n.updatePartInputValues&&(n.onInputsSetPromise=Q(n.updatePartInputValues(i.onInputsSetParameters.inputs,i.onInputsSetParameters.settings,i.onInputsSetParameters.traceOptions))),n})):void 0)}function k(n){var t=MsPortalFx.isPlainObject(n)&&Object.keys(n).map((function(t){return n[t]}))||Array.isArray(n)&&n;return t&&t.some((function(n){return typeof n=="function"||k(n)}))}var p,a;Object.defineProperty(t,"__esModule",{value:!0});t.resolve=t.registerWithDi=t.registerWithState=t.ViewModelManager=t.getViewModelOptions=t.getNextSequenceNumber=void 0;var d=FxImpl.TelemetryContext,g=MsPortalFx.Base.Diagnostics.createLog(n),nt=1;t.getNextSequenceNumber=v;t.getViewModelOptions=y;p=(function(){function t(n,t,i,r,u){this._diContainer=n;this._rpcClient=t;this._extensionManagerOptions=i;this._definitionCache=r;this._extensionLoader=u;this._proxiedObjects=new Map;this._prefetchedResults=[];this._bladeSequenceNumbers=[]}return t.prototype.getViewModel=function(n,t,i,r){return this._getViewModel(n,i,t,r,u.getViewModelEndPoint,!1)},t.prototype.getPartViewModel=function(n,t,i,f){var o=this,e;return this._useAzViewModelManager(n,t)?this._diContainer.getAsync(r.get("MsPortalImpl/AzFramework/AzExtensionCore","AzViewModelManager")).then((function(r){return r.getPartViewModel(n,t,i,f)})):(e=this._getViewModel(n,i,t,f,u.getPartViewModelEndPoint,!0),e.then((function(r){return r||g.error("ViewModelComposer returned null/undefined for the view model",0,[{extensionName:n,type:i,name:t,options:f}]),o._onPartViewModelAcquired(r)})),e)},t.prototype.getWeaveShellPort=function(n){var t=this._proxiedObjects.get(n);return t&&t.isPartViewModel&&t.managedValue},t.prototype._useAzViewModelManager=function(n,t){return!!(this._extensionManagerOptions.getNormalizedMetadata(n,!0).flags&256)||typeof t=="string"&&(t.toLowerCase().endsWith(".ReactView".toLowerCase())||t.toLowerCase().endsWith("_dx"))},t.prototype._getViewModel=function(n,t,i,r,u,f){var s=this,e,o;return(r=r||{},e=y(t,i,r),o=b(this._diContainer,n,e,r.onViewModelAcquired),o)?o:u.acquireChannel(this._rpcClient,n,e).then((function(n){var t=n.value;return s._proxiedObjects.set(t,{isPartViewModel:f,managedValue:n}),r.onViewModelAcquired&&r.onViewModelAcquired(t),t}))},t.prototype.releaseViewModel=function(n,t){var i=this._proxiedObjects.get(n),r;i&&(r=i.managedValue,t||MsPortalFx.disposeViewModelProperties(n),MsPortalFx.disposeDisposable(n),r.dispose(),this._proxiedObjects.delete(n))},t.prototype.getBladeSequenceNumber=function(n,t){var i,r=n+","+t;if((i=MsPortalFx.find(this._bladeSequenceNumbers,(function(n){return r===n.key})))!==null&&i!==void 0)return i.sequenceNumber},t.prototype.tryEarlyGetViewModel=function(n,t,i,r){var c=this,y,o,p,w,f,b,d;try{n=this._extensionManagerOptions.getNormalizedMetadata(n,!0).name}catch(tt){return Q.reject(tt)}var g=function(n,t){while(t.length>2)t.pop();t.push(n)},h=n+","+t,l=r.isPrefetch,nt=this.getBladeSequenceNumber(n,t),a=r.sequenceNumber||nt||v();return(l&&!nt&&g({key:h,sequenceNumber:a},this._bladeSequenceNumbers),y=this._useAzViewModelManager(n,t),y&&t.toLowerCase().endsWith(".ReactView".toLowerCase())&&e.setLatest({extensionName:n,viewName:t,parameters:i,isMenuBladeContent:r.isMenuBladeContent,inContextPane:r.inContextPane,diContainer:this._diContainer,bladeSequenceNumber:a}),o=!(y||rt(t)),o&&(p=this._definitionCache.getBladeDefinition(n,t,!0),w=p&&p.valueOf(),w&&!u.canGetViewModelEarly(w,i)?o=!1:(i=ko.toJS(i||{}),k(i)&&(o=!1))),f=MsPortalFx.find(this._prefetchedResults,(function(n){return h===n.key})),l||(f&&MsPortalFx.remove(this._prefetchedResults,f),b=MsPortalFx.find(this._bladeSequenceNumbers,(function(n){return h===n.key})),b&&MsPortalFx.remove(this._bladeSequenceNumbers,b)),!o)?(f===null||f===void 0?void 0:f.result)||this._definitionCache.getBladeDefinition(n,t).then((function(n){return{definition:n,rpcDurationMs:-1,viewModel:null,viewModelLoadIndex:-1}})):f?f.result:(this._extensionLoader.setRequestedBlade(n,t),d=u.tryEarlyGetViewModelEndPoint.acquireChannel(this._rpcClient,n,{timestamp:Date.now(),bladeName:t,parameters:i,options:{menuId:r.menuId,partialFlags:(r.inContextPane?1:0)|(r.isMenuBladeContent?4:0)|(r.menuContentOverride?8:0),sequenceNumber:a}}).then((function(i){var r=i.value;return r.viewModel?(c._proxiedObjects.set(r.viewModel,{isPartViewModel:!0,managedValue:i}),c._onPartViewModelAcquired(r.viewModel)):i.dispose(),c._diContainer.get(s.DefinitionCache).setBladeDefinition(n,t,Q(r.definition)).then((function(n){return{definition:n,rpcDurationMs:r.rpcDurationMs,viewModel:r.viewModel,viewModelLoadIndex:r.viewModelLoadIndex}}))})),l&&(g({key:h,result:d},this._prefetchedResults),this._prefetchMenuBladeContent(r.menuContentOverride)),d)},t.prototype._onPartViewModelAcquired=function(n){var i=this,t=n&&n.internal.initialMenuContentBlade;t&&MsPortalFx.tryImmediateResolve(Q(t),(function(n){i._prefetchMenuBladeContent(n)}))},t.prototype._prefetchMenuBladeContent=function(n){if(n){var t=n.extensionName,i=n.bladeName,r=n.parameters;t&&i&&this.tryEarlyGetViewModel(t,i,r||{},{isPrefetch:!0,isMenuBladeContent:!0})}},__decorate([__metadata("fx:diagnostics",[n,"ViewModelManagerImpl"]),i.Class(),__metadata("design:paramtypes",[i.Container,FxImpl.Rpc.Client,f.ExtensionManagerOptions,s.DefinitionCache,h.ExtensionLoader])],t)})();a=(function(){function t(){}return t.create=function(n){return n},__decorate([__metadata("fx:diagnostics",[n,"ViewModelManager"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[p]),__metadata("design:returntype",t)],t,"create",null),t})();t.ViewModelManager=a;var c={},l={},tt=(function(t){function r(n){return t.call(this,null,null,n.get(FxImpl.Rpc.Client))||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"ShellViewModelProvider"]),i.Class(),__metadata("design:paramtypes",[i.Container])],r)})(u.ViewModelProvider);t.registerWithState=it;t.registerWithDi=w;t.resolve=b;MsPortalFx.forEachKey(o.shellParts,(function(n,t){return w(t.viewModelName,n,t.shellModule)}))}));
define("MsPortalImpl/AzFramework/AzExtensionCore",["require","exports","Fx/DependencyInjection","MsPortalImpl/AzFramework/AzBladeViewModel","MsPortalImpl/Base/Base.ImplUtils","FxInternal/Composition/ViewModelComposer","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Extension/Extension.Manifest","FxInternal/Composition/Part"],(function(n,t,i,r,u,f,e,o,s){"use strict";function a(n){return u.validateAbsoluteHttpUri(n)||MsPortalFx.startsWith(n,"//")&&u.validateAbsoluteHttpUri("http:"+n)}function h(n,t,i,r,u,f){var e="bladeParameters",o=i===MsPortalFx.Parts.PartKind._Internal_React,h,s={name:n,initialDisplayState:2,locked:!0,pinnable:!0,azBlade:i===MsPortalFx.Parts.PartKind._Internal_Az?{}:null,reactView:o?{}:null,style:8,lenses:[{name:"AzBladeVirtualLens",partInstances:[{name:n,inline:h={isBlade:!0,bladeOrPartName:n,extensionName:t,partKind:i,viewModel:n,inputs:[e],bindings:[{property:e,optional:!1,isIdentityInput:!1,valuesFrom:[{referenceType:999,property:e}]}],initialSize:9,shareVmWithParentBlade:!0}}]}],effectiveInputs:h.bindings,toolbar:i===MsPortalFx.Parts.PartKind._Internal_Az&&{source:{valuesFrom:[{referenceType:0,part:n,property:"content.commandBar"}]}},hasOnPinMethod:!0,attributes:1,contextPaneWidth:o?1:u?3:null};return r&&(s.width=3),(f||o)&&(s.reflowReady=!0),s}var c,l;Object.defineProperty(t,"__esModule",{value:!0});t.AzViewModelManager=t.AzDefinitionCache=t.createAzBladeDefinition=t.isValidUri=void 0;t.isValidUri=a;t.createAzBladeDefinition=h;c=(function(){function t(n){this._manifestCache=n}return t.prototype.getBladeDefinition=function(n,t,i,r){var u=t.toLowerCase(),f=n.bladeMap[u];return r===MsPortalFx.Parts.PartKind._Internal_Az?f?Q(f):this._manifestCache.getManifestAsync(n.name,"assetTypes").then((function(f){var e=f&&f.azMetadata&&f.azMetadata.blades&&f.azMetadata.blades[t]||{};return n.bladeMap[u]=h(t,i,r,e.useXLargeMinWidth,e.contextPaneXLargeWidth,e.reflowReady)})):Q(f||(n.bladeMap[u]=h(t,i,r)))},__decorate([__metadata("fx:diagnostics",[n,"AzDefinitionCache"]),i.Class(),__metadata("design:paramtypes",[o.ManifestCache])],t)})();t.AzDefinitionCache=c;l=(function(){function t(){}return t.prototype.getPartViewModel=function(n,t,i,u){typeof t=="object"&&(t=t.name);var o=s.composePartViewModel((function(n){return new r.ViewModel(n)}),{createSelectable:u&&u.createSelectable,location:u&&u.partLocation,logArea:"Extension/"+n+"/PartType/"+t,flags:u&&u.flags});if(o.internal.reactViewInitializeEnd=ko.observable(),u&&(f.tryApplyEarlyOnInputsSet(o,e.getViewModelOptions(i,t,u)),u.onViewModelAcquired))u.onViewModelAcquired(o);return Q(o)},__decorate([__metadata("fx:diagnostics",[n,"AzViewModelManager"]),i.Class()],t)})();t.AzViewModelManager=l}));
define("MsPortalImpl/RpcEndPoints",["require","exports","FxInternal/AsyncLoader","FxHubs/HubsSettingsSchema","FxHubs/RpcEndPoints","FxInternal/DirectoryManagement","FxHubs/ProvisioningRpc","FxInternal/Redirect","FxInternal/ResourceManagement/Subscriptions","FxInternal/ResourceManagement/GlobalResourceFilters","FxInternal/RpcEndPointsCore","FxInternal/ReactView/DataCacheEndpoints"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";function y(n){i.registerRpc(n,{"MsPortalImpl/Base/Base.Selectable2.Provisioning":{getProvisioningContextHandler:i.makeRegistration(e.provisioningContextEndpoint)},"MsPortalImpl/Extension/ExtensionRpc.Manifest":{getManifestHandler:i.makeRegistration(a.getManifestEndPoint),getManifestEnvironmentHandler:i.makeRegistration(a.CreateUiDef.getExtensionConfigurationEndPoint,"Microsoft_Azure_CreateUIDef")},"MsPortalImpl/Extension/ExtensionManagerOptions":{registerTestExtensions:i.makeRegistration(a.CreateUiDef.registerTestExtensionsEndPoint,"Microsoft_Azure_CreateUIDef"),unregisterTestExtensions:i.makeRegistration(a.CreateUiDef.unregisterTestExtensionsEndPoint,"Microsoft_Azure_CreateUIDef"),listTestExtensions:i.makeRegistration(a.CreateUiDef.listTestExtensionsEndPoint,"Microsoft_Azure_CreateUIDef"),getCatalogApiCacheContent:i.makeRegistration(a.getCatalogApiCacheContentEndPoint),getExtensionRegistration:i.makeRegistration(a.getExtensionRegistrationEndPoint),postBoot:i.makeRegistration(FxImpl.Extension.postBootEndPoint)},"MsPortalImpl/UI/Hubs/UI.ResourceMapManager":{mapAssetIdToResourceId:i.makeRegistration(a.mapAssetIdToResourceIdEndPoint),mapResourceIdToAssetId:i.makeRegistration(a.mapResourceIdToAssetIdEndPoint),mapResourceIdToDynamicSelectionAndIcon:i.makeRegistration(a.mapResourceIdToDynamicSelectionAndIconEndPoint),getResourceAssetInformation:i.makeRegistration(a.getResourceAssetInformationEndPoint),getResourceAssetInformationForHubs:i.makeRegistration(u.AssetTypes.getResourceAssetInformationEndPoint),getResource:i.makeRegistration(a.getResourceEndPoint)},"MsPortalImpl/UI/UI.JourneyManager":{getLastResourceIdInJourney:i.makeRegistration(a.getLastResourceIdInJourneyEndPoint,null)},"MsPortalImpl/UI/UI.ConfirmationDialog":{invokeAmeConfirmationDialogHandler:i.makeRegistration(a.invokeAmeConfirmationDialogEndPoint,null)},"MsPortalImpl/Services/Services.FavoritesSettings":{getUserDirectorySettingsHandler:i.makeRegistration(f.getUserDirectorySettingsEndPoint,"Microsoft_AAD_IAM"),saveUserDirectorySettingsHandler:i.makeRegistration(f.saveUserDirectorySettingsEndPoint,"Microsoft_AAD_IAM")},"MsPortalImpl/Services/Services.Subscriptions":{getInSessionSelectedSubscriptionsObservableHandler:i.makeProxyRegistration(s.getInSessionSelectedSubscriptionsObservableEndPoint),getSubscriptionInfoHandler:i.makeRegistration(FxImpl.Azure.getSubscriptionInfoEndPoint),getInSessionDisplayedSubscriptionsHandler:i.makeRegistration(u.Subscriptions.getInSessionDisplayedSubscriptionsEndPoint),searchForSubscriptionsHandler:i.makeRegistration(FxImpl.Azure.searchForSubscriptionsEndPoint),setInSessionSelectedSubscriptionsHandler:i.makeRegistration(FxImpl.Azure.setInSessionSelectedSubscriptionsEndPoint,"HubsExtension")},"MsPortalImpl/Services/Services.GlobalResourceFilters":{getGlobalResourceFilterObservableHandler:i.makeProxyRegistration(h.getGlobalResourceFilterObservableEndPoint)},"MsPortalImpl/Services/Services.Tenants":{getHomeTenantsCountHandler:i.makeRegistration(u.Directories.getHomeTenantsCountEndPoint)},"MsPortalImpl/Services/Services.ProjectedDirectories":{getSubscriptionsForSelectedDirectoriesHandler:i.makeRegistration(u.Directories.getSubscriptionsForSelectedDirectoriesEndPoint),getDirectoriesMapHandler:i.makeRegistration(u.Directories.getDirectoriesMapEndPoint)},"MsPortalImpl/Services/Services.AssetManagement":{notifyAssetDeletedHandler:i.makeRegistration(u.Events.notifyAssetDeletedDefinition)},"MsPortalImpl/Services/Services.AzureStorage":{sasEndPointHandler:i.makeRegistration(FxImpl.InternalAzure.getSasUriForQueueEndPoint,"Microsoft_Azure_Scheduler")},"MsPortalImpl/Services/Services.EditScopeManagement":{loadSerializedEditScope:i.makeRegistration(v.loadSerializedEditScopeEndPoint),saveSerializedEditScope:i.makeRegistration(v.saveSerializedEditScopeEndPoint),updateEditScopeIsSavingState:i.makeRegistration(v.updateEditScopeIsSavingStateEndPoint)},"MsPortalImpl/Services/Services.ExtensionTokensManager":{getAuthorizationTokenEndPoint:i.makeRegistration(a.getAuthorizationTokenEndPoint)},"MsPortalImpl/Services/Services.GalleryEndpoints":{getLocalGalleryPackages:i.makeRegistration(a.getLocalGalleryPackagesEndpointsDefinition)},"MsPortalImpl/Services/Services.Permissions":{hasPermissionsToShell:i.makeRegistration(a.hasPermissionsToShell)},"MsPortalImpl/Services/Services.SharedSettings":{getSharedSettings:i.makeRegistration(a.getSharedSettingsEndPoint)},"MsPortalImpl/Extension/Extension.Definition.Locator":{getBladeDefinitionLocator:i.makeRegistration(u.Provisioning.getBladeDefinitionLocatorEndPoint,"HubsExtension")},"MsPortalImpl/Extension/DefinitionCache":{doesBladeDefinitionExist:i.makeRegistration(u.Provisioning.doesBladeDefinitionExistEndPoint,"HubsExtension")},"MsPortalImpl/UI/UI.DesktopManagerImpl":{getDashboardDeepLinkHandler:i.makeRegistration(u.DashboardEndpoints.getDashboardDeepLink,"HubsExtension"),getDashboardFiltersHandler:i.makeRegistration(u.PartFilterEndpoints.getFilters,"HubsExtension"),getFilterValuesHandler:i.makeRegistration(u.PartFilterEndpoints.getFilterValues,"HubsExtension"),getFilterValueDisplayTextHandler:i.makeRegistration(u.PartFilterEndpoints.getFilterValueDisplayText,"HubsExtension"),getFilterWarningHandler:i.makeRegistration(u.PartFilterEndpoints.getFilterWarning,"HubsExtension")},"MsPortalImpl/Services/Services.BrowseQueryManifest":{getBrowseManifestsHandler:i.makeRegistration(u.ArtBrowse.getBrowseManifestsEndpoint,"fxw")},"MsPortalImpl/Services/Services.AssetMenuManifest":{getAssetMenuPrereqsHandler:i.makeRegistration(u.AssetMenu.getAssetMenuPrereqsEndpoint,"HubsExtension"),getResourceMenuPrereqsHandler:i.makeRegistration(u.AssetMenu.getResourceMenuPrereqsEndpoint,"HubsExtension")},"MsPortalImpl/Notifications/PortalNotifications":{irisTelemetryHandler:i.makeRegistration(u.Impl.irisTelemetryEndpoint,"HubsExtension"),updateContactEmailHandler:i.makeRegistration(u.UpdateContact.updateContactEmail,"HubsExtension"),getCMProfileHandler:i.makeRegistration(u.UpdateContact.getCMProfile,"HubsExtension")},"MsPortalImpl/Services/Services.DeploymentManager":{pollDeploymentHandler:i.makeRegistration(u.ResourceManager.pollDeploymentEndPoint,null),getMarketplaceUserSettingsHandler:i.makeRegistration(u.Marketplace.getMarketplaceUserSettingsEndPoint,["Microsoft_Azure_Marketplace","HubsExtension"]),internalDeploymentHelperHandler:i.makeRegistration(u.ResourceManager.internalDeploymentHelper,["VMCP","Citrix_XenApp_Essentials","Citrix_XenDesktop_Essentials","CloudSimpleExtension","SendGrid_EmailService","SamplesExtension","InternalSamplesExtension",]),notifyDeploymentHandler:i.makeRegistration(u.ResourceManager.notifyDeploymentEndPoint,null),writeLastUsedUserSettingsHandler:i.makeRegistration(r.writeHubsLastUsedUserSettings,"HubsExtension")},"MsPortalImpl/Notifications/NotifyResourcesCreated":{notifyResourcesCreatedHandler:i.makeRegistration(u.NotifyResourceCreated.notifyResourcesCreatedEndpoint,["Microsoft_Azure_Billing","Microsoft_Health_Admin"])},"MsPortalImpl/Services/Services.GeneralSettings":{writeBrowsePreviewOptInFlagHandler:i.makeRegistration(r.writeBrowsePreviewOptInFlagEndpoint,"HubsExtension")},"MsPortalImpl/Services/Services.Settings":{deleteUserSettingsHandler:i.makeRegistration(r.deleteHubsUserSettings,"HubsExtension"),readUserSettingsHandler:i.makeRegistration(r.readHubsUserSettings,"HubsExtension"),writeUserSettingsHandler:i.makeRegistration(r.writeHubsUserSettings,"HubsExtension"),readBrowserStorageSettingsHandler:i.makeRegistration(u.BrowserStorageSettings.readBrowserStorageSettingsEndpoint,"HubsExtension"),writeBrowserStorageSettingsHandler:i.makeRegistration(u.BrowserStorageSettings.writeBrowserStorageSettingsEndpoint,"HubsExtension"),readExtUserSettingsHandler:i.makeRegistration(FxImpl.Azure.ResourceManager.readUserSettingsEndPoint)},"MsPortalImpl/Services/Services.ArmEvents":{createResourceDeletedEventHandler:i.makeRegistration(u.Events.createResourceDeletedEventDefinition),matchEventsHandler:i.makeRegistration(u.Events.matchEventsDefinition),removeArmEventSubscriptionHandler:i.makeRegistration(u.Events.removeArmEventSubscriptionDefinition),subscribeToArmEventHandler:i.makeProxyRegistration(u.Events.subscribeToArmEventDefinition,"HubsExtension",!1)},"MsPortalImpl/Services/Services.ArmLocations":{getLocationsForCreateHandler:i.makeRegistration(FxImpl.Azure.getLocationsForCreateEndPoint,null),getLocationsHandler:i.makeRegistration(FxImpl.Azure.getLocationsEndPoint,["HubsExtension","InternalSamplesExtension"])},"MsPortalImpl/Services/PastDueSubsCheck":{raiseWarningForPastDueSubsHandler:i.makeRegistration(u.Subscriptions.pastDueSubsWarningEndpoint,"HubsExtension")},"MsPortalImpl/UI/Hubs/UI.NotificationManager":{addClientNotificationDefinition:i.makeRegistration(FxImpl.Hubs.Notifications.addClientNotificationDefinition,null),addClientNotificationsDefinition:i.makeRegistration(FxImpl.Hubs.Notifications.addClientNotificationsDefinition,null),showModalNotificationHandler:i.makeRegistration(FxImpl.Hubs.Notifications.showModalNotification,"HubsExtension"),updateNotificationHandler:i.makeRegistration(FxImpl.NotificationManager.updateNotificationEndPoint,null),addNotification2Handler:i.makeRegistration(FxImpl.NotificationManager.addNotification2EndPoint,null),addNotificationHandler:i.makeRegistration(FxImpl.NotificationManager.addNotificationsEndPoint,null)},"MsPortalImpl/UI/UI.NavigationManager":{forceSignInHandler:i.makeRegistration(o.forceSignInEndPoint,t.extensionsAllowedToForceSignIn)},"MsPortalImpl/Services/Services.PersistentStorage":{writeSettingHandler:i.makeRegistration(c.writeSettingEndPoint),readSettingsHandler:i.makeRegistration(c.readSettingsEndPoint),removeSettingsHandler:i.makeRegistration(c.removeSettingsEndPoint),clearHandler:i.makeRegistration(c.clearEndPoint),getAllKeysHandler:i.makeRegistration(c.getAllKeysEndPoint)},"MsPortalImpl/Services/Services.ReactViewDataCache":{dataCacheAddHandler:i.makeRegistration(l.dataCacheAddEndPoint),dataCacheGetHandler:i.makeRegistration(l.dataCacheGetEndPoint),dataCacheClearHandler:i.makeRegistration(l.dataCacheClearEndPoint),dataCacheClearAllHandler:i.makeRegistration(l.dataCacheClearAllEndPoint)}})}Object.defineProperty(t,"__esModule",{value:!0});t.registerRpc=t.extensionsAllowedToForceSignIn=void 0;var v=FxImpl.Data,a=FxImpl.Extension;t.extensionsAllowedToForceSignIn=["Microsoft_AAD_IAM","Microsoft_Azure_PIM","Microsoft_Azure_PIMCommon","Microsoft_Intune_DeviceSettings","Microsoft_Intune_MTM",];t.registerRpc=y}));
define("MsPortalImpl/Services/Services.ArmEvents",["require","exports","Fx/ResourceManagement","FxHubs/ArmHelpers/ArmIds","FxHubs/RpcEndPoints","FxInternal/AsyncLoader","Fx/DependencyInjection"],(function(n,t,i,r,u,f,e){"use strict";function s(n,t){return!n==!t&&n.toLowerCase()===t.toLowerCase()}var o;Object.defineProperty(t,"__esModule",{value:!0});t.subscribeToArmEventHandler=t.removeArmEventSubscriptionHandler=t.matchEventsHandler=t.createResourceDeletedEventHandler=t.ArmEvents=void 0;o=(function(){function t(){this.instanceHandlers=[]}return t.prototype.subscribeToArmEvent=function(n,t,i){if(!n.operationNameRegex&&!n.source&&!n.status&&!n.subStatus)throw new Error("At least one criteria must be specified.");var r=MsPortalFx.getUniqueId();return this.instanceHandlers.push({cookie:r,criteria:n,callback:t,eventLimit:i}),r},t.prototype.removeArmEventSubscription=function(n){this.instanceHandlers=this.instanceHandlers.filter((function(t){return t.cookie!==n}))},t.prototype.matchEvent=function(n,t){var i=t.operationNameRegex,r;if(i&&(r=new RegExp(i,"ig"),!r.test(n.operationName)))return!1;var u=t.source,f=t.status,e=t.subStatus,o=u&&!s(n.source,u)||f&&!s(n.status,f)||!MsPortalFx.isNullOrUndefined(e)&&!s(n.subStatus,e);return!o},t.prototype.matchEvents=function(n){var t=this,i=this.instanceHandlers.slice();i.forEach((function(i){var r=[];n.forEach((function(n){t.matchEvent(n,i.criteria)&&r.push(n)}));i.callback(r.slice(0,i.eventLimit||r.length))}))},t.prototype.createResourceDeletedEvent=function(n){var e=this,t="microsoft.resources",o=t+"/subscriptions/resourcegroups",u="/delete",f=function(n,i){e.matchEvents([{operationName:i,status:"succeeded",source:t,correlationId:null,timestamp:new Date,assetId:n,isLocalEvent:!0}])};n.forEach((function(n){var t=i.ArmId.parse(n.assetId,!0);t.kind===4?f(n.assetId,o+u):r.ResourceArmIdKindMap[t.kind]&&f(n.assetId,u)}))},__decorate([__metadata("fx:diagnostics",[n,"ArmEvents"]),e.Class()],t)})();t.ArmEvents=o;var h=u.Events.createResourceDeletedEventDefinition,c=u.Events.matchEventsDefinition,l=u.Events.removeArmEventSubscriptionDefinition,a=u.Events.subscribeToArmEventDefinition;t.createResourceDeletedEventHandler=f.defineHandler(h,(function(n){return n.diContainer.get(o).createResourceDeletedEvent(MsPortalFx.makeArray(n.messageArg))}));t.matchEventsHandler=f.defineHandler(c,(function(n){return n.diContainer.get(o).matchEvents(n.messageArg.events)}));t.removeArmEventSubscriptionHandler=f.defineHandler(l,(function(n){return n.diContainer.get(o).removeArmEventSubscription(n.messageArg.cookie)}));t.subscribeToArmEventHandler=f.defineHandler(a,(function(n){var t=n.messageArg,i=ko.observableArray(),r=n.diContainer.get(o).subscribeToArmEvent(t.eventCriteria,i,t.eventLimit);return{cookie:r,events:i}}))}));
define("MsPortalImpl/Base/Base.ArmIdHelpers",["require","exports","Fx/ResourceManagement","FxHubs/ArmHelpers/ArmIds"],(function(n,t,i,r){"use strict";function u(n){return r.ResourceArmIdKindMap[n.kind]}function f(n){return i.ArmId.parse(n,!0).kind!==0?MsPortalFx.sanitizeMessage(n):"_REDACTED_"}Object.defineProperty(t,"__esModule",{value:!0});t.sanitizeId=t.isResourceAtAnyLevel=void 0;t.isResourceAtAnyLevel=u;t.sanitizeId=f}));
define("MsPortalImpl/Base/Base.DeepLink",["require","exports","Fx/ResourceManagement","MsPortalImpl/Base/Base.ArmIdHelpers","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/UI/UI.AuthStateManager"],(function(n,t,i,r,u,f){"use strict";function a(n,t){return function(){var r,u;try{t.apply(n,arguments)}catch(i){r=!0;i instanceof DOMException&&(u=i,(u.code===DOMException.SECURITY_ERR||u.name==="SecurityError")&&(r=!1));r&&b.error(i,0)}}}function o(){return new u.Uri(location.href)}function k(n,t,i,r){i===void 0&&(i={});r===void 0&&(r={});var c=r.allowObjectsInLinks||!1,o=r.setDeepLinkContext||$.noop,f=new u.Uri(r.baseUri||""),s=!0,h="";return(r.selectedMenuItemId&&(h="/"+r.selectedMenuItemId),MsPortalFx.forEachKey(i,(function(n,t){if(n!=="editScopeId"){var i=ko.unwrap(t);if(i&&typeof i=="object")if(c)i=JSON.stringify(i);else{s=!1;return}i!==undefined&&(i===0&&(i="0"),h+="/{0}/{1}".format(encodeURIComponent(n),encodeURIComponent(i||"")))}})),!s)?(o(f.toString(),s,"UnableToSerializeInputs"),""):(f.setHash("#blade/{0}/{1}{2}".format(n,t,h)).setHashQueryString(e()),f.href.length>32e3)?(o(f.toString(),!1,"InputsExceedURILength"),""):(o(f.toString(),!0),f.toString())}function d(n){var r=new u.Uri(n),f=r.getHashParts(),i,t;switch(f.category){case"blade":return i=r.hash.split("/"),v(i)?i[3]:"";case"resource":return t=f.rest.split("/"),y(t)?t[t.length-1]:""}return""}function g(n,t){var i=new u.Uri(n),f=i.getHashParts(),r=i.hash.split("/"),e;switch(f.category){case"blade":if(v(r))return r[3]=t,i.setHash(r.join("/")),i.toString();break;case"resource":if(e=f.rest.split("/"),y(e))return r[r.length-1]=t,i.setHash(r.join("/")),i.toString()}return n||""}function v(n){return n.length>=4&&n.length%2==0&&n[0]==="#blade"&&!MsPortalFx.isNullOrWhiteSpace(n[3])}function y(n){return n.length%2==1&&!MsPortalFx.isNullOrWhiteSpace(n[n.length-1])}function nt(n,t,r){r===void 0&&(r={});var f=t.assetId,o=f&&typeof f=="string"&&i.ArmId.parse(f,!0);return o&&o.kind!==0&&(f=f.substring(1)),new u.Uri(r.baseUri||"").setHash("#{0}{1}/{2}/{3}/{4}".format(h(n),"asset",t.extensionName,t.assetType,f)).setHashQueryString(e()).toString()}function tt(n,t){t===void 0&&(t={});var i="#{0}/{1}",r=t.model;return r&&(ko.unwrap(r.additionalConfig)||{}).preview&&(i+="/preview"),new u.Uri(t.baseUri||"").setHash(i.format("create",n)).setHashQueryString(e()).toString()}function p(n,t){return(h(n)+"dashboard/"+t).toLowerCase()+e()}function it(){return"#home"+e()}function rt(){return"#dashboard"+e()}function ut(n){return"#allservices"+(n?"/"+n:"")+e()}function ft(n,t){var u,s;t=MsPortalFx.trimStart(t,"/");u=t;t.startsWith("dashboard/arm")||t.startsWith("dashboard/private")||(s=i.ArmId.parse(MsPortalFx.ensurePrefix(t,"/"),!0),u=r.isResourceAtAnyLevel(s)?MsPortalFx.ensurePrefix(t,"dashboard/arm/"):MsPortalFx.ensurePrefix(t,"dashboard/private/"));var f=window.location,c=o(),a=h(n),l=f.port;return[f.protocol,"//",c.host,l?":"+l:"",f.pathname,c.queryString,"#",a,u,e(),].join("")}function e(){return o().hashQueryString}function h(n){var t=n.get(f.AuthStateManager).getSignedInUserTenant();return t?"@"+t+"/":""}function et(n,t){return t&&t.startsWith("#resource/")?"#"+h(n)+t.substring(1):t}function c(n){return!MsPortalFx.localeCompareIgnoreCase(n.getHashParts().category,t.dashboardRouteName)}function ot(){var n=o();return c(n)?n.getHashParts().rest.split("/")[0]:""}function st(n){return n===void 0&&(n=o()),c(n)?n.getHashParts().rest:""}function ht(n,i,r,u){var f=p(n,i),e;u=u||o();u.hash.toLowerCase()!=="#"+f&&(u.setHash(f),e=r?t.history_replaceState:t.history_pushState,e(null,null,u.href))}Object.defineProperty(t,"__esModule",{value:!0});t.updateDashboardUri=t.getDashboardIdFromUri=t.getDashboardTypeFromUri=t.isDashboardRoute=t.prependTenantToResourceDeepLink=t.rpcGetDashboardDeepLink=t.getAllServicesDeeplink=t.getDefaultDashboardDeeplink=t.getHomeDeeplink=t.getDashboardDeepLink=t.getGalleryDeepLink=t.getAssetDeepLink=t.replaceMenuIdFromDeepLink=t.getMenuIdFromDeepLink=t.getBladeDeepLink=t.getCurrentUri=t.originalHref=t.history_replaceState=t.history_pushState=t.dashboardRouteName=void 0;var l=window,s=l.history,w=MsPortalFx.Base,b=w.Diagnostics.createLog(n);t.dashboardRouteName="dashboard";t.history_pushState=a(s,s.pushState);t.history_replaceState=a(s,s.replaceState);t.originalHref=l.location.href;t.getCurrentUri=o;t.getBladeDeepLink=k;t.getMenuIdFromDeepLink=d;t.replaceMenuIdFromDeepLink=g;t.getAssetDeepLink=nt;t.getGalleryDeepLink=tt;t.getDashboardDeepLink=p;t.getHomeDeeplink=it;t.getDefaultDashboardDeeplink=rt;t.getAllServicesDeeplink=ut;t.rpcGetDashboardDeepLink=ft;t.prependTenantToResourceDeepLink=et;t.isDashboardRoute=c;t.getDashboardTypeFromUri=ot;t.getDashboardIdFromUri=st;t.updateDashboardUri=ht}));
define("MsPortalImpl/Base/Base.ItemCache",["require","exports"],(function(n,t){"use strict";function u(n){return function(t){return n(t.item)}}function o(n){var t=r();return t-n}function v(n){return{age:r(),item:n}}function f(n,t){var i;return n&&(t&&(n.age=r()),i=n.item),i}function y(n,t){var r=(c++).toString();return i.set(r,t),n.registerForDispose((function(){i.delete(r)})),r}function p(n){return i.get(n)}var s,h,i,c;Object.defineProperty(t,"__esModule",{value:!0});t.rotFind=t.rotAdd=t.ItemArrayCache=t.BaseItemCache=void 0;var e=MsPortalFx.remove,l=MsPortalFx.find,a=MsPortalFx.findIndex,r=Date.now;s=(function(){function n(n,t){var i=this;n===void 0&&(n=12e4);this._map=t;this._maxAge=n;setTimeout((function(){return i._reduceCache()}),1e3)}return n.prototype.dispose=function(){this.flush()},n.prototype.hasEntry=function(n){return n in this._map},n.prototype.getEntry=function(n){return f(this._map[n],!0)},n.prototype.peekEntry=function(n){return f(this._map[n])},n.prototype.removeEntry=function(n){n in this._map&&this._delete(n)},n.prototype._removeEach=function(n){for(var t in this._map)n.call(this,t)&&this._delete(t)},n.prototype.removeEach=function(n){this._removeEach(n)},n.prototype.flush=function(){this._removeEach()},n.prototype._delete=function(n){delete this._map[n]},n.prototype._isExpired=function(n){return o(this._map[n].age)>this._maxAge},n.prototype._reduceCache=function(){this._removeEach(this._isExpired)},n})();t.BaseItemCache=s;h=(function(){function n(n){var t=this;n===void 0&&(n=12e4);this._cache=[];this._maxAge=n;setTimeout((function(){return t._reduceCache()}),1e3)}return n.prototype.dispose=function(){this.clear()},n.prototype.first=function(n,t){var i=l(this._cache,u(n));return f(i,!t)},n.prototype.peekFirst=function(n){return this.first(n,!0)},n.prototype.pushEntry=function(n){this._cache.push(v(n))},n.prototype.removeEntry=function(n){this.removeFirst((function(t){return MsPortalFx.deepEquals(t,n)}))},n.prototype.removeFirst=function(n){var t=a(this._cache,u(n));t>=0&&this._cache.splice(t,1)},n.prototype.removeEach=function(n){e(this._cache,u(n))},n.prototype.clear=function(){this._cache=[]},n.prototype._isEntryExpired=function(n){return o(n.age)>this._maxAge},n.prototype._reduceCache=function(){var n=this;e(this._cache,(function(t){return n._isEntryExpired(t)}))},n})();t.ItemArrayCache=h;i=new Map;c=1;t.rotAdd=y;t.rotFind=p}));
define("MsPortalImpl/Extension/Extension.Definition.Locator",["require","exports","Fx/DependencyInjection","Fx/ResourceManagement","FxInternal/AsyncLoader","FxInternal/Utils/Promise","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Extension/DefinitionCache","FxHubs/RpcEndPoints"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";function a(n,t){for(var u=[],i=n,r;i;)u.unshift(i.getCacheKeyPart()),i=i.parent;return r=u.join("-"),t?r:r.toLowerCase()}function et(n,t){for(var r=[],i=n;i;)r.unshift(i.getCacheFriendlyKeyPart(t)),i=i.parent;return r.join(t)}function nt(n,t,i){return n.definitionCache.getDefinition(t.name).partTypeMap[i.toLowerCase()]}function p(n,t){var i="<InvalidJsonString>";try{i=JSON.stringify(t)}catch(r){}return ft.error("{0} JSON: {1}".format(n,i)),v.forExtension("##ErrorDeserializingLocator##-{0}".format(i))}var w,y,b,v,k,d,tt;Object.defineProperty(t,"__esModule",{value:!0});t.getBladeDefinitionLocator=t.resourceMenu=t.hubsLocator=t.DefinitionFinder=t.DefinitionFinderImpl=t.Locator=t.LocatorContext=t.LocatorError=t.LocatorTypeMap=void 0;var it=MsPortalFx.Base.Constants,rt=MsPortalFx.Base.Diagnostics,ut=MsPortalFx.Extension,ot=ut.BrowseType,ft=rt.createLog(n),g="Unable to locate {0} '{1}'. Search path:'{2}'.";(function(n){n[n.Extension=0]="Extension";n[n.Blade=1]="Blade";n[n.Lens=2]="Lens";n[n.AssetType=3]="AssetType";n[n.CommandGroup=4]="CommandGroup";n[n.PartInstance=5]="PartInstance";n[n.PartType=6]="PartType";n[n.StartboardPartInstance=7]="StartboardPartInstance";n[n.BladeActionBar=8]="BladeActionBar";n[n.Command=9]="Command";n[n.Hub=11]="Hub";n[n.CustomLen_Unused=12]="CustomLen_Unused";n[n.CommandType=13]="CommandType";n[n.BladeRedirect=14]="BladeRedirect";n[n.PartInstanceRedirect=15]="PartInstanceRedirect";n[n.PartTypeRedirect=16]="PartTypeRedirect";n[n.AssetTypeForBrowse=17]="AssetTypeForBrowse";n[n.HtmlTemplate=18]="HtmlTemplate"})(w=t.LocatorTypeMap||(t.LocatorTypeMap={}));y=(function(n){function t(t,i,r,u){var f=n.call(this,{message:r,innerErrors:u})||this;return f.source=i,f.data=t,f}return __extends(t,n),t})(MsPortalFx.Errors.Error);t.LocatorError=y;b=(function(){function t(n,t,i,r){this.extensionManager=n;this.manifestCache=t;this.definitionCache=i;this.redirectMap=r}return t.prototype.tryLocateAssetDefinitionFromResourceId=function(n,t){var i=r.ArmId.parse(n,!0).resourceType,u=r.ArmId.parse(n).resourceType;return this.tryLocateAssetDefinitionFromResourceType(i,t)?!0:this.tryLocateAssetDefinitionFromResourceType(u,t)},t.prototype.tryLocateAssetDefinitionFromResourceType=function(n,t){var r=this,u=n.toLowerCase(),i=this.extensionManager.getExtensions().some((function(n){var f=r.manifestCache.getManifest(n.name,"assetTypes"),i=f&&MsPortalFx.find(f.assetTypes,(function(n){return n.resourceType&&n.resourceType.resourceTypeName&&n.resourceType.resourceTypeName.toLowerCase()===u&&n.browseType!==3}));return i&&(t.extensionName=n.name,t.value=i),!!i}));return i||(t.error="Unable to locate extension for resource type '{0}'.".format(n),t.value=null),i},__decorate([__metadata("fx:diagnostics",[n,"LocatorContext"]),i.Class(),__metadata("design:paramtypes",[h.ExtensionManager,s.ManifestCache,c.DefinitionCache,s.RedirectMap])],t)})();t.LocatorContext=b;v=(function(){function n(n,t,i,r,u,f,e){this.type=n;this.name=t;this.parent=u;this.enumerate=i;this.getValue=f;this.getValueAsync=e;this.typeDisplayName=r}return n.forExtension=function(t){return new n(0,t,undefined,"extension",undefined,function(n){return n.extensionManager.getExtension(t)},null)},n.fromJSON=function(t,i){var e;if(!i||typeof i!="object")return p("Locator object is invalid.",i);var r=i.parent?n.fromJSON(t,i.parent):null,u=w[i.type],f="with{0}".format(u);if(!r&&i.type!==0)return p("Locator with name '{0}' has no parent.".format(i.name),i);switch(i.type){case 0:return e=t.resolveExtensionName(i.name),n.forExtension(e)}return f in r?r[f](i.name):p("Unknown locator type: {0}.".format(u),i)},n.prototype.getCacheKeyPart=function(){return"["+this.type+"]"+this.name},n.prototype.getCacheFriendlyKeyPart=function(n){return n===void 0&&(n="/"),""+w[this.type]+n+this.name},n.prototype.withBlade=function(t){return new n(1,t,undefined,"blade",this,function(n,t,i){return n.definitionCache.getDefinition(t.name).bladeMap[i.toLowerCase()]},function(n,i){return f.toPromise(n.definitionCache.getBladeDefinition(i.name,t))})},n.prototype.withPartInstance=function(t){return new n(5,t,function(n,t){return t.partInstances},"part instance",this)},n.prototype.tryLocate=function(n,t,i){var u=a(this),r={},o=!1,f,s,e;return t.hasOwnProperty(u)||(this.parent&&this.parent.tryLocate(n,t,r),(!this.parent||r.value)&&(this.getValue?(f=this.getValue(n,r.value,this.name),f!==undefined&&(t[u]=f)):(s=this.enumerate(n,r.value),this._fillCacheFromArray(t,s)))),e=t[u],e?(i.value=e,o=!0):(i.error=g.format(this.typeDisplayName,this.name,this.toString()),r.error&&(i.error=r.error+"\n"+i.error)),o},n.prototype.locateAsync=function(n,t){var i=this,r={},u,f;return this.tryLocate(n,t,r)?Promise.resolve(r.value):(u=void 0,f=this.parent,u=f?f.locateAsync(n,t):Promise.resolve(),u.then((function(u){if(i.tryLocate(n,t,r))return r.value;if(i.getValueAsync)return i.getValueAsync(n,u);throw new y(i.type,i.toFriendlyString(),r.error);}),(function(n){var t=g.format(i.typeDisplayName,i.name,i.toString());throw new y(i.type,i.toFriendlyString(),t,n);})).then((function(n){return t[a(i)]=n})))},n.prototype._fillCacheFromArray=function(n,t){var i=ko.toJS(this);t&&t.forEach((function(t){i.readFromIdentifiable(t);var r=a(i);n[r]=t}))},n.forPartInstanceRedirect=function(t,i,r,u){return new n(15,s.partRedirectKey(5,t,i,r,u),undefined,"part instance redirect",undefined,function(n){var f=n.redirectMap.getPartRedirect(5,t,i,r,u);return f.definition&&MsPortalFx.extend({name:f.key},f.definition)})},n.forPartTypeRedirect=function(t,i){return new n(16,s.partRedirectKey(4,t,i),undefined,"part type redirect",undefined,function(n){var r=n.redirectMap.getPartRedirect(4,t,i);return r.definition&&MsPortalFx.extend({name:r.key},r.definition)})},n.forBladeRedirect=function(t,i){return new n(14,s.bladeRedirectKey(t,i),undefined,"blade redirect",undefined,function(n){var r=n.redirectMap.getBladeRedirect(t,i);return r.definition&&MsPortalFx.extend({name:r.key},r.definition)})},n.prototype.withBladeActionBar=function(t){return new n(8,t,function(n,t){return t.actionBar?[t.actionBar]:[]},"blade actionbar",this)},n.prototype.withStartboardPartInstance=function(t){return new n(7,t,function(n,t){return n.definitionCache.getDefinition(t.name).startBoardParts},"startboard part instance",this)},n.prototype.withPartType=function(t){return new n(6,t,undefined,"part type",this,nt,function(n,i){if(MsPortalFx.startsWith(t,o.PinPrefix)){var r=t.substr(o.PinPrefix.length);return f.toPromise(n.definitionCache.getBladeDefinition(i.name,r)).then((function(){return nt(n,i,t)}))}return f.toPromise(n.definitionCache.getPartDefinition(i.name,t))})},n.prototype.withLens=function(t){return new n(2,t,function(n,t){return t.lenses},"lens",this)},n.prototype.withAssetType=function(t){return new n(3,t,function(n,t){return n.manifestCache.getManifest(t.name,"assetTypes").assetTypes},"asset type",this)},n.prototype.withAssetBrowseType=function(t){return new n(17,t,function(n,t){var i=n.manifestCache.getManifest(t.name,"assetTypesBrowse");return i&&i.assetTypesBrowse},"asset browse type",this,undefined,function(n,i){return f.toPromise(n.manifestCache.getManifestAsync(i.name,"assetTypesBrowse")).then((function(n){return MsPortalFx.find(n.assetTypesBrowse,(function(n){return t===n.name}))||Q.reject(new MsPortalFx.Errors.NotFoundDataError("assetTypesBrowse"))}))})},n.prototype.withCommand=function(t){return new n(9,t,null,"command",this)},n.prototype.withHtmlTemplate=function(t){return new n(18,t,null,"html template",this,function(n,t,i){return n.definitionCache.getDefinition(t.name).htmlTemplates[i]})},n.prototype.getExtensionLocator=function(){for(var n=this;n.parent;)n=n.parent;return n},n.prototype.getExtensionName=function(){return this.getExtensionLocator().name},n.prototype.toString=function(){return a(this,!0)},n.prototype.toFriendlyString=function(n){return n===void 0&&(n="/"),et(this,n)},n.prototype.equals=function(n){if(this.name&&n&&n.name&&this.name===n.name&&this.type===n.type){if(this.parent)return this.parent.equals(n.parent);if(!n.parent)return!0}return!1},n.prototype.toJSON=function(){return{name:this.name,type:this.type,parent:this.parent&&this.parent.toJSON()}},n.prototype.readFromIdentifiable=function(n){this.name=n.name},n})();t.Locator=v;k=(function(){function t(n,t){this._locatorContext=n;this._cache=t||{}}return t.populateCache=function(n,t,i){return n[a(t)]=i,n},t.prototype.locateAsync=function(n){return n.locateAsync(this._locatorContext,this._cache)},t.prototype.locate=function(t,i){var r={},u=null,f;return this.tryLocate(t,r)?u=r.value:(f=i||t.getExtensionName(),e.logToExtension(n,f,2,r.error)),u},t.prototype.tryLocate=function(n,t){return n.tryLocate(this._locatorContext,this._cache,t)},t})();t.DefinitionFinderImpl=k;d=(function(){function t(){}return t.create=function(n){return new k(n)},__decorate([__metadata("fx:diagnostics",[n,"DefinitionFinder"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[b]),__metadata("design:returntype",t)],t,"create",null),t})();t.DefinitionFinder=d;tt=it.BladeNames.Hubs.ResourceMenuBlade;t.hubsLocator=v.forExtension("HubsExtension");t.resourceMenu=t.hubsLocator.withBlade(tt);t.getBladeDefinitionLocator=u.defineHandler(l.Provisioning.getBladeDefinitionLocatorEndPoint,(function(n){var t=n.messageArg;return Q(n.diContainer.get(d).locateAsync(v.forExtension(t.extensionName).withBlade(t.bladeName)))}))}));
define("MsPortalImpl/Services/Services.Settings",["require","exports","Fx","Fx/DependencyInjection","FxHubs/HubsSettingsSchema","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/UI/UI.NavigationManager","FxHubs/RpcEndPoints","FxInternal/AsyncLoader"],(function(n,t,i,r,u,f,e,o,s){"use strict";function ot(n){return function(t){this[t]=n}}function lt(){return MsPortalFx.map(v,MsPortalFx.identity)}function at(n){return p[n+1e3]}function vt(n){return v[n]}function yt(n,t){if(!t||!t.length)return Q(new Map);var i=t.map((function(t){return n.queryStore(t)}),n);return Q.all(i).then((function(n){var i=new Map;return n.forEach((function(n,r){i.set(t[r],n)})),i}))}function rt(n,t,i){var r={};return r[t]=i,{store:n,settings:r}}function b(n){return JSON.parse(JSON.stringify(n))}function ut(n){var t=[n?n.flushSettings():Promise.resolve(),k.Telemetry.flush(),i.toPromise(k.Upload.flush()),];return Promise.all(t)}function d(n,t,i){var r={store:MsPortalFx.isNullOrUndefined(i)?6:i,keys:t};return n.querySettings(r).then((function(n){return t.length?MsPortalFx.convertArrayToMap(t,MsPortalFx.identity,(function(t){return n[t]})):n}))}function ft(n,t,i,r){var u={store:r||6,settings:t};n.setSettings(u,i)}function pt(n,t,i){var r={store:i||6,keys:t};n.deleteSettings(r)}var v,p,it,w,c,l;Object.defineProperty(t,"__esModule",{value:!0});t.readExtUserSettingsHandler=t.readBrowserStorageSettingsHandler=t.writeBrowserStorageSettingsHandler=t.writeUserSettingsHandler=t.readUserSettingsHandler=t.deleteUserSettingsHandler=t.writeUserSettings=t.readUserSettings=t.flush=t.SettingsManager=t.Internal=t.queryStores=t.getDashboardStoreId=t.getDashboardStoreName=t.getAllStoreIds=t.PortalStartupMarkers=void 0;var a=MsPortalFx.Base,g=a.Net2,k=MsPortalFx.Base.Diagnostics,et=MsPortalFx.tryImmediateResolve;var st=fx.environment,y=fx.environment.applicationPath+"/api/Settings{0}"+MsPortalEarly.settingsUriQuery,nt=y.format("/Update"),tt=y.format("/Select"),ht=y.format("/Clear"),ct=y.format("/ClearAll"),h=a.Diagnostics.createLog(n);a.getVersionFromString(st.version).revision=0;v={General:0,Blade:1,Part:2,LensState:3,Startboard:4,SharedPart:5,HubsExtension:6,CrossTenant:7,Favorites:8,DashboardInventory:9,FileUpload:10,FirstVisited:12,StartupNotifications:13,ArgQueryInventory:14,Browse:15,Recents:16,Hats:18,ResourceFilters:19,BrowseFallback:20};p=MsPortalFx.forEachKey(v,(function(n,t,i){i[t]=n}),[]),(function(){for(var t,i,n=0;n<100;n++)t="Dashboard"+n,i=n+1e3,v[t]=i,p[i]=t})();it=(function(){function t(){}return __decorate([__metadata("fx:diagnostics",[n,"PortalStartupMarkers"]),r.Class()],t)})();t.PortalStartupMarkers=it;t.getAllStoreIds=lt;t.getDashboardStoreName=at;t.getDashboardStoreId=vt;t.queryStores=yt,(function(n){function b(n,t,i,e){return new c(new f(n,new r(u.createWithWriteDeleteBufferTimeout(t,e),i)))}function t(n){var t=p[n];if(!t)throw new Error("Invalid store: "+n);return t}function e(n,i){var r={};return i&&i.forEach((function(i,u){var f=typeof u=="string"?u:t(u);r[f]=i;n&&delete n[f]})),r}function o(n){var i={},t;return n.keys.forEach(ot(null),i),t=new Map,t.set(n.store,i),t}function k(n,t){var u=MsPortalFx.merge(n,t),r={settingsToSet:new Map,settingsToDelete:new Map};return r=u.reduce((function(n,t){return i(n.settingsToSet,n.settingsToDelete,t.settingsToSet),i(n.settingsToDelete,n.settingsToSet,t.settingsToDelete),n}),r),[r]}function i(n,t,i){i&&i.forEach((function(r,u){var f=typeof u=="string"?u:parseInt(u),o=i.get(f),e;n&&(n.get(f)||n.set(f,{}),s(o,n.get(f)));t&&(e=t.get(f),e&&(l(o,e),MsPortalFx.isEmpty(e)&&t.delete(f)))}))}function s(n,t){MsPortalFx.forEachKey(n,(function(n,i){t[n]=i}))}function l(n,t){MsPortalFx.forEachKey(n,(function(n){delete t[n]}))}var w=FxImpl.features.isEnabled("cae"),v,r,y,u,f;n.createUserSettingsManager=b;n.getSettingStoreName=t;n.convertSettingQueryToDictionary=o;n.updateDictionary=i;n.updateSettingsDictionary=s;n.sanitizeSettingsDictionary=l;v=(function(){function n(){this._maps={}}return n.prototype.setSettings=function(n){MsPortalFx.forEachKey(n.settings,(function(n,t,i){i.set(n,JSON.stringify(t))}),this._getMap(n.store))},n.prototype.queryStore=function(n){var i=this._getMap(n),t={};return i.forEach((function(n,i){t[i]=JSON.parse(n)})),Promise.resolve(t)},n.prototype.deleteSettings=function(n){if(n.keys){var t=this._getMap(n.store);n.keys.forEach((function(n){t.delete(n)}))}},n.prototype.clearSettings=function(){return Promise.resolve(this._maps={})},n.prototype.flushSettings=function(){return Promise.resolve()},n.prototype.dispose=function(){},n.prototype._getMap=function(n){return this._maps[n]=this._maps[n]||new Map},n})();n.InMemorySettingsManagerImpl=v;r=(function(){function n(n,t){var i=this;this._baseManager=n;this._managersDictionary=new Map;this._managers=[this._baseManager];t&&t.forEach((function(n){i._managers.push(n.manager);n.stores.forEach((function(t){i._managersDictionary.set(t,n.manager)}))}))}return n.prototype.queryStore=function(n,t){return this._getManager(n).queryStore(n,t)},n.prototype.deleteSettings=function(n,t){return this._getManager(n.store).deleteSettings(n,t)},n.prototype.setSettings=function(n,t){return this._getManager(n.store).setSettings(n,t)},n.prototype.clearSettings=function(){return Q.all(this._managers.map((function(n){return n.clearSettings()})))},n.prototype.flushSettings=function(){return this._baseManager.flushSettings()},n.prototype.dispose=function(){this._baseManager.dispose()},n.prototype._getManager=function(n){return this._managersDictionary.get(n)||this._baseManager},n})();n.RoutingSettingsManager=r;y=(function(){function n(n,t){var i=this;this._ajaxState=0;this._memoizedQueryStore=MsPortalFx.memoizeQ((function(n){var t=MsPortalFx.startTimer();return Q(i._ajax(tt,[n])).then((function(r){i._setAjaxState(1);var f=(r===null||r===void 0?void 0:r.content)&&r.content[n]||{},u=t();return u>5e3&&h.warning("\n                        Request to store '"+n+"' took more than 5s to complete.\n                        Request time: "+u+"ms.\n                        Response size: "+(r&&r.jqXHR&&r.jqXHR.responseText.length)+"\n                    "),f})).catch((function(n){return i._setAjaxState(2,n,"queryStore(duration:"+t()+")"),{}}))}));this._clearAllUserSettings=n.isEnabled("clearallusersettings");this._useInMemorySettings=n.isEnabled("inmemorysettings");t=Promise.resolve(t);this._preloadingStores=t.then((function(n){return i._setAjaxState(1),n&&n.settings||{}}),(function(n){return MsPortalFx.Helpers.isXMLHttpRequestLike(n)&&g.isRetryable(n)||h.error(new MsPortalFx.Errors.Error({message:"Early Failed to preload stores.",innerErrors:n}),1),{}}));this._preloadingStores.then((function(n){i._preloadStores=MsPortalFx.forEachKey(n,(function(n,t,i){t&&(i[n]=Promise.resolve(t))}),{});i._preloadingStores=null}))}return n.prototype._ajax=function(n,t){return!t&&(n===nt||n===tt)?Promise.reject(FxImpl.createError("Invalid setting ajax call uri: "+n+", data: "+MsPortalFx.getObjectDescriptor(t))):g.ajaxExtended({uri:n,type:"POST",dataType:"json",data:t&&JSON.stringify(t),contentType:"application/json;charset=utf-8",timeout:3e4,performRetry:!0,maxRetryDuration:3e4,setAuthorizationHeader:w?{resourceName:"self"}:!0}).catchError(MsPortalFx.Errors.AjaxError,(function(i){var r,u;return((r=i.jqXHR)===null||r===void 0?void 0:r.status)===400?h.error("Setting _ajax 400 occurred. uri: "+n+", data: "+MsPortalFx.getObjectDescriptor(t,!0)+"."):((u=i.jqXHR)===null||u===void 0?void 0:u.status)>=500&&h.error("Setting _ajax 5xx occurred. uri: "+n+", response: "+i.jqXHR.responseText+"."),Promise.reject(i)}))},n.prototype._setAjaxState=function(n,t,i){if(n>this._ajaxState&&(this._ajaxState=n,n===2)){var r=(t&&t.data&&t.data.status===0?h.warning:h.error).bind(h);r(new MsPortalFx.Errors.Error({message:i+" Setting is transitioned into HasFailRequests state. All further querystore/updatesetting will be in-memory mode.",innerErrors:t}))}},n.prototype.queryStore=function(n,i){var u=this,r=typeof n=="string"?n:t(n);return this._ajaxState>=2?Q({}):(i&&this._memoizedQueryStore.delete(r),this._preloadingStores?this._preloadingStores.then((function(n){return n[r]||u._memoizedQueryStore(r)})):this._preloadStores[r]||this._memoizedQueryStore(r))},n.prototype.clearSettings=function(){var n=this,t;return MsPortalFx.forEachKey(this._preloadStores,(function(t){delete n._preloadStores[t]})),this._memoizedQueryStore.clear(),t=MsPortalFx.startTimer(),this._ajax(this._clearAllUserSettings?ct:ht).catch((function(i){n._setAjaxState(2,i,"clearSetting(duration:"+t()+"):")}))},n.prototype.updateSettings=function(n){var r=this,t,i;return!this._useInMemorySettings&&this._ajaxState===1&&(t={save:e(this._preloadStores,n.settingsToSet),remove:e(this._preloadStores,n.settingsToDelete)},t.save||t.remove)?(i=MsPortalFx.startTimer(),this._ajax(nt,t).catch((function(n){return r._setAjaxState(2,n,"updateSettings(duration:"+i()+"):"),Promise.reject(n)}))):Promise.resolve()},n})();n.UserSettingsManagerImpl=y;u=(function(){function n(n,t,i,r){var u=this;this._primitiveSettingsManager=n;this._sequencer=t(k,(function(n){return u._executeMethod(n[0])}),i,!0,{optionalDataInterval:r})}return n.createWithWriteDeleteBufferTimeout=function(t,i,r){var u=i||5e3,f=r||3e5;return new n(t,function(n,t,i,r,u){return new a.Debouncer(n,t,i,r,u)},u,f)},n.prototype.queryStore=function(n,t){return this._primitiveSettingsManager.queryStore(n,t)},n.prototype.setSettings=function(n,t){var i=this;return MsPortalFx.isEmpty(n.settings)?Promise.resolve():new Promise(function(r,u){var f=new Map;f.set(n.store,n.settings);i._sequencer.execute([{settingsToSet:f,settingsToDelete:null}],t===1,r,u)})},n.prototype.deleteSettings=function(n,t){var i=this;return n.keys&&n.keys.length?new Promise(function(r,u){i._sequencer.execute([{settingsToSet:null,settingsToDelete:o(n)}],t===1,r,u)}):Promise.resolve()},n.prototype.flushSettings=function(){return this._sequencer.flush()},n.prototype.clearSettings=function(){var t=this,n=Q.defer();return this.flushSettings().finally((function(){t._primitiveSettingsManager.clearSettings().finally((function(){n.resolve()}))})),n.promise},n.prototype.dispose=function(){this.flushSettings()},n.prototype._executeMethod=function(n){return this._primitiveSettingsManager.updateSettings(n)},n})();n.SequencingSettingsManager=u;f=(function(){function n(n,t){var i=this;this._cache=new Map;this._activeUpdatePromises=new Map;this._uniqueId=1;this._memoizedQueryPromises=MsPortalFx.memoizeQ((function(n){var t=i._verifySettings()?Q(i._baseManager.queryStore(n)):Q({});return et(t,(function(t){return i._updateCaches(n,t)}))}));this._useInMemorySettings=n.isEnabled("inmemorysettings");this._baseManager=t}return n.prototype.queryStore=function(n,t){var i=this;return t?(this._memoizedQueryPromises.delete(n),this._baseManager.queryStore(n,t).then((function(t){return i._updateCaches(n,t)}))):this._memoizedQueryPromises(n)},n.prototype.setSettings=function(n,t,i){var r=this;return new Promise(function(u,f){r._execute(r._setSettingsInternal,n,t,u,f,i)})},n.prototype.dispose=function(){this._baseManager.dispose()},n.prototype._setSettingsInternal=function(n,t,i,r,u,f){var o=this,s=this._writeSettingsToCache(n,!0),e=function(){var n;if((n=o._baseManager.setSettings(s,t))!==null&&n!==void 0)return n.then(r).catch(u)};f?(e(),this._resolveSetPromise(i)):this._executeIfBaseManagerCallIsAllowed(e,i)},n.prototype._resolveSetPromise=function(n){var t=this._activeUpdatePromises.get(n);t&&(t.resolve(),this._activeUpdatePromises.delete(n))},n.prototype._execute=function(n,t,i,r,u,f){var h=this,s=this._uniqueId++,e,o;this._activeUpdatePromises.set(s,Q.defer());t&&(e=t.store,o=function(){n.call(h,t,i,s,r,u,f)},this._cache.get(e)?o():this.queryStore(e).then(o))},n.prototype.deleteSettings=function(n,t){var i=this;return new Promise(function(r,u){i._execute(i._deleteSettingsInternal,n,t,r,u)})},n.prototype._deleteSettingsInternal=function(n,t,i,r,u){var f=this;this._deleteSettingsFromCache(n);this._executeIfBaseManagerCallIsAllowed((function(){var i;(i=f._baseManager.deleteSettings(n,t))===null||i===void 0?void 0:i.then(r).catch(u)}),i)},n.prototype.clearSettings=function(){var n=this,t=Q.defer();return this.flushSettings().finally((function(){return n._baseManager.clearSettings().finally((function(){n._cache=new Map;n._memoizedQueryPromises.clear();t.resolve()}))})),t.promise},n.prototype.flushSettings=function(){var t=this,n=[];return this._activeUpdatePromises.forEach((function(t){return n.push(t)})),Q.all(n).then((function(){return t._baseManager.flushSettings()}))},n.prototype._updateCaches=function(n,t){return this._writeSettingsToCache({store:n,settings:t}),this._cache.get(n)},n.prototype._verifySettings=function(){return this._useInMemorySettings?!1:!0},n.prototype._executeIfBaseManagerCallIsAllowed=function(n,t){n();this._resolveSetPromise(t)},n.prototype._deleteSettingsFromCache=function(n){var t=this._cache.get(n.store);n.keys&&t&&n.keys.forEach((function(n){delete t[n]}))},n.prototype._writeSettingsToCache=function(n,t){var i=n.store,r,u;return n?(this._cache.has(i)||this._cache.set(i,{}),r=this._cache.get(i),u={},MsPortalFx.forEachKey(n.settings,(function(n,i){t&&(r[n]===i||JSON.stringify(r[n])===JSON.stringify(i))||(r[n]=u[n]=i)})),{store:i,settings:u}):null},n})();n.CachingSettingsManagerImpl=f})(w=t.Internal||(t.Internal={}));c=(function(){function t(n){this._baseManager=n}return t.prototype.deleteSettings=function(n,t){this._baseManager.deleteSettings(n,t)},t.prototype.deleteSettingsWithPromise=function(n,t){return this._baseManager.deleteSettings(n,t)},t.prototype.clearSettings=function(){return this._baseManager.clearSettings()},t.prototype.flushSettings=function(){return this._baseManager.flushSettings()},t.prototype.dispose=function(){this._baseManager.dispose()},t.prototype.queryStore=function(n,t,i){return __awaiter(this,void 0,void 0,(function(){var r;return __generator(this,(function(u){switch(u.label){case 0:return[4,this._baseManager.queryStore(n,t)];case 1:return r=u.sent(),[2,i?r:b(r)]}}))}))},t.prototype.querySettings=function(n,t){return n.keys&&n.keys.length>0?this.queryStore(n.store,t,!0).then((function(t){var i={},r;return t&&(r=n.keys.filter((function(n){return n in t})),r.forEach((function(n){i[n]=t[n]}))),b(i)})):this.queryStore(n.store,t)},t.prototype.querySetting=function(n,t,i){return this.querySettings({store:n,keys:[t]},i).then((function(n){if(n){var i=n[t];return i===undefined?null:i}return null}))},t.prototype.setSettings=function(n,t){this._baseManager.setSettings(b(n),t)},t.prototype.setSetting=function(n,t,i,r){this.setSettings(rt(n,t,i),r)},t.prototype.setSettingWithPromise=function(n,t,i,r){return this._baseManager.setSettings(b(rt(n,t,i)),r)},t.prototype.readSettingsRpc=function(n,t){var r=n,i=MsPortalFx.find(n,(function(n){return!u.allowedUserSettingsKeys.includes(n)}));if(i)throw k.createIgnoreUnhandledRejectionError(t.srcWindowId+" is not allowed to read the user setting "+i+".");return d(this,r).then((function(n){var t={};return Object.getOwnPropertyNames(n).forEach((function(i){t[i]=n[i]})),t}))},t.create=function(n,t){var u={manager:new w.InMemorySettingsManagerImpl,stores:[11,]},r=n.isEnabled("day0settings"),i=w.createUserSettingsManager(n,new w.UserSettingsManagerImpl(n,!r&&MsPortalEarly.preload),[u]);return t.unloadCallbacks.push((function(){return ut(i)})),r?i.clearSettings().then((function(){var n=new a.UriBuilder(t.location.href);return n.query.removeParameters(["day0settings","feature.day0settings"]),t.redirect({uri:n.toString(),skipFlushBuffers:!0,reason:"useDayZeroSettings"}),Q.defer().promise})):i},__decorate([__metadata("fx:diagnostics",[n,"SettingsManager"]),r.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[FxImpl.Features,e.WindowManager,f.SecurityTokensManager]),__metadata("design:returntype",Object)],t,"create",null),t})();t.SettingsManager=c;t.flush=ut;t.readUserSettings=d;t.writeUserSettings=ft;t.deleteUserSettingsHandler=s.defineHandler(u.deleteHubsUserSettings,(function(n){return pt(n.diContainer.get(c),n.messageArg.settingsKeys,n.messageArg.settingStore)}));t.readUserSettingsHandler=s.defineHandler(u.readHubsUserSettings,(function(n){return d(n.diContainer.get(c),n.messageArg.settingsKeys,n.messageArg.settingStore)}));t.writeUserSettingsHandler=s.defineHandler(u.writeHubsUserSettings,(function(n){return ft(n.diContainer.get(c),n.messageArg.settings,n.messageArg.priority,n.messageArg.settingStore)}));l=[];l[1]="hideBrowseInfo";t.writeBrowserStorageSettingsHandler=s.defineHandler(o.BrowserStorageSettings.writeBrowserStorageSettingsEndpoint,(function(n){var t=n.messageArg,i;return t.storageType!==0?Q.reject("Access outside of local storage is denied."):(i=!1,MsPortalFx.forEachKey(t.storageSettings,(function(n){l[n]||(i=!0)})),i)?Q.reject("Certain keys in the list are not allowed to be accessed."):(MsPortalFx.forEachKey(t.storageSettings,(function(n,t){MsPortalFx.getTypeOf(t)==="string"&&MsPortalImpl.localStorage.setItem(l[n],t)})),Q(null))}));t.readBrowserStorageSettingsHandler=s.defineHandler(o.BrowserStorageSettings.readBrowserStorageSettingsEndpoint,(function(n){var r=n.messageArg,t,i;return r.storageType!==0?Q.reject("Access outside of local storage is denied."):(t={},i=!1,r.storageKeys.forEach((function(n){l[n]||(i=!0);t[n]=MsPortalImpl.localStorage.getItem(l[n])})),i?Q.reject("Certain keys in the list are not allowed to be accessed."):Q(t))}));t.readExtUserSettingsHandler=s.defineHandler(FxImpl.Azure.ResourceManager.readUserSettingsEndPoint,(function(n){return n.diContainer.get(c).readSettingsRpc(n.messageArg,n.messageContext)}))}));
define("MsPortalImpl/Services/Services.AssetTypes",["require","exports","Fx/DependencyInjection","Fx/ResourceManagement","FxInternal/Assets/AssetTypes","FxHubs/ResourceManagement","FxHubs/ArmClient","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.ArmIdHelpers","MsPortalImpl/Base/Base.ItemCache","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Extension/Extension.Manifest","FxHubs/ArtHelpers/ArgBrowseHelpers","MsPortalImpl/Services/Services.Settings","FxInternal/Features","ShellWorker/AssetTypeRequirements"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){"use strict";function ui(n){ot.push(n)}function d(n){return(n||"").toLowerCase()}function fi(n,t){return n===t||d(n)===d(t)}function fr(n,t){var i=r.ArmId.parse(n,!0),u=r.ArmId.parse(t,!0);return i.kind!==0&&u.kind!==0&&fi(n,t),MsPortalFx.deepEquals(n,t)}function er(n){return n.kind===1||n.kind===4||s.isResourceAtAnyLevel(n)}function oi(n){return n.replace(ei,(function(n,t,i){return i&&d(i)}))}function or(n,t,i){return oi(n+" "+t+i||(i?" "+i:""))}function sr(n,t,i){var r;return at.isInstanceOfErrorType(n,at.Error)?r=tt(n,i):di.isXMLHttpRequestLike(n)?(r=tt(n.message||t,n.stack,i),MsPortalFx.shallowCopyFromObject(r,n,["readyState","status","statusText","responseText"])):r=tt(new at.Error({message:t,data:i,innerErrors:n})),r}function hr(n){var t=n.text||n.name,i=n.pluralDisplayName||t;return{plural:i,singular:n.singularDisplayName||t,lowerPlural:n.lowerPluralDisplayName||t,lowerSingular:n.lowerSingularDisplayName||t,service:n.serviceDisplayName||i}}function hi(n,t,i){var r;return ot.some((function(u){return r=u.provideAssetTypeKeywords(n,t,i),!!r})),r}function cr(n){var t;return ot.some((function(i){return t=i.provideCategoryName(n),!!t})),t||n}function ci(n){var t=n.resourceType;return t&&d(t.resourceTypeName)}function li(n,t,i,r,u){var f;return(i===void 0&&(i=null),r===void 0&&(r=null),u===void 0&&(u=null),!n)?{icon:rt.Images.Polychromatic.ResourceDefault(),selection:FxImpl.ViewModels.getBladeSelection("HubsExtension",it,{id:t})}:(f=n.assetTypeManifest,r=r||f.bladeExtensionName||n.extension,i=i||f.bladeName,i||(i=f.resourceType?it:bi,r="HubsExtension"),{icon:u||n.icon,selection:FxImpl.ViewModels.getBladeSelection(r,i,{id:t}),isPreview:n.isPreview})}function st(n,t){var r,i=n.assetTypeManifest;return k.assetTypeMeetsRequirements({browseType:i===null||i===void 0?void 0:i.browseType,browseLinkUri:i===null||i===void 0?void 0:i.browseLinkUri,resourceType:(r=i===null||i===void 0?void 0:i.resourceType)===null||r===void 0?void 0:r.resourceTypeName},t)}function lr(n,t){return"Extension <"+n+"> : AssetType <"+t+"> : ID _REDACTED_"}function ai(n,t,i){return tt("Asset type does not specify a resource type. Extension <"+t+"> : AssetType <"+i+"> : "+n)}function pt(n){return tt("Resource ID <"+s.sanitizeId(n)+"> is not a subscription ID, resource group ID or resource ID.")}function vi(n,t,i){return new Error("The "+n+" view model was already disposed. Extension <"+t+"> : ViewModel <"+(typeof i=="string"?i:i.name)+">")}function ar(n,t){var r=function(n,t){return MsPortalFx.unique((n||"").split(",").filter((function(n){return!!n})).concat(t)).join(",")},u=t.name,i=hi(n,u,""),f;i&&i.length&&(t.keywords=r(t.keywords,i));f=t.resourceType||{};(f.kinds||[]).forEach((function(t){var f=d(t.name),i=hi(n,u,f);i&&i.length&&(t.keywords=r(t.keywords,i))}))}function vr(n,t,i,r){var u=r.resourceType&&r.resourceType.kinds||[],f=MsPortalFx.find(u,(function(n){return n.isDefault}));return{lowerCaseAssetType:d(r.name),lowerCaseExtension:d(n),lowerCaseResourceType:ci(r)||"",kindMap:MsPortalFx.extendArrayIntoMap(Object.create(null),u,(function(n){return d(n.name)}),MsPortalFx.identity),defaultKind:f&&d(f.name),assetTypeManifest:r,id:t,extension:n,compositeDisplayName:hr(r),icon:r&&r.icon||ur,isPreview:i.isPreview||!!r.isPreview}}function yr(n,i){u.getAllAssetTypesEndPoint.register(n,null,(function(){return t.assetTypesMemo(i)}));ht.getAssetTypeInformationEndPoint.register(n,null,(function(n){return i.getAssetTypeInformation(n.extensionName,n.assetType)}));ht.getResourceTypeAssetTypeInformationEndPoint.register(n,null,(function(n){return i.getResourceTypeAssetTypeInformation(n)}));ht.mapAssetIdToDynamicSelectionAndIconEndPoint.register(n,null,(function(n){return i.mapAssetIdToDynamicSelectionAndIcon(n.assetId,"mapAssetIdToDynamicSelectionAndIcon")}))}function wt(n,t,i){var r=MsPortalFx.makeArray(t),u;r.length&&(u=n.length+r.length-i,u>0&&n.splice(0,u),n.push.apply(n,r))}function ut(n,t){return MsPortalFx.find(n,t,-1)}function pr(n){var t=n.get(FxImpl.Rpc.Client),i=n.get(kt);yr(t,i)}function yi(n){var t=3;return(n.privateBrowse||f.supportsAnyOption(n.options,3))&&(t-=2),n.isPreview&&(t-=1),t}function pi(){return MsPortalFx.isFeatureEnabled("artbrowse")?"#blade/HubsExtension/BrowseAll":"#blade/HubsExtension/BrowseAllResourcesBlade/resourceType/Microsoft.Resources%2Fresources"}function wr(){return MsPortalFx.isFeatureEnabled("artbrowse")?"#blade/HubsExtension/BrowseResourceGroups":"#blade/HubsExtension/BrowseResourceGroupBlade/resourceType/Microsoft.Resources%2Fsubscriptions%2FresourceGroups"}function br(n,i,r,u,e){var o,h,c,s,l,a;if(i===t.lowerCaseAllResourcesId)return Q(pi());if(i===t.lowerCaseResourceGroupsId)return Q(wr());if(o=u&&u.assetTypeManifest,o&&o.resourceType){if(o.browseDeepLink)return Q(o.browseDeepLink);if(h=f.supportsContract(o.contracts,16384),c=!f.supportsContract(o.contracts,2)&&(o.resourceType.routingType||lt.Default)===lt.Default,(h||c)&&MsPortalFx.isFeatureEnabled("artbrowse")&&o.argBrowseOption!==4){if(s=r,l=function(){i===t.lowerCaseResourceGroupsId?s="#blade/HubsExtension/BrowseResourceGroups":(s="#blade/HubsExtension/BrowseResource/resourceType/"+encodeURIComponent(o.resourceType.resourceTypeName),e&&(s=s+"/kind/"+encodeURIComponent(e)))},o.argBrowseOption===3)return l(),Q(s);if(p.canOptIn(o.argBrowseOption,{resourceType:o.resourceType&&o.resourceType.resourceTypeName,contracts:o.contracts,browseType:o.browseType}))return a=n.get(w.SettingsManager),Q(a.querySetting(15,"argBrowsePreference").then((function(n){var t=(n||{})[i],r=!h&&c&&o.argBrowseOption===undefined?3:o.argBrowseOption;return(t===!0||t===undefined&&[2,3].includes(r))&&(l(),bt[i]!==t&&(bt[i]=t,rt.Diagnostics.Telemetry.trace({source:"Shell",action:"ArgBrowseOption",name:i,data:{setting:t,argBrowseOption:r}}))),s})))}}return Q(r)}var ot,ei,si,bt,wi,kt;Object.defineProperty(t,"__esModule",{value:!0});t.AssetTypeService=t.getBrowseBladeUri=t.getBrowseAllDeeplink=t.lowerCaseResourceGroupsId=t.lowerCaseAllResourcesId=t.Internal=t.assetTypesMemo=t.setupAssetTypeServiceRpc=t.createViewModelDisposedError=t.assetTypeMeetsRequirements=t.provideCategoryName=t.compareAssetId=t.registerStringProvider=t.failedToFindAssetTypePrefix=void 0;var ht=FxImpl.Extension,rt=MsPortalFx.Base,ct=rt.Constants,dt=ct.AssetNames,gt=dt.NonAssetResource,ft=ct.ResourceTypes,nt=ct.BladeNames.Hubs,it=nt.ResourceMenuBlade,bi=nt.UnavailableAssetBlade,ni=MsPortalFx.Extension,kr=ni.BrowseType,et=rt.Images,ki=FxImpl.Assets,lt=ni.ResourceRoutingType,at=MsPortalFx.Errors,di=MsPortalFx.Helpers,g=MsPortalFx.tryImmediateResolve,gi=window,ti=gi.fx.environment,vt=rt.Diagnostics.createLog(n),yt=et.Polychromatic.ResourceDefault(),nr={image:et.Polychromatic.Preview(),width:40},tr={icon:yt,previewIcon:yt,bladeName:it,bladeExtension:"HubsExtension"},ii=function(n){return vt.warning(n)},ri="Timeout trying to load extension manifest",ir=MsPortalFx.remove,tt=rt.Diagnostics.createIgnoreUnhandledRejectionError,rr=ki.getAssetTypeOrResourceTypeId,ur=rt.Images.Polychromatic.ResourceDefault();t.failedToFindAssetTypePrefix="Could not find the asset type";ot=[];t.registerStringProvider=ui;t.compareAssetId=fr;ei=/(^|[^A-Za-z0-9]*)([A-Za-z0-9]+)/g;si=/^https?:\/\//i;ui({provideCategoryName:function(n){return o.BrowseCategories[oi(n)]||n},provideAssetTypeKeywords:function(n,t,i){var r=o.AssetTypeKeywords[or(n,t,i)];return r?r.split(","):[]}});t.provideCategoryName=cr;t.assetTypeMeetsRequirements=st;t.createViewModelDisposedError=vi;t.setupAssetTypeServiceRpc=pr;t.assetTypesMemo=MsPortalFx.memoizeQ((function(n){return n.assetTypesComplete.then((function(){return Q(n.assetTypes.map((function(t){return n.mapAssetTypeToResourceTypeAssetTypeInformation(t)})))}))}));t.Internal={};t.lowerCaseAllResourcesId="hubsextension_browseallresources";t.lowerCaseResourceGroupsId="hubsextension_resourcegroups";t.getBrowseAllDeeplink=pi;bt={};t.getBrowseBladeUri=br;wi=(function(){function u(n,t,i,r,u){this._viewModelManager=n;this._manifestCache=t;this._redirectMap=i;this.assetTypes=[];this._resourceTypeMap={};this._assetTypeByIdBrowseLink={};this._assetTypeByResourceTypePromises=[];this._selectionFromResourceIdPromises=[];this._bladeInfoPromises=[];this._memoizedManifestsLoadedError=MsPortalFx.memoize((function(n){return tt(n)}));this._serviceMenuEnabled=r.isEnabled("servicemenu");this._lifetimeManager=new FxImpl.TriggerableLifetimeManager;this._cachedUser=u.getCurrentUser();this.assetTypesComplete=this._listenForExtensions()}return u.prototype.dispose=function(){MsPortalFx.disposeDisposable(this._memoizedManifestsLoadedError,this._lifetimeManager,this._resourceIdSelectionCache)},u.prototype.getMappedBladeLocator=function(n){if(n.type===1){var t=this._mappedBrowseBlades.get(n.getExtensionName());if(t&&t.get(n.name))return a.resourceMenu}return n},u.prototype.getAssetType=function(n,t,i){return ut(this.assetTypes,(function(r){return r.extension===n&&r.assetTypeManifest.name===t&&st(r,i)}))},u.prototype.getAssetTypeById=function(n,t){return ut(this.assetTypes,(function(i){return i.id===n&&st(i,t)}))},u.prototype.getAssetTypeByResourceType=function(n,t){if(n){var i=d(n);return ut(this.assetTypes,(function(n){return n.lowerCaseResourceType===i&&st(n,t)}))}},u.prototype.getAssetTypeByResourceTypeWithFallback=function(n,t){var i=this.getAssetTypeByResourceType(n,t);return i||(i=MsPortalFx.clone(this.getAssetType("HubsExtension",gt,t)),i.assetTypeManifest.resourceType={resourceTypeName:n}),i},u.prototype.getAssetTypeDeepLink=function(n,t){var r=n.assetTypeManifest,a=r.name,o=r.bladeName,v=n.extension,y=r.bladeExtensionName||v,w=r.resourceType,u=w&&w.resourceTypeName,s=function(n,t){return c.getBladeDeepLink("HubsExtension",n,t)},i="",b=this._serviceMenuEnabled&&r.serviceMenuBlade,e,p,h,l,k;if(r.browseDeepLink)i=r.browseDeepLink;else if(b)i=c.getBladeDeepLink(r.serviceMenuBladeExtension||n.extension,b,{id:r.serviceMenuItemId});else{e=FxImpl.lowerCaseStringMap();e.set(ft.AllResources,nt.BrowseAllResourcesBlade);e.set(ft.ResourceGroups,nt.BrowseResourceGroupBlade);e.set(ft.RecentResources,nt.BrowseRecentResourcesBlade);switch(r.browseType){case 1:p=e.get(u||ft.AllResources)||nt.BrowseResourceBlade;i=t?s(p,{resourceType:u,kind:t}):s(p,{resourceType:u});break;case 2:y==="HubsExtension"?(h=FxImpl.lowerCaseStringMap(),h.set(nt.BrowseAllResourcesBlade,{resourceType:ft.AllResources,bladeName:nt.BrowseAllResourcesBlade}),h.set(nt.BrowseRecentResourcesBlade,{resourceType:ft.RecentResources,bladeName:nt.BrowseRecentResourcesBlade}),l=h.get(o),l&&(i=s(l.bladeName,{resourceType:l.resourceType}))):f.supportsContract(r.contracts,32768)&&(i=s(nt.AssetMenuBlade,{assetName:a,extensionName:v}));i||(k=a==="Dashboard"&&y==="HubsExtension",i=k?"#":c.getBladeDeepLink(y,o),a===dt.Gallery&&(i+="/selectedMenuItemId/home"));break;case 3:i=this.getBrowseLinkUri(n);break;case 999:i=o&&c.getBladeDeepLink(v,o)}}return!i&&u&&vt.error("<"+u+"> asset type does not have a deep link. Side bar & search results will not be able to open any blades."),i},u.prototype.getBrowseLinkUri=function(n){var t=this._cachedUser,r=this._assetTypeByIdBrowseLink[n.id],i,u;return r?r:(i=n.assetTypeManifest.browseLinkUri,i&&(u=ti.links.classicPortal.format({domain:t&&t.tenantDomain}),i=i.format({accountPortal:ti.links.accountPortal,classicPortal:u,domain:t&&t.tenantDomain,tenantId:t&&t.tenantId})),this._assetTypeByIdBrowseLink[n.id]=i,i)},u.prototype.getAssetTypeInformation=function(n,i){var u=this,r=t.Internal.getAssetTypeInformationOverride;return r?Q(r(n,i)):g(this._getAssetTypePromise(n,i),(function(t){if(!t)throw tt("Asset type not found: AssetType <"+n+":"+i+">");return u.mapAssetTypeToAssetTypeInformation(t)}))},u.prototype.getResourceTypeAssetTypeInformation=function(n){var r=this,u=t.Internal.getResourceTypeAssetTypeInformationOverride;if(u)return Q(u(n));var f=function(n,t){return{resourceType:n,topLevelTenantAlias:null,topLevelResourceTypeAlias:null,extensionName:null,assetType:null,browseType:-1,compositeDisplayName:null,icon:null,viewModelLocator:null,viewModel:null,viewModelExtensionName:null,contracts:0,lowerCaseExtension:null,lowerCaseAssetType:null,lowerCaseResourceType:d(n),reason:MsPortalFx.getLogFriendlyMessage(t)}},i=[],e=[],o=FxImpl.lowerCaseStringMap();return n.forEach((function(n){var t=n.split("/").length>=2;t?o.set(n,!0):e.push(n)})),i.push.apply(i,e.map((function(n){return f(n,"Invalid resource type")}))),o.forEach((function(n,t){var u=g(r.assetTypesComplete,(function(){var n=r.getAssetTypeByResourceType(t);return n?r.mapAssetTypeToResourceTypeAssetTypeInformation(n):f(t,"Asset type not found")}));i.push(u)})),Q.all(i)},u.prototype.mapAssetIdToResourceId=function(n){var u=n.extensionName,f=n.assetType,t=n.assetId,i=r.ArmId.parse(t,!0);return i.kind===1||i.kind===4||s.isResourceAtAnyLevel(i)?Q(t):Q.reject(tt("Asset ID not a resource ID. "+lr(u,f,t)))},u.prototype.mapResourceIdToAssetId=function(n){return g(this._getAssetTypeByResourceId(n),(function(t){var f;if(!t)throw tt("Asset type not found: ResourceId <"+s.sanitizeId(n)+">");var i=t.assetTypeManifest,r=i.name,e=i.resourceType,u=t.extension;if(!e)throw ai("ResourceId <"+s.sanitizeId(n)+">",u,r);return f=function(n){return{extensionName:u,assetType:r,assetId:n}},f(n)}))},u.prototype.mapAssetIdToDynamicSelectionAndIcon=function(n,t){var i=this,u=n.extensionName,f=n.assetType,e=n.assetId;return g(this._getAssetTypePromise(u,f),(function(o){if(o){n.assetId=e&&ko.unwrap(e);var s=r.ArmId.parse(n.assetId,!0);if(er(s)){if(s.kind===0)throw pt(n.assetId);return i._getDynamicSelectionAndIconFromResourceId(o,n.assetId,s,n,t)}return i._getDynamicSelectionAndIconFromAssetId(o,n)}throw tt("Asset type not found: AssetType <"+u+":"+f+">");}))},u.prototype.mapResourceIdToDynamicSelectionAndIcon=function(n,t){var i=this,f=r.ArmId.parse(n,!0),u;return(this._resourceIdSelectionCache=this._resourceIdSelectionCache||new h.ItemArrayCache(216e5),f.kind===0)?Q.reject(pt(n)):(u=this._resourceIdSelectionCache.first((function(t){return fi(t.resourceId,n)})),u)?Q(u.value):g(g(this._getAssetTypeByResourceId(n),(function(r){if(!r)throw tt("Asset type not found: ResourceId <"+s.sanitizeId(n)+">");var u=r.assetTypeManifest,e=u.name;if(!u.resourceType)throw ai("ResourceId <"+s.sanitizeId(n)+">",r.extension,e);return g(i.mapResourceIdToAssetId(n),(function(u){return i._getDynamicSelectionAndIconFromResourceId(r,n,f,u,t)}))})),(function(t){return i._resourceIdSelectionCache.pushEntry({resourceId:n,value:t}),t}))},u.prototype.mapResourceIdAndKindToBladeInfo=function(n,t){var c=this;n=n||"";t=t||"";var u=t.toLowerCase(),i=r.ArmId.parse(n,!0),o=r.ResourceName.getDisplayName({id:n,armId:i}),l=i.kind===1?g(MsPortalFx.Azure.getSubscriptionInfo(i.subscription),(function(n){return n.displayName}),(function(){return o})):Q(o);var a=n.startsWith("/")?"#resource"+n:"#resource/"+n,f=i.resourceType||"",s=f.toLowerCase(),h=ut(this._bladeInfoPromises,(function(n){return n.resourceKind===u&&n.resourceType===s})),e=h&&h.promise;return e||(e=g(this.getResourceTypeAssetTypeInformation([f,r.ArmId.parse(n).resourceType]),(function(n){var i=n&&n[0].assetType&&n[0]||n[1]||{},h=i.kindMap&&(i.kindMap[u]||i.kindMap[i.defaultKind]),r=h||{},l=r.singularDisplayName||i.compositeDisplayName&&i.compositeDisplayName.singular||f,a=r.icon||i.icon||yt,e=l?et.CustomImageWithOptions(a,{title:l}):a,w=r.isPreview!==undefined?r.isPreview:i.isPreview,b=w?et.CustomImageWithBadge(e,nr):e,v=it,y="HubsExtension",p=r.bladeName||i.bladeName,o;return p&&(v=p,y=r.bladeExtensionName||i.bladeExtensionName||i.extensionName),o={icon:e,previewIcon:b,bladeName:v,bladeExtension:y},(!t||h)&&wt(c._bladeInfoPromises,{resourceType:s,resourceKind:u,promise:Q(o)},200),o}),(function(){return tr}))),g(e,(function(n){var t=n.icon,i=n.previewIcon,r=n.bladeName,u=n.bladeExtension;return g(l,(function(n){return{displayName:n,deepLink:a,icon:t,previewIcon:i,bladeName:r,bladeExtension:u}}))}))},u.prototype.mapAssetTypeToAssetTypeInformation=function(n){var t=n.assetTypeManifest,i=t.keywords;return{extensionName:n.extension,assetType:t.name,options:t.options,browseType:t.browseType!==undefined?t.browseType:-1,browseLinkUri:this.getBrowseLinkUri(n),compositeDisplayName:n.compositeDisplayName,icon:n.icon,viewModelLocator:t.viewModelLocator,viewModel:t.viewModel,viewModelExtensionName:t.viewModelExtensionName,contracts:t.contracts,isPreview:n.isPreview,privateBrowse:t.privateBrowse,keywords:i?i.split(","):undefined,hiddenCommands:t.hiddenCommands,browseCommandExperiments:t.browseCommandExperiments}},u.prototype.mapAssetTypeToResourceTypeAssetTypeInformation=function(n){var t=n.assetTypeManifest,i=t.resourceType||{},u=t.browseType,f=t.keywords,r=i.proxyRoutingFilters;return r||n.lowerCaseExtension!=="microsoft_azure_marketplace"||n.lowerCaseAssetType!=="galleryrpitem"||(r=[1,3]),{resourceType:i.resourceTypeName,topLevelTenantAlias:i.topLevelTenantAlias,topLevelResourceTypeAlias:i.topLevelResourceTypeAlias,apiVersion:i.apiVersion,routingType:i.routingType,bladeName:t.bladeName,bladeExtensionName:t.bladeExtensionName,partName:t.partName,partExtensionName:t.partExtensionName,kinds:i.kinds,kindMap:n.kindMap,defaultKind:n.defaultKind,proxyRoutingFilters:r,extensionName:n.extension,assetType:t.name,options:t.options,browseType:u!==undefined?u:-1,browseLinkUri:this.getBrowseLinkUri(n),compositeDisplayName:n.compositeDisplayName,icon:n.icon,viewModelLocator:t.viewModelLocator,viewModel:t.viewModel,viewModelExtensionName:t.viewModelExtensionName,contracts:t.contracts,isPreview:n.isPreview,noPdlCreateBlade:t.noPdlCreateBlade,noPdlCreateExtension:t.noPdlCreateExtension||n.extension,noPdlCreateParameters:t.noPdlCreateParameters,marketplaceItemId:t.marketplaceItemId,marketplaceMenuItemId:t.marketplaceMenuItemId,staticOverview:t.staticOverview,privateBrowse:t.privateBrowse,keywords:f&&f.split(","),lowerCaseAssetType:n.lowerCaseAssetType,lowerCaseExtension:n.lowerCaseExtension,lowerCaseResourceType:n.lowerCaseResourceType,description:t.description,links:t.links,argBrowseOption:t.argBrowseOption,hiddenCommands:t.hiddenCommands,hideBrowseInfoBox:t.hideBrowseInfoBox,browseCommandExperiments:t.browseCommandExperiments}},u.prototype._getAssetTypePromiseWorker=function(n){var t=n();return t?Q(t):g(this.assetTypesComplete,(function(){return Q(n())}))},u.prototype._getAssetTypeByResourceId=function(n){var i=this,t=r.ArmId.parse(n,!0);return t.kind===0?Q.reject(pt(n)):g(this._getAssetTypeByResourceType(t.resourceType),(function(t){if(!t){var u=r.ArmId.parse(n);return g(i._getAssetTypeByResourceType(u.resourceType),(function(n){return n}))}return t}))},u.prototype._getAssetTypeByResourceType=function(n,t){var u=this,f=d(n),e=ut(this._assetTypeByResourceTypePromises,(function(n){return n.resourceType===f&&n.requirements===t})),i,r;return e?e.promise:(i=this._getAssetTypePromiseWorker((function(){return u.getAssetTypeByResourceType(n,t)})),Q.isRejected(i)||(r={resourceType:f,promise:i,requirements:t},wt(this._assetTypeByResourceTypePromises,r,200),Q.isPending(i)&&i.catch((function(n){n.message===ri&&vt.warning(ri);ir(u._assetTypeByResourceTypePromises,r)}))),i)},u.prototype._getDynamicSelectionAndIconFromAssetId=function(n,t){var r=li(n,t.assetId),i;return f.supportsContract(n.assetTypeManifest.contracts,32768)&&(i=r.selection,i.extension="HubsExtension",i.detailBlade=nt.AssetMenuBlade,i.detailBladeInputs={assetName:n.assetTypeManifest.name,extensionName:n.extension}),Q(r)},u.prototype._getDynamicSelectionAndIconFromResourceId=function(n,t,i,u,o){var k=this,h=li(n,u.assetId),c=h.selection,s=n&&n.assetTypeManifest,l,y,a,v,p,w,b;return i.kind===1||i.kind===4?(c.extension="HubsExtension",c.detailBlade=it,Q(h)):(l=s&&s.resourceType,l&&l.routingType===lt.Extension&&!f.supportsContract(s.contracts,64))?Q(h):s&&f.supportsContract(s.contracts,128)?(c.extension="HubsExtension",c.detailBlade=it,Q(h)):(y=ut(this._selectionFromResourceIdPromises,(function(n){return n.resourceId===t})),y)?y.promise:(!s||l&&l.kinds&&(!f.supportsContract(s.contracts,512)||f.supportsAnyContract(s.contracts,13312))?(v=void 0,f.supportsContract(s.contracts,64)?(p=n.assetTypeManifest.viewModelLocator||n.assetTypeManifest.viewModel,w=this._lifetimeManager.createChildLifetime(),v=this._viewModelManager.getViewModel(n.extension,p,11).then((function(i){var u=!1;if(w.registerForDispose((function(){u=!0;k._viewModelManager.releaseViewModel(i)})),!u)return i.content().getResource(t).then((function(n){return MsPortalFx.extend2(n,{armId:r.ArmId.parse(n.id,!0)})}));throw vi("asset type service",n.extension,p);})).finally((function(){return w.dispose()}))):v=e.getResource(t,o),a=g(v,(function(t){var r,i;return!s||s.name===gt?Q(h):f.supportsOption(s.options,2)?Q(h):(r=n.kindMap&&(n.kindMap[(t.kind||"").toLowerCase()]||n.kindMap[(n.defaultKind||"").toLowerCase()]),r&&f.supportsOption(r.options,2))?Q(h):(i=!1,f.supportsContract(s.contracts,8)&&(c.extension="HubsExtension",c.detailBlade=it,i=!0),g(MsPortalFx.require("MsPortalImpl/Services/Services.AssetTypesDelayed"),(function(r){if(l&&l.kinds){var e=!1,o=!1,u=!1;if(r.getIconAndBladeFromAssetTypeInformation(t,n.kindMap,n.defaultKind,null,(function(n){n?f.supportsContract(s.contracts,16)&&(c.extension="HubsExtension",c.detailBlade=it,i=!0):i=!1}),(function(n){o||(o=!0,h.isPreview=n)}),(function(n){e||(e=!0,h.icon=n)}),(function(t,r){u||i||(u=!0,c.extension=t||n.extension,c.detailBlade=r)})),u||i)return h}return h})))})).catch((function(i){var r=sr(i,"_getDynamicSelectionAndIconFromResourceId have unexpected error.",{assetType:n,resourceId:t,assetId:u,telemetry:o});throw r;}))):a=g(Q(h),MsPortalFx.identity),b={resourceId:t,promise:a},wt(this._selectionFromResourceIdPromises,b,200),a.catch((function(){MsPortalFx.remove(k._selectionFromResourceIdPromises,b)})),a)},u.prototype._preventDuplicateResourceTypes=function(n,t,i){if(this._resourceTypeMap[n]){var r=ut(this.assetTypes,(function(t){return t.lowerCaseResourceType&&t.lowerCaseResourceType===n})),u=yi(r.assetTypeManifest),f=yi(i);if(u<f)delete this._resourceTypeMap[n],MsPortalFx.remove(this.assetTypes,r);else return u>f?!1:(ii("Extension <"+t+"> has duplicate resource type <"+n+"> also found in <"+r.extension+"> extension"),!1)}return!0},u.prototype._listenForExtensions=function(){var t=this,n=this._mappedBrowseBlades=FxImpl.lowerCaseStringMap(),i={system:!0,"v2.0,system":!0,"v12.0,system":!0};return this._manifestCache.getManifests("assetTypes",(function(r,u){n.has(r)||n.set(r,FxImpl.lowerCaseStringMap());var e=u.assetTypes;e&&e.forEach((function(e){var h,p,w,o,s,g,a;if(e.browseType!==4&&(e.browseType!==3||(e.browseLinkUri||"").match(si))&&(h=t._redirectMap.getAssetRedirect(r+"_"+e.name),p=h&&h.toExtension===r&&h.toAsset===e.name,!h||p)){var l=e.resourceType,v=l&&l.resourceTypeName,y=ci(e);if(v){if(w=v.split("/"),w.length<2){ii("Skipping asset type <"+e.name+"> with invalid resource type <"+v+"> in extension <"+r+">");return}if(!t._preventDuplicateResourceTypes(y,r,e))return;t._resourceTypeMap[y]=!0}var b=function(t,i,u){if(t&&u){var f=i||r;n.has(f)||n.set(f,FxImpl.lowerCaseStringMap());n.get(f).set(t,!0)}},c=l&&l.kinds,k=f.supportsContract(e.contracts,8);c&&c.length?(c.forEach((function(n){b(n.bladeName||e.bladeName,n.bladeExtensionName||e.bladeExtensionName,n.useResourceMenu!==undefined?n.useResourceMenu:k);n.filterMap=MsPortalFx.extendArrayIntoMap(Object.create(null),n.kinds||[n.name],(function(n){return d(n)}),(function(){return!0}));n.isDefault&&(n.filterMap[""]=!0)})),r==="SqlAzureExtension"&&e.name==="Database"&&(o=MsPortalFx.find(c,(function(n){return d(n.name)==="v12.0,user,datawarehouse"})),s=MsPortalFx.find(c,(function(n){return d(n.name)==="v12.0,user,datawarehouse,gen2"})),o&&s&&(o.filterMap[d(o.name)]=!0,o.filterMap[d(s.name)]=!0,s.filterMap[d(o.name)]=!0,s.filterMap[d(s.name)]=!0))):b(e.bladeName,e.bladeExtensionName,k);ar(r,e);g=rr(r,e.name);a=vr(r,g,u,e);e.options===undefined&&(e.privateBrowse&&(e.options=e.options|1),y==="microsoft.sql/servers/databases"&&a.kindMap&&MsPortalFx.forEachKey(a.kindMap,(function(n,t){i[n]&&t.options===undefined&&(t.options=t.options|2)})));r.toLowerCase()==="microsoft_azure_datafactory"&&(e.name.toLowerCase()==="datafactory"||e.name.toLowerCase()==="datafactoryv2")&&e.argBrowseOption===undefined&&(e.argBrowseOption=4);t.assetTypes.push(a)}}))}))},u.prototype._getAssetTypePromise=function(n,t,i){var r=this;return this._getAssetTypePromiseWorker((function(){return r.getAssetType(n,t,i)}))},__decorate([__metadata("fx:diagnostics",[n,"AssetTypeServiceImpl"]),i.Class(),__metadata("design:paramtypes",[l.ViewModelManager,y.ManifestCache,y.RedirectMap,b.Features,v.AuthStateManager])],u)})();kt=(function(){function t(){}return t.create=function(n){return n},__decorate([__metadata("fx:diagnostics",[n,"AssetTypeService"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[wi]),__metadata("design:returntype",t)],t,"create",null),t})();t.AssetTypeService=kt}));
define("MsPortalImpl/Services/Services.Permissions",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","Fx/ResourceManagement","FxHubs/Helpers/PermissionsHelpers"],(function(n,t,i,r,u,f){"use strict";function o(n){return n&&n.length===1&&n[0]==="rdfe"}function c(n,t){if(!t&&v.fxDisableRbacCache)return{getPermissions:n,getCachedPermissions:function(){return{}},clear:MsPortalFx.noop};var i,r=function(){return i=i||{}};return{getPermissions:function(t,i){var u=r(),f=u[t]||(u[t]=MsPortalFx.memoizeQ((function(t){return Q(n(t,i))})));return f(t)},getCachedPermissions:r,clear:function(n){var i=r(),t=i[n];t&&t.clear()}}}var s,h,l;Object.defineProperty(t,"__esModule",{value:!0});t.PermissionsChecker=t.hasPermissionsToShell=t.PermissionsManager=t.isRDFEAction=void 0;var a=FxImpl.Extension,v=window,e=function(){return MsPortalFx.require(n.normalize("./PermissionsHelpers"))};t.isRDFEAction=o;s=(function(){function t(){}return t.create=function(n){return new h(n)},__decorate([__metadata("fx:diagnostics",[n,"PermissionsManager"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.Container]),__metadata("design:returntype",t)],t,"create",null),t})();t.PermissionsManager=s;h=(function(){function n(n){this._diContainer=n;var t=c((function(n,t){return e().then((function(i){return i.getPermissions(n,t)}))}));this._cachedPermissionsGetter=t;this._getPermissionsCallback=function(n,i){return t.getPermissions(n,i)}}return n.prototype.hasPermission=function(n,t,i){var r=this,f;return o(t)?e().then((function(u){return u.hasPermissionsImpl(r._diContainer,n,t,i)})):(f=u.ArmId.parse(n,!0),f.kind===0)?Q("The entity ID for hasPermission must be a resource ID, a subscription ID or a resource group ID"):e().then((function(u){return u.hasPermission(n,t,null,r._getPermissionsCallback,i)}))},n.prototype.getDiagnosticsData=function(){var n=[],t=this._cachedPermissionsGetter.getCachedPermissions(),i=[];return Object.keys(t).forEach((function(r){n.push(t[r]().then((function(n){i.push({entityId:r,permissions:n})})))})),Q.all(n).then((function(){return i}))},n})();t.hasPermissionsToShell=r.defineHandler(a.hasPermissionsToShell,(function(n){return n.diContainer.get(s).hasPermission(n.messageArg.entityId,n.messageArg.requestedActions,n.messageContext.srcWindowId)}));l=(function(){function t(n,t){this._permissionsCache=c((function(t){return e().then((function(i){return i.getPermissionsFromArm(t,n)}))}),t)}return t.prototype.hasPermission=function(n,t,i,r){var u=this;return o(t)?this.hasRdfePermissions(n):e().then((function(f){return f.hasPermission(n,t,i,(function(n){return u._permissionsCache.getPermissions(n,r)}),r)}))},t.prototype.getDiagnostics=function(){return this._permissionsCache.getCachedPermissions()},t.prototype.hasRdfePermissions=function(n){var t=u.ArmId.parse(n,!0);return t.kind!==1?Q(!1):MsPortalFx.Azure.getSubscriptionInfo(t.subscription).then(f.subscriptionRequiresRdfe)},t.create=function(){return new t("HubsExtension")},__decorate([__metadata("fx:diagnostics",[n,"PermissionsChecker"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",t)],t,"create",null),t})();t.PermissionsChecker=l}));
define("MsPortalImpl/Services/Services.PersistentStorage",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.Settings","FxInternal/AsyncLoader","FxInternal/RpcEndPointsCore"],(function(n,t,i,r,u,f){"use strict";var o,c,l;Object.defineProperty(t,"__esModule",{value:!0});t.getAllKeysHandler=t.clearHandler=t.removeSettingsHandler=t.readSettingsHandler=t.writeSettingHandler=t.StorageCapacityExceededError=t.KeySizeExceededError=t.PersistentStorageSettings=void 0;var a=MsPortalFx.Base.Diagnostics.Telemetry,s=function(n){return n+"PersistentStorage"},h=function(n){return"__fx_metadata__"+n},e=(function(){function t(n){this._settingsManager=n;this._cache={}}return t.prototype.writeSetting=function(n,t,i,r){var a=this,u,f,e;return(r===void 0&&(r=[]),u=function(n,t){return o.error(n,0,t),Promise.reject(n.message)},t.length>241)?u(new c,{keyLength:t.length}):(f=s(n),e=this._traceAction(n,"ClearPersistentStorage"),this._getCacheStorage(n).then((function(n){var s=[[t,i]],o;return(r.length&&s.push([h(t),JSON.stringify({readers:r})]),o=2*s.reduce((function(n,t){return n+t[0].length+t[1].length}),0),o+n.size>102400)?u(new l,{keyValuePairsSize:o,cacheSize:n.size}):Promise.all(s.map((function(t){var i=t[0],r=t[1],u=2*(i.length+r.length);return n.size+=u,n.storage.set(i,r),a._settingsManager.setSettingWithPromise(f,i,r)}))).then((function(){e({sizeAdded:o})}))})))},t.prototype.readSettings=function(n,t,i){i===void 0&&(i=n);var r=this._traceAction(n,"ReadPersistentSettings");return this._getCacheStorage(n).then((function(u){var f=t.reduce((function(t,r){var o=u.storage.get(r),s=u.storage.get(h(r))||"",e=s.length?JSON.parse(s):{},f=e===null||e===void 0?void 0:e.readers,c=n===i||f==="*"||(f===null||f===void 0?void 0:f.includes(i));return c&&o!==undefined&&(t[r]=o),t}),{});return r({numberOfRequestedKeys:t.length,numberOfReturningPairs:Object.keys(f).length}),f}))},t.prototype.removeSettings=function(n,t){var r=this,u=s(n),i=t.concat(t.map(h)),f=this._traceAction(n,"RemovePersistentSettings");return this._getCacheStorage(n).then((function(n){return i.forEach((function(t){var r=n.storage.has(t),i;r&&(i=(n.storage.get(t)||"").length,n.size-=i+t.length,n.storage.delete(t))})),r._settingsManager.deleteSettingsWithPromise({store:u,keys:i}).then(f).catch((function(n){o.error(n)}))}))},t.prototype.clear=function(n){var t=this,i=this._traceAction(n,"ClearPersistentStorage");return this.getAllSettingsKeys(n).then((function(r){return t.removeSettings(n,r).then((function(){i({numberOfKeysRemoved:r.length})}))}))},t.prototype.getAllSettingsKeys=function(n){return this._getCacheStorage(n).then((function(n){return Array.from(n.storage.keys()).filter((function(n){return!n.startsWith("__fx_metadata__")}))}))},t.prototype._getCacheStorage=function(n){var r=this,t,i=Date.now();return((t=this._cache[n])===null||t===void 0?void 0:t.expires)>i?Promise.resolve(this._cache[n]):this._settingsManager.querySettings({store:s(n)}).then((function(t){var u=0,f=Object.keys(t).map((function(n){return u+=2*(n.length+t[n].length),[n,t[n]]}));return r._cache[n]={expires:i+36e5,storage:new Map(f),size:u},r._cache[n]})).catch((function(n){return o.error(n),{expires:i+36e5,storage:new Map,size:0}}))},t.prototype._traceAction=function(n,t){var r=this,u=MsPortalFx.startTimer(),i=function(n){return n&&{size:n.size,numberOfKeys:Array.from(n.storage.keys()).length}},f=i(this._cache[n]);return function(e){var o=i(r._cache[n]);a.trace({source:"Services.PersistentStorage",action:t,actionModifier:a.ActionModifier.Complete,name:n,data:{initialCacheState:f,finalCacheState:o,extraData:e,duration:u()}})}},__decorate([__metadata("fx:diagnostics",[n,"PersistentStorageSettings"]),i.Class(),__metadata("design:paramtypes",[r.SettingsManager])],t)})();t.PersistentStorageSettings=e;o=MsPortalFx.Base.Diagnostics.createLog(n);c=(function(n){function t(){var t=n.call(this,"Attempting to set a key/value pair that has a key size that exceeds the portal's limit: 241 characters.")||this;return t.name="KeySizeExceededError",t}return __extends(t,n),t})(Error);t.KeySizeExceededError=c;l=(function(n){function t(){var t=n.call(this,"Attempting to set a key/value pair which when combined with all settings would exceed the portal's limit: 102400 bytes.")||this;return t.name="StorageCapacityExceededError",t}return __extends(t,n),t})(Error);t.StorageCapacityExceededError=l;t.writeSettingHandler=u.defineHandler(f.writeSettingEndPoint,(function(n){return Q(n.diContainer.get(e).writeSetting(n.messageContext.srcWindowId,n.messageArg.key,n.messageArg.value,n.messageArg.readers))}));t.readSettingsHandler=u.defineHandler(f.readSettingsEndPoint,(function(n){return Q(n.diContainer.get(e).readSettings(n.messageArg.extensionName,n.messageArg.keys,n.messageContext.srcWindowId))}));t.removeSettingsHandler=u.defineHandler(f.removeSettingsEndPoint,(function(n){return Q(n.diContainer.get(e).removeSettings(n.messageContext.srcWindowId,n.messageArg.keys))}));t.clearHandler=u.defineHandler(f.clearEndPoint,(function(n){return Q(n.diContainer.get(e).clear(n.messageContext.srcWindowId))}));t.getAllKeysHandler=u.defineHandler(f.getAllKeysEndPoint,(function(n){return Q(n.diContainer.get(e).getAllSettingsKeys(n.messageContext.srcWindowId))}))}));
define("MsPortalImpl/Services/Services.PortalIdleState",["require","exports","Fx/DependencyInjection"],(function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PortalIdleStateService=void 0;var r=(function(){function t(n,t){var i=this,r;this._win=n;this._defaultPollMS=t;this._state=0;this._handleId=1;this._iteration=0;this._actions=new Map;this._frameInFocus=!1;this._win.addEventListener("blur",this._blurFunc=function(){document.activeElement instanceof HTMLIFrameElement||i._signalIdle(i._defaultPollMS)});this._win.addEventListener("focus",this._focusFunc=function(){i._blurStartTime=null;i.signalBusy()});MsPortalFx.isFeatureEnabled("displayidlestateindom")&&(r=document.getElementById("web-container"),r.dataset.frameinfocus=String(this._frameInFocus),r.dataset.idlestate=String(this._state))}return t.prototype.dispose=function(){var n=this._win;return n?(this._win=null,n.removeEventListener("blur",this._blurFunc),n.removeEventListener("focus",this._focusFunc),this._setIdleState(0),!0):!1},t.prototype.addCallbacks=function(n){var t=this._handleId++;return this._actions.set(t,n),t},t.prototype.removeCallbacks=function(n){return this._actions.delete(n)},t.prototype.signalBusy=function(n){n===void 0&&(n=0);this._setFrameInFocus(n===1);this._state===1&&(this._setIdleState(2),this._processCallbacks(5e3))},t.prototype.signalIdle=function(n){n===void 0&&(n=0);(n===0||this._frameInFocus)&&this._signalIdle(0)},t.create=function(){return new t(window,6e4)},t.prototype._setFrameInFocus=function(n){this._frameInFocus=n;MsPortalFx.isFeatureEnabled("displayidlestateindom")&&(document.getElementById("web-container").dataset.frameinfocus=String(this._frameInFocus))},t.prototype._setIdleState=function(n){this._state=n;MsPortalFx.isFeatureEnabled("displayidlestateindom")&&(document.getElementById("web-container").dataset.idlestate=String(this._state))},t.prototype._signalIdle=function(n){this._blurStartTime||(this._blurStartTime=Date.now());this._setIdleState(1);this._processCallbacks(n)},t.prototype._processCallbacks=function(n){var t=this,r,i;this._win&&(r=function(){var i,n;switch(t._state){case 2:t._setIdleState(0);i=function(n){return n.onBusy&&n.onBusy(new Date)};break;case 1:t._setIdleState(1);i=function(n){return n.onIdle(Math.floor((Date.now()-t._blurStartTime)/6e4))};break;default:case 0:return}var f=function(n,r){var f=n[r],u=t._actions.get(f);u&&i(u)},e=Array.from(t._actions.keys()),r=t._actions.size,u=t._iteration%r;for(t._iteration++,n=u;n<r+u;n++)f(e,n%r)},i=this._timeoutHandle,i&&this._win.clearTimeout(i),this._timeoutHandle=this._win.setTimeout((function(){t._timeoutHandle=null;try{r()}finally{t._state!==0&&t._processCallbacks(t._defaultPollMS)}}),n))},__decorate([__metadata("fx:diagnostics",[n,"PortalIdleStateService"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",t)],t,"create",null),t})();t.PortalIdleStateService=r}));
define("MsPortalImpl/Services/Services.BrowserSettings",["require","exports","Fx/DependencyInjection","Weave"],(function(n,t,i,r){"use strict";function c(){return e&&f.width<480}function l(){return e&&(f.width<768||f.height<800)}function a(){return e&&(u.innerHeight<400&&u.innerWidth<800||u.devicePixelRatio*100>300)}var o,s,h;Object.defineProperty(t,"__esModule",{value:!0});t.ServiceDependencyState=t.PrivateLinkState=t.temporaryExtensionCount=t.isZoomedInTooDeep=t.hideLargeModals=t.hideSmallModals=void 0;var u=window,f=u.screen||{},e=MsPortalFx.isFeatureEnabled("hidemodalsonsmallscreens");t.hideSmallModals=c;t.hideLargeModals=l;t.isZoomedInTooDeep=a;o=(function(){function n(){this._extensionCountTable=new Object(null);this._intervalIds=[]}return n.prototype._getCurrentCount=function(n){var t;return(t=this._extensionCountTable[n])!==null&&t!==void 0?t:0},n.prototype.addIntervalId=function(n){this._intervalIds.push(n)},n.prototype.flush=function(){this._extensionCountTable=new Object(null)},n.prototype.flushIntervalIds=function(){this._intervalIds.filter((function(n){return clearInterval(n)}));this._intervalIds.length=0},n.prototype.incrementCount=function(n){this._extensionCountTable[n]=this._getCurrentCount(n)+1},n.prototype.getExtensionCountsAsList=function(){var t=this,n=[];return Object.keys(this._extensionCountTable).forEach((function(i){n.push({extension:i,count:t._extensionCountTable[i]})})),n},n})();t.temporaryExtensionCount=new o;s=(function(){function t(){this.isPrivateLinked=r.makeWritableComputation(!1)}return __decorate([__metadata("fx:diagnostics",[n,"PrivateLinkState"]),i.Class()],t)})();t.PrivateLinkState=s;h=(function(){function t(){this.azureResourceGraphUnavailable=r.makeWritableComputation(!1)}return __decorate([__metadata("fx:diagnostics",[n,"ServiceDependencyState"]),i.Class()],t)})();t.ServiceDependencyState=h}));
define("MsPortalImpl/Services/SubscriptionAndLocationHelpers",["require","exports","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i){"use strict";function e(n){var e=n.subsMap||{},o={},h="disabled",r=[],s=0,t=new Set,u;return MsPortalFx.forEachKey(e,(function(n,u){var f=u.subscription,w=u.notInFirstPage,l=f.displayName,y=f.state,p=(f.subscriptionPolicies||{}).quotaId,k=f.uniqueDisplayName,b=__rest(f,["uniqueDisplayName"]),a,c,v;p&&t.size<10&&t.add(p);a=y&&y.toLowerCase()===h?i.disabledSubscriptionLabelFormat.format(l):l;c=o[l];c?(a=i.subscriptionNameAndIdLabelFormat.format(a,n),c.updated||(v=r[c.index],v.uniqueDisplayName=i.subscriptionNameAndIdLabelFormat.format(v.uniqueDisplayName,v.subscriptionId),c.updated=!0)):o[l]={index:s,updated:!1};f=__assign(__assign({},b),{uniqueDisplayName:a});e[n]={subscription:f,notInFirstPage:w};r.push(f);s++})),t.size&&(u=[],t.forEach((function(n){return u.push(n)})),f.trace({source:n.telemetrySource+".getSubscriptionsWithUniqueDisplayNames",action:n.isPortalStartup?"quotaIdsOnPortalLoad":"additionalQuotaIdsOnAllSubscriptionsLoad",data:{quotaIds:u.join(",")}})),r}function o(n,t,i){for(var c,h,r,o=i?n.length+t.length:Math.min(1e3,n.length+t.length),s=new Map,u=new Array(o),f=Math.min(n.length,o),e=0;e<f;e++)r=n[e],s.set(r.subscriptionId,r),u[e]=r;for(c=Math.min(t.length,o),h=0;h<c&&f<u.length;)r=t[h++],s.has(r.subscriptionId)||(s.set(r.subscriptionId,r),u[f++]=r);return u.length=f,u}function s(n,t){var i="disabled",r=(n.state||"").toLowerCase(),u=(t.state||"").toLowerCase(),f=(n.displayName||"").toLowerCase(),e=(t.displayName||"").toLowerCase(),o=(n.subscriptionId||"").toLowerCase(),s=(t.subscriptionId||"").toLowerCase();if(r!==u){if(r===i)return 1;if(u===i)return-1}return MsPortalFx.compare(f,e)||MsPortalFx.compare(o,s)}Object.defineProperty(t,"__esModule",{value:!0});t.compareSubscriptions=t.mergeSelectedSubscriptionsWithFirstPage=t.getSubscriptionsWithUniqueDisplayNames=void 0;var r=MsPortalFx.Base,u=r.Diagnostics,f=u.Telemetry;t.getSubscriptionsWithUniqueDisplayNames=e;t.mergeSelectedSubscriptionsWithFirstPage=o;t.compareSubscriptions=s}));
define("MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers",["require","exports","Fx/Ajax","FxHubs/RpcEndPoints","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/Services/SubscriptionAndLocationHelpers","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/Services/Services.Settings"],(function(n,t,i,r,u,f,e,o){"use strict";function nt(){h.trace({source:"LazyUserDataHelpers",action:"ServiceErrorFromArg"})}function w(t){return __awaiter(this,void 0,void 0,(function(){var i;return __generator(this,(function(r){switch(r.label){case 0:return[4,MsPortalFx.require(n.normalize("./LazyUserData.Deferred"))];case 1:return i=r.sent(),[4,i.getLazyUserData({diContainer:t,useGlobalResourceFiltersPromise:b(t),fetchFirstPageAndSelectedSubscriptions:!0})];case 2:return[2,r.sent()]}}))}))}function tt(n){return __awaiter(this,void 0,void 0,(function(){var ct,a,b,lt,at,o,vt,yt,pt,r,c,k,it,rt,wt,ut,ft,et,l,y,tt,ot,st,ht;return __generator(this,(function(bt){switch(bt.label){case 0:return p&&s.error("getLazyUserData should only be called once per session"),[4,n.get(e.SecurityTokensManager).getToken({extensionName:"fx",resourceName:"",isBackground:!1,skipCache:!1})];case 1:ct=bt.sent()||{};p=!0;a=d.fx.environment.applicationPath;a[a.length-1]!=="/"&&(a+="/");b=new v.UriBuilder(a+"api/Portal/GetLazyUserData");MsPortalFx.isFeatureEnabled("inmemorysettings")&&b.query.setParameter("inmemorysettings","true");MsPortalFx.isFeatureEnabled("globalresourcefilter")&&b.query.setParameter("feature.globalresourcefilter","true");lt=h.startTrace({source:"LazyUserDataHelpers",action:"loadLazyUserData"});at=ct.token||{};bt.label=2;case 2:return bt.trys.push([2,4,,9]),[4,i.ajaxExtended({contentType:"application/json",headers:{accept:"application/json"},setAuthorizationHeader:g?{resourceName:"self"}:!0,type:"POST",uri:b.toString(),data:JSON.stringify({version:"2019-10-01",armAuthorizationHeader:at.header})})];case 3:return vt=bt.sent(),o=vt.content,[3,9];case 4:yt=bt.sent();s.warning("Call to GetLazyUserData failed and will be retried on the client. Error details: "+MsPortalFx.getLogFriendlyMessage(yt));bt.label=5;case 5:return bt.trys.push([5,7,,8]),[4,w(n)];case 6:return o=bt.sent(),[3,8];case 7:return pt=bt.sent(),s.warning("Failed to load client-side lazyUserData. Error details: "+MsPortalFx.getLogFriendlyMessage(pt)),[3,8];case 8:return[3,9];case 9:if(o=o||{},r=o.firstPageSubscriptions||{},c=o.serviceHealthAlerts,k=["Failure_PrivateLink","Failure_CaePolicyValidation",].includes(r.resultCode),it=o.argServiceIsUnavailable||r.resultCode==="Failure_ArgServiceUnavailable",it&&(n.get(u.ServiceDependencyState).azureResourceGraphUnavailable(!0),nt()),k&&n.get(u.PrivateLinkState).isPrivateLinked(!0),!(k||it))return[3,13];h.trace({source:"LazyUserDataHelpers",action:k?"ReceivedPrivateLinkCode":"ARGUnavailableFallback",data:{resultCode:r.resultCode}});bt.label=10;case 10:return bt.trys.push([10,12,,13]),[4,w(n)];case 11:return rt=bt.sent(),r=rt.firstPageSubscriptions||{},c=rt.serviceHealthAlerts,[3,13];case 12:return wt=bt.sent(),s.warning("Failed to load client-side lazyUserData. Error details: "+MsPortalFx.getLogFriendlyMessage(wt)),[3,13];case 13:return ut=r.valueMapById||{},ft=r.count||{},et=(ft.type||"").toLowerCase(),l=o.locations||{},y=o.recentResources||Object.create(null),tt=y.recentResources||Object.create(null),c=c||[],ot=f.getSubscriptionsWithUniqueDisplayNames({subsMap:ut,isPortalStartup:!0,telemetrySource:"LazyUserDataHelpers"}),st=ot.length,h.completeTrace(lt,{firstPageSubscriptions:{armCount:r.count||{},hasErrors:r.hasErrors,nextLink:r.nextLink,resultCode:r.resultCode,subscriptionsReturned:st},locations:{armCount:l.count||{},hasErrors:l.hasErrors,locationsReturned:(l.value||[]).length,nextLink:l.nextLink},recentResources:{recentResourcesCount:Object.keys(y).length,status:y.status||"unknown",verifiedRecentResourcesCount:Object.keys(tt).reduce((function(n,t){return tt[t].existenceState.toLowerCase()==="exists"&&n++,n}),0)},serviceHealthAlerts:{returnedCount:c.length}}),r.hasErrors&&s.warning("Subscriptions in GetLazyUserData contained errors."),ht=ft.value,et!=="total"&&(ht=st),[2,{firstPageSubscriptions:{subscriptions:ot,subscriptionsMap:ut,countData:{value:ht,type:t.countTypeMap[et]},nextLink:r.nextLink},locations:l,recentResources:(y.status||"").toLowerCase()==="completedsuccess"?tt:undefined,serviceHealthAlerts:c}]}}))}))}function b(n){return __awaiter(this,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(u){switch(u.label){case 0:return c?[2,c]:(t=n.get(FxImpl.Features),i=t.isEnabled("settingsflyout")&&t.isEnabled("globalresourcefilter"),!i)?[2,c=Promise.resolve(!1)]:[4,n.getAsync(o.SettingsManager)];case 1:return r=u.sent(),[2,c=r.querySetting(19,"optedIn").then((function(n){return!!n}))]}}))}))}function k(n){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(){try{return[2,tt(n)]}catch(t){if(s.warning("Failed to load lazyUserData. Error details: "+MsPortalFx.getLogFriendlyMessage(t)),a<1)return a++,[2,k(n)];throw t;}return[2]}))}))}function it(n){return l?l:l=k(n)}var a,l;Object.defineProperty(t,"__esModule",{value:!0});t.DEV=t.lazyUserDataMemo=t.useGlobalResourceFilters=t.countTypeMap=void 0;var rt=r.Subscriptions.CountTypeEnum,v=MsPortalFx.Base,y=v.Diagnostics,h=y.Telemetry,d=window,s=y.createLog(n),g=FxImpl.features.isEnabled("cae"),p=!1,c;t.countTypeMap={total:1,partial:2,notabletocalculate:4};t.useGlobalResourceFilters=b;a=0;t.lazyUserDataMemo=it}));
define("MsPortalImpl/Services/Services.Subscriptions",["require","exports","Fx/Ajax","Fx/DependencyInjection","FxHubs/ArmHelpers/ArmApisStartup","FxHubs/HubsSettingsSchema","FxHubs/RpcEndPoints","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers","MsPortalImpl/Services/SubscriptionAndLocationHelpers","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Tenants","FxInternal/ResourceManagement/Subscriptions","FxInternal/AsyncLoader","Weave"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){"use strict";var it,d;Object.defineProperty(t,"__esModule",{value:!0});t.DEV=t.getInSessionDisplayedSubscriptionsHandler=t.getSubscriptionInfoHandler=t.getInSessionSelectedSubscriptionsObservableHandler=t.searchForSubscriptionsHandler=t.setInSessionSelectedSubscriptionsHandler=t.SubscriptionsUserContext=t.StartupSubscriptionsInfoProvider=t.ServicesSubscriptions=void 0;var st=e.Subscriptions.CountTypeEnum,ot=MsPortalFx.Base,rt=ot.Diagnostics,w=rt.Telemetry,g=MsPortalFx.Hubs.Notifications,k=MsPortalFx.require,ut=rt.createLog(n),ft=MsPortalFx.isFeatureEnabled("getselectedsubstelemetry"),tt=f.Keys.subscriptionsSelected,b=MsPortalFx.isFeatureEnabled("argsubscriptions")?parseInt(MsPortalFx.getFeatureValue("maxselectedsubs")||"1000"):100,nt=MsPortalFx.memoizeQ((function(){return k("MsPortalImpl/Services/Services.SubscriptionsDeferred")})),et=(function(){function t(n,t,i,r){var u=this;this._diContainer=n;this._authStateManager=i;this.globalSelectedSubscriptionsObservable=ko.observable([]);this.loadedSubscriptionsPromise=ko.observable();this.startupSubscriptionsInfoMemo=MsPortalFx.memoizeQ((function(){w.trace({source:"Services.Subscriptions",action:"startupSubscriptionsInfoMemo"});var n=Q(u._loadSubscriptions());return u.loadedSubscriptionsPromise(n),u.handleZeroSubsNotification=n.then((function(n){u.subscriptionsMap=n.subscriptionsMap;var i=n.countData.type===4,t=n.subscriptions.length,r=function(){var n=t===1?o.subscriptionErrorSingleSubscription:o.subscriptionErrorPluralSubscription,i=o.subscriptionErrorDescription.format(t,n);g.ClientNotification.publish({title:o.subscriptionErrorTitle,description:i,status:g.NotificationStatus.Warning})};if(t&&n.countData.value)i&&r();else return Q.spread([u._authStateManager.getUserInfo(),u._diContainer.get(a.TenantsService).getHomeTenantsCount(),],(function(n,t){return k("MsPortalImpl/Services/NoSubsChecks").then((function(f){return f.handleNoSubsInDirectory(u._diContainer,n,t,s.useGlobalResourceFilters(u._diContainer)).then((function(n){if(!n&&i)return r()}))}))}))})),n}));this.allSubscriptionsInfoMemo=MsPortalFx.memoizeQ((function(){return Q.spread([u.startupSubscriptionsInfoMemo(),s.useGlobalResourceFilters(u._diContainer),],(function(n,t){w.trace({source:"Services.Subscriptions",action:"allSubscriptionsInfoMemo",data:{nextLink:n.nextLink,startupSubsInfoCountData:n.countData,startupSubscriptionsInfoSubsCount:n.subscriptions.length}});var i;return n.nextLink&&!t?(i=Q(u._loadSubscriptions(n)),i.then((function(n){u.subscriptionsMap=n.subscriptionsMap}))):i=Q(__assign(__assign({},n),{countData:{type:1,value:n.subscriptions.length}})),u.loadedSubscriptionsPromise(i),i}))}));var e="ServicesSubscriptionsConstructor",l=function(){return __awaiter(u,void 0,void 0,(function(){var n;return __generator(this,(function(t){switch(t.label){case 0:return r.isEnabled("mspfilter")?[4,k("MsPortalImpl/Services/Services.ProjectedDirectories")]:[3,3];case 1:return n=t.sent(),[4,this._diContainer.getAsync(n.ServicesProjectedDirectories)];case 2:return[2,t.sent()];case 3:return[2,null]}}))}))},f=s.useGlobalResourceFilters(n),v=function(){return __awaiter(u,void 0,void 0,(function(){var i,n;return __generator(this,(function(r){switch(r.label){case 0:return[4,f];case 1:return(i=r.sent(),i)?[2]:[4,t.querySetting(6,tt)];case 2:return n=r.sent(),[2,(n===null||n===void 0?void 0:n.split(";"))||[]]}}))}))},c=function(n){return __awaiter(u,void 0,void 0,(function(){var ct,yt,it,y,s,pt,rt,c,ft,a,u,et,ot,st,p,lt,i,at,d,wt,bt,kt,ht,dt,vt;return __generator(this,(function(gt){switch(gt.label){case 0:return!n?(ct=this.startupSubscriptionsInfoMemo(),[3,3]):[3,1];case 1:return[4,nt()];case 2:yt=gt.sent();it=Q(yt.fetchSubscriptions(this._diContainer));this.loadedSubscriptionsPromise(it);this.startupSubscriptionsInfoMemo=MsPortalFx.memoizeQ((function(){return it}));ct=it;gt.label=3;case 3:return gt.trys.push([3,13,,14]),[4,Promise.all([ct,v(),l(),f,])];case 4:if(y=gt.sent(),s=y[0],pt=y[1],rt=y[2],c=y[3],ft=pt,c){if(s.countData.value===0)return[2,[]];ft=s.subscriptions.map((function(n){return n.subscriptionId}))}else w.trace({source:"Services.Subscriptions",action:e,data:{selectedSubscriptionsInSettingsCount:ft.length}});return(a=s.subscriptions,u=s.countData.value,et=s.countData.type,ot=c?a:a.filter((function(n){return ft.indexOf(n.subscriptionId)>=0})),st=!1,p=Promise.resolve(ot),!(!c&&rt))?[3,6]:[4,rt.getSubscriptionsForSelectedDirectories(ot)];case 5:return lt=gt.sent(),p=lt.length?Promise.resolve(lt):rt.getSubscriptionsForSelectedDirectories(a),[3,7];case 6:ot.length===0&&(w.trace({source:"Services.Subscriptions",action:"zeroValidSelectedSubscriptions"}),p=Promise.resolve(a.slice(0,b)),st=u>0&&et===2);gt.label=7;case 7:return[4,p];case 8:return(i=gt.sent(),!c&&i.length>=b&&(w.trace({source:"Services.Subscriptions",action:"cappedSelectedSubscriptions",data:{selectedSubscriptionsCount:i.length}}),i.length=b,st=u>b),st&&(at=function(n,t){g.ClientNotification.publish({status:g.NotificationStatus.Information,title:n,description:t,uri:"#menu/directory"})},d=o.SubscriptionsNotification,et===1?at(d.totalCappedTitle.format(b,u),d.totalSubscriptionsCapped.format(b,u)):et===2&&at(d.partialCappedTitle.format(u),d.partialSubscriptionsCapped.format(b,u))),wt=h.mergeSelectedSubscriptionsWithFirstPage(i,a,r.isEnabled("removesubsdropdownlimit")),!c&&i&&(w.trace({source:"Services.Subscriptions",action:"saveSelectedSubscriptions"}),bt=(i||[]).map((function(n){return n.subscriptionId})).join(";"),t.setSetting(6,tt,bt)),!r.isEnabled("subscreditcheck"))?[3,10]:[4,k("MsPortalImpl/Services/SubsCreditCheck")];case 9:kt=gt.sent();kt.checkRemainingCredit(i);gt.label=10;case 10:return!r.isEnabled("ci")?(ht=i.filter((function(n){return n.state.toLowerCase()==="pastdue"})),w.trace({source:"Services.Subscriptions",action:"pastDueSubsCheck",data:{pastDueSubsCount:ht.length}}),!ht.length)?[3,12]:[4,k("MsPortalImpl/Services/PastDueSubsCheck")]:[3,12];case 11:dt=gt.sent();dt.raiseWarningForPastDueSubs(this._diContainer,ht);gt.label=12;case 12:return this.globalSelectedSubscriptionsObservable(i),[2,wt];case 13:return vt=gt.sent(),w.trace({source:"Services.Subscriptions",action:e,data:{err:vt}}),ut.warning(MsPortalFx.getLogFriendlyMessage(vt)),[3,14];case 14:return[2]}}))}))};this.displayedSubscriptionsPromise=ko.observable(c(!1));f.then((function(n){n&&k("MsPortalImpl/Services/Services.GlobalResourceFilters").then((function(n){return u._diContainer.getAsync(n.ResourceFilterManager)})).then((function(n){var t=new FxImpl.TriggerableLifetimeManager;p.subscribe(t,[n.currentFilter],(function(){return __awaiter(u,void 0,void 0,(function(){var n,t,r,u,f,i;return __generator(this,(function(e){switch(e.label){case 0:return n=c(!0),this.displayedSubscriptionsPromise(n),[4,n];case 1:return!((i=e.sent())===null||i===void 0?void 0:i.length)?[4,Promise.all([this._authStateManager.getUserInfo(),this._diContainer.get(a.TenantsService).getHomeTenantsCount(),])]:[3,4];case 2:return t=e.sent(),r=t[0],u=t[1],[4,k("MsPortalImpl/Services/NoSubsChecks")];case 3:f=e.sent();f.handleNoSubsInDirectory(this._diContainer,r,u,Promise.resolve(!0));e.label=4;case 4:return[2]}}))}))}))}))}))}return t.prototype._loadSubscriptions=function(n){return __awaiter(this,void 0,void 0,(function(){var t,r,u,i,f,e,o;return __generator(this,(function(s){switch(s.label){case 0:return(n=n||{},!n.nextLink)?[3,3]:[4,nt()];case 1:return r=s.sent(),[4,r.loadAllSubscriptionsFromArm(n)];case 2:return t=s.sent(),[3,6];case 3:return s.trys.push([3,5,,6]),[4,this._diContainer.get(it).getSubscriptionsInfo()];case 4:return u=s.sent(),i=u.firstPageSubscriptions||{},f=i.subscriptions,e=__rest(i,["subscriptions"]),t=__assign(__assign({},e),{subscriptions:MsPortalFx.stableSort(f,h.compareSubscriptions)}),[3,6];case 5:return o=s.sent(),ut.warning("Error retrieving first page of subscriptions: \n"+MsPortalFx.getLogFriendlyMessage(o)),[2,{subscriptions:[],subscriptionsMap:{},countData:{type:0,value:0},nextLink:""}];case 6:return w.trace({source:"Services.Subscriptions",action:"_loadSubscriptions",data:{startupStubsNextLink:n.nextLink,subscriptionsCount:t.subscriptions.length,countData:t.countData,nextLink:t.nextLink}}),[2,t]}}))}))},__decorate([__metadata("fx:diagnostics",[n,"ServicesSubscriptions"]),r.Class(),__metadata("design:paramtypes",[r.Container,l.SettingsManager,c.AuthStateManager,FxImpl.Features])],t)})();t.ServicesSubscriptions=et;it=(function(){function t(n){this.getSubscriptionsInfo=function(){return s.lazyUserDataMemo(n)}}return __decorate([__metadata("fx:diagnostics",[n,"StartupSubscriptionsInfoProvider"]),r.Class(),__metadata("design:paramtypes",[r.Container])],t)})();t.StartupSubscriptionsInfoProvider=it;d=(function(){function t(n,t,i,r){var u=this,f,e;this._diContainer=n;this._servicesSubscriptions=t;this._settingsManager=i;this._features=r;f=new FxImpl.TriggerableLifetimeManager;t.displayedSubscriptionsPromise.subscribeAndRun(f,(function(n){u._inSessionDisplayedSubscriptionsPromise=u._globalDisplayedSubscriptionsPromise=n}));e=this._globalSelectedSubscriptions=t.globalSelectedSubscriptionsObservable;this.inSessionSelectedSubscriptions=ko.observable(e());t.loadedSubscriptionsPromise.subscribeAndRun(f,(function(n){u._loadedSubscriptionsPromise=n}));this.useGlobalResourceFiltersPromise=s.useGlobalResourceFilters(n);this._globalSelectedSubscriptions.subscribe(f,(function(n){u.inSessionSelectedSubscriptions(n)}))}return t.prototype.getAllSubscriptionsCount=function(){return this._loadedSubscriptionsPromise.then((function(n){return n.countData}))},t.prototype.getGlobalDisplayedSubscriptions=function(){return Q(this._globalDisplayedSubscriptionsPromise)},t.prototype.getInSessionDisplayedSubscriptions=function(){var n=this;return Q.spread([this.getAllSubscriptionsCount(),this._inSessionDisplayedSubscriptionsPromise,this.getGlobalSelectedSubscriptions(),],(function(t,i,r){return n._features.isEnabled("removesubsdropdownlimit")||t.value<=1e3?{subscriptions:i,isPartialSet:!1}:{subscriptions:r(),isPartialSet:!0}}))},t.prototype.getGlobalSelectedSubscriptions=function(){var n=this,t=ft?w.start({source:"Services.Subscriptions",action:"GetSelectedSubscriptions"}):"";return Q(this._globalDisplayedSubscriptionsPromise).then((function(){return ft&&w.completeTrace(t,{selectedSubscriptionsCount:n._globalSelectedSubscriptions().length}),n._globalSelectedSubscriptions}))},t.prototype.getInSessionSelectedSubscriptions=function(){var n=this;return Q(this._globalDisplayedSubscriptionsPromise).then((function(){return n.inSessionSelectedSubscriptions}))},t.prototype.setGlobalSelectedSubscriptions=function(n){var t=this;return Q(this.useGlobalResourceFiltersPromise).then((function(i){return i?Q.reject("Unable to set global selected subscriptions with feature.globalresourcefilter enabled"):t.processNewSelectedSubscriptions(MsPortalFx.convertArrayToMap(n,MsPortalFx.identity,(function(){return!0}))).then((function(n){var i,r;w.trace({source:"Services.Subscriptions",action:"setGlobalSelectedSubscriptions",data:{areAllSubsSelected:n.areAllSubsSelected,displayedSubscriptionsCount:n.displayedSubscriptions.length,selectedSubscriptionsCount:n.selectedSubscriptions.length,first100SubscriptionIds:n.selectedSubscriptions.slice(0,100).map((function(n){return n.subscriptionId}))}});t._globalDisplayedSubscriptionsPromise=Q(n.displayedSubscriptions);t._inSessionDisplayedSubscriptionsPromise=Q(n.displayedSubscriptions);i=n.selectedSubscriptions;t._globalSelectedSubscriptions(__spreadArray([],i));r=i.length===n.countData.value&&!t._features.isEnabled("argsubscriptions")?[]:i.slice(0,b);t._settingsManager.setSetting(6,tt,r.map((function(n){return n.subscriptionId})).join(";"))}))}))},t.prototype.setInSessionSelectedSubscriptions=function(n){var t=this;return this.processNewSelectedSubscriptions(MsPortalFx.convertArrayToMap(n,MsPortalFx.identity,(function(){return!0}))).then((function(n){w.trace({source:"Services.Subscriptions",action:"setInSessionSelectedSubscriptions",data:{areAllSubsSelected:n.areAllSubsSelected,displayedSubscriptionsCount:n.displayedSubscriptions.length,selectedSubscriptionsCount:n.selectedSubscriptions.length,first100SubscriptionIds:n.selectedSubscriptions.slice(0,100).map((function(n){return n.subscriptionId}))}});t._inSessionDisplayedSubscriptionsPromise=Q(n.displayedSubscriptions);t.inSessionSelectedSubscriptions(n.selectedSubscriptions)}))},t.prototype.getSubscriptionSearchResults=function(n){var t=this;return nt().then((function(i){return i.getSubscriptionSearchResults(n,t._servicesSubscriptions.allSubscriptionsInfoMemo())}))},t.prototype.getAllSubscriptionIds=function(){var n=this;return Q(this.useGlobalResourceFiltersPromise).then((function(t){var i=t?n._loadedSubscriptionsPromise:n._servicesSubscriptions.allSubscriptionsInfoMemo();return i.then((function(n){return{subscriptionIds:n.subscriptions.map((function(n){return n.subscriptionId})),allSubscriptionsCountData:n.countData}}))}))},t.prototype.getSubscription=function(n){var t=this;return n?this._loadedSubscriptionsPromise.then((function(r){return t._subscriptionsNameMap||(t._subscriptionsNameMap=MsPortalFx.convertArrayToMap(r.subscriptions,(function(n){return n.uniqueDisplayName}),(function(){return!0}))),MsPortalFx.memoizeQ((function(n){return Q(t._globalDisplayedSubscriptionsPromise).then((function(){var r=t._servicesSubscriptions.subscriptionsMap,f,e;return(r&&(f=(r[n]||{}).subscription),!f)?(e=u.getSubscriptionApi(n),i.batch({uri:e,type:"GET",setTelemetryHeader:"GetSubscription"}).then((function(n){var i=n.content,f=i.displayName,u=i.state&&i.state.toLowerCase()==="disabled"?o.disabledSubscriptionLabelFormat.format(f):f;return t._subscriptionsNameMap[f]&&(u=o.subscriptionNameAndIdLabelFormat.format(u,i.subscriptionId)),i.uniqueDisplayName=u,r[i.subscriptionId]={subscription:i,notInFirstPage:!1},t._subscriptionsNameMap[u]=!0,i}))):f})).catch((function(n){n=n||{};var r=n.content,t=n.httpStatusCode,i=MsPortalFx.Base.Diagnostics.createIgnoreUnhandledRejectionError(JSON.stringify({httpStatusCode:t,message:r||n}),(r||{}).stackTrace);i.httpStatusCode=t;[401,404,403].includes(t)&&(i.errorLevel=0);throw i;}))}))(n)})):Q.reject("Invalid subscription ID.")},t.prototype.processNewSelectedSubscriptions=function(n){var t=this;return nt().then((function(i){var r=t._servicesSubscriptions,u=t._features.isEnabled("removesubsdropdownlimit")?r.allSubscriptionsInfoMemo():r.startupSubscriptionsInfoMemo();return i.processSelectedSubscriptionChanges(t._diContainer,n,t._loadedSubscriptionsPromise,u,t.useGlobalResourceFiltersPromise)}))},__decorate([__metadata("fx:diagnostics",[n,"SubscriptionsUserContext"]),r.Class(),__metadata("design:paramtypes",[r.Container,et,l.SettingsManager,FxImpl.Features])],t)})();t.SubscriptionsUserContext=d;t.setInSessionSelectedSubscriptionsHandler=y.defineHandler(FxImpl.Azure.setInSessionSelectedSubscriptionsEndPoint,(function(n){return n.diContainer.get(d).setInSessionSelectedSubscriptions(n.messageArg)}));t.searchForSubscriptionsHandler=y.defineHandler(FxImpl.Azure.searchForSubscriptionsEndPoint,(function(n){return n.diContainer.get(d).getSubscriptionSearchResults(n.messageArg)}));t.getInSessionSelectedSubscriptionsObservableHandler=y.defineHandler(v.getInSessionSelectedSubscriptionsObservableEndPoint,(function(n){return n.diContainer.get(d).getInSessionSelectedSubscriptions()}));t.getSubscriptionInfoHandler=y.defineHandler(FxImpl.Azure.getSubscriptionInfoEndPoint,(function(n){return n.diContainer.get(d).getSubscription(n.messageArg)}));t.getInSessionDisplayedSubscriptionsHandler=y.defineHandler(e.Subscriptions.getInSessionDisplayedSubscriptionsEndPoint,(function(n){return n.diContainer.get(d).getInSessionDisplayedSubscriptions()}))}));
define("MsPortalImpl/UI/UI.BladeOpener",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader"],(function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BladeOpener=void 0;var u=r.getFactory("MsPortalImpl/UI/UI.BladeOpenerImpl","BladeOpener"),f=(function(){function t(n){this._diContainer=n}return t.prototype.openBlade=function(n,t){return t===void 0&&(t={}),this._diContainer.getAsync(u()).then((function(i){return i.openBlade(n,t)}))},__decorate([__metadata("fx:diagnostics",[n,"BladeOpener"]),i.Class(),__metadata("design:paramtypes",[i.Container])],t)})();t.BladeOpener=f}));
define("MsPortalImpl/UI/UI.NavigationManager.ForceSignIn",["require","exports","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u,f){"use strict";function s(n){var t=Object.create(null);return Object.keys(n).forEach((function(i){(i==="acr_values"||i==="amr_values"||i==="claims")&&(t[i]=n[i])})),t}function h(n,t,h){return __awaiter(this,void 0,void 0,(function(){var d,y,p,l,w,a,c,v,b,k;return __generator(this,(function(g){switch(g.label){case 0:return d=o.startTrace({source:"UI.NavigationManager",action:"ForceSignInHandler"}),y=n.get(i.AuthStateManager),[4,y.getUserInfo()];case 1:return p=g.sent(),MsPortalImpl.sessionStorage.setItem("forceSignIn_previousSessionId",MsPortalFx.sessionId),l={callingExtension:h,reason:t.reason,tenantSource:"Options"},w=y.getSignedInUserTenant(),a=t.tenantId,a?a.toLowerCase()!==w.toLowerCase()&&(l.newTenantId=a):(a=w,l.tenantSource="Current"),c=new MsPortalFx.Base.UriBuilder(fx.environment.applicationPath),c.setRelativePath(c.getRelativePath()+"/"+a),t.bladeDeepLink?c.fragment=MsPortalFx.sanitizeMessage(t.bladeDeepLink):t.bladeReference&&(v=t.bladeReference,b=u.getBladeDeepLink(v.extensionName,v.bladeName,v.parameters),l.deepLink=MsPortalFx.sanitizeMessage(b),c.fragment=b),c.query=new e.QueryStringBuilder(f.getQueryStringSegment(location.href)),c.query.setParameter("loginHint",MsPortalFx.isFeatureEnabled("preferredusername")?p.preferredUsername:p.email),c.query.setParameter("forcesignin","true"),t.signInParameters&&(k=s(t.signInParameters),c.query.setParameter("signInParameters",JSON.stringify(k)),l.providedSignInParameters=Object.keys(t.signInParameters),l.effectiveSignInParameters=Object.keys(k)),o.completeTrace(d,l),n.get(r.WindowManager).redirect({uri:c.toString(),redirectAction:3,reason:"forceSignIn"}),[2]}}))}))}Object.defineProperty(t,"__esModule",{value:!0});t.forceSignIn=void 0;var e=MsPortalFx.Base,o=e.Diagnostics.Telemetry;t.forceSignIn=h}));
define("MsPortalImpl/AzFramework/AzHost",["require","exports","Fx/Controls/Toolbar","Fx/Composition/Selectable","FxInternal/AsyncLoader","FxInternal/Controls/Essentials","FxHubs/RpcEndPoints","MsPortalFx/Globalization","MsPortalImpl/RpcEndPoints","MsPortalImpl/AzFramework/AzExtensionCore","MsPortalImpl/Services/Services.ArmEvents","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/Services/Services.Tenants","MsPortalImpl/Services/Services.PersistentStorage","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.Permissions","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/UI/UI.BladeOpener","MsPortalImpl/UI/UI.NavigationManager.ForceSignIn","MsPortalImpl/Services/Services.PortalIdleState"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d){"use strict";function ct(n){function bt(n,t){ut(1001,{stubId:n,args:t})}function ei(n){var i=n.bladeName,u=n.extensionName,f=n.parameters,y=n.marketplaceId,s=n.onClosed,o=n.referenceType,h=n.initialData,c=n.providerConfig,l=n.receiveResult,p=n.menuId,a=n.contentBladeReference,e=ii(s)&&function(n,t){bt(s,[n,t])},t,v;return o===1?t=new r.ParameterProviderBladeReference(i,u,{parameters:f,onClosed:e,supplyInitialData:h&&function(){return FxImpl.fromSerializableObject(h)},supplyProviderConfig:c&&function(){return c},receiveResult:ii(l)&&function(n){bt(l,[n&&FxImpl.toSerializableObject(n)])}}):o===2?(v=a&&ei(a),t=new r.MenuBladeReference(i,p,u,{contentBladeReference:v,parameters:f,onClosed:e})):t=o===3?new r.ProvisioningBladeReference(i,u,y,{parameters:f,onClosed:e}):new r.PdlBladeReference(i,u,{parameters:f,onClosed:e}),FxImpl.shellInterface(t,FxImpl.shellInterface(n)),t}function oi(n){return{bladeName:n.bladeName,extensionName:n.extensionName,parameters:n.parameters}}function fu(n){function t(){return MsPortalFx.find(or,(function(t){return t.name===n.name}))}var r=n.type,i,u;switch(r){case 4:return new nt.CommandButton({name:n.name,command:{canExecute:ko.observable(),execute:function(){var n=t();return bt(n.execute),Q()}}});case 2:return i=new nt.OpenLinkButton({name:n.name,uri:""}),i.clickableLink.onLinkOpened=function(){var n=t();bt(n.clickableLink.onLinkOpened)},i;case 12:return new nt.Separator;case 6:return u=n,new nt.ToggleButton({name:n.name,optionGroupName:u.optionGroupName,command:{canExecute:ko.observable(),execute:function(n){var i=t();return bt(i.execute,[n.checked]),Q()}}});case 1e3:return ft.ToolbarItems.createFeedbackButton(h,{onButtonClicked:function(n){var i=t();bt(i.onButtonClicked,[n])},telemetryName:n.telemetryName});default:throw new Error("Unsupported toolbar item - "+r+".");}}function eu(n){var i=n.uri,r=n.target,t=n.onLinkOpened;return{uri:ko.observable(i),target:ko.observable(r),onLinkOpened:ii(t)&&function(n){return bt(t,[n])}}}function ou(n){var t=n.buttons,r=n.defaultButton,i=n.onClosed;return MsPortalFx.extend2(n,{buttons:typeof t=="number"&&t||Array.isArray(t)&&t.map((function(n){var t=n.displayText,i=n.button;return{displayText:t,button:i}}))||null,defaultButton:r,onClosed:ii(i)&&function(n){bt(i,[n])}})}function gt(n,t){ut(1003,{responseStubId:n.responseStubId,response:{result:t}})}function i(n,t){g.Promises.cancelOnDispose(yi,n).then((function(n){return gt(t,n)})).catch((function(n){ct.isDisposed()||ut(1003,{responseStubId:t.responseStubId,response:{error:yt(n)}})}))}function su(){var n=ir.currentTheme,t=ir.highContrastMode,i=n();return{mode:i.mode,highContrastMode:t()}}function sr(n){var u=n.inContextPane,r=n.fromMenu,t=n.options,i;return(t===null||t===void 0?void 0:t.asNewJourney)?i|=8:u?(i|=1,i|=ur&&4):r&&(i|=r&&4),i|=(t===null||t===void 0?void 0:t.asSubJourney)&&2,i^(ur&&16)}function hu(){var r=FxImpl.internalEnv.extensionTelemetryUri,u=FxImpl.internalEnv.extensionTraceUri,n=MsPortalFx.sessionId,f=MsPortalFx.extend2(FxImpl.getStandardHeaders(ot,pr),{"Accept-Language":o.displayLanguage,"x-ms-effective-locale":FxImpl.Intl.effectiveLocale,"x-ms-client-session-id":n}),t=ko.computed(ct,(function(){return su()})),i;return t.subscribe(ct,(function(n){return ut(1004,{theme:n})})),i=rr,{parameters:yr,sessionId:n,diagnostics:{telemetryContext:ti,headers:f,telemetryUri:r,loggingUri:u},features:i,theme:t()}}function lr(n,i){li&&li[n]&&li[n]();var r=t.get(n);r?r(i):ht.error("Handler["+n+"] is undefined")}var hi=this,ct=n.lifetime,vr=n.getToken,yr=n.parameters,nr=n.defaultTokenPromise,ni=n.telemetryContextState,h=n.container,ci=n.initializedDeferred,li=n.onMessageReceived,wt=n.viewModel,ot=n.extensionName,pr=n.extensionVersion,e=n.diContainer,wr=n.selectedSubscriptions,tr=n.getUserInfo,br=n.contentRevealedDeferred,ir=n.theme,rr=n.features,kr=n.router,dr=n.redirectBaseUri,gr=n.provisioningContext,kt=n.isReactView,ui=n.extensionStorage,nu=n.getSafeLink,ai=n.setContextPaneWidth,ur=n.inContextPane,ti=ni&&FxImpl.TelemetryContext.usingState((function(){return FxImpl.TelemetryContext.getCurrentValues()}),ni),fi=wr,or,yi,pi,hr,cr,t,wi,si,bi,pt,ri,ki,di,ar;if(!fi){var fr=e.get(l.SubscriptionsUserContext).getInSessionSelectedSubscriptions(),tu=function(){return fr.then((function(n){return n()}))},iu=fr;fi={get:tu,onChangedPromise:iu}}var vi=vt(),ru=vi.registerFunction,uu=vi.callRegisteredFunction,ii=vi.validStubId,er=[],ut=(function(){function n(n,t){er.push({kind:n,data:t})}return n})();yi=new FxImpl.TriggerableLifetimeManager;pi=(function(){var n=[];return{request:function(t){var s=t.bladeReferenceStubId,u=t.fromMenu,f=n[s]=Q.defer(),o=f.promise,c=sr(t),r;u&&(o=f.promise.then((function(n){var t=n.options.onClosed;return n.options.onClosed=function(n,i){gi();t(n,i)},n})));r=e.get(b.BladeOpener).openBlade(o,{container:h,flags:c,telemetryName:"AzHost"});u&&r.then(dt);i(r,t)},response:function(t){var i=t.responseStubId,r=t.response;rt(n[i],r,ei)}}})();fi.onChangedPromise.then((function(n){return n.subscribe(ct,(function(n){ut(1005,{subscriptions:n})}))}));e.get(c.ArmEvents).subscribeToArmEvent({status:"succeeded"},(function(n){return ut(1030,n)}));hr=nr&&g.Promises.cancelOnDispose(ct,nr).then((function(n){return{result:n}})).catch((function(n){return{error:n}}));cr=g.Promises.cancelOnDispose(ct,tr?tr():e.get(w.AuthStateManager).getUserInfo()).then((function(n){return{result:n}})).catch((function(n){return{error:n}}));t=new Map;wi=function(){ut(1,hu());hr.then((function(n){return ut(2,{token:n})}));cr.then((function(n){return ut(4,{userInfo:n})}))};kt?(t.set(1042,(function(){var n=window.location.hash;window.location.hash="#home";setTimeout((function(){return window.location.hash=n}))})),wi()):t.set(0,wi);t.set(1e3,(function(n){n.forEach((function(n){return lr(n.kind,n.data)}))}));t.set(1010,(function(){br.resolve();h.revealContent()}));t.set(1011,(function(){return ci.resolve()}));t.set(1012,(function(n){var t=n&&n.title,i=n&&n.subtitle;wt.title(t);wt.subtitle(i)}));kt||t.set(1013,(function(){var n;return function(t){var i=t.indicator,r,u;i&&i!==0?(n||(n=Q.defer(),h.operations.add(n.promise)),r=i===2||i===3,u=i===2?0:i===3?1:null,h.operations.update(n.promise,{blockUi:r,shieldType:u})):n&&(n.resolve(),n=null)}})());t.set(1014,(function(n){var o=n.bladeReference,u=n.fromMenu,t=ei(o),s=sr(n),f,r;u&&(f=t.options.onClosed,t.options.onClosed=function(n,t){gi();f(n,t)});r=e.get(b.BladeOpener).openBlade(t,{container:h,flags:s,telemetryName:"AzHost"});u&&r.then(dt);i(r,n)}));t.set(1015,pi.request);t.set(1016,pi.response);t.set(1028,(function(){window.location.hash="#menu/directory"}));t.set(3006,(function(n){i(Q(MsPortalFx.require("FxInternal/ResourceManagement/ResourceGroups").then((function(t){var i=t.getArmResourceGroups;return i(n.subscriptionIds)}))),n)}));t.set(3007,(function(n){var t=Q(e.get(p.PermissionsManager).hasPermission("/subscriptions/"+n.subscriptionId,["Microsoft.Resources/subscriptions/resourcegroups/write"],g.Constants.Shell).then((function(t){return MsPortalFx.ViewModels.getValidationResult(t?undefined:MsPortalFx.Resources.Strings.ResourceGroup.Validation.subscriptionHasNoPermissionsMessage.format(n.subscriptionId))})));i(Q(MsPortalFx.Azure.ResourceGroups.validateResourceGroupName(n.resourceGroupName,n.subscriptionId,n.existingResourceGroupNames,undefined,t)).then((function(n){return{valid:n.valid,message:n.message}})),n)}));t.set(3004,(function(n){var t=MsPortalFx.require("FxInternal/Controls/Essentials").then((function(t){var i=t.getEssentialsResourceInfo;return i(h,n.resourceId,n.includeTags)}));i(t,n)}));t.set(3025,(function(n){var t=MsPortalFx.Assets.mapResourceIdToBladeReference(n.resourceId).then((function(n){return oi(n)}));i(t,n)}));t.set(3026,(function(n){var t=new f.TagResourcesBladeReference(n);i(Q(oi(t)),n)}));t.set(3028,(function(n){var t=new f.EditTagsBladeReference({resource:n.resourceId,tagName:n.tagName});i(Q(oi(t)),n)}));t.set(3042,(function(n){var t=Q.defer();MsPortalFx.require("FxHubs/ArmHelpers/ArmTags").then((function(i){i.handleTagsContextPaneResults(n.resourceToTagsMap).then((function(i){if(i.armErrorsMap.get(n.resourceId))t.resolve();else{var r=i.newTagsMap.get(n.resourceId),u=Object.keys(r).map((function(n){return{key:n,value:r[n]}}));t.resolve(u)}}))}));i(t.promise,n)}));t.set(3027,(function(n){var t=rr.moveresourcesreact?"MoveResources.ReactView":"MoveResourceBlade",r={extensionName:"HubsExtension",bladeName:t,parameters:n};i(Q(r),n)}));t.set(3029,(function(n){var t=new r.PdlBladeReference("RmAddResourceWizardBlade","Microsoft_Azure_ResourceMove",{parameters:n});i(Q(oi(t)),n)}));t.set(1017,(function(n){i(h.closeChildBlade(),n)}));t.set(1018,(function(n){i(h.closeContextBlade(),n)}));t.set(1019,(function(n){var r=n.partReferences,t=n.options,u=MsPortalFx.require("Fx/Pinner").then((function(n){var i=n.pin;return i(r.map(tt),{notify:t&&t.notify})}));i(u,n)}));t.set(1020,(function(n){h.fail(n);ci.reject();dt()}));t.set(1023,(function(n){h.noDataMessage(n);dt()}));t.set(1021,(function(n){h.notFound(n);dt()}));t.set(1022,(function(n){var t=typeof n=="string"?n:lt(n);h.unauthorizedMessage(t);dt()}));kt||t.set(1024,(function(n){i(h.openDialog(ou(n)),n)}));t.set(1025,(function(n){var f=n.status,e=n.title,o=n.description,s=n.descriptionAsHtml,h=n.correlationIds,c=n.percentComplete,t=n.linkTo,i={status:f,title:e,description:o,descriptionAsHtml:s,correlationIds:h,percentComplete:c};if(t)if(typeof t=="string")i.uri=t;else if(t.assetId){var r=t,l=r.extensionName,a=r.assetType,v=r.assetId;i.asset={extensionName:l,assetType:a,assetId:v}}else{var u=t,y=u.extensionName,p=u.bladeName,w=u.parameters;i.linkedBlade={detailBlade:p,extension:y,detailBladeInputs:w||{}}}et.ClientNotification.publish(i)}));t.set(1003,uu);t.set(1006,(function(n){var t=n.resourceName,r=vr(t&&{resourceName:t});i(r,n)}));t.set(1007,(function(n){i(fi.get(),n)}));t.set(3055,(function(n){MsPortalFx.UI.AssetManager.notifyResourceDeleted(n.resourceId)}));si=null;bi=function(){if(!si){var n=Q.defer();e.get(l.SubscriptionsUserContext).getInSessionDisplayedSubscriptions().then((function(t){return n.resolve(t.subscriptions)}));si=n.promise}return si};t.set(3001,(function(n){i(bi(),n)}));t.set(3002,(function(n){var t=Q.defer(),r=n.subscriptions.reduce((function(n,t){return(n[t.subscriptionId]=!0)&&n}),{});bi().then((function(n){var i=n.map((function(n){return n.subscriptionId})).filter((function(n){return r[n]}));e.get(l.SubscriptionsUserContext).setInSessionSelectedSubscriptions(i).then((function(){return t.resolve(!0)}))}));i(t.promise,n)}));t.set(3015,(function(n){i(Q(FxImpl.Azure.getLocationsForCreate(FxImpl.Rpc.client,{subscriptionId:n.subscriptionId,resourceTypes:n.resourceTypes}).then((function(n){return n}))),n)}));t.set(3037,(function(n){i(Q(e.get(v.PersistentStorageSettings).writeSetting(ot,n.key,n.value,n.readers)),n)}));t.set(3038,(function(n){var t;i(Q(e.get(v.PersistentStorageSettings).readSettings((t=n.extensionName)!==null&&t!==void 0?t:ot,n.keys,ot)),n)}));t.set(3039,(function(n){i(Q(e.get(v.PersistentStorageSettings).removeSettings(ot,n.keys)),n)}));t.set(3040,(function(n){i(Q(e.get(v.PersistentStorageSettings).clear(ot)),n)}));t.set(3041,(function(n){i(Q(e.get(v.PersistentStorageSettings).getAllSettingsKeys(ot)),n)}));t.set(3018,(function(n){i(e.get(y.AssetTypeService).getResourceTypeAssetTypeInformation(n.resourceTypes),n)}));t.set(3019,(function(n){i(e.get(l.SubscriptionsUserContext).getSubscription(n.subscriptionId),n)}));t.set(1026,(function(n){var t=n.dashboardId;kr.navigateToDashboard(t)}));kt||t.set(1027,(function(n){var t=n.baseUri;dr(t)}));t.set(3043,(function(n){if(s.extensionsAllowedToForceSignIn.includes(ot)){var r=n.reason,t=n.bladeReference,u=n.signInParameters,f=n.tenantId,o=t&&ei({extensionName:t.extensionName,bladeName:t.bladeName,parameters:t.parameters,referenceType:null,menuId:null}),h=k.forceSignIn(e,{bladeReference:o,reason:r,signInParameters:u,tenantId:f},ot);i(Q(h),n)}else i(Q.reject("The extension '"+ot+"' is not whitelisted to access the 'forceSignIn' API."),n)}));t.set(1029,(function(n){i(MsPortalFx.require("MsPortalImpl/Base/Base.ImageHelper").then((function(t){var i=t.GetImageData;return i({type:n.type,options:{symbol:!0}},{bypassCache:!0})})).then((function(n){return n.map((function(n){return n.outerHTML})).join("")})),n)}));t.set(3020,(function(n){i(MsPortalFx.require("Fx/Assets/AssetTypes").then((function(n){var t=n.getAllAssetTypes;return t()})),n)}));t.set(3005,(function(n){i(e.get(a.TenantsService).getTenants().then((function(n){return n.tenants})),n)}));t.set(2e3,(function(n){var i=wt.icon(),t=it(n.iconUri);i&&t&&i.data===t.data||wt.icon(t)}));t.set(2001,(function(n){var t=n.stubId,i=ii(t)?function(){var n=Q.defer();return ut(1002,{stubId:t,responseStubId:ru((function(t){rt(n,t,tt)}),!0)}),g.Promises.cancelOnDispose(ct,n.promise)}:null;wt.setOnPinHandler(i)}));pt={};t.set(3008,(function(n){var t=MsPortalFx.require("FxInternal/Composition/ViewModelAdapters.DoesProvisioning").then((function(n){var t=n.setProvisioning,i=n.policyExperimentFlag;return __awaiter(hi,void 0,void 0,(function(){var n,r;return __generator(this,(function(u){switch(u.label){case 0:return n=t,r=[pt,gr,h,FxImpl.TelemetryContext.usingState((function(){return FxImpl.TelemetryContext.getCurrentValue(FxImpl.TelemetryContext.ContextType.Blade)}),ni)],[4,i()];case 1:return n.apply(void 0,r.concat([u.sent()])),[2,{initialValues:pt.initialValues,marketplaceItem:pt.marketplaceItem,resourceGroupName:pt.resourceGroupName,telemetryId:pt.telemetryId}]}}))}))}));i(t,n)}));t.set(3009,(function(n){i(pt.validateTemplate(n),n)}));ri=Object.create(null);t.set(3010,(function(n){var t=pt.deployTemplate(n),r=Q.defer(),u=MsPortalFx.getUniqueId();ri[u]=r;t.finally((function(){return setTimeout(r.resolve,5e3)}));i(t,n)}));t.set(3011,(function(n){var t=Q.defer(),i=MsPortalFx.getUniqueId();ri[i]=t;pt.deployCustom({provisioningPromise:t.promise});gt(n,i)}));t.set(3012,(function(n){ri[n.deploymentId].resolve()}));t.set(3013,(function(n){var t=pt.getArmErrorsBladeReference(n);gt(n,{bladeName:t.bladeName,extensionName:t.extensionName,parameters:t.parameters})}));t.set(3014,(function(n){var t=pt.getAutomationBladeReference(n);gt(n,{bladeName:t.bladeName,extensionName:t.extensionName,parameters:t.parameters})}));t.set(3016,(function(n){ci.resolve(n)}));t.set(3017,(function(n){i(MsPortalFx.require("MsPortalImpl/UI/UI.LinkHandler").then((function(t){var i=t.getUriAndHandler(ct,e,n,!1);return i.uriPromise?i.uriPromise().then((function(){return FxImpl.ensureAbsoluteUri(i.uri())})):FxImpl.ensureAbsoluteUri(i.uri())})),n)}));kt||t.set(2002,(function(n){wt.commandBar||(wt.commandBar=new nt.Toolbar(ct));var t=wt.commandBar,i=t.items(),r=or=n,u=r.map((function(n){var t=n.name&&MsPortalFx.find(i,(function(t){return t instanceof nt.ToolbarItem&&t.name===n.name}));return t||(t=fu(n)),at(n,t),t}));t.setItems(u)}));t.set(2003,(function(n){i(h.closeCurrentBlade(n.returnedData),n)}));kt||t.set(2004,(function(n){var t=n,i=t&&{text:t.text,state:t.state,onClick:typeof t.onClick=="number"?function(){return bt(t.onClick)}:t.onClick&&eu(t.onClick)};wt.statusBar(i)}));t.set(2005,(function(n){var t=n.id;h.menu.switchItem(t)}));t.set(2006,(function(n){var i=n&&n.title,r=n&&n.subtitle,t=wt.menuContent;t.title(i);t.subtitle(r)}));t.set(2007,(function(n){n?h.form.configureAlertOnClose(ko.observable(n)):h.form.configureAlertOnClose(1)}));t.set(3030,(function(n){var r=new MsPortalFx.Base.UriBuilder(n.url),t;r.getAuthority().includes(FxImpl.origin)||(t=window.fetch(n.url,{headers:new Headers(n.headers),method:n.method,body:n.body}).then((function(n){var t={};return n.headers.forEach((function(n,i){t[i]=n})),n.text().then((function(i){return{responseHeaders:t,responseText:i,status:n.status}}))})),i(Q(t),{responseStubId:n.responseStubId}))}));ki=e.get(d.PortalIdleStateService);t.set(3052,(function(){return ki.signalBusy(1)}));t.set(3051,(function(){return ki.signalIdle(1)}));kt&&(t.set(3021,(function(n){ui.setItem(n)})),t.set(3022,(function(n){ui.removeItem(n)})),t.set(3023,(function(n){ui.clear(n)})),t.set(3031,(function(n){i(Q({uri:nu(n.uri,ot)}),n)})),t.set(3035,(function(n){["keyup","keydown"].includes(n.type)&&window.document.dispatchEvent(new KeyboardEvent(n.type,n.event))})),t.set(3044,(function(n){ai===null||ai===void 0?void 0:ai(n)})),t.set(3045,(function(n){i(st.invoke(FxImpl.Rpc.client,"HubsExtension",{}),n)})),t.set(3047,(function(n){MsPortalFx.require("Fx/ResourceManagement").then((function(t){return t.addRecentResource(n)}))})),t.set(3048,(function(n){var t=e.getAsync(u.get("MsPortalImpl/UI/UI.SupportContext","SupportContext")).then((function(t){return t.hasMenuItem(n.menuId)}));i(t,n)})),t.set(3049,(function(n){var t;gt(n,(t=window.location.hash)===null||t===void 0?void 0:t.replace("#",""))})),t.set(3050,(function(n){g.Diagnostics.Telemetry.trace({name:ti===null||ti===void 0?void 0:ti.Blade.id,source:"AzHost",action:"ReactViewReady",actionModifier:"complete",extension:ot,data:n.entries,duration:n.duration,context:ti})})),t.set(3053,(function(n){di=n})),t.set(3057,(function(n){return __awaiter(hi,void 0,void 0,(function(){var t;return __generator(this,(function(i){switch(i.label){case 0:return[4,e.getAsync(u.get("MsPortalImpl/UI/UI.HelpPane","HelpPane"))];case 1:return t=i.sent(),t.open(),gt(n,undefined),[2]}}))}))})),ar=ui.registerChangeListener((function(n){return ut(3024,n)})),ct.registerForDispose({dispose:function(){ar()}}));var dt=MsPortalFx.noop,gi=MsPortalFx.noop,cu=function(n){var r=n.setOnMessage,i=n.reactViewOptions;if(ut=n.postMessage,i){var u=i.dispose,f=i.onUnloaded,e=i.hide,o=i.show;t.set(3034,(function(){u();yi.dispose()}));t.set(3054,(function(){return __awaiter(hi,void 0,void 0,(function(){return __generator(this,(function(n){switch(n.label){case 0:return[4,Q.delay(1e3)];case 1:return n.sent(),f(),di&&ni&&FxImpl.TelemetryContext.usingState((function(){var n;MsPortalFx.Base.Diagnostics.Telemetry.trace({extension:ot,source:"Shell",action:"BladeLighthouse",actionModifier:"complete",data:di,name:(n=MsPortalFx.Base.Diagnostics.Telemetry.Context.getBladeContext())===null||n===void 0?void 0:n.id})}),ni),[2]}}))}))}));dt=e;gi=o;ct.registerForDispose({dispose:function(){var n=[];MsPortalFx.forEachKey(ri,(function(t,i){return n.push(i.promise)}));Q.allSettled(n).finally((function(){ut(3033)}))}})}r(lr);er.forEach((function(n){return ut(n.kind,n.data)}))},lu=function(){ut(3046)},au=function(){ut(3056)};return{initialize:cu,toggleDevTools:lu,togglePerfTools:au}}function tt(n){var t=n,e=t.extensionName,o=t.partName,s=t.parameters,i=t.initialSize,h=t.resourceId,r,u,f;return h?n:(typeof i=="number"?r=i:i&&(r=99,u=i.height,f=i.width),new ot(o,s||{},{extensionName:e,initialSize:r,initialHeight:u,initialWidth:f}))}function lt(n){var t=n.header,i=n.title,r=n.description,u=n.callToActionText,f=n.callToActionUri,e=n.imageType;return{noticeHeader:t,noticeTitle:i,noticeDescription:r,noticeCallToActionText:u,noticeCallToActionUri:f,noticeImageType:e}}function it(n){return n&&h.isValidUri(n)?g.Images.ImageUri(n):null}function at(n,t){var i,r,f,h,e,o,u,s;if(n.type!==12&&n.type!==1e3){i=n;r=t;r.ariaLabel(i.ariaLabel);r.disabled(i.disabled);f=it(i.iconUri);MsPortalFx.deepEquals(f,r.icon())||r.icon(f);r.label(i.label);r.tooltip(i.tooltip);r.unauthorizedMessage(i.unauthorizedMessage);switch(n.type){case 4:h=r;h.command.canExecute(!i.disabled);break;case 2:e=r;o=i;e.clickableLink.uri(o.clickableLink.uri);e.clickableLink.target(o.clickableLink.target);break;case 6:if(u=r,s=i,u.command.canExecute(!i.disabled),u.checked(s.checked),u.optionGroupName!==(s.optionGroupName||""))throw new Error("Can't modify 'optionGroupName' dynamically.");}}}function vt(){function r(t,r){if(t){var f=i++;return n[f]=r?function(){u(f);t.apply(null,arguments)}:t,f}}function u(i){t(i)&&delete n[i]}function f(t){var i=t.responseStubId,r=t.response,u=n[i];u.call(null,r)}function t(n){return typeof n=="number"}var i=1,n={};return{registerFunction:r,callRegisteredFunction:f,validStubId:t}}function rt(n,t,i){"result"in t?n.resolve(i(t.result)):n.reject(new Error(t.error))}function yt(n){var t;try{t=JSON.stringify(n,(function(n,t){var i=t;return t instanceof Error&&(i={message:t.message,stack:t.stack,isError:!0}),i}))}catch(i){t="<Failed to serialize error>"}return t}Object.defineProperty(t,"__esModule",{value:!0});t.create=void 0;var g=MsPortalFx.Base,ut=MsPortalFx.ViewModels,nt=ut.Toolbars,ft=i,et=MsPortalFx.Hubs.Notifications,ot=MsPortalFx.Composition.PartReference,st=e.AssetTypes.getRecentResourcesEndPoint,ht=g.Diagnostics.createLog(n);t.create=ct}));
define("MsPortalImpl/Base/Base.Events",["require","exports"],(function(n,t){"use strict";function r(){var n=document;return!!(n.fullscreenElement||n.webkitFullscreenElement||n.mozFullScreenElement||n.msFullscreenElement)}function u(){var n=document,t=n.exitFullscreen||n.webkitExitFullscreen||n.mozCancelFullScreen||n.msExitFullscreen;t&&t.call(n)}function f(){var n=document.documentElement,t=n.requestFullscreen||n.webkitRequestFullscreen||n.mozRequestFullScreen||n.msRequestFullscreen;t&&t.call(n)}function i(n){return n._handle}function e(n,t){var r=MsPortalFx.find(t(),(function(t){return i(t)===n}));return r||(r={_handle:n},t.push(r)),r}Object.defineProperty(t,"__esModule",{value:!0});t.CustomEvents=t.getOrCreateFxElement=t.unwrapFxElement=t.requestFullscreen=t.exitFullscreen=t.isFullscreen=t.fullscreen=t.fxpinmultipleparts=void 0;t.fxpinmultipleparts="fxpinmultipleparts";t.fullscreen="fullscreenchange MSFullscreenChange mozfullscreenchange webkitfullscreenchange";t.isFullscreen=r;t.exitFullscreen=u;t.requestFullscreen=f;t.unwrapFxElement=i;t.getOrCreateFxElement=e;var o=(function(){function n(){this._events=new Map}return n.prototype.setElement=function(n){var t=this;this._element=n;this._events.forEach((function(n,i){n.forEach((function(n){t._setEvent(i,n)}))}))},n.prototype._setEvent=function(n,t){if(t.ltm){if(t.ltm.isDisposed&&t.ltm.isDisposed())return;t.ltm.registerForDispose([this._element.setEvents([n,t.callback,]),])}else this._element.setEvents([n,t.callback,])},n.prototype.trigger=function(n,t){if(this._element){var i=$.Event(n);return i.type=n,i.target=this._element[0],this._element.trigger(i,t),i.isDefaultPrevented()}},n.prototype.addHandler=function(n,t,i){this._events.has(t)||this._events.set(t,[]);var r={ltm:n,callback:i};this._events.get(t).push(r);this._element&&this._setEvent(t,r)},n.prototype.removeHandler=function(n,t){if(this._events.has(n)){var i=this._events.get(n);i.filter((function(n){return n.callback===t?!0:!1})).forEach((function(n){i.remove(n)}))}},n})();t.CustomEvents=o}));
define("MsPortalImpl/Base/Base.FeatureDetection",["require","exports"],(function(n,t){"use strict";function e(n){return FxImpl.createElement("div",n)}function h(){if(!i){for(var u=1e8,t=1e4,r=$(e({"class":"fxs-detect-maxheight",style:"position:fixed;right:-10px;bottom:-10px;width:10px"})).appendTo("body"),n=void 0,f=void 0;(f=u-t)>10;)n=0|t+f/2,r.height(n),n===(0|r.height())?t=n:u=n-1;i=t;r.remove()}return i}function o(){var t=$(e({style:"position:fixed;right:-1000px;bottom:-1000px;width:100px;height:100px;overflow:scroll"})).appendTo("body"),n=t[0];u=n.offsetWidth-n.clientWidth;r=n.offsetHeight-n.clientHeight;t.remove()}function c(){return u||o(),u}function l(){return r||o(),r}function a(){if(f===undefined){f=!1;var n=e();n.addEventListener("focus",(function(n){n.preventDefault();n.stopPropagation()}),!0);n.focus({get preventScroll(){return f=!0,!1}});n.remove()}return f}Object.defineProperty(t,"__esModule",{value:!0});t.canPreventScrollOnFocus=t.getScrollbarHeight=t.getScrollbarWidth=t.getMaxElementHeight=void 0;var s=window,i,r,u,f;$(s).on("resize",(function(){i=0;r=0;u=0}));t.getMaxElementHeight=h;t.getScrollbarWidth=c;t.getScrollbarHeight=l;t.canPreventScrollOnFocus=a}));
define("MsPortalImpl/Base/Base.SvgHelper",["require","exports","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.Sanitization"],(function(n,t,i,r,u){"use strict";function a(n,t){var i=n.getAttribute("class");n.setAttribute("class",(i?i+" ":"")+t)}function k(n,t){n.setAttribute("class",(n.getAttribute("class")||"").split(" ").filter((function(n){return n&&n!==t})).join(" "))}function e(n,t){for(var i=0,r=n.length;i<r;++i)t(n[i])}function v(n,i){var u,r,h;return i.customClass&&b(i.customClass).split(" ").filter((function(n){return n.startsWith("ext-")||n.startsWith("msportalfx")||n.startsWith("fxt-")})).forEach((function(i){return e(n.getElementsByClassName(t.SvgPlaceholderClass),(function(n){return a(n,i)}))})),i.description&&(u=f.createElementNS(o,"desc"),u.textContent=i.description,r=n.getElementsByTagName("title")[0],r&&r.parentNode.insertBefore(u,r.nextSibling)),i.title?e(n.getElementsByTagName("title"),(function(n){n.textContent||(n.textContent=i.title)})):(h=[],e(n.getElementsByTagName("title"),(function(n){return n&&!n.textContent&&h.push(n)})),h.forEach((function(n){return n.remove()}))),i._badgeWidth||(e(n.getElementsByClassName(t.SvgPlaceholderClass),(function(n){return k(n,t.SvgPlaceholderClass)})),e(n.querySelectorAll("[class='']"),(function(n){return n.removeAttribute("class")}))),c(n.firstElementChild||s.cloneNode(),n.innerHTML)}function ht(t,i,u,f){var o=g[t],s;return(!o||f)&&(o=i?et:ft,o.innerHTML=t,i||(s=[],e(o.querySelectorAll(st),(function(i){r.logToExtension(n,u,2,"Svg contains illegal element: "+i.tagName,{contextData:{svg:t}});s.push(i)})),s.forEach((function(n){return n.remove()})),e(o.querySelectorAll("*"),(function(i){for(var f,o=i.attributes,s=[],e=0,h=o.length;e<h;++e)f=o[e].name,ot[f]||(r.logToExtension(n,u,2,"Svg contains illegal attribute: "+f,{contextData:{svg:t}}),s.push(f));s.forEach((function(n){return i.removeAttribute(n)}))})),MsPortalFx.isFeatureEnabled("preservegradients")||e(o.querySelectorAll("linearGradient,radialGradient,clipPath"),(function(n){var i=n.getAttribute("id"),t;i&&(t=MsPortalFx.getUniqueId(),n.setAttribute("id",t),["fill","clip-path"].forEach((function(n){e(o.querySelectorAll("["+n+"*='#"+i+"']"),(function(i){i.setAttribute(n,"url(#"+t+")")}))})))}))),f||(e(o.querySelectorAll("linearGradient,radialGradient,clipPath"),(function(n){return nt.appendChild(n)})),g[t]=o.cloneNode(!0))),o.cloneNode(!0)}function tt(n,i){var y=ut(),r=s.cloneNode(),p=FxImpl.createElement("div"),e,h,d,l,v;a(r,t.SvgPlaceholderClass);r.setAttribute("height","100%");r.setAttribute("width","100%");r.appendChild(f.createElementNS(o,"title"));p.appendChild(r);var c=s.cloneNode(),w=f.createElementNS(o,"defs"),u=f.createElementNS(o,"symbol"),b=f.createElementNS(o,"use");for(b.setAttribute("href","#"+y),r.appendChild(b),e=i.getElementsByTagName("svg")[0]||i,h=0,d=e.attributes.length;h<d;++h)l=e.attributes[h],u.setAttribute(l.name,l.value);while(e.hasChildNodes())u.appendChild(e.firstChild);return u.setAttribute("id",y),u.setAttribute("data-type",n+""),k(u,t.SvgPlaceholderClass),w.appendChild(u),c.appendChild(w),v=f.createElement("div"),v.appendChild(c),{reference:p,symbol:c,symbolContainer:v}}function yt(i,f,o,h,l,w){var it,g,ft,ut,k,st,et,nt,ot;if(f=f||i.options||{},it=i&&i.type,g=i&&i.data,it!==0&&g){if(it===2)return u.sanitizeUri(g,null,{diContainer:w,localRequire:n,windowContext:o})?(ft=b(f.title||""),ut=FxImpl.createElement("img"),ft?ut.setAttribute("alt",ft):ut.setAttribute("aria-hidden","true"),ut.setAttribute("src",rt(g)),ut):(r.logToExtension(n,o,2,"Image has failed to load as an invalid uri was passed in : "+g),c(s.cloneNode(),p))}else return c(s.cloneNode(),p);return(k=ht(g,h||it!==1,o,l),!k.hasChildNodes())?(r.logToExtension(n,o,2,"Svg has failed to load, imageData: "+g),c(s.cloneNode(),p)):(st=t.SvgsPalettes[f.palette],f.palette&&e(k.getElementsByClassName(t.SvgPlaceholderClass),(function(n){return a(n,st)})),f.symbol)?v(tt(it,k).symbolContainer,f):!at&&(lt||ct||!MsPortalFx.isNullOrWhiteSpace(f.customClass)||vt.test(k.outerHTML))?v(k,f):(et=k.outerHTML,nt=d.get(et),nt?nt=nt.cloneNode(!0):(ot=tt(it,k),nt=ot.reference,y.appendChild(ot.symbol),d.set(et,nt.cloneNode(!0))),v(nt,f))}var c,y,w;Object.defineProperty(t,"__esModule",{value:!0});t.getSvgReferenceOrFallBackToData=t.SvgsPalettes=t.SvgBadgeClass=t.SvgPlaceholderClass=void 0;var it=MsPortalFx.Base,pt=it.Diagnostics,rt=MsPortalFx.encodeAttribute,b=MsPortalFx.encodeHtml,l=window,o="http://www.w3.org/2000/svg",f=l.document;t.SvgPlaceholderClass="msportalfx-svg-placeholder";t.SvgBadgeClass="msportalfx-svg-badge";t.SvgsPalettes=[];t.SvgsPalettes[0]="";t.SvgsPalettes[2]="msportalfx-svg-palette-black";t.SvgsPalettes[3]="msportalfx-svg-palette-blue";t.SvgsPalettes[1]="msportalfx-svg-palette-white";t.SvgsPalettes[4]="msportalfx-svg-palette-green";t.SvgsPalettes[5]="msportalfx-svg-palette-gray";t.SvgsPalettes[99]="msportalfx-svg-palette-inherit";t.SvgsPalettes[100]="msportalfx-svg-disabled";c=l.SVGElement&&"outerHTML"in SVGElement.prototype?function(n){return n}:function(n,t){return n.outerHTML=t,n};y=FxImpl.createElement("div",{id:"FxSymbolContainer","aria-hidden":"true",role:"presentation",style:"width: 0; height: 0; overflow: hidden"});f.body.appendChild(y);var ut=MsPortalFx.getIdGenerator("FxSymbol"),d=new Map,ft=f.implementation.createHTMLDocument("").body,et=FxImpl.createElement("div"),g=Object.create(null),s=f.createElementNS(o,"svg"),p=(function(){var n=FxImpl.createElement("div");return n.appendChild(s),n.innerHTML})(),nt=f.createElementNS(o,"defs"),h=f.createElementNS(o,"svg");h.setAttribute("aria-hidden","true");h.setAttribute("width","0");h.setAttribute("height","0");h.setAttribute("role","presentation");h.setAttribute("focusable","false");h.appendChild(nt);w=FxImpl.createElement("div",{id:"DefsContainer","aria-hidden":"true",role:"presentation",style:"width: 0; height: 0; overflow: hidden"});w.appendChild(h);f.body.appendChild(w);var ot=["aria-hidden","aria-labelledby","class","clip-path","clip-rule","cx","cy","d","data-islogo","enable-background","fill","fill-opacity","fill-rule","filter","focusable","gradientTransform","gradientUnits","height","id","mask","offset","opacity","points","r","role","rx","ry","spreadMethod","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","transform","viewBox","viewbox","width","x","x1","x2","xml:space","xmlns","xmlns:svg","xmlns:xlink","y","y1","y2","xlink:href",].reduce((function(n,t){return t&&(n[t]=!0,n[t.toUpperCase()]=!0),n}),l.Object.create(null)),st="*:not("+["circle","clipPath","defs","ellipse","g","image","line","linearGradient","mask","path","polygon","polyline","radialGradient","rect","stop","svg","symbol","title","use",].join("):not(")+")";var ct=MsPortalFx.isFeatureEnabled("fulldiagnostics"),lt=i.isIe||!MsPortalFx.isFeatureEnabled("allowshadowdominsafari")&&i.isSafari,at=MsPortalFx.isFeatureEnabled("forcesvgshadowdom"),vt=/msportalfx-svg-c0(5|7)|-animated(\s|'|")|(\s|'|")ext-|fxs-svg-number/;t.getSvgReferenceOrFallBackToData=yt}));
define("MsPortalImpl/Base/Base.ImageHelper",["require","exports","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Base/Base.SvgHelper"],(function(n,t,i,r){"use strict";function u(n){return n.tagName.toLowerCase()==="svg"?n:n.getElementsByTagName("svg")[0]}function f(n,t){n&&MsPortalFx.forEachKey(t,(function(t,i){return n.setAttribute(t,i)}))}function e(t,i){var p,l,d,v,g;i=i||{};var y=i.context,w=i.bypassCache,b=i.svgAttributes,h=t&&t.type,c=t&&t.options||{},a,k=h>=899&&h<999;return h===0||h===1||h===2||k?(l=r.getSvgReferenceOrFallBackToData(t,c,y,k,w),l.tagName.toLowerCase()==="img"||l.hasChildNodes()?(f(u(l),b),a=Q([l])):a=Q([]),a=Q(l.hasChildNodes()||l.tagName.toLowerCase()==="img"?[l]:[])):(d=t&&t.data&&Q((p={},p[h]=t,p)),a=(d||MsPortalFx.require("MsPortalImpl/Base/Base.ImageLibrary")).then((function(t){var p,i,e;if(h>=999)return p=c.title?s(c.title,n,y).sanitizedMarkup:"",i=FxImpl.createElement("img"),i.setAttribute("alt",p),i.setAttribute("aria-hidden",(!c.title).toString()),i.setAttribute("src",o(t[h]&&t[h].data)),[i];var l=r.getSvgReferenceOrFallBackToData(t[h],c,y,!0,w),a=u(l),v=c._badgeWidth;return v&&(e=a&&a.getAttribute("class").indexOf(r.SvgPlaceholderClass)>-1&&a||l.querySelector("svg."+r.SvgPlaceholderClass),e&&(e.setAttribute("class",e.getAttribute("class").replace(r.SvgPlaceholderClass,r.SvgBadgeClass)),typeof v=="number"&&e.setAttribute("style","width:"+v+"%; height:"+v+"%"))),f(a,b),l.childElementCount?[l]:[]}))),c.badge&&(v=c.badge.width,v&&typeof v=="number"||(v=40),g=MsPortalFx.extend2(c.badge.image,{options:MsPortalFx.extend2(c.badge.image.options||{},{_badgeWidth:v})}),a=Q.all([a,e(g,{context:y})]).then((function(n){return[].concat.apply([],n||[])}))),a}Object.defineProperty(t,"__esModule",{value:!0});t.GetImageData=void 0;var o=MsPortalFx.encodeAttribute,s=i.sanitizeHTML;t.GetImageData=e}));
define("MsPortalImpl/Base/Base.KeyboardHelper",["require","exports","MsPortalImpl/Base/Base.BrowserDetection"],(function(n,t,i){"use strict";function s(n){switch(n){case 18:case 17:case 40:case 35:case 27:case 36:case 37:case 34:case 33:case 39:case 16:case 9:case 38:return!0;default:return!1}}function h(n){return(n.altKey&&1)|(n.metaKey&&2)|(n.shiftKey&&4)|(n.ctrlKey&&8)}function c(n,t){var i=n?r:u;return i[t]||e[t]}function o(n){return n.ctrlKey&&!n.metaKey||i.isMac&&n.metaKey&&!n.ctrlKey}function l(n){return!n.shiftKey&&!n.altKey&&o(n)}function a(n){n.ctrlKey=!i.isMac;n.metaKey=i.isMac}var f,e,r,u;Object.defineProperty(t,"__esModule",{value:!0});t.setCtrlOrCommandModifier=t.isCtrlOrCommandOnly=t.isCtrlOrCommand=t.mapKeyCodeToString=t.getModifierKeys=t.isNonWrittenCharacter=t.VariableKeyCode=void 0,(function(n){n[n.Equals=i.isFirefox?61:187]="Equals";n[n.Minus=i.isFirefox?173:189]="Minus"})(f=t.VariableKeyCode||(t.VariableKeyCode={})),(function(n){n[n.Alt=18]="Alt";n[n.Backslash=220]="Backslash";n[n.Backspace=8]="Backspace";n[n.Comma=188]="Comma";n[n.Control=17]="Control";n[n.Delete=46]="Delete";n[n.Down=40]="Down";n[n.End=35]="End";n[n.Enter=13]="Enter";n[n.Equals=f.Equals]="Equals";n[n.Escape=27]="Escape";n[n.F1=112]="F1";n[n.F2=113]="F2";n[n.F10=121]="F10";n[n.Home=36]="Home";n[n.Left=37]="Left";n[n.Menu=93]="Menu";n[n.Minus=f.Minus]="Minus";n[n.PageDown=34]="PageDown";n[n.PageUp=33]="PageUp";n[n.Period=190]="Period";n[n.Right=39]="Right";n[n.Shift=16]="Shift";n[n.Slash=191]="Slash";n[n.Space=32]="Space";n[n.Tab=9]="Tab";n[n.Up=38]="Up";n[n.A=65]="A";n[n.B=66]="B";n[n.C=67]="C";n[n.D=68]="D";n[n.E=69]="E";n[n.F=70]="F";n[n.G=71]="G";n[n.H=72]="H";n[n.I=73]="I";n[n.J=74]="J";n[n.K=75]="K";n[n.L=76]="L";n[n.M=77]="M";n[n.N=78]="N";n[n.O=79]="O";n[n.P=80]="P";n[n.Q=81]="Q";n[n.R=82]="R";n[n.S=83]="S";n[n.T=84]="T";n[n.U=85]="U";n[n.V=86]="V";n[n.W=87]="W";n[n.X=88]="X";n[n.Y=89]="Y";n[n.Z=90]="Z";n[n.Num0=48]="Num0";n[n.Num1=49]="Num1";n[n.Num2=50]="Num2";n[n.Num3=51]="Num3";n[n.Num4=52]="Num4";n[n.Num5=53]="Num5";n[n.Num6=54]="Num6";n[n.Num7=55]="Num7";n[n.Num8=56]="Num8";n[n.Num9=57]="Num9";n[n.NumPad0=96]="NumPad0";n[n.NumPad1=97]="NumPad1";n[n.NumPad2=98]="NumPad2";n[n.NumPad3=99]="NumPad3";n[n.NumPad4=100]="NumPad4";n[n.NumPad5=101]="NumPad5";n[n.NumPad6=102]="NumPad6";n[n.NumPad7=103]="NumPad7";n[n.NumPad8=104]="NumPad8";n[n.NumPad9=105]="NumPad9";n[n.SingleQuote=222]="SingleQuote"})(e||(e={}));t.isNonWrittenCharacter=s;t.getModifierKeys=h;r=[];r[192]="~";r[219]="{";r[221]="}";r[220]="|";r[59]=":";r[188]="<";r[f.Equals]="+";r[f.Minus]="_";r[49]="!";r[50]="@";r[51]="#";r[52]="$";r[53]="%";r[54]="^";r[55]="&";r[56]="*";r[57]="(";r[48]=")";r[190]=">";r[191]="?";r[222]='"';r[32]="SHIFT+SPACE";r[40]="SHIFT+Down";r[38]="SHIFT+Up";u=[];u[220]="\\";u[188]=",";u[f.Minus]="-";u[49]="1";u[50]="2";u[51]="3";u[52]="4";u[53]="5";u[54]="6";u[55]="7";u[56]="8";u[57]="9";u[48]="0";u[190]=".";u[32]="SPACE";u[191]="/";t.mapKeyCodeToString=c;t.isCtrlOrCommand=o;t.isCtrlOrCommandOnly=l;t.setCtrlOrCommandModifier=a}));
define("MsPortalImpl/Base/Base.KnockoutExtensions",["require","exports"],(function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f="fxs-display-none",i=ko.bindingHandlers,r=ko.virtualElements.allowedBindings,u=ko.utils,e=u.domData,o=MsPortalFx.wrap({controlsDescendentBindings:!0});i.commands={update:function(n,t){var i=ko.unwrap(t()),r,f;if(i&&i.group){r=$(n);f=function(n){var t=ko.unwrap(i.viewModel),u=$.Event("rightclick",{target:n.target,clientX:n.clientX,clientY:n.clientY});r.trigger(u,{commandGroup:i.group,viewModel:t,entityType:2});n.preventDefault();n.stopPropagation()};r.on("fxcontextmenurequest",f);u.domNodeDisposal.addDisposeCallback(n,(function(){r.off("fxcontextmenurequest",f)}))}}};i.visible={update:function(n,t){var i=ko.unwrap(t()),r=n.classList;r?r.toggle(f,!i):$(n).toggleClass(f,!i)}};i.keyedCss={update:function(n,t){var i=[],r=[];MsPortalFx.forEachKey(ko.unwrap(t()),(function(t,f){var o=ko.unwrap(f);if(typeof o!="string")MsPortalFx.forEachKey(o,(function(n,t){ko.unwrap(t)?i.push(n):r.push(n)}));else{t="_fxCss_"+t;var h=e.get(n,t)||[],s=o.split(" ").filter(MsPortalFx.identity)||[],c=u.compareArrays(h,s,{sparse:!0});c.forEach((function(n){undefined===n.moved&&(n.status==="added"?i.push(n.value):n.status==="deleted"&&r.push(n.value))}));e.set(n,t,s)}}));$(n).removeClass(r.join(" ")).addClass(i.join(" "))}};r.vtext=r.text;i.vtext=i.text;r.text=!1;i.text={init:o,update:function(n,t){var i=ko.unwrap(t());i=i===undefined?"":i;n.textContent=i}}}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.Image",["require","exports","MsPortalImpl/Base/Base.ImageHelper"],(function(n,t,i){"use strict";function u(n,t){var e,u,o;return t?(e=void 0,u=void 0,r&&(e=JSON.stringify(t),u=r.get(e)),u||(u=i.GetImageData(t,{context:n,svgAttributes:f}).then((function(n){for(var i=document.createDocumentFragment(),t=0,r=n.length;t<r;t++)i.appendChild(n[t].cloneNode(!0));return i})),r&&r.set(e,u)),o=n.firstChild,MsPortalFx.tryImmediateResolve(u,(function(t){o===n.firstChild&&(n.innerHTML="",n.appendChild(t.cloneNode(!0)))}))):(n.innerHTML="",Promise.resolve())}Object.defineProperty(t,"__esModule",{value:!0});t.renderImage=void 0;var f={"aria-hidden":"true",role:"presentation",focusable:"false"},r=!MsPortalFx.isFeatureEnabled("nokosvgcaching")&&new Map,e={controlsDescendantBindings:!0};t.renderImage=u;ko.bindingHandlers.image={init:function(){return e},update:function(n,t){var i=ko.unwrap(t());u(n,i)}}}));
define("MsPortalImpl/Base/Base.Timers",["require","exports"],(function(n,t){"use strict";function u(n){if(!n&&i.requestAnimationFrame&&i.cancelAnimationFrame)t.requestAnimationFrame=function(n){return i.requestAnimationFrame(n)},t.cancelAnimationFrame=function(n){return i.cancelAnimationFrame(n)};else{var r=0;t.requestAnimationFrame=function(n){var t=Date.now(),i=Math.max(0,16-(t-r)),u=setTimeout((function(){n(t+i)}),i);return r=t+i,u};t.cancelAnimationFrame=function(n){clearTimeout(n)}}}function h(n){var r,i;return function(){for(var u,o,e=[],f=0;f<arguments.length;f++)e[f]=arguments[f];return r=e,i||(u=Q.defer(),o=i=u.promise,i.timeout(2e3,"requestAnimationFrameQ timout after 2 seconds: callback:"+n).catch((function(){o===i&&(i=null)})),t.requestAnimationFrame((function(){try{var t=Q(n.apply(void 0,r));t.then(u.resolve,u.reject)}catch(f){u.reject(f)}i=null}))),i}}function r(n,t,i){return new c.CanceledError({message:n,data:t&&t+"",innerErrors:i})}var i;Object.defineProperty(t,"__esModule",{value:!0});t.debounce=t.throttle=t.throttleByAnimationFrame=t.setupTimers=t.cancelAnimationFrame=t.requestAnimationFrame=void 0;i=window;t.setupTimers=u;u(!1);t.throttleByAnimationFrame=h;var f="function",e=MsPortalFx.memoize,o=MsPortalFx.uncurryThis(Array.prototype.slice),c=MsPortalFx.Errors,s={noDebugCheck:!0};t.throttle=function(n,t,i){var a,v,u,y,h,c,l;return typeof t!==f&&(i=t,t=n,n=null),h=e((function(){var n=u||(u=Q.defer()),t=i>0?Q.delay(i):Q();return t.then((function(){return n.promise.isPending()&&v()})).then(n.resolve,n.reject),n.promise}),s),v=function(){return h.clear(),u=null,t.apply(null,a)},c=function(){return a=arguments.length?o(arguments):undefined,h()},l=function(n){u&&u.promise.isPending()&&u.reject(n||r("canceled",t));u=null;y||h.clear()},c.cancel=l,c.dispose=function(){var n,i;y=!0;n=r("disposed",t);l(n);i=Q.reject(n);i.catch(MsPortalFx.noop);h.map().set(undefined,i)},n&&n.registerForDispose(c),c};t.debounce=function(n,t,i){function w(n){u&&u.promise.isPending()&&u.reject(n||r("canceled",t));u=null;p||h.clear()}var a,l,v,y,u,p,h,c;return i===void 0&&(i=0),typeof t!==f&&(i=t,t=n,n=null),l=0,h=e((function(){var n=u||(u=Q.defer()),r=Date.now(),t=l+i-r;return t>0?Q.delay(t).then((function(){return n.promise.isPending()&&y()})):Q.fcall((function(){return n.promise.isPending()&&v()})).then(n.resolve,n.reject),n.promise}),s),y=function(){return h.clear(),h()},v=function(){return h.clear(),u=null,t.apply(null,a)},c=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return l=Date.now(),a=arguments.length?o(arguments):undefined,h()},c.cancel=w,c.dispose=function(){var n,i;p=!0;n=r("disposed",t);w(n);i=Q.reject(n);i.catch(MsPortalFx.noop);h.map().set(undefined,i)},n&&n.registerForDispose(c),c};ko.extenders.rateLimit.tasks.debounce=t.debounce;ko.extenders.rateLimit.tasks.throttle=t.throttle}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.FxClick",["require","exports"],(function(n,t){"use strict";function i(n,t,i,r){var u=!1;r&&r.registerForDispose((function(){return u=!0}));MsPortalFx.require("MsPortalImpl/UI/Compositions/UI.Composition.Selectable2Registrar",(function(f){u||f.attachFxClickHandler(n,i,t,r)}))}Object.defineProperty(t,"__esModule",{value:!0});t.applyFxClick=void 0;ko.bindingHandlers.fxclick={init:function(n,t,r,u,f){i(n,t(),f,null)}};t.applyFxClick=i}));
define("MsPortalImpl/Weave/InternalUtil",["require","exports","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Base/Base.KnockoutExtensions.FxClick","MsPortalImpl/Base/Base.Sanitization"],(function(n,t,i,r,u){"use strict";function f(t,r,u){return function(f){return f?f.skipSanitization&&u?f.content:r.get(i.KODeniedTemplateSanitizer).sanitize({contextData:{moduleName:f.moduleName},diContainer:r,localRequire:n,value:f.content,windowContext:t}).sanitizedMarkup:""}}function e(n,t,i,u){r.applyFxClick(n,i,{$dicontainer:u.diContainer,$disabled:u.disabled,$tabIndex:u.tabIndex},t)}function o(n,t){var i=u.sanitizeLinkUri(n,t);return i===!1?{valid:!1}:{valid:!0,value:i}}function s(n){return u.validateUriOrBlank(n)||u.validateDataImage(n)?{valid:!0,value:n}:{valid:!1}}function h(n,t){return n===!0||Array.isArray(n)&&n.indexOf(t)>=0}Object.defineProperty(t,"__esModule",{value:!0});t.matchKeyCode=t.sanitizeSrc=t.sanitizeHref=t.applyFxClickToElement=t.makeHtmlDataHandler=void 0;t.makeHtmlDataHandler=f;t.applyFxClickToElement=e;t.sanitizeHref=o;t.sanitizeSrc=s;t.matchKeyCode=h}));
define("MsPortalImpl/Weave/SandboxDomAgents/EntryPoint",["require","exports"],(function(n,t){"use strict";function r(n,t,i,r){MsPortalFx.tryImmediateResolve(u[r.type](),(function(u){t.isDisposed()||u.attachDomAgent(n,t,i,r.options)}))}Object.defineProperty(t,"__esModule",{value:!0});t.attachSandboxDomAgent=void 0;t.attachSandboxDomAgent=r;var i=MsPortalFx.require,u={tab:function(){return i("MsPortalImpl/Weave/SandboxDomAgents/Tab")},splitter:function(){return i("MsPortalImpl/Weave/SandboxDomAgents/Splitter")},button:function(){return i("MsPortalImpl/Weave/SandboxDomAgents/Button")}}}));
define("MsPortalImpl/Weave/Util",["require","exports","Weave/DirectMode","Weave","Weave/Core/Computation","FxInternal/Weave/Util","Fx/Weave","Weave/Core/InternalUtil","FxInternal/WeaveControls/Common"],(function(n,t,i,r,u,f,e,o,s){"use strict";function c(n){var t=document.activeElement;t!==n&&u.invokeAfterChangePropagation((function(){(t===document.activeElement||document.activeElement===document.body)&&n.focus()}))}function l(n){return(n||"").trim()||undefined}function a(n){return(n||"").indexOf("_weave_e_")===0}function v(n,t){var i=!1;return function(){i&&t||(i=!0,u.invokeAfterChangePropagation((function(){i=!1;n()})))}}function y(n){return function(t){return i(r.GetContext,{fn:function(u){return s.patchFieldControlVM(u,t.vm),s.tryWrapAggregationSourceForFieldControlVM(t.vm,i(r.LifetimeManagerScoped,{fn:function(){function s(i,f){f.registerForDispose(new n.widgetCtor($(i),t.vm,{weaveContext:u,diContainer:u.diContainer},r));e&&e(i,f)}var r=new n.widgetUIStateCtor({diContainer:u.diContainer,vm:t.vm}),i=n.innerComponent({vm:t.vm,state:r}),e=t.afterMount;return f.isWeaveNodeWithParentRenderInfo(i)?o.WeaveTsx(t.tagName||"div",__assign(__assign({},t),{afterMount:s,className:[i.parentClassName,t.className],vm:undefined,tagName:undefined}),i.weaveNode):o.WeaveTsx(t.tagName||"div",__assign(__assign({},t),{afterMount:s,vm:undefined,tagName:undefined}),i)}}))}})}}function p(n){return function(t){return i(r.GetContext,{fn:function(i){s.patchFieldControlVM(i,t.vm);var r=t.afterMount,u=function(u,f){f.registerForDispose(new n.widgetCtor($(u),t.vm,{weaveContext:i,diContainer:i.diContainer}));r&&r(u,f)};return s.tryWrapAggregationSourceForFieldControlVM(t.vm,o.WeaveTsx(t.tagName||"div",__assign(__assign({},t),{afterMount:u,vm:undefined,tagName:undefined}),n.innerComponent({vm:t.vm})))}})}}function w(n){return function(t){return i(r.GetContext,{fn:function(i){s.patchFieldControlVM(i,t.vm);var r=t.afterMount,u=function(u,f){f.registerForDispose(new n.widgetCtor($(u),t.vm,{bindingContext:h(i,f,{}),diContainer:i.diContainer}));r&&r(u,f)};return s.tryWrapAggregationSourceForFieldControlVM(t.vm,o.WeaveTsx(t.tagName||"div",__assign(__assign({},t),{afterMount:u,vm:undefined,tagName:undefined})))}})}}function b(n,t,i){var r=e.toComputation(t.disabled);return{disabled:f.aggregateDisabled([n.disabled,i&&e.toComputation(i.disabled),r]),tabIndex:f.aggregateTabindex([n.tabIndex,i&&e.toComputation(i.tabIndex)],r)}}function k(n){return function(t){return i(r.GetContext,{fn:function(u){s.patchFieldControlVM(u,t.vm);var e=MsPortalFx.tryImmediateResolve(n(),(function(n){return i(r.LifetimeManagerScoped,{fn:function(){function s(i,f){f.registerForDispose(new n.Widget($(i),t.vm,{weaveContext:u,diContainer:u.diContainer},r));e&&e(i,f)}var r=new n.WidgetUIState({diContainer:u.diContainer,vm:t.vm}),i=n.InnerTsxComponent({vm:t.vm,state:r}),e=t.afterMount;return f.isWeaveNodeWithParentRenderInfo(i)?o.WeaveTsx(t.tagName||"div",__assign(__assign({},t),{afterMount:s,className:[i.parentClassName,t.className],vm:undefined,tagName:undefined}),i.weaveNode):o.WeaveTsx(t.tagName||"div",__assign(__assign({},t),{afterMount:s,vm:undefined,tagName:undefined}),i)}})}));return s.tryWrapAggregationSourceForFieldControlVM(t.vm,i(r.PromiseFragment,{promise:e}))}})}}function d(n){return function(t){return i(r.GetContext,{fn:function(u){var f=MsPortalFx.tryImmediateResolve(n(),(function(n){var f=t.afterMount,i=t.vm,r=typeof i=="function"?i(n):i,e;return s.patchFieldControlVM(u,r),e=function(t,i){i.registerForDispose(new n.Widget($(t),r,{bindingContext:h(u,i,{}),diContainer:u.diContainer}));f&&f(t,i)},s.tryWrapAggregationSourceForFieldControlVM(r,o.WeaveTsx(t.tagName||"div",__assign(__assign({},t),{afterMount:e,vm:undefined,tagName:undefined})))}));return i(r.PromiseFragment,{promise:f})}})}}function h(n,t,i){return(n.koContext?n.koContext.createChildContext(i):new ko.bindingContext(i)).extend({$disabled:e.toObservable(t,n.disabled),$tabIndex:e.toObservable(t,n.tabIndex),$index:e.toObservable(t,n.indexInLoop),$dicontainer:n.diContainer,$partName:n.partName,$extensionName:n.extensionName})}function g(n){return i(r.Fragment,null,n)}Object.defineProperty(t,"__esModule",{value:!0});t.createFragment=t.weaveContextToKoContext=t.createControlLazyComponentForKO=t.createControlLazyComponent=t.aggregateContext=t.createControlComponentForKO=t.createControlComponentNoUIState=t.createControlComponent=t.wrapFnWaitForChangePropagation=t.isTsxElemId=t.mapWhiteSpaceToUndefined=t.tryFocusAfterChangePropagation=void 0;t.tryFocusAfterChangePropagation=c;t.mapWhiteSpaceToUndefined=l;t.isTsxElemId=a;t.wrapFnWaitForChangePropagation=v;t.createControlComponent=y;t.createControlComponentNoUIState=p;t.createControlComponentForKO=w;t.aggregateContext=b;t.createControlLazyComponent=k;t.createControlLazyComponentForKO=d;t.weaveContextToKoContext=h;t.createFragment=g}));
define("_generated/Less/Viva.Controls/Util/Viva.Resize.css",["module"],(function(n){"use strict";return{css:"@keyframes azc-resize-enter{0%{bottom:0}}.azc-resize{animation:azc-resize-enter 1ms;position:absolute;bottom:0;right:0;pointer-events:none;width:200%;height:200%;min-width:1px;min-height:1px;overflow:hidden;visibility:hidden}",moduleId:n.id}}));
define("Viva.Controls/Util/Viva.Resize",["require","exports","MsPortalImpl/Base/Base.Timers","FxInternal/Css","_generated/Less/Viva.Controls/Util/Viva.Resize.css"],(function(n,t,i,r,u){"use strict";function b(){return!!s.ResizeObserver&&!t.disableResizeObserver.peek()}function k(n){return FxImpl.createElement("div",{"class":"azc-resize "+n},FxImpl.createElement("div",{"class":l}))}function e(n,t){return n.children("."+t)}function f(n){var t;return n&&n.endsWith("px")&&(t=parseFloat(n)),t||0}function d(n){var t=getComputedStyle($(n)[0],null),u=t.boxSizing==="border-box",r=f(t.width),i;return r&&u&&(r-=f(t.paddingLeft),r-=f(t.paddingRight)),i=f(t.height),i&&u&&(i-=f(t.paddingTop),i-=f(t.paddingBottom)),{width:r,height:i}}function g(n){var t=d(n);return{width:Math.round(t.width),height:Math.round(t.height)}}function nt(n,t,r,u){var h,c,l;if(!n.isDisposed()){var f=0,e=0,s=function(t,i){!n.isDisposed()&&(i||t)&&(i!==f||t!==e)&&(f=i,e=t,r(t,i))},y=i.debounce(n,(function(n,t){i.requestAnimationFrame((function(){s(n,t)}))}),100);if(o.has(t))throw new Error("Viva.Resize.track already registered for this element.");if(h=u&&u.ignoreInitialState,c={lifetime:n,handler:y,ignoreInitialState:h},o.set(t,c),a.observe(t),n.registerForDispose((function(){a.unobserve(t);o.delete(t)})),l=u&&u.notifyInitialSize,l){var v=g(t),p=v.width,w=v.height;s(p,w)}}}function tt(n,t,r,u){function st(){var s=g(t),r=s.width,u=s.height,e=!1,n,i;if(r||u){if(e=r!==it||u!==rt,it=r,rt=u,ut||e||!et){ft.css({"min-width":"1px","min-height":"1px"});var h=d(f),c=Math.floor(h.width),l=Math.floor(h.height);if(c){n=0;do n++,ft.width(c+n),f.scrollLeft(f[0].scrollWidth);while(!f.scrollLeft()&&n<5)}if(l){i=0;do i++,ft.height(l+i),f.scrollTop(f[0].scrollHeight);while(!f.scrollTop()&&i<5)}lt.css({width:"200%","min-width":"1px",height:"200%","min-height":"1px"});o.scrollLeft(o[0].scrollWidth);o.scrollTop(o[0].scrollHeight);et=!!f.scrollLeft()&&!!f.scrollTop()&&!!o.scrollLeft()&&!!o.scrollTop()}ut=!1}else et=!1;return e}function a(n,t){ut=ut||t;ct()}var ot,tt,ht,ct;if(t.length!==1)throw new Error("Viva.Resize.track can only take a element with length of 1. Current element.length: "+t.length);if(t.addClass(w),n.registerForDispose((function(){t.removeClass(w)})),b())return nt(n,t[0],r,u);if(ot=u&&u.notifyInitialSize,e(t,c).length)throw new Error("Viva.Resize.track already registered for this element.");tt=t.css(h);tt===y&&t.css(h,"relative");t.append(k(p),k(c));var f=e(t,c),o=e(t,p),ft=e(f,l),lt=e(o,l),it,rt,et=!1,ut=!0;st();ot&&r(it,rt);ht=i.throttleByAnimationFrame((function(){!n.isDisposed()&&st()&&r(it,rt)}));ct=i.debounce(n,ht,100);n.registerForDispose([f.setEvents([v,function(n){return a(n)},],["animationstart",function(n){return a(n,!0)},]),o.setEvents([v,function(n){return a(n)},]),$(s).setEvents(["resize",function(n){return a(n,!0)},]),$(document).setEvents(["visibilitychange",function(n){var t=document.visibilityState;a(n,t?t==="visible":!0)},]),]);n.registerForDispose((function(){f.remove();o.remove();tt===y&&t.css(h,tt)}))}var o,a;Object.defineProperty(t,"__esModule",{value:!0});t.track=t.ResizeObserverEnabled=t.disableResizeObserver=void 0;r.injectCss(u);var v="scroll",s=window,h="position",y="static",c="azc-resize-grow",p="azc-resize-shrink",l="azc-resize-content",w="fxs-vivaresize";t.disableResizeObserver=ko.observable();o=new Map;a=s.ResizeObserver?new s.ResizeObserver(function(n){for(var i=0,r=n;i<r.length;i++){var u=r[i],e=u.target,t=o.get(e);if(t){var s=t.lifetime,h=t.handler,c=t.ignoreInitialState,l=t.inited;if(h&&!s.isDisposed())if(c&&!l)t.inited=!0;else{var f=u.contentRect,a=Math.round(f.width),v=Math.round(f.height);t.handler(a,v)}}}}):null;t.ResizeObserverEnabled=b();t.track=tt}));
define("WeaveDOM/Core/InternalUtil",["require","exports"],(function(n,t){"use strict";function r(n){return document.createRange().createContextualFragment(n)}function h(n,t,i){for(var u,r=0,f=(t||"").split(" ");r<f.length;r++)u=f[r],u&&(i?n.classList.add(u):n.classList.remove(u))}function u(n){n.remove?n.remove():n.parentNode.removeChild(n)}function c(n,t){for(var i=n.nextSibling,r;i!==t;)r=i.nextSibling,u(i),i=r}function i(n,t){return n.nodeType===t}function l(n,t){if(i(n,1))n.insertAdjacentHTML("beforebegin",t);else{var u=r(t);f(n,u)}}function f(n,t){i(n,1)&&i(t,1)?n.insertAdjacentElement("beforebegin",t):n.before?n.before(t):n.parentNode.insertBefore(t,n)}function e(n,t){return n.getElementById?n.getElementById(t):n.querySelector("#"+t)}function a(n,t){for(var f,s,i=new Map,r=0,u=n;r<u.length;r++)f=u[r],s=e(t,f),o(s,i);return o(t,i),i}function o(n,t){for(var r,f=n.childNodes,u=0;u<f.length;++u)r=f[u],i(r,8)&&t.set(r.textContent,r)}function v(n,t,i,r){if(!i&&t.commentStart.nextSibling!==t.commentEnd)throw new Error("Node is not empty, operation invalid.");n.ensureContentDisposed(t,r)}function y(n,t,i,r){n.addEventListener(i,r);t.registerForDispose((function(){return n.removeEventListener(i,r)}))}function p(){return window.performance.now()}function w(n){while(n.lastChild)n.removeChild(n.lastChild)}function b(n,t,i){return function(){for(var u,e,h,c,f,o,l,s=[],r=0;r<arguments.length;r++)s[r]=arguments[r];for(u=0,e=t;u<e.length;u++)h=e[u],h.call(this);if(c=n.apply(this,s),i)for(f=0,o=i;f<o.length;f++)l=o[f],l.call(this);return c}}function d(){var n=""+k++;return{commentStartId:"_weave_cstart_"+n,commentEndId:"_weave_cend_"+n}}function g(n){return s(n,"_weave_cstart_")}function nt(n){return s(n,"_weave_cend_")}function s(n,t){return n.startsWith?n.startsWith(t):n.indexOf(t)===0}Object.defineProperty(t,"__esModule",{value:!0});t.isCommentEndId=t.isCommentStartId=t.getUniqueCommentIdPair=t.wrapFunc=t.removeAllChildren=t.performanceNow=t.attachEventListener=t.ensureNoContent=t.collectCommentNodes=t.getElementByIdInDocumentFragment=t.insertNodeBeforeNode=t.insertHtmlBeforeNode=t.isNodeType=t.removeNodesBetween=t.removeNode=t.toggleClass=t.documentFragmentFromHtml=void 0;t.documentFragmentFromHtml=r;t.toggleClass=h;t.removeNode=u;t.removeNodesBetween=c;t.isNodeType=i;t.insertHtmlBeforeNode=l;t.insertNodeBeforeNode=f;t.getElementByIdInDocumentFragment=e;t.collectCommentNodes=a;t.ensureNoContent=v;t.attachEventListener=y;t.performanceNow=p;t.removeAllChildren=w;t.wrapFunc=b;var k=0;t.getUniqueCommentIdPair=d;t.isCommentStartId=g;t.isCommentEndId=nt}));
define("WeaveDOM/Core/DefaultInputBindings",["require","exports"],(function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultInputBindings=void 0;var i={eventsToListen:["input","change"],writeValueToElement:function(n,t){var i=n;t=""+(t||"");i.value!==t&&(i.value=t)},collectDataFromEvent:function(n){return{value:n.target.value}}},r={eventsToListen:["change"],writeValueToElement:function(n,t){var i=n;t=!!t;i.checked!==t&&(i.checked=t)},collectDataFromEvent:function(n){return{checked:n.target.checked}}};t.defaultInputBindings=[{name:"textInput",metadata:i},{name:"checkboxInput",metadata:r}]}));
define("WeaveDOM/Core/Sanitization",["require","exports"],(function(n,t){"use strict";function i(n){for(var u,i=new Set,t=0,r=n;t<r.length;t++)u=r[t],i.add(u);return i}function o(n){return n==="img"||n==="input"||n==="area"||n==="br"||n==="col"||n==="hr"||n==="source"||n==="track"||n==="wbr"}function s(n){return p.has(n)}function h(n){return w.has(n)}function c(n,t){switch(n){case"a":return d.has(t);case"area":return g.has(t);case"audio":return nt.has(t);case"button":return tt.has(t);case"blockquote":return it.has(t);case"canvas":return rt.has(t);case"col":case"colgroup":return ut.has(t);case"del":return ft.has(t);case"details":case"dialog":return st.has(t);case"embed":return et.has(t);case"form":return ot.has(t);case"input":return k.has(t);case"img":return ct.has(t);case"ins":return lt.has(t);case"iframe":return ht.has(t);case"label":return at.has(t);case"map":return vt.has(t);case"meter":return yt.has(t);case"ol":return pt.has(t);case"optgroup":return wt.has(t);case"option":return bt.has(t);case"output":return kt.has(t);case"progress":return dt.has(t);case"q":return gt.has(t);case"source":return ni.has(t);case"td":return ti.has(t);case"textarea":return ii.has(t);case"th":return ri.has(t);case"time":return ui.has(t);case"track":return fi.has(t);case"video":return ei.has(t);default:return b.has(t)}}function l(n){if(n==="class")throw new Error("class attribute not supported.");}function a(n,t){if(!c(n,t))throw new Error("Attribute "+t+" is not allowed for tag "+n+".");}function v(n,t,i){if(i)switch(n){case"src":if(i.src)return i.src(t);break;case"href":if(i.href)return i.href(t)}return{valid:!0,value:t}}Object.defineProperty(t,"__esModule",{value:!0});t.sanitizeAttributeValue=t.ensureAllowedAttribute=t.ensureNotClass=t.validateTagNameInDirectMode=t.validateTagNameInSandboxMode=t.isSelfCloseTag=t.arrayToSet=void 0;t.arrayToSet=i;t.isSelfCloseTag=o;t.validateTagNameInSandboxMode=s;t.validateTagNameInDirectMode=h;t.ensureNotClass=l;t.ensureAllowedAttribute=a;t.sanitizeAttributeValue=v;var u=["a","abbr","address","area","article","aside","audio","b","bdi","bdo","blockquote","br","button","canvas","caption","cite","code","col","colgroup","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","header","hgroup","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","label","legend","li","main","map","mark","meter","nav","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","source","small","span","strong","sub","summary","sup","table","tbody","textarea","td","tfoot","th","thead","time","tr","track","u","ul","var","video","wbr",],y=u.concat(["iframe","svg","template",]),p=i(u),w=i(y),r=["aria-atomic","aria-autocomplete","aria-checked","aria-controls","aria-current","aria-describedby","aria-disabled","aria-expanded","aria-grabbed","aria-haspopup","aria-hidden","aria-invalid","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-owns","aria-orientation","aria-posinset","aria-pressed","aria-readonly","aria-required","aria-selected","aria-setsize","aria-valuemin","aria-valuemax","aria-valuenow","class","datetime","dir","draggable","focusable","hidden","id","lang","spellcheck","role","style","tabindex","title","translate",],b=i(r),k=i(r.concat(["accept","autocomplete","autofocus","capture","disabled","form","list","max","maxlength","min","minlength","multiple","name","pattern","placeholder","readonly","required","size","step","type","value",])),f=r.concat(["download","href","hreflang","media","rel","target","type",]),d=i(f),g=i(f.concat("alt","coords","shape")),e=r.concat(["autoplay","controls","crossorigin","loop","muted","preload","src",]),nt=i(e),tt=i(r.concat("autofocus","disabled","form","formaction","formenctype","formmethod","formnovalidate","formtarget","name","type")),it=i(r.concat("cite")),rt=i(r.concat("width","height")),ut=i(r.concat("span")),ft=i(r.concat("cite","datetime")),et=i(r.concat("height","src","width","type")),ot=i(r.concat("accept-charset","action","autocomplete","enctype","method","name","novalidate","target")),st=i(r.concat("open")),ht=i(r.concat("height","name","sandbox","scrolling","seamless","src","srcdoc","width")),ct=i(r.concat("alt","crossorigin","height","ismap","src","width")),lt=i(r.concat("cite","datetime")),at=i(r.concat("for","form")),vt=i(r.concat("name")),yt=i(r.concat("form","high","low","max","min","optimum","value")),pt=i(r.concat("reversed","type","start")),wt=i(r.concat("label","disabled")),bt=i(r.concat("disabled","label","selected","value")),kt=i(r.concat("for","form","name")),dt=i(r.concat("max","value")),gt=i(r.concat("cite")),ni=i(r.concat("src","media","type")),ti=i(r.concat("colspan","headers","rowspan")),ii=i(r.concat("autofocus","cols","disabled","form","maxlength","minlength","name","placeholder","readonly","required","rows","wrap")),ri=i(r.concat("abbr","colspan","headers","rowspan","scope")),ui=i(r.concat("datetime")),fi=i(r.concat("default","kind","label","src","srclang")),ei=i(e.concat("height","poster","width"))}));
define("WeaveDOM/Core/DomOperatorBase",["require","exports","WeaveDOM/Core/InternalUtil","WeaveDOM/Core/Sanitization","Weave/Core/InputBindings","Weave/Core/InternalUtil","WeaveDOM/Core/DefaultInputBindings"],(function(n,t,i,r,u,f,e){"use strict";function h(n,t){n.hideCount+=t;var i=t>0;return!i&&n.hideCount===0?2:i&&n.hideCount===t?3:1}var o,s;Object.defineProperty(t,"__esModule",{value:!0});t.DirectDomAgent=void 0;o=document.createElement("style");o.textContent=".weave-display-none1,.weave-display-none2{display:none !important}";document.head.appendChild(o);s=(function(){function n(){this.inputBindingsMgr=new u.InputBindingsManager;this._textHiddenContentMap=new WeakMap;this._dynamicNodeDisplayStateMap=new WeakMap;this._inputBindingDefMap=f.makeMap(e.defaultInputBindings,(function(n){return n.name}),(function(n){return n.metadata}))}return n.prototype.prepareInitInputBinding=function(n,t){return this.inputBindingsMgr.ensureNoInputBindingExists(n,t),this.ensureInputBindingMetadata(t)},n.prototype.ensureInputBindingMetadata=function(n){var t=this._inputBindingDefMap.get(n);if(!t)throw new Error('Input binding "'+n+'" is not defined.');return t},n.prototype.setAttribute=function(n,t,i,u,f){var o=n.getAndEnsureElementNode(i).element,e;if(u.indexOf("data-")!==0){if(r.ensureAllowedAttribute(o.tagName.toLowerCase(),u),e=r.sanitizeAttributeValue(u,f,t),!e.valid)throw new Error("Invalid attribute value for "+u+": "+f);f=e.value;r.ensureNotClass(u)}o.setAttribute(u,f)},n.prototype.removeAttribute=function(n,t,i){var u=n.getAndEnsureElementNode(t).element;i.indexOf("data-")!==0&&(r.ensureAllowedAttribute(u.tagName.toLowerCase(),i),r.ensureNotClass(i));u.removeAttribute(i)},n.prototype.toggleClass=function(n,t,r,u){var f=n.getAndEnsureElementNode(t).element;i.toggleClass(f,r,u)},n.prototype.setStyle=function(n,t,i,r){n.getAndEnsureElementNode(t).element.style[i]=r||""},n.prototype.clear=function(n){i.removeNodesBetween(n.commentStart,n.commentEnd)},n.prototype.remove=function(n){this.clear(n);i.removeNode(n.commentStart);i.removeNode(n.commentEnd)},n.prototype.toggleDisplay=function(n,t,i){var r=n.getAndEnsureDynamicNode(t),u,f;if(r.type!=="if")throw new Error('Only If node supports "toggleDisplay", '+t+", "+r.type);(i=!!i,u=this._getOrCreateDynamicNodeDisplayState(r.commentStart,!1),u.visible!==i)&&(u.visible=i,f=i?-1:1,this._applyDisplayState(f,h(u,f),r.commentStart.nextSibling,r.commentEnd))},n.prototype.setDisplayState=function(n,t){var i=this._dynamicNodeDisplayStateMap.get(n);i&&i.hideCount!==0&&this._applyDisplayState(i.hideCount,3,t.firstChild,null)},n.prototype._applyDisplayState=function(n,t,r,u){var e;if(r!==null)for(var s=[t],o=0,f=r;f!==u;)i.isNodeType(f,8)?i.isCommentStartId(f.textContent)?s[++o]=h(this._getOrCreateDynamicNodeDisplayState(f,n<0),n):i.isCommentEndId(f.textContent)&&o--:i.isNodeType(f,1)?(e=s[o],e!==1&&i.toggleClass(f,"weave-display-none2",e===3)):i.isNodeType(f,3)&&(e=s[o],e===2?f.textContent=this._textHiddenContentMap.get(f):e===3&&(this._textHiddenContentMap.set(f,f.textContent),f.textContent="")),f=f.nextSibling},n.prototype._getOrCreateDynamicNodeDisplayState=function(n,t){var i=this._dynamicNodeDisplayStateMap.get(n);if(!i){if(t)throw new Error("DynamicNodeDisplayState doesn't exist, "+n.textContent);this._dynamicNodeDisplayStateMap.set(n,i={visible:!0,hideCount:0})}return i},n})();t.DirectDomAgent=s}));
define("WeaveDOM/DirectRender/AttributeHandler",["require","exports","Weave/Core/InternalUtil"],(function(n,t,i){"use strict";function r(n,t){i.isNotNullNorUndefined(t)&&n.addDeferredBinding({handler:e,value:t})}function u(n,t,i,r,u,e){var o=u.type;e==="input"&&o==="file"&&n.addBinding({handler:f,value:t})}function e(n,t,i){var r=n.getElementMetadata(t);i(r.element,r.ltm.innerLtmRoot)}Object.defineProperty(t,"__esModule",{value:!0});t.onChangeHandler=t.onWheelHandler=t.onTouchStartHandler=t.onTouchMoveHandler=t.onTouchEndHandler=t.onTouchCancelHandler=t.onSelectHandler=t.onScrollHandler=t.onMouseUpHandler=t.onMouseOverHandler=t.onMouseOutHandler=t.onMouseMoveHandler=t.onMouseDownHandler=t.onFocusHandler=t.onDropHandler=t.onDragStartHandler=t.onDragOverHandler=t.onDragLeaveHandler=t.onDragExitHandler=t.onDragEnterHandler=t.onDragEndHandler=t.onDragHandler=t.onDoubleClickHandler=t.onBlurHandler=t.afterMountHandler=void 0;t.afterMountHandler=r;t.onBlurHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("blur"));t.onDoubleClickHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("dblclick"));t.onDragHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("drag"));t.onDragEndHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("dragend"));t.onDragEnterHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("dragenter"));t.onDragExitHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("dragexit"));t.onDragLeaveHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("dragleave"));t.onDragOverHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("dragover"));t.onDragStartHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("dragstart"));t.onDropHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("drop"));t.onFocusHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("focus"));t.onMouseDownHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("mousedown"));t.onMouseMoveHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("mousemove"));t.onMouseOutHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("mouseout"));t.onMouseOverHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("mouseover"));t.onMouseUpHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("mouseup"));t.onScrollHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("scroll"));t.onSelectHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("select"));t.onTouchCancelHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("touchcancel"));t.onTouchEndHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("touchend"));t.onTouchMoveHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("touchmove"));t.onTouchStartHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("touchstart"));t.onWheelHandler=i.generateBindOnlyAttributeHandler(i.makeEventHandler("wheel"));t.onChangeHandler=u;var f=i.makeEventHandler("change")}));
define("WeaveDOM/DirectRender/Common",["require","exports","WeaveDOM/Core/InternalUtil","Weave/Core/InternalUtil"],(function(n,t,i,r){"use strict";var u,f;Object.defineProperty(t,"__esModule",{value:!0});t.createHTMLNode=t.createTextNode=t.markParentActive=t.markInactive=t.markAttributeSealed=t.markSealed=t.ensureActive=t.ensureNotAttributeSealed=t.ensureNotSealed=void 0;u=function(n){return this.collectors.htmlCollector.push(r.encodeHtml(n)),this};t.createTextNode=u;f=function(n){return this.collectors.htmlCollector.push(this.getHtmlString(n)),this};t.createHTMLNode=f}));
define("WeaveDOM/DirectRender/DataAttribute",["require","exports","Weave/Core/InternalUtil"],(function(n,t,i){"use strict";function r(n){return u.get(n)}Object.defineProperty(t,"__esModule",{value:!0});t.dataHandler=t.getElementData=void 0;t.getElementData=r;t.dataHandler=i.generateBindOnlyAttributeHandler((function(n,t,i){u.set(n.getElementMetadata(t).element,i)}));var u=new WeakMap,f=window.weaveDebug||(window.weaveDebug={});f.getElementData=r}));
define("WeaveDOM/DirectRender/ForEachNodeOperations",["require","exports","WeaveDOM/Core/InternalUtil"],(function(n,t,i){"use strict";function u(n,t,u,f,e,o,s){var h=f.map((function(n){return e(n)?null:o(n)})),c=document.activeElement,l=r(n,t,f.length-1,u.commentEnd.previousSibling,f,e,h,s);return i.removeNodesBetween(u.commentStart,l),document.activeElement!==c&&c.focus(),h}function r(n,t,i,r,u,s,h,c){if(i>=0){var l=u[i];return s(l)?f(n,t,i,r,u,s,h,c):n(l).commentEnd===r?e(n,t,i,r,u,s,h,c):o(n,t,i,r,u,s,h,c)}return r.nextSibling}function f(n,t,i,u,f,e,o,s){for(var c=i,l,a,h;i>=0&&e(f[i]);)--i;if(i!==c){for(l=c-i,a=t(f.slice(i+1,c+1),u),h=0;h<l;++h)o[h+i+1]=a[h];s.created+=l}return r(n,t,i,u,f,e,o,s)}function e(n,t,i,u,f,e,o,s){for(var l=i,h,c;i>=0;){if(h=f[i],!e(h)&&(c=n(h),c.commentEnd===u)){u=c.commentStart.previousSibling;--i;continue}break}return s.skipped+=l-i,r(n,t,i,u,f,e,o,s)}function o(n,t,u,f,e,o,s,h){for(var a=u,v,c,p;u>=0&&!o(e[u])&&n(e[u]).commentEnd!==f;)--u;if(u!==a){for(v=document.createDocumentFragment(),c=u+1;c<=a;++c)for(var y=n(e[c]),l=y.commentStart,w=y.commentEnd.nextSibling;l!==w;)p=l.nextSibling,v.appendChild(l),l=p;i.insertNodeBeforeNode(f.nextSibling,v);h.moved+=a-u}return r(n,t,u,f,e,o,s,h)}Object.defineProperty(t,"__esModule",{value:!0});t.processForEachItems=void 0;t.processForEachItems=u}));
define("WeaveDOM/DirectRender/NodeEditors",["require","exports","WeaveDOM/DirectRender/Common","WeaveDOM/Core/InternalUtil","WeaveDOM/Core/Sanitization","Weave/Core/InternalUtil","Weave/Core/WeaveUtil"],(function(n,t,i,r,u,f,e){"use strict";function h(){throw new Error("Operation is not supported for self-close element.");}var o,s,c,l;Object.defineProperty(t,"__esModule",{value:!0});t.createChildElementNode=t.createChildDynamicNode=t.ignoreDebugInfo=void 0;o=function(n){this.state|=8;var t=f.getUniqueDynamicNodeId(),u=r.getUniqueCommentIdPair(),h=u.commentStartId,l=u.commentEndId,a=f.createDynamicNodeLtms(n.type,this.ltm),v=a.selfLtm,y=a.contentLtm;return this.collectors.dynamicBindingCollector.push({commentStartId:h,commentEndId:l,dynamicNodeId:t,initContentLtm:y,metadata:n,selfLtm:v}),this.collectors.htmlCollector.push("<!--",h,"-->"),{attributeSanitizer:this.attributeSanitizer,collectors:this.collectors,commentEndId:l,getHtmlString:this.getHtmlString,ltm:y||v,nodeId:t,nodeType:n.type,parentEditor:this,state:1,createChildDynamicNode:o,createChildElementNode:s,createChildVirtualNode:e.returnThis,createHTMLNode:i.createHTMLNode,createTextNode:i.createTextNode,seal:c}};t.createChildDynamicNode=o;s=function(n){return this.collectors.htmlCollector.push("<",n),{attributeSanitizer:this.attributeSanitizer,collectors:this.collectors,elementBinders:undefined,elementDeferredBinders:undefined,elementId:"",debugInfo:undefined,getHtmlString:this.getHtmlString,idAttrPlaceHolderIndex:-1,ltm:this.ltm,parentEditor:this,state:1,tagName:n,addAttribute:p,addBinding:w,addDebugInfo:k,addDeferredBinding:b,seal:y,sealAttributes:l}};t.createChildElementNode=s;c=function(){this.collectors.htmlCollector.push("<!--",this.commentEndId,"-->")};l=function(){var n=this.collectors.htmlCollector,t;return this.elementBinders||this.elementDeferredBinders?(t=this.elementId,t||(this.elementId=t=f.getUniqueElementId(),n.push(' id="',t,'"')),this.collectors.elementBindingCollector.push({elementId:t,binders:this.elementBinders,deferredBinders:this.elementDeferredBinders,ltm:this.ltm})):this.elementId||(this.idAttrPlaceHolderIndex=n.length,n.push("")),u.isSelfCloseTag(this.tagName)?(n.push("/>"),{attributeSanitizer:undefined,collectors:undefined,commentEndId:undefined,getHtmlString:undefined,ltm:undefined,nodeId:undefined,nodeType:undefined,parentEditor:this,state:1,createChildDynamicNode:h,createChildElementNode:h,createChildVirtualNode:e.returnThis,createHTMLNode:h,createTextNode:h,seal:a}):(n.push(">"),{attributeSanitizer:this.attributeSanitizer,collectors:this.collectors,commentEndId:undefined,getHtmlString:this.getHtmlString,ltm:this.ltm,nodeId:undefined,nodeType:undefined,parentEditor:this,state:1,createChildDynamicNode:o,createChildElementNode:s,createChildVirtualNode:e.returnThis,createHTMLNode:i.createHTMLNode,createTextNode:i.createTextNode,seal:v})};var a=e.noop,v=function(){if(this.state&8){var t=this.parentEditor,n=t.elementId;n||(n=t.elementId=f.getUniqueElementId(),this.collectors.htmlCollector[t.idAttrPlaceHolderIndex]=' id="'+n+'"');this.collectors.commentContainerCollector.push(n)}},y=function(){u.isSelfCloseTag(this.tagName)||this.collectors.htmlCollector.push("<\/",this.tagName,">")},p=function(n,t){var i=u.sanitizeAttributeValue(n,t,this.attributeSanitizer);return i.valid?this.collectors.htmlCollector.push(" ",n,'="',f.encodeHtml(i.value),'"'):console.warn("Invalid attribute value will be ignored: "+n+", "+t),this},w=function(n){return this.elementBinders?this.elementBinders.push(n):this.elementBinders=[n],this},b=function(n){return this.elementDeferredBinders?this.elementDeferredBinders.push(n):this.elementDeferredBinders=[n],this},k=function(){throw new Error("addDebugInfo not supported in prod mode.");}}));
define("WeaveDOM/DirectRender/RenderAgent",["require","exports","Weave/Core/RenderAgentBase","WeaveDOM/Core/InternalUtil","WeaveDOM/DirectRender/Common","WeaveDOM/DirectRender/NodeEditors","Weave/Core/ApplyBindings","WeaveDOM/DirectRender/ForEachNodeOperations","WeaveDOM/Core/Sanitization","Weave/Core/CollectRenderInfo","WeaveDOM/DirectRender/AttributeHandler","Weave/Core/InternalUtil","Weave/Core/WeaveUtil","WeaveDOM/Core/DomOperatorBase","WeaveDOM/DirectRender/DataAttribute","Weave/Core/AttributeHandler","Weave/Core/InternalUtil"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){"use strict";function tt(n){var t=w.makeMap(g.concat(n.customAttributeHandlers||[]),(function(n){return n.name}),(function(n){return n.handler}),!1);return function(n,i,r,u,f,e,o){var s=t.get(i);s?s(n,r,u,f,e,o):p.htmlAttributeHandler(n,i,r,0)}}function d(n){return"_wv_locator_"+n}function it(n){return n.itemId}function rt(n){return n.weaveNode}function ut(n){return n.type==="new"}function ft(n){return n.metadata}function et(n){return n.itemId}var b,k,g,nt;Object.defineProperty(t,"__esModule",{value:!0});t.DirectModeRenderEngine=void 0;b=a.noop;k=(function(n){function t(t){var i=n.call(this,tt(t),undefined,t.customEventDataProvider)||this,u;return i._options=t,i._domAgent=new v.DirectDomAgent,i._attributeSanitizer=i._options.attributeSanitizer,i._getHtmlString=i._options.htmlElementDataSerializer,i.thisInstance=i,i.render(i._memoryManager.outerLtmRoot,undefined,t.weaveNode,h.createInternalWeaveContext(__assign({},t.weaveContext)),new l.AggregationRelay(t.aggregators,{}),t.afterMount,(function(n){var o=n.containerDoc,t;if(i.applyCssChanges(),t=i._options.rootElement,i._options.renderKind==="replace")r.removeAllChildren(t),t.appendChild(o),u=function(){return r.removeAllChildren(t)};else{var s=nt++,e=document.createComment("tsx_vroot_"+s+"_start"),f=document.createComment("tsx_vroot_"+s+"_end");t.appendChild(e);t.appendChild(f);r.insertNodeBeforeNode(f,o);u=function(){r.removeNodesBetween(e,f);r.removeNode(e);r.removeNode(f)}}})),i._cleanup=u,i}return __extends(t,n),t.prototype.buildNodeLookup=function(n){for(var i,u,o,t,f,c=n.elementBindings,l=n.dynamicBindings,a=n.containerDoc,s=n.commentLookup,e=0,h=c;e<h.length;e++)i=h[e],this._memoryManager.setElementNode({nodeId:i.elementId,ltm:i.ltm,element:r.getElementByIdInDocumentFragment(a,i.elementId)});for(u=0,o=l;u<o.length;u++)t=o[u],f=t.metadata,this._memoryManager.setDynamicNode({nodeId:t.dynamicNodeId,type:f.type,commentStart:s.get(t.commentStartId),commentEnd:s.get(t.commentEndId),contentLtm:t.initContentLtm,selfLtm:t.selfLtm,itemNodesId:f.type==="forEach"?f.initRenderDomInfo.map(it):undefined})},t.prototype.applyCssChanges=function(){var n=[],t=[];this._cssMetadataMap.forEach((function(i,r){i.oldRefCount===0&&i.newRefCount>0?n.push(r):i.oldRefCount>0&&i.oldRefCount===0&&t.push(r);i.oldRefCount=i.newRefCount}));(n.length||t.length)&&this._options.cssLoader(n,t)},t.prototype.clearVisualState=function(n){this._domAgent.clear(n)},t.prototype.createCollector=function(n){var t=undefined,i=undefined;return{attributeSanitizer:this._attributeSanitizer,collectors:{commentContainerCollector:[],dynamicBindingCollector:[],dynamicDebugInfoCollector:t,elementBindingCollector:[],elementDebugInfoCollector:i,htmlCollector:[]},commentEndId:undefined,getHtmlString:this._getHtmlString,ltm:n,nodeId:undefined,nodeType:undefined,parentEditor:undefined,state:1,createChildDynamicNode:f.createChildDynamicNode,createChildElementNode:f.createChildElementNode,createChildVirtualNode:a.returnThis,createHTMLNode:u.createHTMLNode,createTextNode:u.createTextNode,seal:b}},t.prototype.clearLogicalState=function(n,t,i){r.ensureNoContent(this._memoryManager,n,i,this._ltmRemovalCallback)},t.prototype.removeVisualState=function(n){this._domAgent.remove(n)},t.prototype.sealCollector=function(n){n.seal();var t=n.collectors,u=t.htmlCollector.join(""),i=r.documentFragmentFromHtml(u),f=r.collectCommentNodes(t.commentContainerCollector,i);return{commentLookup:f,containerDoc:i,dynamicBindings:t.dynamicBindingCollector,dynamicDebugInfos:t.dynamicDebugInfoCollector,elementBindings:t.elementBindingCollector,elementDebugInfos:t.elementDebugInfoCollector,ltm:n.ltm}},t.prototype.setContent=function(n,t,i){var u=i.commentStart,f=i.commentEnd;if(u.nextSibling!==f)throw new Error("The next sibling of start node is not end node.");this._domAgent.setDisplayState(u,n.containerDoc);r.insertNodeBeforeNode(f,n.containerDoc)},t.prototype.setAttribute=function(n,t,i){this._domAgent.setAttribute(this._memoryManager,this._attributeSanitizer,n,t,i)},t.prototype.removeAttribute=function(n,t){this._domAgent.removeAttribute(this._memoryManager,n,t)},t.prototype.toggleClass=function(n,t,i){this._domAgent.toggleClass(this._memoryManager,n,t,i)},t.prototype.setStyle=function(n,t,i){this._domAgent.setStyle(this._memoryManager,n,t,i)},t.prototype.toggleDisplay=function(n,t){this._domAgent.toggleDisplay(this._memoryManager,n.dynamicNodeId,t)},t.prototype.dispose=function(){n.prototype.dispose.call(this);this._cleanup()},t.prototype.addEventListener=function(n,t){var e=this,i=t.eventName,o=t.eventHandler,u,f;if(i==="input")throw new Error(i+" is not allowed through this API: addEventListener");u=this._memoryManager.getAndEnsureElementNode(n);f=u.ltm.innerLtmRoot;r.attachEventListener(u.element,f,i,(function(n){o(e._makeFullEventData(n,i,f,l.getEventData(n,i)))}))},t.prototype.setItems=function(n,t,i,r,u){var f=this,e=this._memoryManager.getAndEnsureDynamicNode(n),y,p,c,w,b,k,a,v;for(l.ensureDynamicNodeOperation(e.type,8),y=e.itemNodesId,p=s.arrayToSet(y),c=0,w=i;c<w.length;c++)if(b=w[c],b.type==="exist"&&(k=b.metadata.itemId,!p.delete(k)))throw new Error("The ForEachItem node "+k+" doesn't exists, state tracking is lost.");return p.forEach((function(n){f.removeLogicalState(n,t)})),a={created:0,deleted:0,skipped:0,moved:0},v=o.processForEachItems((function(n){return f.getDynamicNodeMetadata(n.metadata.itemId)}),(function(n,i){var o=f.createCollector(e.selfLtm,t),c=h.collectForEachItemsRenderInfo({aggregators:u.aggregators,attributesHandler:f._handleAttribute,cssMetadataMap:f._cssMetadataMap,hooksState:undefined},t,o,n.map(rt),r,u),s=f.sealCollector(o);return f.applyCssChanges(),f._domAgent.setDisplayState(e.commentStart,s.containerDoc),f._renderBetweenNodes(s,i,i.nextSibling),c}),e,i,ut,ft,a),a.deleted=y.length-(v.length-a.created),e.itemNodesId=v.map(et),v},t.prototype.getDynamicNodeMetadata=function(n){return this._memoryManager.getAndEnsureDynamicNode(n)},t.prototype.focus=function(n,t){var i=this._options.rootElement.getElementsByClassName(d(n))[t];i&&document.activeElement!==i&&i.focus()},t.prototype.setLocatorClass=function(n,t){this._domAgent.toggleClass(this._memoryManager,n,d(t),!0)},t.prototype.initTwoWayInputBinding=function(n,t,i){var l=this,u=this._memoryManager.getAndEnsureElementNode(n),e=this._domAgent.prepareInitInputBinding(u,t),o,s,f,h,c;for(this._domAgent.inputBindingsMgr.createInputBinding(u,{type:"twoWay",name:t}),o=u.element,s=u.ltm.innerLtmRoot,f=0,h=e.eventsToListen;f<h.length;f++)c=h[f],r.attachEventListener(o,s,c,(function(n){e.writeValueToElement(o,i(l._makeFullEventData(n,t,s,e.collectDataFromEvent(n))))}))},t.prototype.initValuePushInputBinding=function(n,t){var i=this._memoryManager.getAndEnsureElementNode(n),o=this._domAgent.prepareInitInputBinding(i,t),s={type:"valuePush",name:t,lastReceivedValue:undefined},f,h,u,e,c;for(this._domAgent.inputBindingsMgr.createInputBinding(i,s),f=i.element,h=i.ltm.innerLtmRoot,u=0,e=o.eventsToListen;u<e.length;u++)c=e[u],r.attachEventListener(f,h,c,(function(){o.writeValueToElement(f,s.lastReceivedValue)}))},t.prototype.initValueSubscribeInputBinding=function(n,t,i){var l=this,u=this._memoryManager.getAndEnsureElementNode(n),s=this._domAgent.prepareInitInputBinding(u,t),h,e,f,o,c;for(this._domAgent.inputBindingsMgr.createInputBinding(u,{type:"valueSubscribe",name:t}),h=u.element,e=u.ltm.innerLtmRoot,f=0,o=s.eventsToListen;f<o.length;f++)c=o[f],r.attachEventListener(h,e,c,(function(n){i(l._makeFullEventData(n,t,e,s.collectDataFromEvent(n)))}))},t.prototype.pushInputValue=function(n,t,i){var r=this._memoryManager.getAndEnsureElementNode(n),u=this._domAgent.inputBindingsMgr.resolveInputBinding(r,t,["twoWay","valuePush"]),f=this._domAgent.ensureInputBindingMetadata(t);u.type==="valuePush"&&(u.lastReceivedValue=i);f.writeValueToElement(r.element,i)},t.prototype._makeFullEventData=function(n,t,i,r){return __assign(__assign(__assign({},r),{event:n,ltm:i}),this._customEventDataProvider(t))},t.prototype._renderBetweenNodes=function(n,t,i){var u=n.containerDoc;if(this.buildNodeLookup(n),t.nextSibling!==i)throw new Error("The next sibling of start node is not end node.");r.insertNodeBeforeNode(i,u);e.applyBindings(this,n.elementBindings,n.dynamicBindings)},t})(i.RenderAgentBase);t.DirectModeRenderEngine=k;g=[{name:"afterMount",handler:c.afterMountHandler},{name:"autoplay",handler:p.autoplayHandler},{name:"checked",handler:p.checkedHandler},{name:"className",handler:p.classNameHandler},{name:"controls",handler:p.controlsHandler},{name:"coords",handler:p.coordsHandler},{name:"data",handler:y.dataHandler},{name:"disabled",handler:p.disabledHandler},{name:"id",handler:p.idHandler},{name:"loop",handler:p.loopHandler},{name:"muted",handler:p.mutedHandler},{name:"autofocus",handler:p.autofocusHandler},{name:"formnovalidate",handler:p.formnovalidateHandler},{name:"hidden",handler:p.hiddenHandler},{name:"open",handler:p.openHandler},{name:"novalidate",handler:p.novalidateHandler},{name:"seamless",handler:p.seamlessHandler},{name:"ismap",handler:p.ismapHandler},{name:"required",handler:p.requiredHandler},{name:"onBlur",handler:c.onBlurHandler},{name:"onChange",handler:c.onChangeHandler},{name:"onValueChange",handler:p.onValueChangeHandler},{name:"onCheckedChange",handler:p.onCheckedChangeHandler},{name:"onClick",handler:p.onClickHandler},{name:"onDoubleClick",handler:c.onDoubleClickHandler},{name:"onDrag",handler:c.onDragHandler},{name:"onDragEnd",handler:c.onDragEndHandler},{name:"onDragEnter",handler:c.onDragEnterHandler},{name:"onDragExit",handler:c.onDragExitHandler},{name:"onDragLeave",handler:c.onDragLeaveHandler},{name:"onDragOver",handler:c.onDragOverHandler},{name:"onDragStart",handler:c.onDragStartHandler},{name:"onDrop",handler:c.onDropHandler},{name:"onFocus",handler:c.onFocusHandler},{name:"onFocusIn",handler:p.onFocusInHandler},{name:"onFocusOut",handler:p.onFocusOutHandler},{name:"onKeyDown",handler:p.onKeyDownHandler},{name:"onKeyPress",handler:p.onKeyPressHandler},{name:"onKeyUp",handler:p.onKeyUpHandler},{name:"onMouseDown",handler:c.onMouseDownHandler},{name:"onMouseEnter",handler:p.onMouseEnterHandler},{name:"onMouseLeave",handler:p.onMouseLeaveHandler},{name:"onMouseMove",handler:c.onMouseMoveHandler},{name:"onMouseOut",handler:c.onMouseOutHandler},{name:"onMouseOver",handler:c.onMouseOverHandler},{name:"onMouseUp",handler:c.onMouseUpHandler},{name:"onScroll",handler:c.onScrollHandler},{name:"onSelect",handler:c.onSelectHandler},{name:"onTouchCancel",handler:c.onTouchCancelHandler},{name:"onTouchEnd",handler:c.onTouchEndHandler},{name:"onTouchMove",handler:c.onTouchMoveHandler},{name:"onTouchStart",handler:c.onTouchStartHandler},{name:"onWheel",handler:c.onWheelHandler},{name:"readonly",handler:p.readonlyHandler},{name:"ref",handler:p.refHandler},{name:"style",handler:p.styleHandler},{name:"value",handler:p.valueHandler},{name:"visible",handler:p.visibleHandler},{name:"reversed",handler:p.reversedHandler},{name:"default",handler:p.defaultHandler},{name:"multiple",handler:p.multipleHandler},];nt=0}));
define("MsPortalImpl/Weave/DirectRender",["require","exports","MsPortalImpl/Weave/Util","MsPortalImpl/Weave/InternalUtil","WeaveDOM/DirectRender/RenderAgent","MsPortalImpl/Base/Base.KnockoutExtensions.Image","Viva.Controls/Util/Viva.Resize","MsPortalImpl/Weave/SandboxDomAgents/EntryPoint","Weave/Core/InternalUtil","FxInternal/Weave/Util","Fx/Weave","FxInternal/Weave/Aggregators","FxInternal/Css","MsPortalImpl/Base/Base.Timers","Weave/Core/ClassNameProcessor","WeaveDOM/Core/InternalUtil"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){"use strict";function nt(n){var t=n.weaveNode;return h.isWeaveNodeWithParentRenderInfo(t)&&(it(n.element,n.ltm,t),t=t.weaveNode),b(__assign(__assign({},n),{weaveNode:t}),"replace")}function tt(n){return b(n,"append")}function b(t,i){function v(n,t,i){var r=n.getElementMetadata(t),u=r.element,e=r.ltm;o.attachSandboxDomAgent(u,e.innerLtmRoot,f.diContainer,i)}var f=t.weaveContext,e=t.element,h=t.ltm,c=new u.DirectModeRenderEngine({afterMount:t.afterMount,aggregators:l.aggregators,attributeSanitizer:{href:function(t){return r.sanitizeHref(t,{diContainer:f.diContainer,windowContext:e,localRequire:n})},src:r.sanitizeSrc},cssLoader:t.cssLoader||function(n){return a.injectCss.apply(void 0,n||[])},customAttributeHandlers:[{name:"fxclick",handler:ut},{name:"image",handler:k},{name:"onResize",handler:d},{name:"domAgent",handler:s.generateDeferredBindOnlyAttributeHandler(v)},{name:"pcControl",handler:st},{name:"onClick",handler:g},w("onKeyDown","keydown"),w("onKeyPress","keypress"),w("onKeyUp","keyup"),],customEventDataProvider:function(){return{requestConfirm:ot}},htmlElementDataSerializer:r.makeHtmlDataHandler(e,f.diContainer,!0),renderKind:i,rootElement:e,weaveNode:t.weaveNode,weaveContext:f});h.registerForDispose(c)}function it(n,t,i){var r,u;!t.isDisposed()&&i.parentClassName&&(r=y.processClassName(i.parentClassName,t),p.toggleClass(n,r.initClass,!0),u=y.applyClassBindingMetadata(r,t,(function(t,i){return p.toggleClass(n,t,i)})),t.registerForDispose((function(){for(var r,t=0,i=u();t<i.length;t++)r=i[t],p.toggleClass(n,r,!1)})))}function rt(n,t,i){var r=n.getElementMetadata(t).element;s.activateAndRun(n,t,i,(function(n){f.renderImage(r,n)}))}function ut(n,t,i){MsPortalFx.isNullOrUndefined(t)||n.addBinding({handler:ft,value:{data:t,context:i}})}function ft(n,t,i){var f=n.getElementMetadata(t),u=f.ltm.innerLtmRoot;r.applyFxClickToElement(f.element,u,h.valueOrComputationToValueOrObservable(u,i.data),{diContainer:i.context.diContainer,disabled:c.toObservable(u,i.context.disabled),tabIndex:c.toObservable(u,i.context.tabIndex)})}function et(n,t,i){var u=n.getElementMetadata(t),r=n.getElementNodeLtm(t);v.requestAnimationFrame((function(){r.isDisposed()||e.track(r.createChildLifetime(),$(u.element),(function(n,t){return i({ltm:r,height:t,width:n})}),{notifyInitialSize:!0})}))}function ot(n){return new Promise(function(t){t(window.confirm(n)?"ok":"cancel")})}function st(n,t,i){MsPortalFx.isNullOrUndefined(t)||(n.addAttribute("data-bind","pcControl: __control_vm__"),n.addDeferredBinding({handler:ht,value:{vm:t,context:i}}))}function ht(n,t,r){var u=n.getElementMetadata(t),f=u.element,e=u.ltm,o=r.vm,s=r.context,h=i.weaveContextToKoContext(s,e.innerLtmRoot,{__control_vm__:o});ko.applyBindings(h,f);e.innerLtmRoot.registerForDispose((function(){return ko.cleanNode(f)}))}function ct(n,t,i){var r=typeof i=="function"?{eventHandler:i,stopPropagation:!1,preventDefault:!1}:{eventHandler:i.handler,stopPropagation:i.stopPropagation,preventDefault:i.preventDefault},u=r.eventHandler,f=r.stopPropagation,e=r.preventDefault;n.addEventListener(t,{eventName:"click",eventHandler:function(n){f&&n.event.stopPropagation();e&&n.event.preventDefault();u(n)}})}function w(n,t){return{name:n,handler:s.generateBindOnlyAttributeHandler((function(n,i,u){var f=typeof u=="function"?{eventHandler:u,stopPropagation:undefined,preventDefault:undefined}:{eventHandler:u.handler,stopPropagation:u.stopPropagation,preventDefault:u.preventDefault},e=f.eventHandler,o=f.stopPropagation,s=f.preventDefault;n.addEventListener(i,{eventName:t,eventHandler:function(n){r.matchKeyCode(o,n.keyCode)&&n.event.stopPropagation();r.matchKeyCode(s,n.keyCode)&&n.event.preventDefault();e(n)}})}))}}var k,d,g;Object.defineProperty(t,"__esModule",{value:!0});t.appendToElement=t.applyToElement=void 0;t.applyToElement=nt;t.appendToElement=tt;k=s.generateDeferredBindOnlyAttributeHandler(rt);d=s.generateDeferredBindOnlyAttributeHandler(et);g=s.generateBindOnlyAttributeHandler(ct)}));
define("_generated/MsPortalImpl/Svg/Startup/Warning.svg",["require","exports"],(function(){"use strict";return{type:9,data:"<svg viewBox='0 0 9 9' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path fill='#db7500' d='M8.267 8H.733c-.6 0-.916-.623-.62-1.129L2.014 3.53 3.896.384c.302-.507.903-.514 1.197-.008L7.001 3.65l1.882 3.229C9.183 7.383 8.881 8 8.267 8z'/><circle cx='4.5' cy='6.178' r='.615' class='msportalfx-svg-c01'/><path d='M4.623 2.428H3.98l.164 2.85h.774l.165-2.85z' class='msportalfx-svg-c01'/><\/g><\/svg>"}}));
define("MsPortalImpl/Widgets/Widgets.Common",["require","exports","Fx/DependencyInjection","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.SvgHelper","_generated/MsPortalImpl/Svg/Startup/Warning.svg","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","Fx/Weave"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function tt(n,t,i){var e,o,s;t===void 0&&(t=0);i===void 0&&(i=!1);var r=n.getBoundingClientRect(),u=document.documentElement,f=!0;return i||(e=c.innerWidth||u.clientWidth,f=r.left>=0&&r.right<=e),o=c.innerHeight||u.clientHeight,s=r.top+t>=0&&r.bottom+t<=o,{elementRect:r,fullyVisible:s&&f}}function it(n,t){var i,r;if(!n||!t){a.error("Cannot register a template with an undefined "+(n?"content":"name")+".");return}if(!/^[a-z][a-z0-9]*$/ig.test(n)){a.error("Name '"+n+"' is invalid. Name must start with a letter and can only contain letters and numbers.");return}if(i=$(c.document.body),i.find("#"+n).length){a.error("A template with name '"+n+"' was already registered.");return}r=$(FxImpl.createElement("script",{id:n,type:"text/html"})).text(t);i.append(r)}function b(n){function r(t){var i=t.element;return n===i||$.contains(n,i)}var i=MsPortalFx.find(p,r),t;return i?i.promise:(t=y.get(n)||MsPortalFx.find(l,(function(t){return $.contains(n,t.element)})),t)?t.promise.then((function(){return b(n)})):Q()}function rt(n){if(n){if(!$.contains(c.document.documentElement,n))return Q.reject(new MsPortalFx.Errors.CanceledError("container is not in documentElement"))}else return FxImpl.QReject("container is "+n);return b(n)}function ut(n){n&&$.contains(c.document.documentElement,n)&&l.filter((function(t){var i=t.element;return n===i||$.contains(n,i)})).forEach((function(n){MsPortalFx.remove(l,n);n&&n.dispose()}))}function ft(n,t,u,f,e){var b=$(u),d=r.getWidget(b),s,l,v,y,a,p,k;if(d!==null&&d.dispose(),f){if(s=void 0,w&&(s=MsPortalFx.getUniqueId(),c.performance.mark(s+"_start")),l=n.$dicontainer||i.container,v=t.WidgetUIState&&new t.WidgetUIState({diContainer:l,vm:f,sanitizationContext:u}),t.InnerTsxComponent||t.tryWeaveInnerContent){p=void 0;t.InnerTsxComponent?(y=new FxImpl.TriggerableLifetimeManager,p=t.InnerTsxComponent({state:v,vm:f})):(p=t.tryWeaveInnerContent({state:v,vm:f}),p!==undefined&&(y=new FxImpl.TriggerableLifetimeManager));var g=h.toComputation(n.$disabled),tt=h.toComputation(n.$enabledTabIndex),nt=h.toComputation(n.$tabIndex);y&&o.applyToElement({element:u,ltm:y,weaveNode:p,weaveContext:{disabled:g,tabIndex:nt,diContainer:l,partName:n.$partName,extensionName:n.$extensionName,koContext:n},opName:"control_"+e,afterMount:t.Widget?function(){a=new t.Widget(b,f,{weaveContext:{disabled:g,enabledTabIndex:tt,tabIndex:nt,diContainer:l},diContainer:l},v);a.ltm.registerForDispose(y)}:undefined})}if(!a&&t.Widget&&(a=new t.Widget(b,f,{bindingContext:n,diContainer:l},v)),w&&(c.performance.mark(s+"_end"),c.performance.measure(e,s+"_start",s+"_end")),a&&(k=a,k.awaitContentRevealed))return k.awaitContentRevealed()}}function et(n,t,i){var u,e,r,f;v.isInstanceOfErrorType(n,v.CanceledError)||(n&&(u=n.message||MsPortalFx.getLogFriendlyMessage(n),e=n.stack),r="Failed to load the control module '"+i+"'.",u&&(r+="\r\n Error: "+u),a.error(r,1),f=$(t),f.html(nt),Q.nextTick((function(){f.trigger("fxportalcontrolloadfailed",new MsPortalFx.Errors.Error({message:r,stack:e,innerErrors:n,data:n&&n.data}))})))}function ot(n,t){return t=t||{controlsDescendantBindings:!0},{init:function(){return t},update:function(t,i,r,u,f){var e=ko.unwrap(i());ko.ignoreDependencies((function(){var r,u=MsPortalFx.tryImmediateResolve(MsPortalFx.require(n),(function(i){if(!r)return ft(f,i,t,e,n)}),(function(i){if(!r&&!MsPortalFx.Errors.isInstanceOfErrorType(i,v.CanceledError))return et(i,t,n),Q.reject(i)})),o,s,i;Q.isFulfilled(u)||(o=function(){MsPortalFx.remove(l,i,-1);y.delete(t);r&&MsPortalFx.remove(p,i,-1)},s=function(){r=!0;o()},ko.utils.domNodeDisposal.addDisposeCallback(t,s),i={element:t,promise:u,dispose:s},Q.isPending(u)&&(l.push(i),y.set(t,i)),i.promise=u.catch((function(n){return p.push(i),Q.reject(n)})).finally(o))}))}}}function k(n){return n&&n.hasOwnProperty("htmlTemplate")}function st(n){return!!n&&n.hasOwnProperty("uri")}function ht(n,t,i,r){var u="";return k(t)?u=t.htmlTemplate:(i&&s.checkStringForHtmlInjection(n,t,i,r),u=t),s.looksLikeAnHtmlFragment(u)?$($.parseHTML(u,g)).text():u}function ct(n){var t=n.closest(".fxs-part-content");return t[0]?t[0].className.split(" ").filter((function(n){return n&&n.startsWith("css-scope-")})).join(" "):""}Object.defineProperty(t,"__esModule",{value:!0});t.getCssScope=t.getStringFromHtmlContent=t.isLink=t.isHtmlContent=t.getAsyncBindingHandler=t.cancelBindings=t.waitForBindings=t.registerKoTemplate=t.isElementFullyInViewport=void 0;var d=MsPortalFx.Base.Diagnostics,v=MsPortalFx.Errors,c=window,g=c.document.implementation.createHTMLDocument(""),w=FxImpl.features.isNativePerf,nt="<span class='fxs-portal-controlloadfailed'>"+f.getSvgReferenceOrFallBackToData(e).outerHTML+MsPortalFx.encodeHtml(u.PartError.title)+"<\/span>",a=d.createLog(n),l=[],y=new Map,p=[];t.isElementFullyInViewport=tt;t.registerKoTemplate=it;t.waitForBindings=rt;t.cancelBindings=ut;t.getAsyncBindingHandler=ot;t.isHtmlContent=k;t.isLink=st;t.getStringFromHtmlContent=ht;t.getCssScope=ct}));
define("_generated/Less/MsPortalImpl/Widgets/CopyField.css",["module"],(function(n){"use strict";return{css:".fxs-copyfield{display:none;position:absolute;width:24px;top:0;right:0}.fxs-copyfield .fxc-copyablelabel{padding:0;margin:-3px 0 -3px -.5px}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox{display:none}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{padding:0;border:0;margin:0;height:auto;background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button{padding:2px 1px 0 1px;margin:0;background-color:transparent;outline-width:1px}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button:hover{background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button svg{height:90%;width:90%}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button .fxc-copyablelabel-copyimage{height:22px;width:22px}.fxs-copyfield-container .fxs-copyfield-wrapper{position:absolute;top:0;right:0;width:24px;height:24px}.fxs-copyfield-container .fxs-copyfield{display:block}.fxs-copyfield-container.fxs-copyfield-copied .fxc-copyablelabel{padding-right:24px}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield-wrapper{width:100%}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield{width:100%}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-textbox{display:block}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-copybutton{margin-right:-24px}.fxs-part-resourcesummary .fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{font-size:13px}.fxs-mode-light .fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton:focus{outline:1px solid #605e5c}.fxs-mode-dark .fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton:focus{outline:1px solid #fff}",moduleId:n.id}}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.Copy",["require","exports","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Widgets/Widgets.Common","Fx/Controls/CopyableLabel","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/CopyField.css"],(function(n,t,i,r,u,f,e){"use strict";function a(n,t,i,f,e){var v="fxs-copyfield",y="fxs-copyfield-copied",s=$(t),o=$(FxImpl.createElement("div",{"class":v+"-wrapper","data-bind":"stopBindings: true"})),c=$(FxImpl.createElement("div",{"class":v,"data-bind":"pcCopyableLabel: $data"})),a;return c.appendTo(o),o.appendTo(s),a=u.create(n,f),a.readOnly(!0),ko.reactor(n,(function(){var n=ko.unwrap(i);a.value(n);s.toggleClass("fxs-copyfield-container",!MsPortalFx.isNullOrWhiteSpace(n))})),ko.applyBindingsToDescendants(a,o[0]),n.registerForDispose([s.setEvents(["fxcopybuttonclick",function(){s.addClass(y)},],["mouseleave",function(){s.removeClass(y)},]),function(){o&&(e||ko.utils.cleanDescendantNodes(o),o.remove())},]),l&&r.waitForBindings(c[0]).then((function(){var t=c.findByClassName("fxc-copyablelabel-copybutton");n.registerForDispose([t.setEvents(["keydown",function(n){var r=n.which,i;(r===13||r===32)&&(t.focus(),i=t.find(".fxc-copyablelabel-clicked")[0],i&&ko.contextFor(i).$ctl._showClickedTooltip())},]),])})),c.css(h,"0"),c}function c(n,t,i,r){var l=$(n),u=r||new o,f,c=!1,e=ko.observable(!1),s=ko.observable(!1),v=function(e){c=e;f||(f=a(u,n,t,i,!!r));f.css(h,e?"1":"0")};u.registerForDispose(l.setEvents(["focusin",function(){e(!0)},],["focusout",function(){e(!1)},],["mouseenter",function(){s(!0)},],["mouseleave",function(){s(!1)},]));ko.computed(u,[e,s],(function(n,t){var i=n||t;i!==c&&v(i)}));r||ko.utils.domNodeDisposal.addDisposeCallback(n,(function(){return u.dispose()}))}var o,s;Object.defineProperty(t,"__esModule",{value:!0});t.initializeCopyBinding=t.CopyField=void 0;o=FxImpl.TriggerableLifetimeManager;s=MsPortalFx.Base;f.injectCss(e);var v=s.Diagnostics.createLog(n),h="opacity",l=i.isIe||i.isEdge;t.initializeCopyBinding=c;ko.bindingHandlers.copy={init:function(n,t){return c(n,t())}}}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css",["module"],(function(n){"use strict";return{css:'.fxs-avatarmenu{flex:0 0 auto;box-sizing:border-box}.fxs-avatarmenu-header{position:relative;display:flex;align-items:center;height:40px}.fxs-avatarmenu-username{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:14px;line-height:normal;max-width:160px}.fxs-avatarmenu-tenant{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:600;font-size:10px;line-height:normal;text-transform:uppercase;max-width:160px}.fxs-avatarmenu-tenant-container{text-align:right;flex:1 1 auto;padding-left:20px}.fxs-avatarmenu-imageonly .fxs-dropmenu-button .fxs-avatarmenu-tenant-container{display:none}.fxs-avatarmenu-dropdown{width:220px;max-height:calc(100vh - 40px);overflow-x:hidden;overflow-y:auto}.fxs-avatarmenu-tenant-image-container{height:28px;width:28px;flex:0 0 auto;padding-left:6px;padding-right:6px;box-sizing:content-box}.fxs-avatarmenu-tenant-image{height:28px;width:28px;border:0;border-radius:28px}.fxs-avatarmenu-dropdown-item{display:flex}.fxs-avatarmenu-scrollviewer{max-height:505px;overflow:auto}html[lang^="ja"] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant,html[lang^="ko"] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant,html[lang^="zh"] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant{font-size:11px}',moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css",["module"],(function(n){"use strict";return{css:".fxs-contextMenu{display:none;position:fixed;width:192px;z-index:200;max-height:100vh;overflow-x:hidden;overflow-y:auto;border-style:solid;border-width:1px}.fxs-contextMenu:focus{outline:none}.fxs-contextMenu.fxs-contextMenu-active{display:block}.fxs-contextMenu-item{display:flex;align-items:center;padding:8px;box-sizing:border-box;font-size:13px;line-height:normal;cursor:pointer}.fxs-contextMenu-text{flex:1 1 auto;margin-left:8px;overflow:hidden;text-overflow:ellipsis}.fxs-contextMenu-icon{flex:0 0 auto;height:16px;width:16px;display:flex;justify-content:center;align-items:center;align-self:flex-start;margin-top:1px}.fxs-contextMenu-icon>svg{height:16px;width:16px}.fxs-contextMenu-itemList{list-style-type:none;margin:0;padding:0}.fxs-contextMenu-extensioncommand .fxs-contextMenu-icon{display:none}.fxs-contextMenu-extensioncommand.fxs-contextMenu-itemDisabled{display:block}.fxs-contextMenu-itemDisabled{cursor:text}.fxs-contextMenu-form{padding:8px 20px;display:none}.fxs-contextMenu-form.fxs-contextMenu-active{display:block}.fxs-dialogballoon.azc-balloon{opacity:1;width:auto;max-width:550px}.fxs-dialogballoon.azc-balloon>.azc-balloon-content{margin:0;overflow:unset;height:unset}.fxs-dialogballoon.azc-balloon .azc-balloon-text,.fxs-dialogballoon.azc-balloon .fxs-messagebox,.fxs-dialogballoon.azc-balloon>.azc-balloon-content{height:100%}.fxs-dialogballoon.azc-balloon .fxs-messagebox{overflow:auto}.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-mini,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-small,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-normal,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-tall,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-large,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-wide,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-herowide,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-herotall,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-hero{height:20px;width:20px}.msportalfx-contextmenu-grid rect{display:none}.msportalfx-contextmenu-grid-mini .msportalfx-grid-rect-mini,.msportalfx-contextmenu-grid-small .msportalfx-grid-rect-small,.msportalfx-contextmenu-grid-normal .msportalfx-grid-rect-normal,.msportalfx-contextmenu-grid-wide .msportalfx-grid-rect-wide,.msportalfx-contextmenu-grid-tall .msportalfx-grid-rect-tall,.msportalfx-contextmenu-grid-large .msportalfx-grid-rect-large,.msportalfx-contextmenu-grid-herowide .msportalfx-grid-rect-herowide,.msportalfx-contextmenu-grid-herotall .msportalfx-grid-rect-herotall,.msportalfx-contextmenu-grid-hero .msportalfx-grid-rect-hero{display:block}.fxs-contextMenuTouchHint{position:fixed;z-index:500;border:2px solid #808080;box-sizing:border-box;background-color:rgba(255,255,255,.2);pointer-events:none}",moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css",["module"],(function(n){"use strict";return{css:".fxs-contextpane{display:none;height:100%;position:relative;z-index:2;overflow:auto}.fxs-contextpane-content{box-sizing:border-box;height:auto;overflow:auto}.fxs-contextpane-loadindicator{display:none;position:absolute;top:0;bottom:0;right:0;left:0;background:inherit}.fxs-contextpane-loading .fxs-contextpane-loadindicator{display:block}.fxs-contextpane-visible{display:block}.fxs-contextpane-title{font-weight:600;font-size:18px;line-height:50px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin:0}.fxs-portal-contextpane-right{position:absolute;right:0;max-width:100%;height:100%}.fxs-portal-contextpane-right .fxs-blade{box-shadow:none}.fxs-blade.fxs-contextpane-content{min-width:300px}.fxs-isEdge.fxs-portal-contextpane-right{overflow:auto}.fxs-portal-contextpane-right.fxs-contextpane-loading{min-width:355px}@media(min-width:640px){.fxs-portal-contextpane-right{height:100%;max-width:calc(100% - 48px)}.fxs-sidebar-hamburger-mode .fxs-portal-contextpane-right{max-width:100%}}@media(min-width:1024px){.fxs-portal-contextpane-right{max-width:calc(100% - 225px)}.fxs-sidebar-is-collapsed~.fxs-portal-contextpane-right{max-width:calc(100% - 48px)}}@media(min-height:500px){.fxs-contextpane-visible{display:flex;flex-flow:column nowrap}.fxs-contextpane{overflow:initial}.fxs-contextpane-content{height:100%}}@media(max-height:499.99999px){.fxs-contextpane .fxc-gc-vscroll{max-height:calc(100vh - 45px)}}",moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Control.css",["module"],(function(n){"use strict";return{css:".fxc-base .fxs-tile-progress{background-color:inherit}.fxc-base .fxs-tile-progress .fxs-tile-progress-transparent{height:100%;width:100%;left:auto;top:auto}.fxc-base .fxs-tile-progress .fxs-tile-progress-transparent>div{margin:0;left:0;vertical-align:baseline}",moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css",["module"],(function(n){"use strict";return{css:".fxs-dropmenu{position:relative;flex:0 0 auto;box-sizing:border-box;z-index:200}.fxs-dropmenu-button{border:none;padding:0;margin:0;background:none;cursor:pointer;display:flex;position:relative;height:100%;align-items:center;justify-content:center}.fx-dropmenu-dropdown .fxs-dropmenu-list-system a{display:flex}.fxs-dropmenu-content:not(.azc-toolbarButton-overflowPopup){position:absolute}.fxs-dropmenu-content:not(.azc-toolbarButton-overflowPopup) ol,.fxs-dropmenu-content:not(.azc-toolbarButton-overflowPopup) ul{list-style:none outside none;padding:0;margin:0}.fxs-dropmenu-content:not(.azc-toolbarButton-overflowPopup) li{white-space:nowrap}.fxs-dropmenu-content:not(.azc-toolbarButton-overflowPopup) li a{align-items:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding:10px 20px}.fxs-dropmenu-list-content{flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-dropmenu-image{flex:0 0 auto;height:16px;width:16px}.fxs-dropmenu-image img,.fxs-dropmenu-image svg{height:13px;width:13px}.fxs-dropmenu-line-separator{border-top-width:1px;border-top-style:solid}.fxs-dropmenu-content li a:hover{text-decoration:none}.fxs-dropmenu-left{right:0}.fxs-dropmenu-right{left:0}.fxs-dropmenu-hidden{display:none}.fxs-dropmenu-invisible{visibility:hidden}",moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css",["module"],(function(n){"use strict";return{css:'.fxs-flowlayout{position:relative}.fxs-flowlayout>.fxs-flowlayout-childcontainer{position:relative;transition:height .25s linear,width .25s linear 0s}.fxs-flowlayout>.fxs-flowlayout-childcontainer>.fxs-flowlayout-element{position:absolute}.fxs-flowlayout>.fxs-flowlayout-childcontainer>.fxs-flowlayout-drop-placeholder{position:absolute;background:rgba(0,0,0,.2)}.fxs-flowlayout-childcontainer>.fxs-tile{transition:height 125ms linear 125ms,width 125ms linear 0s,top 175ms ease-out,left 175ms ease-out,right 175ms ease-out}.fxs-flowlayout-resolutionguide{position:absolute;top:0;left:0;box-sizing:border-box;color:#fff;border-color:#fff;opacity:.7;border-width:1px;border-right-style:dashed;border-bottom-style:dashed;pointer-events:none;font-size:13px;line-height:normal}.fxs-flowlayout-resolutionguide::after{position:absolute;right:8px;bottom:5px}.fxs-flowlayout-resolutionguide-1024x768{height:768px;width:1024px}.fxs-flowlayout-resolutionguide-1024x768::after{content:"1024 x 768"}.fxs-flowlayout-resolutionguide-1366x768{height:768px;width:1366px}.fxs-flowlayout-resolutionguide-1366x768::after{content:"1366 x 768"}.fxs-flowlayout-resolutionguide-1440x900{height:900px;width:1440px}.fxs-flowlayout-resolutionguide-1440x900::after{content:"1440 x 900"}.fxs-flowlayout-resolutionguide-1920x1080{height:1080px;width:1920px}.fxs-flowlayout-resolutionguide-1920x1080::after{content:"1920 x 1080"}.fxs-flowlayout-resolutionguide-3840x2160{height:2160px;width:3840px}.fxs-flowlayout-resolutionguide-3840x2160::after{content:"3840 x 2160"}.fxs-drag-surface{position:fixed;margin:0;padding:0;top:0;left:0;right:0;bottom:0;overflow:hidden;background-color:transparent;pointer-events:none;z-index:199}.fxs-drag-disableTouchAction{-ms-touch-action:none;touch-action:none}.fxs-flowlayout-resizehandle{display:inline-block;padding:0 4px 4px 0;bottom:0;right:0}.fxs-flowlayout-resizehandle>div{height:12px;width:12px;border:2px solid rgba(125,125,125,.5);border-left-width:0;border-top-width:0}.fxs-flowlayout-resizehandle,.fxs-flowlayout-livepreview{position:absolute;cursor:se-resize;z-index:1}.fxs-flowlayout-livepreview{min-width:85px;min-height:85px;max-width:2245px;max-height:2245px;overflow:hidden}',moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Panorama.css",["module"],(function(n){"use strict";return{css:".fxs-panorama{position:relative;-ms-scroll-chaining:none}.fxs-panorama .fxs-startboard-target,.fxs-panorama .fxs-home-target,.fxs-panorama .fxs-journey-target,.fxs-panorama .fxs-sidebar-flyout{display:none;position:absolute;top:0;left:0;height:100%;width:100%;z-index:0}.fxs-panorama .fxs-settings-flyout{position:absolute;top:0;left:0;height:100%;width:100%;z-index:202}.fxs-panorama>div[data-popup='true'].azc-control{z-index:150}.fxs-home-target{overflow-y:auto}.fxs-show-startboard .fxs-startboard-target,.fxs-show-journey .fxs-journey-target{display:flex}.fxs-show-home .fxs-home-target,.fxs-show-allservices .fxs-sidebar-flyout,.fxs-show-settings .fxs-settings-flyout{display:block}",moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css",["module"],(function(n){"use strict";return{css:"@keyframes fxs-search-indicator-animatedEllipses{0%{transform:scale(1);opacity:.3}36.1%{transform:scale(1.06);opacity:1}50%{transform:scale(1.06);opacity:1}86.1%{transform:scale(1);opacity:.3}}.fxs-search-menu{position:absolute;top:30px;left:0;width:100%;display:none;box-sizing:border-box;max-height:calc(100vh - 40px);overflow-x:hidden;overflow-y:auto}.fxs-asyncsearch-menu{position:absolute;top:30px;left:0;display:none;width:100%;box-sizing:border-box;max-height:calc(100vh - 40px);overflow-x:hidden;overflow-y:auto}.fxs-search-text{white-space:normal;overflow:hidden;text-overflow:ellipsis}.fxs-search-wrapper{display:flex;align-items:center;width:100%;border-radius:2px}.fxs-search{position:relative;display:flex}.fxs-search-icon-mini{padding:0 2px 0 8px;box-sizing:border-box;height:26px;width:22px;display:flex;align-items:center}.fxs-search-icon-mini svg{height:12px;width:12px}.fxs-search-clear{height:26px;width:24px;cursor:pointer;fill:#484644;box-sizing:border-box;display:flex;align-items:center;justify-content:center}.fxs-search-clear svg{height:12px;width:12px}.fxs-search-box{height:26px;flex:1 1 auto}.fxs-search-box .azc-input{border:0;font-size:13px;height:26px;background-color:transparent;box-sizing:border-box;outline:0;padding:2px 8px 4px;width:100%}.fxs-search-indicator{display:none;align-items:center;height:26px;box-sizing:border-box}.fxs-search-indicator>div{height:7px;width:7px;animation:fxs-search-indicator-animatedEllipses 1.5s infinite;background:#aab3bd;margin:0 2.5px}.fxs-search-indicator>div:nth-child(1){animation-delay:0s}.fxs-search-indicator>div:nth-child(2){animation-delay:.2s}.fxs-search-indicator>div:nth-child(3){animation-delay:.4s}.fxs-searching .fxs-search-indicator{display:flex}.fxs-search .fxs-search-icon{display:none}.fxs-search-showmenu .fxs-search-menu{display:block}.fxs-search-showmenu .fxs-asyncsearch-menu{display:block}.fxs-topbar-state-searchcollapsed .fxs-search-icon{display:flex}.fxs-topbar-state-searchcollapsed .fxs-search-wrapper{display:none}.fxs-topbar-state-searchcollapsed .fxs-search-activated .fxs-search-icon{display:none}.fxs-topbar-state-searchcollapsed .fxs-search-activated .fxs-search-wrapper{display:flex}.fxs-topbar-state-searchcollapsed .fxs-search-activated.fxs-search-showmenu .fxs-search-menu{display:block}.fxs-topbar-state-searchcollapsed .fxs-search-showmenu .fxs-search-menu{display:none}",moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css",["module"],(function(n){"use strict";return{css:".fxs-sidebar{z-index:6;height:100%;font-size:13px;box-sizing:border-box;position:fixed;top:0}.fxs-sidebar-list{padding:0;margin:0;list-style:none}.fxs-sidebar-button{cursor:pointer}.fxs-sidebar-favorites{padding-bottom:20px}.fxs-sidebar-bar{width:225px;display:flex;flex-direction:column;height:100%;overflow:hidden}.fxs-sidebar-top{flex:0 0 auto}.fxs-sidebar-top>.fxs-sidebar-button{width:100%;border:none;padding:0;text-align:left}.fxs-sidebar-middle{flex:1 1 auto;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch}.fxs-sidebar-favorites-section{height:32px;display:flex;align-items:center;flex:0 0 auto}.fxs-sidebar-myfavorites{text-transform:uppercase;font-weight:700;font-size:10px;word-break:keep-all;margin-left:10px}.fxs-sidebar-divider,.fxs-sidebar-divider2{border-bottom-width:1px;border-bottom-style:solid;height:0;flex:1 1 0}.fxs-sidebar-divider:first-of-type{margin-right:5px;max-width:13px}.fxs-sidebar-divider:last-of-type{margin-left:5px}.fxs-sidebar-item-link{display:flex;align-items:center;flex:1 1 auto;min-height:32px;-webkit-user-drag:none;color:inherit;box-sizing:border-box;padding:7px 0}a.fxs-sidebar-item-link:hover{text-decoration:none;color:inherit}.fxs-sidebar-icon{flex:0 0 18px;height:18px;padding-left:15px;align-self:flex-start}.fxs-sidebar-icon svg,.fxs-sidebar-icon img{height:18px;width:18px}.fxs-sidebar-hamburger .fxs-sidebar-icon{height:16px;padding-left:15px;align-self:center}.fxs-sidebar-hamburger .fxs-sidebar-icon svg{height:16px;width:16px}.fxs-sidebar-label{flex:1 1 auto;overflow:hidden;text-overflow:ellipsis;margin-left:6px}.fxs-sidebar-create,.fxs-sidebar-browse{font-size:inherit}.fxs-sidebar-create .fxs-sidebar-label,.fxs-sidebar-browse .fxs-sidebar-label{margin-right:15px}.fxs-sidebar-collapse-button{display:flex;align-items:center;height:28px}.fxs-sidebar-collapse-button svg{height:8px;width:8px;transform:rotate(-90deg);margin-left:auto;margin-right:10px}.fxs-sidebar-fav-icon svg{height:12px;width:12px;fill:#0078d4}.fxs-theme-blue .fxs-sidebar-fav-icon svg,.fxs-mode-dark .fxs-sidebar-fav-icon svg{fill:#f2f2f2}.fxs-sidebar-external{flex:0 0 12px;margin:0 10px;padding-top:3px;width:12px;fill:#bbb}.fxs-sidebar-external svg{height:12px;width:12px}.fxs-sidebar-handle{flex:0 0 20px;cursor:move;fill:#bbb}.fxs-sidebar-handle svg{display:none;height:16px;width:16px;transform:rotate(90deg)}.fxs-sidebar-item:hover .fxs-sidebar-handle svg{display:block}.fxs-sidebar-is-collapsed .fxs-sidebar-bar{width:48px}.fxs-sidebar-is-collapsed .fxs-sidebar-myfavorites,.fxs-sidebar-is-collapsed .fxs-sidebar-external{display:none}.fxs-sidebar-is-collapsed .fxs-sidebar-top>.fxs-sidebar-item-link .fxs-sidebar-label,.fxs-sidebar-is-collapsed .fxs-sidebar-middle .fxs-sidebar-label{display:none}.fxs-sidebar-is-collapsed .fxs-sidebar-top>.fxs-sidebar-item-link .fxs-sidebar-favorites,.fxs-sidebar-is-collapsed .fxs-sidebar-middle .fxs-sidebar-favorites{width:48px}.fxs-sidebar-is-collapsed .fxs-sidebar-collapse-button svg{transform:rotate(90deg)}.fxs-sidebar-is-collapsed .fxs-sidebar-middle{width:68px}.fxs-sidebar-shadow{pointer-events:none;position:absolute;right:0;top:0;bottom:0}.fxs-sidebar-menu-toggle-link,.fxs-sidebar-divider2,.fxs-sidebar .fxs-sidebar-collapse-button,.fxs-sidebar.fxs-sidebar-is-collapsed,.fxs-sidebar-menu-container{display:none}.fxs-sidebar-item-link.fxs-sidebar-hamburger{display:flex;border:none;padding:0;width:100%;height:40px}.fxs-sidebar-is-collapsed .fxs-sidebar-bar.msportalfx-shadow-level3{box-shadow:none}.fxs-sidebar .fxs-sidebar-shadow{display:none}.fxs-sidebar-menu .fxs-sidebar-menu-toggle-link{display:flex;align-items:center;height:32px}.fxs-sidebar-menu .fxs-sidebar-menu-toggle-link .fxs-sidebar-menu-icon{height:16px;align-self:center}.fxs-sidebar-menu .fxs-sidebar-menu-toggle-link .fxs-sidebar-menu-icon svg{height:16px;width:16px}.fxs-sidebar-menu .fxs-sidebar-divider2{display:flex;margin-top:12px;margin-bottom:8px}.fxs-sidebar-menu-activated .fxs-sidebar-menu-activated-hidden{display:none}.fxs-sidebar-menu-activated .fxs-sidebar-menu-container{display:flex;min-height:0;flex-direction:column}.fxs-sidebar-menu-activated .fxs-sidebar-menu-toggle-link svg{transform:rotate(180deg)}@media(min-width:640px) and (min-height:500px){.fxs-sidebar-hamburger-mode .fxs-sidebar.fxs-sidebar-is-collapsed,.fxs-sidebar-hamburger-mode .fxs-sidebar .fxs-sidebar-collapse-button{display:none}.fxs-sidebar-hamburger-mode .fxs-sidebar-item-link.fxs-sidebar-hamburger{display:flex}.fxs-sidebar-hamburger-mode .fxs-sidebar{position:fixed}.fxs-sidebar-hamburger-mode .fxs-sidebar .fxs-sidebar-shadow{display:none}.fxs-sidebar-docked-mode .fxs-sidebar{z-index:4;position:relative;max-width:48px}.fxs-sidebar-docked-mode .fxs-sidebar .fxs-sidebar-collapse-button{display:flex}.fxs-sidebar-docked-mode .fxs-sidebar-item-link.fxs-sidebar-hamburger{display:none}.fxs-sidebar-docked-mode .fxs-sidebar.fxs-sidebar-is-collapsed{position:relative;display:flex}.fxs-sidebar-docked-mode .fxs-sidebar.fxs-sidebar-is-collapsed .fxs-sidebar-shadow{display:flex}.fxs-sidebar-menu .fxs-sidebar-menu-toggle-link,.fxs-sidebar-menu .fxs-sidebar-divider2{display:none}}@media(min-width:1024px) and (min-height:500px){.fxs-sidebar-hamburger-mode .fxs-sidebar .fxs-sidebar-shadow{display:none}.fxs-sidebar-hamburger-mode .fxs-sidebar{position:fixed}.fxs-sidebar-docked-mode .fxs-sidebar-bar.msportalfx-shadow-level3{box-shadow:none}.fxs-sidebar-docked-mode .fxs-sidebar{position:relative;max-width:initial}.fxs-sidebar-docked-mode .fxs-sidebar .fxs-sidebar-shadow{display:flex}}",moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.StackLayout.css",["module"],(function(n){"use strict";return{css:".fxs-stacklayout{display:flex}.fxs-stacklayout-vertical{flex-direction:column}.fxs-stacklayout-horizontal{flex-direction:row}.fxs-stacklayout-child{flex:0 0 auto}",moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css",["module"],(function(n){"use strict";return{css:'.fxs-startboard{display:flex;flex-flow:column nowrap;overflow:auto;width:100%}.fxs-startboard .fxs-startboard-message-container{display:none}.fxs-startboard.fxs-startboard-notfound>.fxs-startboard-layout{display:none}.fxs-startboard.fxs-startboard-notfound .fxs-startboard-message-container{display:block}.fxs-startboard-header{display:flex;align-items:center;flex:0 0 auto;width:100%;height:45px;padding:0 25px 0 40px;margin-top:20px;box-sizing:border-box}.fxs-startboard-header .fxs-startboard-title-next{display:block}.fxs-startboard-header .fxs-startboard-title-content{display:flex}.fxs-startboard-header .fxs-startboard-button-text{font-size:13px}.fxs-startboard-header .fxs-startboard-button-icon{height:12px;width:12px;align-items:center;justify-content:center;flex:0 0 12px}.fxs-startboard-header .fxs-startboard-dropdown .fxs-startboard-button-icon,.fxs-startboard-header .fxs-startboard-title-next .fxs-startboard-button-icon{height:16px;width:16px;margin:4px 8px;flex:0 0 auto}.fxs-startboard-header .fxs-startboard-dropdown .fxs-startboard-button-icon>svg,.fxs-startboard-header .fxs-startboard-title-next .fxs-startboard-button-icon>svg{flex:0 0 16px}.fxs-startboard-header .fxs-startboard-title{max-width:300px;font-weight:600}.fxs-startboard-header .fxs-startboard-title-edit{padding:0 5px 2px 5px;margin:0 -6px -2px -6px;border-width:1px;border-style:solid;color:inherit;background-color:transparent;width:300px;transition:border .12s}.fxs-startboard-header .fxs-startboard-title-edit:active,.fxs-startboard-header .fxs-startboard-title-edit:hover{border-color:inherit}.fxs-startboard-header .fxs-startboard-button{position:relative}.fxs-startboard-header .fxs-startboard-title,.fxs-startboard-header .fxs-startboard-button{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:left}.fxs-startboard-header .fxs-startboard-dropdown,.fxs-startboard-header .fxs-startboard-button{font-size:13px;line-height:20px}.fxs-startboard-header .fxs-startboard-title,.fxs-startboard-header .fxs-startboard-title-edit{font-size:18px;line-height:24px}.fxs-startboard-header .fxs-startboard-subtitle{text-align:initial;font-size:12px;line-height:14px}.fxs-startboard-header .fxs-startboard-subtitle.fxs-startboard-subtitle-shared{margin-left:32px}.fxs-startboard-header .fxs-startboard-migration{height:40px;align-items:center;display:flex;flex:0 0 auto}.fxs-startboard-customize-header{min-height:70px}.fxs-startboard-commandBar,.fxs-startboard-customize-header,.fxs-startboard-warning,.fxs-startboard-error{padding:0 25px 0 40px}.fxs-startboard-commandBar-fullScreen{display:none;margin-left:10px}.fxs-startboard-actions{margin-left:30px}.fxs-startboard-actions .fxs-startboard-actions-preview,.fxs-startboard-actions .fxs-startboard-actions-save{margin-right:10px}.fxs-startboard-warning,.fxs-startboard-error{margin:0}.fxs-startboard-layout{padding:16px 40px;flex:1 1 auto}.fxs-startboard-layout .fxs-flowlayout-childcontainer{padding-bottom:25px;padding-right:25px}.fxs-startboard-dropdown{display:none;flex:0 1 auto;max-width:560px;padding:2px 0}.fxs-startboard-button{flex:0 0 auto;border:0;margin:0 5px;padding:4px 5px;height:20px;background-color:transparent;box-sizing:content-box}.fxs-startboard-button:not([aria-disabled]):hover{cursor:pointer}.fxs-startboard-button .fxs-startboard-button-text{margin-left:5px}.fxs-startboard-button .fxs-startboard-button-icon{height:16px;width:16px}.fxs-startboard-button{display:flex;align-items:center;min-width:0}.fxs-startboard-button-browse{padding:0 !important}.fxs-startboard-dropdown>.fxs-dropmenu{width:100%}.fxs-startboard-dropdown>.fxs-dropmenu .fxs-dropmenu-button{width:100%}.fxs-startboard-dropdown .fxs-dropmenu-content{overflow-x:hidden;overflow-y:auto;min-width:400px;max-width:560px;min-height:35px}.fxs-startboard-dropdown .fx-dropmenu-dropdown{max-height:calc(100vh - 120px)}.fxs-startboard-item-container{display:flex;align-items:center;min-width:0}.fxs-startboard-dropdown .fxs-dropmenu-list-system .fxs-startboard-dropdown-item{padding:7px 25px 8px}.fxs-startboard-dropdown-item+.fxs-startboard-dropdown-item::before{content:"";position:absolute;top:0;width:calc(100% - 50px);border-top-width:1px;border-top-style:solid;border-color:rgba(125,125,125,.5)}.fxs-startboard-item-title{flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-startboard-item-icon{flex:0 0 auto;height:14px;width:14px;padding-right:5px}.fxs-startboard-dropdown-button{display:flex;flex-flow:column nowrap}.fxs-startboard-title-container{display:flex}.fxs-startboard-dropdown-item{position:relative;height:35px;box-sizing:border-box;cursor:pointer}.fxs-startboard-dropdown-item.fxs-startboard-dropdown-browseall{height:auto;cursor:default}.fxs-startboard-dropdown-subscriptions{white-space:normal}.fxs-startboard-migration,.fxs-startboard-dropdown{display:none}.fxs-startboard-header:not(.fxs-startboard-header-normal) .fxs-startboard-title-edit{display:none}.fxs-startboard-header-normal .fxs-startboard-dropdown{display:block}.fxs-startboard-header-normal .fxs-startboard-migration{display:none}.fxs-startboard-header-normal .fxs-startboard-title-next{display:none}.fxs-startboard-header-migration .fxs-startboard-dropdown{display:none}.fxs-startboard-header-migration .fxs-startboard-migration{display:flex}.fxs-startboard-header-migration .fxs-startboard-title-next{display:block}.fxs-startboard-message-container{padding:55px 40px}.fxs-startboard-message-title{font-size:32px;margin-bottom:20px}.fxs-startboard-message-body{font-size:17px}.fxs-startboard-notfound .fxs-startboard-button{display:none}.fxs-portal:not(.fxs-desktop-organize) .fxs-topbar-dashboard-changed .fxs-startboard-header-item{display:none}.fxs-portal:not(.fxs-desktop-organize) .fxs-topbar-dashboard-changed .fxs-startboard-title-next{display:block}.fxs-startboard-loadanimation{display:none;align-items:center;justify-content:center;position:absolute;height:100%;width:100%}.fxs-startboard-loading .fxs-startboard-loadanimation{display:flex}.fxs-startboard-loading .fxs-startboard-layout,.fxs-startboard-loading .fxs-startboard-message-container{visibility:hidden}.fxs-startboard-loading .fxs-startboard-header-item{display:none}.fxs-startboard-loading .fxs-startboard-title-next{display:block}.fxs-startboard-loading .fxs-startboard-layout .fxs-tile .fxs-part-content{display:none}@media(min-height:500px){.fxs-startboard{overflow:hidden}.fxs-startboard-layout{overflow:auto}}',moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css",["module"],(function(n){"use strict";return{css:".fxs-tile-progress-transparent{height:12px;position:absolute;top:0;left:0;z-index:195;overflow:hidden}.fxs-tile-progress-transparent>div{margin-left:6px}.fxs-tile-progress-transparent>div::after{height:4px;width:4px;background:#000}.fxs-startboard .fxs-tile{border-radius:2px}.fxs-startboard .fxs-tile>.fxs-part{border-radius:2px}.fxs-tile{height:175px;width:175px;position:relative;box-shadow:none}.fxs-tilesize-mini{height:85px;width:85px}.fxs-tilesize-small{height:85px;width:175px}.fxs-tilesize-tall{height:355px;width:175px}.fxs-tilesize-wide{height:175px;width:355px}.fxs-tilesize-normal{height:175px;width:175px}.fxs-tilesize-large{height:355px;width:355px}.fxs-tilesize-herotall{height:535px;width:355px}.fxs-tilesize-herowide{height:355px;width:535px}.fxs-tilesize-hero{height:535px;width:535px}.fxs-tilesize-herowidefitheight{height:auto;width:535px}.fxs-tilesize-fullwidthfitheight{height:auto;width:100%}.fxs-tilesize-fullwidthfitheight .fxs-part{height:auto}.fxs-tilesize-fullwidthfitheight .fxs-part-content{height:auto}.fxs-tilesize-herowidefitheight,.fxs-tilesize-fullwidthfitheight{margin-bottom:5px}.fxs-tilesize-herowidefitheight:last-child,.fxs-tilesize-fullwidthfitheight:last-child{margin-bottom:0}.fxs-tilesize-fittocontainer{height:100%;width:100%}.fxs-tilesize-fittocontainer>.fxs-part{overflow:visible}.fxs-tile-actionbar{z-index:196}.fxs-tile-container{width:100%;height:100%}div.fxs-tile-overlay:not(.fxs-progress){display:none;position:absolute;width:100%;top:0;bottom:0;cursor:pointer}.fxs-bladestyle-create .fxs-tile .fxs-part,.fxs-bladestyle-context .fxs-tile .fxs-part,.fxs-bladestyle-contextaction .fxs-tile .fxs-part,.fxs-bladestyle-help .fxs-tile .fxs-part{box-shadow:none}",moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css",["module"],(function(n){"use strict";return{css:".fxs-tile-actionbar-actionlist{display:flex;flex-flow:row nowrap;border-radius:0 2px 0 0}.fxs-tile-actionbar-actionlist:empty{height:25px;visibility:hidden}.fxs-tile-actionbar-actionlist .fxs-tile-actionbar-action:last-of-type{border-radius:0 2px 0 0}.fxs-tile-actionbar-action{flex:0 0 auto;display:flex;align-items:center;justify-content:center;box-sizing:border-box;height:25px;width:25px;padding:6px;background-color:transparent;cursor:pointer;border:0;transition:background .1s ease-out}.fxs-tile-actionbar-action>svg{height:13px;width:13px}.fxs-tile .fxs-tile-actions{position:absolute;right:0;cursor:default}.fxs-tile-actionbar-command-unpinfromstartboard{display:none}.fxs-desktop-organize .fxs-tile-actionbar-command-unpinfromstartboard{display:flex}.fxs-tile-transparent{opacity:0}",moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css",["module"],(function(n){"use strict";return{css:".fxs-toast{position:fixed;top:45px;right:5px;width:355px;max-width:100%;box-sizing:border-box;list-style-type:none;margin:0;padding:0;padding-left:10px}.fxs-global-security-banner-top~.fxs-topbar>.fxs-topbar-content>.fxs-topbar-toast>.fxs-toast{top:75px}.fxs-global-info-banner~.fxs-topbar>.fxs-topbar-content>.fxs-topbar-toast>.fxs-toast{top:75px}.fxs-global-security-banner-top~.fxs-global-info-banner~.fxs-topbar>.fxs-topbar-content>.fxs-topbar-toast>.fxs-toast{top:90px}.fxs-toast-wrapper,.fxs-toast-content{flex:1 1 auto;width:100%;padding:10px;box-sizing:border-box}.fxs-toast-item{display:flex;margin-bottom:5px;position:relative}.fxs-toast-header{display:flex;align-items:center;padding-top:5px;margin-bottom:5px}.fxs-toast-icon{margin-right:4px}.fxs-toast-icon svg{height:15px;width:15px;vertical-align:middle}.fxs-toast-title{flex:1 1 auto;margin:0 4px;max-width:254px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:600}.fxs-toast-title.fxs-toast-link:hover{text-decoration:underline}.fxs-toast-time{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:60px;flex:0 0 auto}.fxs-toast-close{position:absolute;top:0;right:0;background:none;border:none;cursor:pointer;margin-left:4px;padding:0;margin-top:16px;margin-right:12px}.fxs-toast-close svg{height:12px;width:12px}.fxs-toast-description{font-size:13px;line-height:normal;max-width:100%;overflow:hidden;position:relative;text-overflow:ellipsis;white-space:pre-wrap;width:335px}.fxs-toast-progressbar{margin-top:10px;max-height:5px}.fxs-nps .fxs-nps-title{font-weight:600;margin-bottom:7px;width:calc(100% - 15px)}.fxs-nps .fxs-nps-score{display:flex}.fxs-nps .fxs-nps-score span{flex:1 1 auto;border:1px solid #c5cbd1;text-align:center;height:23px;line-height:23px;margin-right:6px;display:inline-block;cursor:pointer}.fxs-nps .fxs-nps-score span:hover,.fxs-nps .fxs-nps-score span.fxs-nps-score-selected{background:#00bcf2;border-color:#00bcf2}.fxs-nps .fxs-nps-score span:last-child{margin-right:0}.fxs-nps .fxs-nps-help{display:flex;margin-bottom:10px}.fxs-nps .fxs-nps-help span:last-child{margin-left:auto}.fxs-nps .fxs-nps-comments{margin-top:6px;margin-bottom:18px;width:100%;box-sizing:border-box;border:1px solid #c5cbd1;height:100px;padding:7px}.fxs-nps .fxs-nps-checkbox{margin:5px 5px 0 0}.fxs-nps .fxs-nps-checkbox-contact{margin-right:3px}.fxs-nps .fxs-nps-contact-link{margin-left:25px}.fxs-nps .fxs-nps-button-holder{border-top:1px solid #dcdfe2}.fxs-nps .fxs-nps-submit{margin:15px 10px 5px 0;border:0}.fxs-nps .fxs-nps-link-survey{text-decoration:underline}.fxs-nps .fxs-nps-thank-you{margin-bottom:10px;margin-top:10px}.fxs-nps .fxs-nps-review-link{display:inline-block;padding-bottom:10px}.fxs-nps .fxs-nps-connect{margin-bottom:10px}.fxs-sat .fxs-sat-title{font-weight:600;margin-bottom:7px}.fxs-sat .fxs-sat-submit{margin:15px 10px 5px 0;border:0}",moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css",["module"],(function(n){"use strict";return{css:".fxs-topbar{height:40px;position:relative;z-index:5;flex:0 0 auto;font-size:13px}.fxs-topbar-preview,.fxs-topbar-brand{flex:0 0 auto;margin:0;padding:0;height:100%}.fxs-topbar .fxs-topbar-journey-icon{border:none}.fxs-topbar .fxs-topbar-journey-icon svg{height:16px;width:16px;margin-top:4px}.fxs-topbar-content{width:100%;height:100%;position:absolute;top:0;-webkit-app-region:drag;display:flex;align-content:center;align-items:center}.fxs-search-box,.fxs-topbar-button,.fxs-topbar-avatarmenu,.fxs-topbar-reportbug,.fxs-topbar-upgradebutton{-webkit-app-region:no-drag}.fxs-topbar-internal{min-width:85px;box-sizing:border-box;text-align:center;flex:0 0 auto}.fxs-topbar-exitdevmode,.fxs-topbar-reportbug,.fxs-topbar-upgradebutton{display:flex;height:40px;width:auto;flex:0 0 auto;align-items:center;justify-content:center;padding:0 5px;color:#000}.fxs-topbar-preview .fxs-topbar-internal,.fxs-topbar-brand .fxs-topbar-home{display:inline-block;font-size:15px;padding:0 20px;height:40px;line-height:40px;font-weight:600}.fxs-topbar-devmode .fxs-topbar-home{color:#000}a.fxs-topbar-home:hover{text-decoration:none}.fxs-topbar-button{display:flex;height:40px;width:40px;flex:0 0 auto;align-items:center;justify-content:center}.fxs-topbar-button svg{height:16px;width:16px}.fxs-topbar-button.fxs-topbar-close:hover{background-color:#ba141a}.fxs-desktop-organize .fxs-topbar-exit-customize{visibility:visible;top:0}.fxs-topbar-exit-customize-message,.fxs-topbar-dashboard-message{font-size:14px}.fxs-topbar-exit-customize-button,.fxs-topbar-dashboard .fxs-button{flex:0 0 auto;margin-left:10px}.fxs-show-startboard .fxs-topbar-dashboard-view{display:none}.fxs-portal:not(.fxs-show-startboard) .fxs-topbar-dashboard-save,.fxs-portal:not(.fxs-show-startboard) .fxs-topbar-dashboard-discard{display:none}.fxs-topbar-exit-customize,.fxs-topbar-dashboard{display:flex;align-items:center;justify-content:center;flex:1 1 auto;position:absolute;top:-40px;z-index:5;visibility:hidden;width:100%;height:100%;transition:top .3s ease .0001s}.fxs-topbar-dashboard-changed .fxs-topbar-dashboard{top:0;visibility:visible}.fxs-topbar-dashboard-changed .fxs-topbar-content{visibility:hidden}.fxs-topbar-dashboard-changed .fxs-topbar-exit-customize{display:none}.fxs-topbar-notifications{position:relative}.fxs-topbar-helpmenu{position:relative}.fxs-topbar-placeholder{flex:1 1 auto}.fxs-topbar-buttons-container,.fxs-topbar-electron-container,.fxs-topbar-history-container{display:flex;flex:0 0 auto}.fxs-topbar-back{transform:scale(-1,1)}.fxs-topbar-search{margin-left:7px;width:800px;min-width:280px;flex:0 1 auto}.fxs-search-back-icon{display:none}.fxs-topbar-reportbug,.fxs-topbar-upgradebutton{margin-left:7px;height:26px;border-radius:2px;font-weight:600}.fxs-topbar-reportbug .fxs-topbar-reportbug-icon,.fxs-topbar-upgradebutton .fxs-topbar-reportbug-icon{width:16px;height:16px}.fxs-topbar-reportbug .fxs-topbar-upgradebutton-icon,.fxs-topbar-upgradebutton .fxs-topbar-upgradebutton-icon{width:14px;height:14px}.fxs-topbar-reportbug .fxs-topbar-reportbug-text,.fxs-topbar-upgradebutton .fxs-topbar-reportbug-text,.fxs-topbar-reportbug .fxs-topbar-upgradebutton-text,.fxs-topbar-upgradebutton .fxs-topbar-upgradebutton-text{margin-left:7px;margin-bottom:2px}.fxs-topbar-reportbug .fxs-topbar-upgradebutton-text,.fxs-topbar-upgradebutton .fxs-topbar-upgradebutton-text{margin-top:1px}.fxs-topbar-state-searchcollapsed .fxs-topbar-search{width:40px;min-width:40px;flex:0 0 auto}.fxs-topbar-state-searchcollapsed.fxs-topbar-search-activated .fxs-topbar-search{width:calc(100% - 40px - 7px*2);margin-left:7px}.fxs-topbar-state-searchcollapsed.fxs-topbar-search-activated .fxs-search-back-icon{display:flex}.fxs-topbar-state-searchcollapsed.fxs-topbar-search-activated .fxs-topbar-search-activated-hidden{opacity:0;position:absolute;height:0 !important;width:0 !important;overflow:hidden !important}.fxs-topbar-sidebar-collapse-button{display:flex;width:48px}@media(max-width:700px){.fxs-topbar-exit-customize-message,.fxs-topbar-dashboard-message{display:none}}@media(min-width:640px) and (min-height:500px){.fxs-topbar-sidebar-collapse-button{display:none}.fxs-sidebar-hamburger-mode .fxs-topbar-sidebar-collapse-button{display:flex}}@media(min-width:494px){.fxs-topbar-search-activated .fxs-search-back-icon{position:absolute}.fxs-topbar-state-searchcollapsed.fxs-topbar-search-activated .fxs-topbar-search{margin:auto}}",moduleId:n.id}}));
define("MsPortalImpl/Widgets/Widgets.WidgetBase",["require","exports","MsPortalImpl/Base/Base.ElementWidgetMap","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Control.css","_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Panorama.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css","_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css","_generated/Less/MsPortalImpl/Widgets/Widgets.StackLayout.css","_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css","_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css","_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){"use strict";r.injectCss(u,f,e,o,s,h,c,l,a,v,y,p,w,b,k);var d;return (function(n){var r=(function(){function n(){this.disabled=ko.observable(!1)}return n})(),t;n.ViewModel=r;t=(function(){function n(t,r,u){var f=this;if(u===void 0&&(u=!1),!t||t.length===0)throw new Error("You must specify an element to associate a widget to it. Your element is either null or an empty collection.");this.options=r;this._ltm=new FxImpl.TriggerableLifetimeManager;this.element=$(t[0]);u||this._ltm.registerForDispose(t.setEvents([n.widgetRemoveEvent,function(n){n.target!==t[0]||f._disposeTriggered||(f._disposeTriggered=!0,f.dispose())},]));i.set(t[0],this)}return n.prototype.setFocus=function(){},n.prototype.dispose=function(){this._ltm.dispose();i.remove(this.element[0],this)},Object.defineProperty(n.prototype,"ltm",{get:function(){return this._ltm},enumerable:!1,configurable:!0}),n.getWidget=function(t,i){var r=n.getWidgets(t,i);return r?r[0]||null:null},n.getWidgets=function(n,t){return(t?i.getAllMatch(n[0],t):i.getAll(n[0]))||[]},n.prototype.trigger=function(n,t){var u=this.options[n],r=this.element,i;return t=t||{},i=$.Event(n),i.type=n,i.target=r[0],r.trigger(i,t),!($.isFunction(u)&&u.apply(r[0],[i].concat(t))===!1||i.isDefaultPrevented())},n.prototype.getTelemetrySource=function(){return null},n.prototype._bindDescendants=function(n){var t={data:this.options,func:this},i=n?$.extend(null,t,n):t;ko.applyBindingsToDescendants(i,this.element[0])},n.prototype._cleanDescendants=function(){ko.utils.cleanDescendantNodes(this.element)},n.prototype._cleanElement=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._cleanDescendants();this._cleanElementClasses(t);this.element.empty()},n.prototype._cleanElementClasses=function(n){n.length>0&&this.element.removeClass(n.join(" "))},n.prototype._isRtl=function(){return $.querySelectorAll("html").first().attr("dir")==="rtl"},n.widgetRemoveEvent="remove.fxWidget",n})();n.Widget=t})(d||(d={})),d}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.FxParameterCollector",["require","exports","MsPortalImpl/Widgets/Widgets.WidgetBase"],(function(n,t,i){"use strict";function f(n){ko.bindingHandlers.fxParameterCollector={init:function(){return{controlsDescendantBindings:!1}},update:function(t,i){var r=ko.unwrap(i());r&&new u($(t),r,n)}}}var r,u;Object.defineProperty(t,"__esModule",{value:!0});t.initialize=t.Widget=t.ViewModel=void 0;r=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(i.ViewModel);t.ViewModel=r;u=(function(n){function t(t,i,u){var f=n.call(this,t,i||new r)||this;return MsPortalFx.require("MsPortalImpl/Base/Base.KnockoutExtensions.FxParameterCollector.Async").then((function(n){return n.initialize(t,i,u,f.ltm)})),f}return __extends(t,n),t})(i.Widget);t.Widget=u;t.initialize=f}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.HtmlTemplateBinding",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl.Controls/Controls/Base/WidgetBinding","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl/Base/Base.LruMap","MsPortalImpl/Controls/ControlBindings"],(function(n,t,i,r,u,f,e,o){"use strict";function rt(n){t.disableUntrustedContentInjection=n}function g(t,i,u,f,e){var s,h,o;return i&&(h=u===1?it:tt,o=h.getOrAdd(i,(function(i){if(u!==1){var o=t.get(r.KOAllowedTemplateSanitizer).sanitize({diContainer:t,value:i,localRequire:n,windowContext:f,contextData:e});i=o.sanitizedMarkup}return i&&nt.createContextualFragment(i)})),o&&(s=o.cloneNode(!0))),s}function h(){return{controlsDescendantBindings:!0}}function w(n,t,r){return function(f,e,o,s,h){var l=ko.unwrap(e()),y=l,a,v,p;l!==null&&typeof l=="object"&&(y=ko.unwrap(l.html),v=l.data,a=ko.unwrap(v),p=ko.unwrap(l.isolated));ko.ignoreDependencies((function(){var o=n,e;r&&r(h)&&(o=1);e=g(h.$dicontainer||i.container,y,o,f,{BindingName:t});p?h=u.createIsolatedContext(a||s,h):v&&(h=h.createChildContext(a));c.cleanDescendantNodes(f);e?(f.innerHTML="",f.appendChild(e),ko.applyBindingsToDescendants(h,f)):f.innerHTML=""}))}}function ut(n,t,i,r){return g(n,t,i?1:0,r)}var y,p;Object.defineProperty(t,"__esModule",{value:!0});t.getTrustedFragment=t.setDisableUntrustedContentInjection=t.disableUntrustedContentInjection=void 0;var c=ko.utils,s=ko.bindingHandlers,l=c.domData,b="htmlTemplate",k="untrustedHtml",a="untrustedContent",v="untrustedContentDeprecated",d="trustedHtml",nt=document.createRange(),tt=new o.LruMap(100),it=new o.LruMap(100);t.disableUntrustedContentInjection=FxImpl.features.isEnabled("disableuntrustedcontentinjection",!0);t.setDisableUntrustedContentInjection=rt;y=w(0,k,(function(n){var t=n.$ctl;return t&&t.isTrusted}));p=[,,y,s["pcControl"].update,];s[b]={init:h,update:w(0,b)};s[k]={init:h,update:y};s[d]={init:h,update:w(1,d)};s[v]={init:h,update:function(n,i,u,o,s){var h=ko.unwrap(i())||"",a=1;ko.ignoreDependencies((function(){var i=l.get(n,v),u;h.controlType?a=3:h.htmlTemplate?(a=2,h={html:h.htmlTemplate,data:h.viewModel}):!t.disableUntrustedContentInjection&&r.looksLikeAnHtmlFragment(h)&&(a=2,h={html:h});l.set(n,v,a);i===3&&(f.cancelBindings(n),u=e.getWidget($(n)),MsPortalFx.disposeDisposable(u));i&&i!==1&&c.cleanDescendantNodes(n);a===1?n.textContent=h:n.innerHTML=""}));a!==1&&p[a](n,(function(){return h}),u,o,s)}};s[a]={init:h,update:function(n,t,i,r,u){var o=ko.unwrap(t())||"",s=1;ko.ignoreDependencies((function(){var t=l.get(n,a),i;o.controlType?s=3:o.htmlTemplate&&(s=2,o={html:o.htmlTemplate,data:o.viewModel});l.set(n,a,s);t===3&&(f.cancelBindings(n),i=e.getWidget($(n)),MsPortalFx.disposeDisposable(i));t&&t!==1&&c.cleanDescendantNodes(n);s===1?n.textContent=o:n.innerHTML=""}));s!==1&&p[s](n,(function(){return o}),i,r,u)}};t.getTrustedFragment=ut}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding",["require","exports","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r){"use strict";function f(n,t,i,r){var u=ko.unwrap(t()),f=s(n,u,i,r);return function(){return f}}function s(t,r,u,f){if(r&&typeof r=="object"){var e={};return Object.getOwnPropertyNames(r).forEach((function(o){var s,h;if(MsPortalFx.isSerializableProperty(o))if(s=ko.unwrap(r[o]),i.getAllowListedAttr().indexOf(o)>-1)e[o]=s?s:null;else switch(o){case"href":s?(h=typeof s!="string"?r:i.sanitizeLinkUri(s,{diContainer:t,localRequire:n,windowContext:f}),h!==!1?e[o]=h:u.push('The value "'+s+'" is not a valid absolute URI or deep link, which should start with "http://" or "https://" or "#".')):e[o]=null;break;case"poster":case"src":s?i.validateUriOrBlank(s,null,{diContainer:t,localRequire:n,windowContext:f})||o==="src"&&i.validateDataImage(s)?e[o]=s:u.push('The value "'+s+'" is not a valid absolute URI, which should start with "http://" or "https://".'):e[o]=null;break;default:u.push("The attribute '{0}' is not allowed.".format(o))}})),e}return null}Object.defineProperty(t,"__esModule",{value:!0});var e=MsPortalFx.Base,h=e.Diagnostics,o="Sanitization error found in 'sanitizedAttr' binding\nTag name: {0}; Binding attribute: \"{1}\"\nMessage: {2}",u=ko.bindingHandlers;u.sanitizedAttr={init:function(n,t,i,r,e){var o=u.attr,s;return o.init?(s=f(e.$dicontainer,t,[],n),o.init(n,s,i,r,e)):null},update:function(t,i,e,s,h){var c=[],a=f(h.$dicontainer,i,c,t),l;return c.length>0&&(l=c.reduce((function(n,i){var r=t.getAttribute("data-bind")||"None",u=o.format(String(t.tagName),r,i);return n+(u+"\n")}),""),r.logToExtension(n,t,2,l)),u.attr.update(t,a,e,s,h)}}}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding",["require","exports","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r){"use strict";function e(n,t){var i=ko.unwrap(n()),r=s(i,t);return function(){return r}}function s(n,t){var r;if(n&&typeof n=="object")return r={},Object.getOwnPropertyNames(n).forEach((function(u){MsPortalFx.isSerializableProperty(u)&&(i.isAllowedCssClassName(u)?r[u]=n[u]:u&&t.push(u))})),r;var u=String(n||""),f=u.split(" "),e=Array.prototype.map.call(f,(function(n){return n=String(n||""),i.isAllowedCssClassName(n)?n:(n&&t.push(n),"")}));return e.join(" ")}function h(t,i,u){var f=i.getAttribute("data-bind")||"None",e=o.format(String(i.tagName),f,u.join(", "));r.logToExtension(n,i,2,e,{diContainer:t})}Object.defineProperty(t,"__esModule",{value:!0});var o="Sanitization error found in 'sanitizedCss' binding\nTag name: {0}; Binding attribute: \"{1}\"\nDisallowed class name(s): {2}",f=ko.bindingHandlers,u=f.css;f.sanitizedCss={init:function(n,t,i,r,f){if(u.init){var o=e(t,[]);return u.init(n,o,i,r,f)}return null},update:function(n,t,i,r,f){var o=[],s=e(t,o);return o.length&&h(f.$dicontainer,n,o),u.update(n,s,i,r,f)}}}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding",["require","exports","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","Fx/DependencyInjection"],(function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=ko.bindingHandlers,f=u.html;u.sanitizedHtml={init:function(n,t,i,r,u){return f.init(n,t,i,r,u)},update:function(t,u,e,o,s){var h=ko.unwrap(u());(h===null||h===undefined)&&(h="");var c=h.toString().substring(0,1e5),l=r.container.get(i.KODeniedTemplateSanitizer).sanitize({value:c,localRequire:n,windowContext:t,diContainer:r.container}),a=MsPortalFx.wrap(l.sanitizedMarkup);return f.update(t,a,e,o,s)}};u.html=u.sanitizedHtml;u.unsanitizedHtml=f}));
define("MsPortalImpl/Base/Base.Pipeline",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader"],(function(n,t,i,r){"use strict";function c(n){return function(t,i){var r=Reflect.getOwnMetadata("fximpl:pipelinesteps",t)||[];r[n]=i;Reflect.defineMetadata("fximpl:pipelinesteps",r,t)}}function l(n,t,i,r,u,f,e){var s=t.getHandlers(i,r,u,f,e,n).filter((function(n){return!!n})),o;return s.forEach((function(n,t){Q.isPromiseAlike(n)&&(o||(o=[]),o[t]=n.then((function(n){s[t]=n})))})),o?Promise.all(o.filter((function(n){return!!n}))).then((function(){return s.filter((function(n){return!!n}))})):s}function a(n,t,i){return new u(n,t,i)}function o(n,t,i,r,u){return new f(n,t,i,r,u)}function v(n){for(var t=[],r=Math.max.apply(Math,n.map((function(n){return n.steps.length}))),u=function(i){n.forEach((function(n){if(n.steps[i]){var r=t[i]||{step:i,handlers:[]};r.handlers.push(n.steps[i]);t[i]=r}}))},i=0;i<r;i++)u(i);return t}function y(n,t,i,r,u,f,e,o){return __awaiter(this,void 0,void 0,(function(){var c,v,s,l,h,a;return __generator(this,(function(y){switch(y.label){case 0:c=new Promise(function(n){f.registerForDispose(n)});u.registerForDispose((function(){return i(!0)}));v=Math.max(n.length,o);s=0;y.label=1;case 1:return(s<v&&!i())?(!i()&&s)?(l=e(n,s),!l)?[3,3]:[4,Promise.race([l,c])]:[3,3]:[3,8];case 2:y.sent();y.label=3;case 3:if(!n[s])return[3,7];h=0;y.label=4;case 4:return(h<n[s].handlers.length&&!i())?(a=n[s].handlers[h](r,t),!Q.isPromiseAlike(a))?[3,6]:[4,Promise.race([a,c])]:[3,7];case 5:y.sent();y.label=6;case 6:return h++,[3,4];case 7:return s++,[3,1];case 8:return[2]}}))}))}var u,f;Object.defineProperty(t,"__esModule",{value:!0});t.createPipelineInstance=t.createDescriptor=t.Pipeline=t.Step=t.PipelineDescriptor=t.Task=void 0;var s=MsPortalFx.Base.Promises.cancelOnDispose,h=1,e=(function(){function t(){}return __decorate([__metadata("fx:diagnostics",[n,"Task"]),i.Value("pipeline")],t)})();t.Task=e;u=(function(){function n(n,t,i){this.configurationClass=n;this.resourcesClass=t;this.taskArgsClass=i;this._pipelineFactories=[]}return n.prototype.register=function(n){var t=this;this._registerFactory((function(i){return t._createInstance(i,n)}))},n.prototype.registerAsync=function(n,t,i,u){var e=this,f;u===void 0&&(u=0);f=function(u,f,o,h,c){return i(o,h,c)?s(f,r.get(n,t)).then((function(n){return e._createInstance(u,n)})):undefined};this._registerFactory(f,u)},n.prototype.registerFactory=function(n,t){t===void 0&&(t=0);var i=function(t,i,r,u,f){function o(t){return{factory:n,steps:t||[]}}var e=n(t,i,r,u,f);return Q.isPromiseAlike(e)?e.then((function(n){return o(n)})):o(e)};this._registerFactory(i)},n.prototype._registerFactory=function(n,t){t===void 0&&(t=0);var i=this._pipelineFactories.length&&this._pipelineFactories[t]||[];i.push(n);this._pipelineFactories[t]=i},n.prototype.registerAsyncFactory=function(n,t,i,r){function u(u,f,e,o,s){return i(e,o,s)?MsPortalFx.require(n,r).then((function(n){return{factory:t,steps:t(f,n,e,o,s)}})):undefined}this._registerFactory(u)},n.prototype.getHandlers=function(n,t,i,r,u,f){return f===void 0&&(f=0),(this._pipelineFactories[f]||[]).map((function(f){return f(n,t,i,r,u)}))},n.prototype.getRegisteredStepsCount=function(){return(this._pipelineFactories||[]).length},n.prototype.createPipeline=function(n,t,i,r){return o(n,t,this,i,r)},n.prototype._createInstance=function(n,t){if(n.isDisposed())throw new MsPortalFx.Errors.CanceledError;var i=n.get(t),r=Reflect.getOwnMetadata("fximpl:pipelinesteps",t.prototype)||[];return{factory:t,steps:r.map((function(n){return function(t,r){return i[n](t,r)}}))}},n})();t.PipelineDescriptor=u;t.Step=c;f=(function(){function n(n,t,i,r,u){this._diContainer=n;this._lifetime=t;this._descriptor=i;this._configuration=r;this._resources=u}return n.prototype.startTask=function(n){return __awaiter(this,void 0,void 0,(function(){function b(n,t){function r(i){i.forEach((function(i){i.steps.forEach((function(i,r){if(r>=t){var u=n[r]||{step:r,handlers:[]};u.handlers.push(i);n[r]=u}}))}))}var i=s(t);return i instanceof Array?(r(i),undefined):i.then(r)}var t,r,i,a,f,p,o,w,s,u,c=this;return __generator(this,(function(k){switch(k.label){case 0:return(t=this._descriptor,r=this._lifetime.createChildLifetime(),i=this._diContainer.createChildContainer("pipeline"),a=h++,f=ko.observable(!1),p=function(){f(!0)},o={pipeline:this,indicateTaskComplete:p,taskId:a,lifetime:r},i.set(e,o),t.configurationClass&&i.set(t.configurationClass,this._configuration),t.resourcesClass&&i.set(t.resourcesClass,this._resources),t.taskArgsClass&&i.set(t.taskArgsClass,n),w=function(u){return __awaiter(c,void 0,void 0,(function(){var h,e,s,c;return __generator(this,(function(l){switch(l.label){case 0:h=v(u);e=!0;s=undefined;l.label=1;case 1:return l.trys.push([1,3,4,6]),[4,y(h,n,f,o,this._lifetime,r,b,t.getRegisteredStepsCount())];case 2:return l.sent(),[3,6];case 3:return c=l.sent(),e=!1,s=c,[3,6];case 4:return[4,i.disposeAsync().then((function(){return r.dispose()}))];case 5:if(l.sent(),!e)throw s;return[7];case 6:return[2]}}))}))},s=function(u){return l(u,t,i,r,c._configuration,c._resources,n)},u=s(0),!Q.isPromiseAlike(u))?[3,2]:[4,u];case 1:u=k.sent();k.label=2;case 2:return[4,w(u)];case 3:return k.sent(),[2]}}))}))},n})();t.Pipeline=f;t.createDescriptor=a;t.createPipelineInstance=o}));
define("MsPortalImpl/Services/Services.SettingsProcessor",["require","exports"],(function(n,t){"use strict";function r(n,t,i,r,u){var e=new FxImpl.TriggerableLifetimeManager,f={},o=Object.keys(i);return o.forEach((function(n){f[n]=0;i[n].subscribe(e,(function(i){f[n]!==1&&(f[n]=3,i===undefined?t.deleteSettings({store:r,keys:[n]}):t.setSetting(r,n,i),u&&t.flushSettings())}))})),Q(t.queryStore(r)).then((function(n){n=n||{};o.forEach((function(t){var r=n[t];r!==undefined&&f[t]===0&&(f[t]=1,i[t](r),f[t]=2)}))})).then((function(){return new n(i,function(){return Q(t.flushSettings())},function(){return e.dispose()})}))}Object.defineProperty(t,"__esModule",{value:!0});t.create=t.SettingsProcessor=void 0;var i=(function(){function n(n,t,i){this.value=n;this.flush=t||function(){return Q()};this.dispose=i||function(){}}return n})();t.SettingsProcessor=i;t.create=r}));
define("MsPortalImpl/Services/Services.GeneralSettings",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.SettingsProcessor","FxHubs/HubsSettingsSchema","FxInternal/AsyncLoader"],(function(n,t,i,r,u,f,e){"use strict";function c(n){var i=n.get(FxImpl.Features),t=n.get(o).landingPage();return!i.isEnabled("azurehome")||t===2||t===4}function l(n){var i=n.get(FxImpl.Features),t=n.get(o).sideBarLayout();return!i.isEnabled("sidebarhamburgermode")||t===2||t===4}function a(n){var t=n.get(o).focusNavigationMode();return!MsPortalFx.isFeatureEnabled("reservehozscroll")||MsPortalFx.isFeatureEnabled("allowdisablehozscroll")&&(t===1||t===3)}var h,s,o;Object.defineProperty(t,"__esModule",{value:!0});t.writeBrowsePreviewOptInFlagHandler=t.GeneralSettings=t.GeneralSettingsManager=t.isFocusNavigationEnabled=t.isSideBarDocked=t.isLandingPageDashboard=void 0;h=0;t.isLandingPageDashboard=c;t.isSideBarDocked=l;t.isFocusNavigationEnabled=a;s=(function(t){function f(n,i,r){return t.call(this,n,i,r)||this}return __extends(f,t),f.create=function(n,t){var i=new o;return t.registerObjectFactory(FxImpl.Constants.RpcMethods.getSettings,{allowedOrigin:null,allowRemoteChanges:!1,handler:function(){return MsPortalFx.clone(i,!1)}}),u.create(f,n,i,h)},__decorate([__metadata("fx:diagnostics",[n,"GeneralSettingsManager"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[r.SettingsManager,FxImpl.Rpc.Client]),__metadata("design:returntype",Object)],f,"create",null),f})(u.SettingsProcessor);t.GeneralSettingsManager=s;o=(function(){function t(){this.rawLocale=ko.observable("");this["fxs-theme"]=ko.observable();this.cdmTimeMs=ko.observable(0);this.npsTimeMs=ko.observable(0);this.sideBarCollapsedKey=ko.observable(!1);this.notificationToastEnabledKey=ko.observable(!0);this.whatsNewEnabledKey=ko.observable(!0);this.sideBarBrowseDisplayModeKey=ko.observable(0);this.whatsNewVersion=ko.observable(0);this.userConsentForNpsContact=ko.observable(!1);this.highContrastKey=ko.observable(0);this.idleTimeoutMins=ko.observable(0);this.dblClickThemeEnabledKey=ko.observable(!0);this.searchHistory=ko.observable("");this.landingPage=ko.observable(MsPortalFx.isFeatureEnabled("landalltohome")?3:4);this.devSatTimeMs=ko.observable(0);this.TestExtensions=ko.observable();this.TestPatches=ko.observable();this.sideBarLayout=ko.observable(MsPortalFx.isFeatureEnabled("sidebarhamburgermode")?3:4);this.focusNavigationMode=ko.observable(!MsPortalFx.isFeatureEnabled("reservehozscroll")||MsPortalFx.isFeatureEnabled("allowdisablehozscroll")?3:4)}return t.create=function(n){return n.value},__decorate([__metadata("fx:diagnostics",[n,"GeneralSettings"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s]),__metadata("design:returntype",t)],t,"create",null),t})();t.GeneralSettings=o;t.writeBrowsePreviewOptInFlagHandler=e.defineHandler(f.writeBrowsePreviewOptInFlagEndpoint,(function(n){var t=n.messageArg,i;(t.assetIds||[]).length&&(i=n.diContainer.get(r.SettingsManager),i.querySetting(15,"argBrowsePreference").then((function(n){var u,f,r;n=n||{};t.assetIds.forEach((function(i){n[i.toLowerCase()]=t.value}));i.setSetting(15,"argBrowsePreference",n);u=(window.location.hash||"").toLowerCase();!t.preventAutoBladeLaunch&&(u.startsWith("#blade/HubsExtension/BrowseResource/resourceType/".toLowerCase())||u.startsWith("#blade/HubsExtension/BrowseResourceBlade/resourceType/".toLowerCase()))&&(f=encodeURIComponent(t.resourceType),r=t.value?"#blade/HubsExtension/BrowseResource/resourceType/"+f:"#blade/HubsExtension/BrowseResourceBlade/resourceType/"+f,t.kind&&(r=r+"/kind/"+encodeURIComponent(t.kind)),window.location.hash=r)})))}))}));
define("MsPortalImpl/UI/Commands/Base.PortalFunctions",["require","exports","Fx/DependencyInjection"],(function(n,t,i){"use strict";var r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at;Object.defineProperty(t,"__esModule",{value:!0});t.ShowWelcomeSequence=t.ShowDebugTools=t.DownloadDiagnosticsJson=t.ToggleCloudShell=t.CreateJourneyForAssetFunc=t.CreateJourneyForBladeFunc=t.ReloadPartPortalFunc=t.ReplacePartPortalFunc=t.DeleteDashboardWithConfimationPortalFunc=t.PinBladePortalFunc=t.PinTilePortalFunc=t.PinTileWithOptionsPortalFunc=t.PinTilesPortalFunc=t.RoutePortalFunc=t.GetCurrentDashboardPropertiesPortalFunc=t.IsCurrentDashboarSharedPortalFunc=t.IsDashboardWritablePortalFunc=t.UnshareDashboardToSessionPortalFunc=t.ShareDashboardToSessionPortalFunc=t.ShareCurrentDashboardPortalFunc=t.AssignTagsToDashboardPortalFunc=t.ClonePartPortalFunc=t.CloneDashboardPortalFunc=t.ResetDashboardPortalFunc=t.SwitchDashboardPortalFunc=t.ReadDashboardPortalFunc=t.ImportDashboardPortalFunc=t.ExportDashboardPortalFunc=t.StartNewDashboardPortalFunc=t.RefreshDashboardPortalFunc=t.PortalFunction=void 0;r=(function(){function n(){this._eventHandlers=[]}return n.prototype.setRegistration=function(n){this._handler=n},n.prototype.addPreInvocationEvent=function(n){this._eventHandlers.push(n)},n.prototype.invoke=function(n,t){if(!this._handler)throw new Error("Must register portal function before calling it.");return this._eventHandlers.forEach((function(n){return n(t)})),this._handler(n,t)},n})();t.PortalFunction=r;u=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"RefreshDashboardPortalFunc"]),i.Class()],r)})(r);t.RefreshDashboardPortalFunc=u;f=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"StartNewDashboardPortalFunc"]),i.Class()],r)})(r);t.StartNewDashboardPortalFunc=f;e=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"ExportDashboardPortalFunc"]),i.Class()],r)})(r);t.ExportDashboardPortalFunc=e;o=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"ImportDashboardPortalFunc"]),i.Class()],r)})(r);t.ImportDashboardPortalFunc=o;s=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"ReadDashboardPortalFunc"]),i.Class()],r)})(r);t.ReadDashboardPortalFunc=s;h=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"SwitchDashboardPortalFunc"]),i.Class()],r)})(r);t.SwitchDashboardPortalFunc=h;c=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"ResetDashboardPortalFunc"]),i.Class()],r)})(r);t.ResetDashboardPortalFunc=c;l=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"CloneDashboardPortalFunc"]),i.Class()],r)})(r);t.CloneDashboardPortalFunc=l;a=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"ClonePartPortalFunc"]),i.Class()],r)})(r);t.ClonePartPortalFunc=a;v=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"AssignTagsToDashboardPortalFunc"]),i.Class()],r)})(r);t.AssignTagsToDashboardPortalFunc=v;y=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"ShareCurrentDashboardPortalFunc"]),i.Class()],r)})(r);t.ShareCurrentDashboardPortalFunc=y;p=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"ShareDashboardToSessionPortalFunc"]),i.Class()],r)})(r);t.ShareDashboardToSessionPortalFunc=p;w=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"UnshareDashboardToSessionPortalFunc"]),i.Class()],r)})(r);t.UnshareDashboardToSessionPortalFunc=w;b=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"IsDashboardWritablePortalFunc"]),i.Class()],r)})(r);t.IsDashboardWritablePortalFunc=b;k=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"IsCurrentDashboarSharedPortalFunc"]),i.Class()],r)})(r);t.IsCurrentDashboarSharedPortalFunc=k;d=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"GetCurrentDashboardPropertiesPortalFunc"]),i.Class()],r)})(r);t.GetCurrentDashboardPropertiesPortalFunc=d;g=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"RoutePortalFunc"]),i.Class()],r)})(r);t.RoutePortalFunc=g;nt=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"PinTilesPortalFunc"]),i.Class()],r)})(r);t.PinTilesPortalFunc=nt;tt=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"PinTileWithOptionsPortalFunc"]),i.Class()],r)})(r);t.PinTileWithOptionsPortalFunc=tt;it=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"PinTilePortalFunc"]),i.Class()],r)})(r);t.PinTilePortalFunc=it;rt=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"PinBladePortalFunc"]),i.Class()],r)})(r);t.PinBladePortalFunc=rt;ut=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"DeleteDashboardWithConfimationPortalFunc"]),i.Class()],r)})(r);t.DeleteDashboardWithConfimationPortalFunc=ut;ft=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"ReplacePartPortalFunc"]),i.Class()],r)})(r);t.ReplacePartPortalFunc=ft;et=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"ReloadPartPortalFunc"]),i.Class()],r)})(r);t.ReloadPartPortalFunc=et;ot=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"CreateJourneyForBladeFunc"]),i.Class()],r)})(r);t.CreateJourneyForBladeFunc=ot;st=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"CreateJourneyForAssetFunc"]),i.Class()],r)})(r);t.CreateJourneyForAssetFunc=st;ht=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"ToggleCloudShell"]),i.Class()],r)})(r);t.ToggleCloudShell=ht;ct=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"DownloadDiagnosticsJson"]),i.Class()],r)})(r);t.DownloadDiagnosticsJson=ct;lt=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"ShowDebugTools"]),i.Class()],r)})(r);t.ShowDebugTools=lt;at=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"ShowWelcomeSequence"]),i.Class()],r)})(r);t.ShowWelcomeSequence=at}));
define("MsPortalImpl/Interactions/Interactions.DismissHandler",["require","exports"],(function(n,t){"use strict";function w(n,t){o.error("An error occurred on dismiss. Unregister might have been forgotten on cleanup of the dismissable element. DismissHandle log name: {0}".format(t&&t.logName||"unknown"),0,n)}function b(n){var i="function",t=!!n;return n.shouldDismissOnFocusOutFn&&(t=t&&typeof n.shouldDismissOnFocusOutFn===i),n.restoreFocus&&(t=t&&typeof n.restoreFocus===i),n.shouldDismissOnMouseDownFn&&(t=t&&typeof n.shouldDismissOnMouseDownFn===i),n.shouldDismissOnMouseWheelFn&&(t=t&&typeof n.shouldDismissOnMouseWheelFn===i),t}function u(n){var t=n&&typeof n.dismissFn=="function"&&b(n);return t||o.error("The dismiss handle object is null or malformed."),t}function f(n){var t,i;if(r.length){t=r[r.length-1];try{i=n(t);i!==0&&(t.dismissFn(),i===2&&t.restoreFocus&&t.restoreFocus())}catch(u){w(u,t)}}}function l(n){f((function(t){return t.shouldDismissOnFocusOutFn&&u(t)?t.shouldDismissOnFocusOutFn(n.target):0}))}function a(n){n.keyCode===27&&f((function(n){return u(n)?2:0}))}function s(n){f((function(t){return t.shouldDismissOnMouseDownFn&&u(t)?t.shouldDismissOnMouseDownFn(n.target,n):0}))}function v(n){h||(h=!0,setTimeout((function(){h=!1}),250),f((function(t){return t.shouldDismissOnMouseWheelFn&&u(t)?t.shouldDismissOnMouseWheelFn(n.target):0})))}function y(n){f((function(t){return t.shouldDismissOnMouseWheelFn&&t.shouldDismissOnScroll&&u(t)&&!$(n.target).hasClass("azc-resize")?t.shouldDismissOnMouseWheelFn(n.target):0}))}function i(){return e?{capture:!0}:!0}function p(){return e?{capture:!0,passive:!0}:!0}function k(){var n=c.body;n.addEventListener("focus",l,i());n.addEventListener("keydown",a,i());n.addEventListener("mousedown",s,i());n.addEventListener("touchstart",s,p());n.addEventListener("wheel",v,p());n.addEventListener("scroll",y,i())}function d(){var n=c.body;n.removeEventListener("focus",l,i());n.removeEventListener("keydown",a,i());n.removeEventListener("mousedown",s,i());n.removeEventListener("touchstart",s,i());n.removeEventListener("wheel",v,i());n.removeEventListener("scroll",y,i());r.length=0}function g(n){if(!u(n))throw new Error("The dismiss handle object is null or malformed.");r.some((function(t){return t===n}))||r.push(n)}function nt(n){MsPortalFx.remove(r,n)}function tt(n){r.length&&r.filter((function(t){return t.logName===n})).forEach((function(t){t.dismissFn(n)}))}function it(n,t){var i="DismissHandle for '"+n.logName+"': previouslyFocusedElement";if(t){if(typeof t.focus!="function")return o.error(FxImpl.createError(i+" focus member is not a function. _previouslyFocusedElement.focus: "+t.focus,{data:{previous:MsPortalFx.getObjectDescriptor(t)}})),!1}else return o.warning(i+" was not defined."),!1;return!0}var e;Object.defineProperty(t,"__esModule",{value:!0});t.validatePreviousFocusedElement=t.dismissByLogName=t.unregister=t.register=t.dispose=t.initialize=void 0;var c=document,o=MsPortalFx.Base.Diagnostics.createLog(n),h=!1,r=[];e=!1;try{window.addEventListener("test",null,{passive:!0});window.removeEventListener("test",null);e=!0}catch(rt){e=!1}t.initialize=k;t.dispose=d;t.register=g;t.unregister=nt;t.dismissByLogName=tt;t.validatePreviousFocusedElement=it}));
define("MsPortalImpl/TsxStringMode/Tsx",["require","exports"],(function(){"use strict";function n(t,i){for(var u=[],r=2;r<arguments.length;r++)u[r-2]=arguments[r];var o=typeof t=="string"?t:t(),f=n.elementStringFactories[o],e=f.createOpenTag(i);return e+=u.join(""),e+f.createClosingTag()}return (function(n){function i(){return"Root"}function r(){return"KoIf"}function u(){return"KoIfNot"}function f(){return"KoForEach"}function e(){return"KoTemplate"}function o(){return"KoContext"}function t(n){var t=[];return n&&Object.keys(n).forEach((function(i){switch(i){case"data-bind":n["data-bind"]&&t.push(h(n["data-bind"]));break;case"class":n["class"]&&t.push(s(n["class"]));break;default:MsPortalFx.isNullOrUndefined(n[i])||t.push(i+"='"+n[i]+"'")}})),t}function s(n){var t=typeof n=="string"?n:n.join(" ");return"class='"+t+"'"}function h(n){var t=[],i=function(n){MsPortalFx.forEachKey(n,(function(n,r){t.push('"'+n+'":');typeof r=="string"?t.push(r):(t.push("{"),i(r),t.push("}"));t.push(",")}));t.pop()};return t.push("data-bind='"),i(n),t.push("'"),t.join("")}n.Root=i;n.KoIf=r;n.KoIfNot=u;n.KoForEach=f;n.KoTemplate=e;n.KoContext=o;n.elementStringFactories={Root:{createOpenTag:function(){return""},createClosingTag:function(){return""}},a:{createOpenTag:function(n){return"<a "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/a>"}},article:{createOpenTag:function(n){return"<article "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/article>"}},aside:{createOpenTag:function(n){return"<aside "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/aside>"}},b:{createOpenTag:function(n){return"<b "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/b>"}},br:{createOpenTag:function(n){return"<br "+t(n).join(" ")+"/>"},createClosingTag:function(){return""}},button:{createOpenTag:function(n){return"<button "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/button>"}},canvas:{createOpenTag:function(n){return"<canvas "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/canvas>"}},div:{createOpenTag:function(n){return"<div "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/div>"}},fieldset:{createOpenTag:function(n){return"<fieldset "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/fieldset>"}},"fxs-progress":{createOpenTag:function(n){return"<fxs-progress "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/fxs-progress>"}},h1:{createOpenTag:function(n){return"<h1 "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/h1>"}},h2:{createOpenTag:function(n){return"<h2 "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/h2>"}},h3:{createOpenTag:function(n){return"<h3 "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/h3>"}},h4:{createOpenTag:function(n){return"<h4 "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/h4>"}},h5:{createOpenTag:function(n){return"<h5 "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/h5>"}},hr:{createOpenTag:function(n){return"<hr "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/hr>"}},header:{createOpenTag:function(n){return"<header "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/header>"}},i:{createOpenTag:function(n){return"<i "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/i>"}},iframe:{createOpenTag:function(n){return"<iframe "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/iframe>"}},img:{createOpenTag:function(n){return"<img "+t(n).join(" ")+"/>"},createClosingTag:function(){return""}},input:{createOpenTag:function(n){return"<input "+t(n).join(" ")+"/>"},createClosingTag:function(){return""}},label:{createOpenTag:function(n){return"<label "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/label>"}},legend:{createOpenTag:function(n){return"<legend "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/legend>"}},li:{createOpenTag:function(n){return"<li "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/li>"}},main:{createOpenTag:function(n){return"<main "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/main>"}},nav:{createOpenTag:function(n){return"<nav "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/nav>"}},p:{createOpenTag:function(n){return"<p "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/p>"}},span:{createOpenTag:function(n){return"<span "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/span>"}},table:{createOpenTag:function(n){return"<table "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/table>"}},tbody:{createOpenTag:function(n){return"<tbody "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/tbody>"}},td:{createOpenTag:function(n){return"<td "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/td>"}},textarea:{createOpenTag:function(n){return"<textarea "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/textarea>"}},th:{createOpenTag:function(n){return"<th "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/th>"}},thead:{createOpenTag:function(n){return"<thead "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/thead>"}},time:{createOpenTag:function(n){return"<time "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/time>"}},tr:{createOpenTag:function(n){return"<tr "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/tr>"}},ul:{createOpenTag:function(n){return"<ul "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/ul>"}},video:{createOpenTag:function(n){return"<video "+t(n).join(" ")+">"},createClosingTag:function(){return"<\/video>"}},KoIf:{createOpenTag:function(n){return"<!-- ko if: "+n.condition+" -->"},createClosingTag:function(){return"<!-- /ko -->"}},KoIfNot:{createOpenTag:function(n){return"<!-- ko ifnot: "+n.condition+" -->"},createClosingTag:function(){return"<!-- /ko -->"}},KoForEach:{createOpenTag:function(n){return"<!-- ko foreach: "+n.items+" -->"},createClosingTag:function(){return"<!-- /ko -->"}},KoTemplate:{createOpenTag:function(n){var t;return n.templateKey?t="'"+n.templateKey+"'":n.options&&(t=n.options),"<!-- ko template: "+t+" -->"},createClosingTag:function(){return"<!-- /ko -->"}},KoContext:{createOpenTag:function(n){return"<!-- ko context: "+n.context+" -->"},createClosingTag:function(){return"<!-- /ko -->"}}}})(n||(n={})),n}));
define("MsPortalImpl/Interactions/Interactions.ContextMenuTouch",["require","exports"],(function(n,t){"use strict";function s(n){var i=n.originalEvent,t=i&&i.touches,r=t&&t.length===1,u=t&&t[0];return r?u:null}function c(){var n={width:0,height:0,top:i.targetY,left:i.targetX};r.css(n);$.querySelectorAll("body").append(r);r.animate({width:u,height:u,top:"-="+(u/2+5),left:"-="+u/2},75)}function l(n){if(n){var t={opacity:.2},i={opacity:1};r.animate(t,25).animate(i,25).animate(t,25).animate(i,25)}r.animate({width:0,height:0,top:"+="+u/2,left:"+="+u/2},75,(function(){r.detach()}))}function e(n,t){t.off(f);clearTimeout(o);l(n);i={startTime:0,target:null,targetX:0,targetY:0}}function a(n){e(!0,$(n.currentTarget))}function v(n){var r=s(n)||{clientX:0,clientY:0},u=Math.abs(i.targetX-r.clientX),f=Math.abs(i.targetY-r.clientY);(u>t.MoveTolerancePixels||f>t.MoveTolerancePixels)&&e(!0,$(n.currentTarget))}function y(n){var u=$(n.currentTarget),o,r;i.startTime&&(o=Math.abs(Date.now()-i.startTime),o>=t.ReactionDelayMillis&&(u.off("contextmenu"+f),r=$.Event("contextmenu"),r.clientX=i.targetX,r.clientY=i.targetY,$(i.target).trigger(r)));e(!1,u)}function h(n){var r=s(n),u=$(n.currentTarget);if(!r){e(!0,u);return}if(!i||i.startTime===0){i={startTime:Date.now(),target:n.target,targetX:r.clientX,targetY:r.clientY};o=setTimeout((function(){c()}),t.ReactionDelayMillis);u.on("contextmenu"+f,(function(){return!1})).on("touchmove"+f,v).on("touchcancel"+f,a).on("touchend"+f,y)}}function p(n){n.on("touchstart",h)}function w(n){n.off("touchstart",h);e(!0,n)}Object.defineProperty(t,"__esModule",{value:!0});t.unregister=t.register=t.HintClassIdentifier=t.MoveTolerancePixels=t.ReactionDelayMillis=void 0;t.ReactionDelayMillis=550;t.MoveTolerancePixels=10;t.HintClassIdentifier="fxs-contextMenuTouchHint";var r=$(FxImpl.createElement("div",{"class":t.HintClassIdentifier})),u=110,f=".cmtevt",o,i={startTime:0,target:null,targetX:0,targetY:0};t.register=p;t.unregister=w}));
define("_generated/Less/MsPortalImpl/Interactions/Interactions.FullScreenMode.css",["module"],(function(n){"use strict";return{css:".fxs-portal-fullscreen .fxs-sidebar,.fxs-portal-fullscreen .fxs-topbar,.fxs-portal-fullscreen .fxs-journey-breadcrumb{display:none !important}.fxs-portal-fullscreen .fxs-startboard-button{display:none}.fxs-portal-fullscreen .fxs-startboard-dropdown,.fxs-portal-fullscreen .fxs-startboard-commandBar{display:none}.fxs-portal-fullscreen .fxs-startboard-title-next,.fxs-portal-fullscreen .fxs-startboard-commandBar-fullScreen{display:block}",moduleId:n.id}}));
define("MsPortalImpl/Interactions/Interactions.FullScreenMode",["require","exports","Fx/DependencyInjection","FxInternal/Css","_generated/Less/MsPortalImpl/Interactions/Interactions.FullScreenMode.css"],(function(n,t,i,r,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FullScreenMode=void 0;r.injectCss(u);var e=document.body,f=e.classList,o=(function(){function t(){var t=this,n;this.isActive=ko.observable(!1);n=new MutationObserver(function(){t.isActive(f.contains("fxs-portal-fullscreen"))});n.observe(e,{attributes:!0,attributeFilter:["class"]})}return t.prototype.enter=function(){f.add("fxs-portal-fullscreen")},t.prototype.exit=function(){f.remove("fxs-portal-fullscreen")},t.prototype.toggle=function(){this.isActive()?this.exit():this.enter()},__decorate([__metadata("fx:diagnostics",[n,"FullScreenMode"]),i.Class(),__metadata("design:paramtypes",[])],t)})();t.FullScreenMode=o}));
define("_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardOnlyOutlines.css",["module"],(function(n){"use strict";return{css:".fxs-hidefocusoutline *{outline:none !important}",moduleId:n.id}}));
define("MsPortalImpl/Interactions/Interactions.KeyboardOnlyOutlines",["require","exports","FxInternal/Css","_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardOnlyOutlines.css"],(function(n,t,i,r){"use strict";function s(){u.addEventListener("mousedown",f,!0);u.addEventListener("pointerdown",f,!0);u.addEventListener("keydown",o,!0);f()}function h(){u.removeEventListener("mousedown",f,!0);u.removeEventListener("pointerdown",f,!0);u.removeEventListener("keydown",o,!0);$(u).removeClass("fxs-showfocusoutline").removeClass("fxs-hidefocusoutline")}Object.defineProperty(t,"__esModule",{value:!0});t.unregister=t.register=void 0;i.injectCss(r);var u=document.body,e=function(n){$(u).toggleClass("fxs-hidefocusoutline",!n).toggleClass("fxs-showfocusoutline",n)},f=function(){e(!1)},o=function(n){var t=n.keyCode;(t===9||t===13||t===27||t===32||t===37||t===38||t===39||t===40)&&e(!0)};t.register=s;t.unregister=h}));
define("MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip",["require","exports","MsPortalImpl/Base/Base.Timers"],(function(n,t,i){"use strict";function e(n){n.on("mouseenter",r,u)}function o(n){n.off("mouseenter",r,u)}Object.defineProperty(t,"__esModule",{value:!0});t.unregister=t.register=void 0;var r=".msportalfx-tooltip-overflow,.msportalfx-text-ellipsis",f="fxs-autotooltip",u=i.throttleByAnimationFrame((function(n){var t=n.currentTarget,i=$(t);t.offsetWidth<t.scrollWidth&&!t.title&&i.attr("title",i.text()||i.val()||i.attr("placeholder")||null).addClass(f)}));t.register=e;t.unregister=o}));
define("MsPortalImpl/Interactions/Interactions.KeyboardNavigation",["require","exports","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Base/JQueryHelper"],(function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.KeyboardNavigation=void 0;var u=(function(){function n(n,t){var i=this,r;this._element=t.element;this._tabTriggers=t.tabTriggers||6;this._itemSelector=t.itemSelector||":tabbable";this._arrowsOnly=!(this._tabTriggers&2);this._internalLifetime=n.createChildLifetime();this._parentTabIndexContextObservable=t.parentTabIndexContextObservable;this._childrenHaveTabIndexContext=t.childrenHaveTabIndexContext;this._setRootTabIndex();this._internalLifetime.registerForDispose(this._element.setEvents(["focus",function(){var n=i._element.find(i._itemSelector).first();i._arrowsOnly&&i._manageTabIndices(n);n.focus()},],["keydown",function(n){i._handleMenuKeyDown(n)},]));this._arrowsOnly&&(r=this._element.find(this._itemSelector),r.attr("tabindex","-1"),this._internalLifetime.registerForDispose(this._element.setEvents(["focus",this._itemSelector,function(n){i._manageTabIndices($(n.target).closest(i._itemSelector,i._element[0]))}])))}return n.prototype.correctState=function(n){(n||this._lastTarget&&this._lastTarget.length&&this._element.find(this._itemSelector).toArray().indexOf(this._lastTarget[0])<0)&&(this._setRootTabIndex(),this._lastTarget&&this._lastTarget.attr("tabindex","-1"))},n.prototype.dispose=function(){this._internalLifetime.dispose()},n.prototype._handleMenuKeyDown=function(n){var u=i.getModifierKeys(n),r=!1,f=this._tabTriggers&2,e=this._tabTriggers&4,o=this._tabTriggers&8,t=u===0;f&&n.keyCode===9&&t||e&&n.keyCode===40&&t||o&&n.keyCode===39&&t?r=this._moveFocusToItem(1,n.target):(f&&n.keyCode===9&&u===4||e&&n.keyCode===38&&t||o&&n.keyCode===37&&t)&&(r=this._moveFocusToItem(-1,n.target));r&&n.preventDefault()},n.prototype._moveFocusToItem=function(n,t){var u=!1,e=this._element.find(this._itemSelector),i=$(e.filter((function(n,t){return r.isElementVisible(t)}))),f=i.index(t);return f!==-1&&($(i[(f+n+i.length)%i.length]).focus(),u=!0),u},n.prototype._manageTabIndices=function(n){var t=this,i,r,u;n&&n.length&&(!this._lastTarget||this._lastTarget[0]!==n[0])&&(i=this._element.find(this._itemSelector),this._itemFocusLifetime&&this._itemFocusLifetime.dispose(),this._itemFocusLifetime=this._internalLifetime.createChildLifetime(),this._lastTarget=n,i.index(this._lastTarget[0])>=0&&(this._parentTabIndexContextObservable?this._parentTabIndexContextObservable.subscribeAndRun(this._itemFocusLifetime,(function(n){if(i.attr("tabindex","-1"),t._lastTarget.attr("tabindex",n),t._childrenHaveTabIndexContext){var r=ko.contextFor(t._lastTarget[0]).$tabIndex;r&&r(n)}})):(i.attr("tabindex","-1"),this._lastTarget.attr("tabindex","0"))),this._clearRootTabIndex(),r=function(){t._setRootTabIndex()},u=this._lastTarget[0],ko.utils.domNodeDisposal.addDisposeCallback(u,r),this._itemFocusLifetime.registerForDispose((function(){ko.utils.domNodeDisposal.removeDisposeCallback(u,r)})))},n.prototype._setRootTabIndex=function(){var n=this;this._parentTabIndexContextObservable?(this._rootFocusLifetime&&this._rootFocusLifetime.dispose(),this._rootFocusLifetime=this._internalLifetime.createChildLifetime(),this._parentTabIndexContextObservable.subscribeAndRun(this._rootFocusLifetime,(function(t){n._element.attr("tabindex",t)}))):this._element.attr("tabindex","0")},n.prototype._clearRootTabIndex=function(){this._rootFocusLifetime&&this._rootFocusLifetime.dispose();this._element.attr("tabindex","-1")},n})();t.KeyboardNavigation=u}));
define("MsPortalImpl/Widgets/Widgets.ContextMenu",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Base/Base.Events","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip","MsPortalImpl/Widgets/Widgets.WidgetBase","WeaveDOM/DirectRender/DataAttribute","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";function v(n,t){return t||ft.error("ContextMenuViewModel."+n+" is not accessible. Please call registerForCleanup first."),t}function nt(n){return n.isShellCommand}var tt,it;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.ViewModel=void 0;l.injectCss(a);var rt=MsPortalFx.Base,ut=rt.Diagnostics,y=window,ft=ut.createLog(n),p="fxs-contextMenu",w="fxs-contextMenu-active",b="fxs-contextMenu-item",et="fxs-contextMenu-itemDisabled",k="fxs-popup",d="fxs-portal-bg-txt-br",g="msportalfx-shadow-level2",ot=i(r.Root,null,i("ul",{role:"menu","class":"fxs-contextMenu-itemList","data-bind":{attr:{"aria-label":"ariaLabel"}}},i(r.KoForEach,{items:"commands"},i("li",{role:"menuitem","class":"fxs-contextMenu-item msportalfx-command-like-button",tabindex:"0","data-bind":{css:{"fxs-portal-hover":"enabled","fxs-contextMenu-itemDisabled msportalfx-command-like-button-disabled":"!enabled()","fxs-contextMenu-extensioncommand":"!!$data._extension"},attr:{title:"$data.tooltip()","aria-disabled":"!enabled()","aria-label":"ariaLabel","aria-posinset":"$index() + 1","aria-setsize":"$parent.commands().length"}}},i("div",{"class":"fxs-contextMenu-icon","data-bind":{image:"icon"}}),i("div",{"class":"fxs-contextMenu-text msportalfx-text-ellipsis","data-bind":{text:"text"}})))));tt=(function(n){function t(){var t=n.call(this)||this;return t.visible=ko.observable(!1),t.menuItems=ko.observableArray(),t.topOffsetCorrection=0,t}return __extends(t,n),t.prototype.getOrderedMenuItemsCommandsComputed=function(){return v("orderedMenuItemsCommands",this._orderedMenuItemsCommands)},t.prototype.getOrderedMenuItemsComputed=function(){return v("orderedMenuItems",this._orderedMenuItems)},Object.defineProperty(t.prototype,"hasVisibleCommands",{get:function(){return v("hasVisibleCommands",this._hasVisibleCommands)},enumerable:!1,configurable:!0}),t.prototype.registerForCleanup=function(n){var t=this,r=this.menuItems,i=this._ltm=n.createChildLifetime(),u=this._orderedMenuItemsCommands=r.filter(i,(function(n){return n.visible()&&!nt(n)&&!n.hasPopup()})),f=this._orderedMenuItems=r.filter(i,(function(n){return n.visible()&&nt(n)&&n.enabled()}));this._hasVisibleCommands=ko.computed(i,(function(){return u().length+f().length>0}));i.registerForDispose((function(){t._ltm=t._orderedMenuItemsCommands=t._orderedMenuItems=t._hasVisibleCommands=null}))},t})(h.ViewModel);t.ViewModel=tt;it=(function(n){function t(t,i,r){var u=n.call(this,t,i)||this,h;u._newRenderFlag=r;u._lastShowArgs=ko.observable(null);var s=u.ltm,c=function(n){var t=u.element[0];return!(t===n)&&!$.contains(t,n)?2:0},o={dismissFn:function(){u.hide()},shouldDismissOnMouseDownFn:c,shouldDismissOnMouseWheelFn:c,logName:"contextmenu"};return r||(i.registerForCleanup(s),t.html(ot).addClass(p+" "+k+" "+d+" "+g),u._bindDescendants({ariaLabel:f.ContextMenu.ariaLabel,commands:ko.explicitComputed(s,[i.getOrderedMenuItemsComputed(),i.getOrderedMenuItemsCommandsComputed()],(function(n,t){return n.concat(t)}))})),h=new MutationObserver(function(){return u.updateRenderedPositionFromLastShow()}),h.observe(t.findByClassName("fxs-contextMenu-itemList")[0],{childList:!0}),s.registerForDispose((function(){return h.disconnect()})),u._initializeHandlers(),i.visible.subscribeAndRun(s,(function(n){var t=u.element,i;n?(i=document.activeElement,o.restoreFocus=function(){e.validatePreviousFocusedElement(o,i)&&i.focus()},t.css(u._ensureInViewPort(u._lastShowArgs())).addClass(w),u.setFocus(),e.register(o)):(u._lastShowArgs(null),t[0].contains(document.activeElement)&&o.restoreFocus&&o.restoreFocus(),t.removeClass(w),e.unregister(o))})),u}return __extends(t,n),t.prototype.dispose=function(){this.hide();this._cleanElement(p,k,d,g);n.prototype.dispose.call(this)},t.prototype.hide=function(){this.options.visible(!1)},t.prototype.show=function(n,t,i){if(n===void 0&&(n=0),t===void 0&&(t=0),i===void 0&&(i=!1),u.isFullscreen()){this.hide();return}this._lastShowArgs({xCoord:n,yCoord:t,forceLeft:i});this.options.visible(!0)},t.prototype.updateRenderedPositionFromLastShow=function(){var n=this._lastShowArgs();n&&this.element.css(this._ensureInViewPort(n))},t.prototype.setFocus=function(){var n=this;Q.fcall((function(){n.element.find("[tabindex=0]:first-of-type").focus()}))},t.prototype._initializeHandlers=function(){var n=this,t=this.element,i=this.ltm,r=function(t){if(t.stopPropagation(),t.preventDefault(),!$(t.currentTarget).hasClass(et)){n.hide();var i=n._newRenderFlag?c.getElementData(t.currentTarget):ko.dataFor(t.target);i&&i.enabled()&&i.execute(!0)}};new o.KeyboardNavigation(this.ltm,{element:t});s.register(t);ko.computed(i,(function(){n._lastShowArgs()&&(n.options.menuItems().forEach((function(n){n.enabled()})),n.updateRenderedPositionFromLastShow())}));i.registerForDispose([function(){s.unregister(t)},t.setEvents(["contextmenu",function(){return!1},]),t.find("ul").setEvents(["click","."+b,r,],["keydown","."+b,function(n){n.which===13&&r(n)},]),])},t.prototype._ensureInViewPort=function(n){var e=n.xCoord,h=n.yCoord,o=n.forceLeft,t=h,i="auto",s=this.element,r=s.outerHeight(),u=s.outerWidth(),f;return this._isRtl()?(i=e-u,(o||i-u<0)&&(i+=u,t+=this.options.topOffsetCorrection)):(i=e,(o||i+u>y.innerWidth)&&(i-=u,t+=this.options.topOffsetCorrection)),f=y.innerHeight,t+r>f&&(t-r>=0?t-=r:t=r<f?MsPortalFx.truncate((f-r)/2):0,t+=this.options.topOffsetCorrection),{top:t,left:i}},t})(h.Widget);t.Widget=it}));
define("MsPortalImpl/Interactions/Interactions.PortalReader",["require","exports"],(function(n,t){"use strict";var i,u,r,f;Object.defineProperty(t,"__esModule",{value:!0});t.PortalReader=void 0;i=document;i.getElementById("PortalReader")||(u=i.body,u.appendChild(FxImpl.createElement("div",{id:"PortalReader","class":"fxs-hide-accessible-label"})));r=i.getElementById("PortalReader");f=(function(){function n(n,t){this._nextId=MsPortalFx.getUniqueIdGenerator(t===null||t===void 0?void 0:t.idPrefix);var u=(t===null||t===void 0?void 0:t.removalDelayMs)>=0?t===null||t===void 0?void 0:t.removalDelayMs:6e4,i=this._liveRegion=FxImpl.createElement("div",{id:this._nextId(),"class":"fxs-hide-accessible-label","aria-live":"polite","aria-relevant":"additions"});r.appendChild(i);n.registerForDispose((function(){setTimeout((function(){r.removeChild(i)}),u)}))}return n.prototype.read=function(n){var t=FxImpl.createElement("div",{id:this._nextId()});t.textContent=n;this._liveRegion.appendChild(t)},n})();t.PortalReader=f}));
define("MsPortalImpl/Widgets/Widgets.UIElementBase",["require","exports","MsPortalImpl/Widgets/Widgets.WidgetBase"],(function(n,t,i){"use strict";var r,f,u,e;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.ViewModel=void 0;r="Not implemented in base class.";f=(function(n){function t(t){var i=n.call(this)||this;return i.locked=ko.observable(!0),i.id=t,i}return __extends(t,n),t.prototype.getViewSettings=function(){throw new Error(r);},t.prototype.applyViewSettings=function(){throw new Error(r);},t})(i.ViewModel);t.ViewModel=f;u=new WeakMap;e=(function(n){function t(i,r,u){u===void 0&&(u=!1);var f=n.call(this,i,r,u)||this;if(!r.id||typeof r.id!="string")throw new Error("An unique identifier is required and it must be a string.");return t.attachId(i,r.id),f}return __extends(t,n),t.prototype.dispose=function(){t.detachId(this.element);n.prototype.dispose.call(this)},t.attachId=function(n,t){var i=n[0];i&&u.set(i,t)},t.detachId=function(n){var t=n[0];t&&u.delete(t)},t.getId=function(n){var t=n[0];return t&&u.get(t)},t.prototype.addChild=function(){throw new Error(r);},t.prototype.insertChild=function(){throw new Error(r);},t.prototype.removeChild=function(){throw new Error(r);},t.prototype.moveChild=function(){throw new Error(r);},t.prototype.saveViewSettings=function(){throw new Error(r);},t.prototype.setSize=function(){throw new Error(r);},t.prototype.discardStateOfUnusedChildren=function(){return{stateDiscarded:!1}},t.viewSettingsChanged="viewSettingsChanged",t})(i.Widget);t.Widget=e}));
define("MsPortalImpl/Widgets/Widgets.ContextPane",["require","exports","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.BrowserDetection","Weave","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.ViewModel=void 0;s.injectCss(h);var v="fxs-contextpane",y="fxs-contextpane-title",c="fxs-contextpane-content",p="fxs-portal-bg-txt-br",l="fxsContextPaneTitle",w=(function(n){function t(t){var i=n.call(this,"fxs-contextpane-identifier")||this;return i.diContainer=t,i.opened=o.makeWritableComputation(!1),i.loading=o.makeWritableComputation(!1),i.hideExpandButton=o.makeWritableComputation(!0),i.openedFromTopBar=o.makeWritableComputation(!1),i.childElementCount=o.makeWritableComputation(0),i.close=MsPortalFx.noop,i}return __extends(t,n),t.prototype.setWidget=function(n){this._widget=n},t.prototype.getWidget=function(){return this._widget},t.prototype.getRootElement=function(){return this._widget.element},t})(r.ViewModel);t.ViewModel=w;a=(function(n){function t(t,i){var r=n.call(this,t,i,!0)||this;return r._announce=new u.PortalReader(r.ltm,{idPrefix:"contextpane"}),i.setWidget(r),e.isEdge&&r.element.addClass("fxs-isEdge"),r._$progress=$(t[0].querySelector(".fxs-contextpane-loadindicator")),o.subscribe(r.ltm,[i.loading],(function(n){n?r._announce.read(f.Shell.Reader.contextPaneLoading):r._announce.read(f.Shell.Reader.contextPaneReady)})),o.subscribe(r.ltm,[i.opened],(function(n){n||r._announce.read(f.Shell.Reader.contextPaneClosed)})),r}return __extends(t,n),t.prototype.dispose=function(){this._cleanElementClasses([v,p]);n.prototype.dispose.call(this)},t.prototype.hasContent=function(){return!!this._$content},t.prototype.addChild=function(n){this._addChild(n)},t.prototype.insertChild=function(n,t){this._addChild(n,t)},t.prototype._addChild=function(n,t){var f=this,u,r;if(!n)throw new Error("Can't add null child.");this.hasContent()&&!t&&this.removeChild(null);t>=0&&(u=$(this._getChildElement()[t-1]),u&&u.addClass("fxs-display-none"));r=this._$content=n.element?n.element:n;r.addClass(c).insertBefore(this._$progress);i.waitForBindings(r[0]).then((function(){var n=r.find("."+y+", .fxs-blade-title-titleText"),t=n.attr("id");t?f.element.attr("aria-labelledby",t):(f.element.attr("aria-labelledby",l),n.attr("id",l))}));this.options.hideExpandButton(!r.hasClass("fxs-partgallery-container"));this.options.childElementCount(this.options.childElementCount.value+1)},t.prototype.removeChild=function(n,t){var r=this._$content,i,u;return r?(t?r.detach():r.remove(),r.removeClass(c),i=this.options.childElementCount,i(Math.max(i.value-1,0)),i.value>0?(u=$(this._getChildElement()[i.value-1]),u.removeClass("fxs-display-none"),this._$content=u):this._$content=null,!0):!0},t.prototype.clear=function(){return this.removeChild(null)},t.prototype.setFocus=function(){if(!e.isAndroidOrMobile){var n=this._$content;n&&i.waitForBindings(this.element[0]).then((function(){var t,i=n.findByClassName("fxs-blade-content-container");i&&(t=i.findFirstTabbable());i&&t.length!==0||(t=n.findFirstTabbable());t.length!==0&&t.focus()}))}},t.prototype.getBladeHost=function(n,t){var i=this;return MsPortalFx.require("MsPortalImpl/Widgets/Widgets.Blade").then((function(r){var u=new r.ViewModel(MsPortalFx.getUniqueId(),i.options.diContainer),f;return u.title(t.title),u.defaultContent.title(t.title),u.defaultContent.bladeStyle(4),u.defaultContent.bladeWidth(t.bladeWidth),f=r.createBladeWidget($(FxImpl.createElement("section")),u),f.initializeLayout(),f.getContentWidget().initializeLayout(),f.getContentWidget().addChild(n),u.loaded(!0),u.defaultContent.loaded(!0),u.close=function(n){i.options.close(n)},f}))},t.prototype._getChildElement=function(){return this.element.children(".fxs-contextpane-content")},t})(r.Widget);t.Widget=a}));
define("MsPortalImpl/Interactions/Interactions.RightClick",["require","exports","MsPortalImpl/Base/Base.KeyboardHelper"],(function(n,t,i){"use strict";var r;return (function(n){function r(n,r,u){function h(){n.removeClass(t);var i=r();i&&i.forEach((function(n){n.dispose()}));f&&(n.off("fxcontextmenurequest",f),f=null);e&&(n.off("keydown",e),e=null);o&&(n.off("remove",o),o=null)}function c(n){var t=r();t&&t.length>0&&(n.preventDefault(),n.stopPropagation(),l(n.clientX,n.clientY))}function l(t,i){var u=$.Event("fxcontextmenu");u.clientX=t;u.clientY=i;s||(s=n.hasClass("fxs-bladecontent")?n:null);n.trigger(u,{commands:r(),formTarget:s,srcElement:n[0]})}var s=u&&u.formTarget,f,e,o;n.addClass(t);n.on("fxcontextmenurequest",f=function(n){c(n)});n.on("keydown",e=function(n){if(n.which===121&&i.getModifierKeys(n)===4){var t=n.target.getClientRects()[0];n.clientX=t&&t.left;n.clientY=t&&t.top;c(n)}});n.on("remove",o=h);return{dispose:h}}var t="fx-rightClick";n.setup=r})(r||(r={})),r}));
define("MsPortalImpl/UI/UI.DesktopManager",["require","exports","Fx/DependencyInjection"],(function(n,t,i){"use strict";var r,u;Object.defineProperty(t,"__esModule",{value:!0});t.PreviouslyFocusedElement=t.DesktopManagerMode=void 0;r=(function(){function t(){this.value=ko.observable(0)}return __decorate([__metadata("fx:diagnostics",[n,"DesktopManagerMode"]),i.Class()],t)})();t.DesktopManagerMode=r;u=(function(){function t(){this.value=ko.observable()}return __decorate([__metadata("fx:diagnostics",[n,"PreviouslyFocusedElement"]),i.Class()],t)})();t.PreviouslyFocusedElement=u}));
define("MsPortalImpl/Widgets/Widgets.DropMenu",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","Fx/Telemetry","MsPortalImpl/Weave/Util","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var w;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.ViewModel=void 0;h.injectCss(c);var l="fxs-dropmenu-button",a="fxs-dropmenu-hidden",v="fxs-dropmenu-is-open",y="fxs-dropmenu-invisible",b="fxs-popup-button",k="fxs-popup",d="fxs-portal-bg-txt-br",g="msportalfx-shadow-level2",p="aria-label",nt=i(r.Root,null,i("div",{"class":"fxs-dropmenu",role:"presentation"},i("button",{"class":"fxs-dropmenu-button","aria-haspopup":"true","aria-expanded":"false"}),i("div",{"class":"fxs-dropmenu-content fxs-text-link",role:"menu"}))),tt=(function(n){function t(t,i,r,u,f){var e=n.call(this)||this;return e.isMenuOpen=ko.observable(!1),e.buttonLabel=ko.observable(),e.buttonDescribedBy=ko.observable(),e.buttonTooltip=ko.observable(),e.menuLabel=ko.observable(),e.buttonTemplate=t,e.menuTemplate=i,e.togglesVisibility=!!u,e.itemSelector=r,e.telemetrySource=f,e.autoDismissMenu=!0,e}return __extends(t,n),t.prototype.open=function(){this.isMenuOpen(!0)},t.prototype.close=function(){this.isMenuOpen(!1)},t.prototype.toggle=function(){this.isMenuOpen(!this.isMenuOpen.peek())},t})(f.ViewModel);t.ViewModel=tt;w=(function(n){function t(t,i,r,u){var f,e,c,a,tt,it,s,rt,y;if(u===void 0&&(u=!1),f=n.call(this,t,i,u)||this,f._newRender=r,e=f.ltm,r){var h=t[0].querySelector(".fxs-dropmenu"),ut=h.querySelector(".fxs-dropmenu-button"),ft=h.querySelector(".fxs-dropmenu-content");f._dropMenu=$(h);f._dropMenuButton=$(ut);f._dropMenuContent=$(ft)}else c=MsPortalFx.getUniqueId(),a=f._dropMenu=$(FxImpl.createElement("div",{trustedInnerHTML:nt}).children[0]),f._dropMenuButton=a.findByClassName(l).attr("id",i.buttonId||null).addClass(i.buttonClass).addClass(b).html(i.buttonTemplate).attr("aria-controls",c),f._dropMenuContent=a.findByClassName("fxs-dropmenu-content").html(i.menuTemplate).attr("id",c).addClass(k).addClass(d).addClass(g).addClass(i.alignMenu===0?"fxs-dropmenu-right":"fxs-dropmenu-left"),t.append(f._dropMenu);var et=f._dropMenuButton,v=f._dropMenuContent,w=f._dropMenu;if(i.isMenuOpen[r?"subscribe":"subscribeAndRun"](e,(function(n){n?(i.telemetrySource&&o.trace({source:i.telemetrySource,action:"DropMenuOpened"}),f._show()):f._hide()})),!r){ko.reactor(e,(function(){et.attr("title",i.buttonTooltip()).attr(p,i.buttonLabel());v.attr(p,i.menuLabel())}));s="click";w.on(s,"."+l,tt=function(n){n.preventDefault();i.toggle()});v.on(s,i.itemSelector,it=function(){i.close()});e.registerForDispose((function(){w.off(s,"."+l,tt);v.off(s,i.itemSelector,it)}))}y="contextmenu";t.on(y,rt=function(){if(i.isMenuOpen())return!1});return e.registerForDispose((function(){t.off(y,rt)})),f}return __extends(t,n),t.prototype._show=function(){var n=this,t,i,f,r;this._newRender||(this._dropMenuButton.attr("aria-expanded",!0),this._dropMenuContent.removeClass(y+" "+a).addClass(v).attr("aria-hidden",!1));t=this._dropMenuContent;this.options.autoDismissMenu?(this._dismissHandle||(i=function(t){return $.contains(n._dropMenu[0],t)?0:2},this._dismissHandle={dismissFn:function(){n.options.close()},shouldDismissOnFocusOutFn:function(){return $.contains(n._dropMenu[0],document.activeElement)?0:1},shouldDismissOnMouseDownFn:i,shouldDismissOnMouseWheelFn:i,restoreFocus:function(){n._dropMenuButton[0].focus()},logName:"dropMenu"}),(!this._dismissLifetime||this._dismissLifetime.isDisposed())&&(f=this._dismissLifetime=this.ltm.createChildLifetime(),r=this._dismissHandle,u.register(r),new e.KeyboardNavigation(this._dismissLifetime,{element:t,tabTriggers:12,itemSelector:this.options.itemSelector}),f.registerForDispose([function(){u.unregister(r)},]))):this._dismissLifetime&&this._dismissLifetime.dispose();this.options.containInViewport&&requestAnimationFrame((function(){var t=window.innerWidth-n._dropMenuContent[0].getBoundingClientRect().right-20;t<0&&n._dropMenuContent.css({left:t+"px"})}));this.options.setItemFocusWhenOpen&&(this._newRender?s.tryFocusAfterChangePropagation(t[0]):t.focus())},t.prototype._hide=function(){this._newRender||(this._dropMenuButton.attr("aria-expanded",!1),this._dropMenuContent.addClass(this.options.togglesVisibility?y:a).removeClass(v).attr("aria-hidden",!0));this.options.containInViewport&&this._dropMenuContent.css({left:""});this._dismissLifetime&&this._dismissLifetime.dispose()},t.prototype.setFocus=function(){this.options.isMenuOpen.peek()?this._newRender?s.tryFocusAfterChangePropagation(this._dropMenuContent[0]):this._dropMenuContent.focus():this._newRender?s.tryFocusAfterChangePropagation(this._dropMenuButton[0]):this._dropMenuButton.focus()},t})(f.Widget);t.Widget=w}));
define("MsPortalImpl/UI/Compositions/UI.Composition.PartSize",["require","exports"],(function(n,t){"use strict";function f(n,t,i){return n<0?-1:n===0?0:Math.max(0,n*t+(n-1)*i)}function e(n,i){return{width:f(n,t.CellWidth,t.CellSpacingWidth),height:f(i,t.CellHeight,t.CellSpacingHeight)}}function o(n,t,i){return Math.ceil(n/(t+i))}function l(n,i){return{colSpan:o(n,t.CellWidth,t.CellSpacingWidth),rowSpan:o(i,t.CellHeight,t.CellSpacingHeight)}}function a(n,t){var i=function(n){return Math.ceil(Math.min(Math.max(n,1),25))};return e(i(n),i(t))}function v(n,r){var u=MsPortalFx.find(t.AllSizes,(function(t){var i=t&&t.size;return t&&i.width===n&&i.height===r}));return u||(u=i(99),u.size={width:n,height:r},u.span=l(n,r)),$.extend(!0,{},u)}function y(){return i(2)}function i(n){return $.extend(!0,{},MsPortalFx.find(t.AllSizes,(function(t){return t&&t.name===n})))}function r(n){return function(t){return t===n}}function p(n){var t=r(n);return s.some(t)}function w(n){var t=r(n);return h.some(t)}function b(n){var t=r(n);return c.some(t)}var u,s,h,c;Object.defineProperty(t,"__esModule",{value:!0});t.isAdaptiveWidth=t.isVariableSize=t.isFixedSize=t.getSize=t.getDefaultSize=t.getCorrespondingStandardSize=t.getGridPixelSize=t.AllCssClasses=t.AllSizes=t.GridSpacingHeight=t.GridSpacingWidth=t.CellSpacingHeight=t.CellSpacingWidth=t.CellHeight=t.CellWidth=void 0;u=MsPortalFx.Parts;t.CellWidth=85;t.CellHeight=85;t.CellSpacingWidth=5;t.CellSpacingHeight=5;t.GridSpacingWidth=t.CellWidth+t.CellSpacingWidth;t.GridSpacingHeight=t.CellHeight+t.CellSpacingHeight;t.AllSizes=(function(){var t=[],n=function(n,i,r){t[n]={name:n,css:"fxs-tilesize-"+u.InternalPartSize[n].toLowerCase(),size:e(i,r),span:{colSpan:i,rowSpan:r}}};return n(0,1,1),n(1,2,1),n(2,2,2),n(3,4,2),n(4,2,4),n(5,6,4),n(6,4,6),n(7,6,0),n(8,-1,0),n(9,-1,-1),n(10,4,4),n(11,6,6),n(99,0,0),t})();t.AllCssClasses=t.AllSizes.map((function(n){return n.css}));t.getGridPixelSize=a;t.getCorrespondingStandardSize=v;t.getDefaultSize=y;t.getSize=i;s=[0,1,2,3,4,10,5,6,11,99,];t.isFixedSize=p;h=[7,8,9,];t.isVariableSize=w;c=[8,9,];t.isAdaptiveWidth=b}));
define("MsPortalImpl/Widgets/Widgets.LayoutBase",["require","exports"],(function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Orientation=void 0;var i;(function(n){n[n.Horizontal=0]="Horizontal";n[n.Vertical=1]="Vertical"})(i=t.Orientation||(t.Orientation={}))}));
define("MsPortalImpl/Widgets/Widgets.TileActionBar.Component",["require","exports","Weave/DirectMode","Fx/Weave","Weave"],(function(n,t,i,r,u){"use strict";function f(n){var t=n.vm;return i("div",{className:"fxs-tile-actionbar-actionlist fxs-portal-background",role:"menubar","aria-label":t.partTitle.compose((function(n){return n+" part actions"}))},i(u.Once,{condition:t.visible,trueFn:function(){return i(u.ForEach,{collection:t.actions.cFilter((function(n){return r.toComputation(n.command.enabled)})),fn:function(n){var u=n.item,t=u.command;return i("button",{type:"button",className:["fxs-tile-actionbar-action fxs-portal-svg",u.className],role:"menuitem",title:r.toComputation(t.text),"aria-label":r.toComputation(t.text),image:r.toComputation(t.icon),onClick:function(n){var i=n.event;i.stopPropagation();MsPortalFx.Base.Diagnostics.Telemetry.trace({source:"TileAction",action:"TileActionClicked",name:t.commandName});t.execute(!1)}})}})}}))}Object.defineProperty(t,"__esModule",{value:!0});t.TileActionBar=void 0;t.TileActionBar=f}));
define("MsPortalImpl/Widgets/Widgets.Tile.Component",["require","exports","Weave/DirectMode","Fx/Weave/Components/LoadingIndicator","Weave","MsPortalImpl/Widgets/Widgets.TileActionBar.Component"],(function(n,t,i,r,u,f){"use strict";function o(n){var t=n.vm;return i("div",{id:t.tsxRootElementId,className:"fxs-tile fxs-portal-bg-txt-br"},i(e,{vm:t}))}function e(n){var t=n.vm,e=u.composeComputation([t.isInBlockingLoadingState,t.hasOngoingOperation,],(function(n,t){var i=0;return n?i=2:t&&(i=1),i}));return i(u.Fragment,null,i("div",{className:"fxs-tile-actionbarcontainer"},i("div",{className:"fxs-tile-actions"},i(f.TileActionBar,{vm:t.actionBarViewModel})),i("div",{className:"fxs-tile-actions-contextmenu"})),i("div",{className:"fxs-tile-overlay"}),i("div",{className:["fxs-tile-progress-transparent fxs-loading5dots-container",{"fxs-display-none":e.compose((function(n){return n!==1}))},]},i("div",{className:"fxs-portal-background"}),i("div",{className:"fxs-portal-background"}),i("div",{className:"fxs-portal-background"}),i("div",{className:"fxs-portal-background"}),i("div",{className:"fxs-portal-background"})),i(r.LoadingIndicator,{className:["fxs-tile-progress fxs-portal-background",{"fxs-display-none":e.compose((function(n){return n!==2}))},]}))}Object.defineProperty(t,"__esModule",{value:!0});t.TileInner=t.Tile=void 0;t.Tile=o;t.TileInner=e}));
define("MsPortalImpl/Widgets/Widgets.TileActionBar",["require","exports","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.ContextMenu","MsPortalImpl/Base/Base.BrowserDetection","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css","Weave"],(function(n,t,i,r,u,f,e,o){"use strict";var l,a,v;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.ViewModel=t.TileActionViewModel=t.actionClassName=t.widgetClassName=void 0;f.injectCss(e);var c="fxs-tile-actionbar-actionlist",s="fxs-tile-actionbar",y="fxs-tile-transparent",h=[];t.widgetClassName=s;t.actionClassName="fxs-tile-actionbar-action";l=(function(){function n(){}return n})();t.TileActionViewModel=l;a=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.actions=o.makeArrayComputation(),t.visible=o.makeWritableComputation(!1),t.partTitle=o.makeWritableComputation(),t}return __extends(t,n),t.prototype.update=function(){var n=this.visible.value;n&&this.actions.value.forEach((function(n){n.command.activate();n.bindCommand()}))},t})(i.ViewModel);t.ViewModel=a;v=(function(n){function t(t,i,u,f){var e=n.call(this,t,u)||this,p=e.options,a=e.ltm,l,v;return h.push(e),t.addClass(s),l=new r.ViewModel,l.topOffsetCorrection=25,v=e.contextMenuWidget=new r.Widget(i,l),a.registerForDispose(t.setEvents(["click","."+c,function(n){var t=n.target;$(t).hasClass(c)&&(f(t),n.preventDefault(),n.stopPropagation())}])),o.subscribeAndRun(a,[p.visible],(function(n){if(!n){var i=document.activeElement;e.has(i)&&f(i)}n?p.update():v.hide();$(t).toggleClass(y,!n);n&&h.forEach((function(t){t!==e&&t.options.visible(!n)}))})),a.registerForDispose((function(){v.dispose();l.menuItems.removeAll();e.contextMenuWidget=null;MsPortalFx.remove(h,e)})),e._bindDescendants(),e}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(s);n.prototype.dispose.call(this)},t.prototype.showTileManagementContextMenu=function(){this.options.actions.value.forEach((function(n){var t=n.command;typeof t._getActionClassIdentifier=="function"&&t._getActionClassIdentifier()==="opencontextmenu"&&t.execute(!1)}))},t.prototype.setFocus=function(){!u.isAndroidOrMobile&&this.options.visible.value&&this.element.findFirstTabbable().focus()},t.prototype.has=function(n){return!!(this.element.has(n).length||this.contextMenuWidget.element.has(n).length)},t})(i.Widget);t.Widget=v}));
define("MsPortalImpl/Widgets/Widgets.Tile",["require","exports","Weave/DirectMode","MsPortalImpl/Interactions/Interactions.RightClick","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Widgets/Widgets.TileActionBar","MsPortalImpl/Widgets/Widgets.UIElementBase","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Widgets/Widgets.Tile.Component","Weave"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";function nt(n,t,i,r,u){return new v(n,t,i,r,u)}var w,b,v;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.createTileWidget=t.ViewModel=t.actionBarContainerClassName=t.overlayClassName=t.widgetClassName=void 0;o.injectCss(s);var k=MsPortalFx.Base,d=k.Diagnostics,g=d.createLog(n),a="fxs-tile",y="fxs-tile-overlay",p="fxs-portal-bg-txt-br";t.widgetClassName=a;t.overlayClassName=y;t.actionBarContainerClassName="fxs-tile-actionbarcontainer";w=0;b=(function(n){function t(t,i){var r=n.call(this,t)||this;return r.isInBlockingLoadingState=l.makeWritableComputation(!1),r.hasOngoingOperation=l.makeWritableComputation(!1),r.size=ko.observable(),r.gridHeight=ko.observable(),r.gridWidth=ko.observable(),r.supportedSizes=ko.observableArray(),r.commands=[],r.actionBarViewModel=new f.ViewModel,r.selected=ko.observable(!1),r.selectedFromHover=ko.observable(!1),r.userResizable=ko.observable(!1),r.inLockedContext=!1,r.tsxRootElementId="__tile_"+w+++"__",r.applyViewSettings(i),r}return __extends(t,n),t.prototype.getViewSettings=function(){return{NormalState:{size:this.size()}}},t.prototype.applyViewSettings=function(n){n&&n.NormalState&&n.NormalState.size!==undefined&&(this.size=ko.observable(n.NormalState.size))},t})(e.ViewModel);t.ViewModel=b;t.createTileWidget=nt;v=(function(n){function t(t,f,e,o,s){var l=n.call(this,t,f)||this,w,v,y,b;return l._tsxRender=o,l._getActions=s,w=l.ltm,f.size&&f.size()!==undefined||(g.warning("No initial size was set on the Tile view model."),f.size=ko.observable(u.getDefaultSize().name)),v=u.getSize(f.size()),t.addClass(v&&v.css),o||(h.applyToElement({element:t[0],ltm:l.ltm,weaveNode:i(c.TileInner,{vm:f}),weaveContext:{diContainer:e}}),t.addClass(a).addClass(p)),99===v.name?(y=u.getGridPixelSize(f.gridWidth(),f.gridHeight()),t.css({width:y.width,height:y.height})):u.isFixedSize(f.size())&&(f.gridWidth(v.span.colSpan),f.gridHeight(v.span.rowSpan)),l._attachEventHandlers(),b=r.setup(t,ko.observableArray(f.commands)),w.registerForDispose(b),l}return __extends(t,n),t.prototype.dispose=function(){this._actionBarWidget&&(this._actionBarWidget.dispose(),this._actionBarWidget=null);this._tsxRender?this.element.removeClass(u.AllCssClasses.join(" ")):this._cleanElement(u.AllCssClasses.join(" "),a,p);n.prototype.dispose.call(this)},t.prototype.addChild=function(n){if(!n)throw new Error("Can't add null child.");var t=n.element||n;t.insertBefore($(this.element).findByClassName(y))},t.prototype.removeChild=function(){return!1},t.prototype.saveViewSettings=function(){return this.options.getViewSettings()},t.prototype.setSize=function(n,t){var h=this,i=u.getCorrespondingStandardSize(n,t),s;i||(i=u.getDefaultSize());var f=i.size,e=this.options,o=e.size(),r=this.element;if(o&&o===i.name){if(o!==99)return;if(parseInt(r.css("height"))===f.height&&parseInt(r.css("width"))===f.width)return}e.size(i.name);e.gridHeight(i.span.rowSpan);e.gridWidth(i.span.colSpan);r.css({height:"",width:""}).removeClass(u.AllCssClasses.join(" ")).addClass(i.css);i.name===99&&r.css({height:f.height,width:f.width});s=300;r.handleTransitionEndOnce("height",s,(function(){h.ltm.isDisposed()||r.trigger("fxsizechanged",[i.name])}))},Object.defineProperty(t.prototype,"actionBarWidget",{get:function(){return this._actionBarWidget},enumerable:!1,configurable:!0}),t.prototype.setFocus=function(n){var t=this._actionBarWidget,i;!n&&t&&t.options.visible.value?t.setFocus():(i=this.element.find(".fxs-part"),i&&i.focus())},t.prototype.showTileManagementContextMenu=function(){var n=this.options,t=this.actionBarWidget;!n.locked()&&n.selected()&&t&&t.showTileManagementContextMenu()},t.prototype._createActionBarWidget=function(){var u=this;if(!this._actionBarWidget){var n=this.element,t=this.options,i=t.actionBarViewModel,r=this._getActions;i.actions.setAll(r&&r());this._actionBarWidget=new f.Widget(n.findByClassName("fxs-tile-actions"),n.findByClassName("fxs-tile-actions-contextmenu"),i,function(i){n[0].contains(i)&&(u.setFocus(!0),t.selectedFromHover(!1))})}},t.prototype._attachEventHandlers=function(){var i=this,t=this.element,n=this.options,r=this.ltm;if(n.size.subscribe(r,(function(){t.trigger(e.Widget.viewSettingsChanged,i.saveViewSettings())})),n.userResizable.subscribeAndRun(r,(function(n){n&&MsPortalFx.tryImmediateResolve(MsPortalFx.require("MsPortalImpl/Interactions/Interactions.FlowLayoutUserResize"),(function(n){n.addUserResizeBehavior(i)}))})),ko.computed(r,n.locked,(function(){t.trigger("fxsizechanged")})).extend({deferred:!0}),ko.computed(r,(function(){var r=n.selected(),f=n.selectedFromHover(),u=r||f;ko.ignoreDependencies((function(){u&&i._createActionBarWidget()}));n.actionBarViewModel.visible(u);t.toggleClass("fxs-tile-selected",r)})),!n.inLockedContext){var f=function(){n.selectedFromHover()||n.selectedFromHover(!0)},o=function(){!n.selectedFromHover()||i.actionBarWidget&&i.actionBarWidget.has(document.activeElement)||n.selectedFromHover(!1)},s=!1,h=function(n){var i=t[0],r=i.contains(n.target)&&(i.contains(n.relatedTarget)||s);return s=!1,r},c=function(n){h(n)||f(n)},l=function(n){h(n)||o(n)},u=t[0],a=function(n){n.keyCode===27&&n.target&&u.contains(n.target)&&i.setFocus(!0)},v=function(){s=!0};t.on("mouseenter",f).on("mouseleave",o).on("keydown",".fxs-tile-actionbar-action",a).on("mousedown",".fxs-tile-actionbar-action",v);u.addEventListener("focus",c,!0);u.addEventListener("blur",l,!0);r.registerForDispose((function(){t.off("mouseenter",f).off("mouseleave",o).off("keydown",a).off("mousedown",v);u.removeEventListener("focus",c,!0);u.removeEventListener("blur",l,!0)}))}},t})(e.Widget);t.Widget=v}));
define("MsPortalImpl/Widgets/Widgets.FlowLayout",["require","exports","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.LayoutBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","Weave","MsPortalImpl/Widgets/Widgets.Tile.Component","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Weave/Util","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css","FxInternal"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){"use strict";function at(n){for(var r,u,f,e=new rt,i,c=!0,o=0;o<n.length;o++){var t=n[o],l=t.position,s=l.row,h=l.col,a=t.rowSpan,v=t.colSpan;if(e.isRectangleFree(h,s,a,v))e.markOccupancy(t);else{for(c=!1,i={misplacedPart:t.id,overlappedParts:[]},r=h;r<h+v;r++)for(u=s;u<s+a;u++)f=e.getItemAt(r,u),f&&i.overlappedParts.indexOf(f.id)===-1&&i.overlappedParts.push(f.id);break}}return{success:c,result:i}}var ut,d,st,b,ht,ct,p,it;Object.defineProperty(t,"__esModule",{value:!0});t.FlowLayoutPositionConflictResolver=t.FlowLayoutPositioningEngine=t.Widget=t.ViewModel=t.validateGrid=t.calculateSize=t.calculateSpan=void 0;ut=MsPortalFx.Base.Diagnostics;d=u.Orientation;a.injectCss(v);var ft=ut.createLog(n),w=e.Widget.getId,tt=r.Widget.getWidget,et="fxs-flowlayout",ot="fxs-flowlayout-childcontainer",g="fxs-flowlayout-element",lt=function(n,t,i){return Math.min(25,Math.ceil((n+i)/(t+i)))};t.calculateSpan=lt;st=function(n,t,i){return n*t+(n-1)*i};t.calculateSize=st;t.validateGrid=at;b={};b[38]=1;b[39]=2;b[40]=3;b[37]=4;ht=(function(n){function t(t,i){var r=n.call(this,t)||this;return r._positions=[],r.minColumns=s.makeWritableComputation(1),r.minRows=s.makeWritableComputation(1),r.maxColumns=s.makeWritableComputation(999),r.maxRows=s.makeWritableComputation(999),r.columnSize=o.CellWidth,r.rowSize=o.CellHeight,r.gutterSize=o.CellSpacingWidth,r.orientation=d.Horizontal,r.allowReorder=!1,r.allowOverflow=!1,r.allowGaps=!1,r.resolutionGuides=!1,r.resolutionGuidesOffset={x:0,y:0},r.childContainerHeight=s.makeWritableComputation(""),r.childContainerWidth=s.makeWritableComputation(""),r.positionUpdatedSignal=ko.observable(0),r.applyViewSettings(i),r}return __extends(t,n),t.prototype.getViewSettings=function(){return{positions:this.positions}},t.prototype.applyViewSettings=function(n){n&&n.positions&&(this.positions=n.positions,this.positionUpdatedSignal(this.positionUpdatedSignal()+1))},Object.defineProperty(t.prototype,"positions",{get:function(){return this._positions},set:function(n){this._positions=n?n:[]},enumerable:!1,configurable:!0}),t})(e.ViewModel);t.ViewModel=ht;ct=(function(n){function r(t,i,r){var u=n.call(this,t,i,r)||this;return u._tsxRender=r,u._dropPlaceholder=null,u._childContainer=null,u._engine=new k(i),u._engine.positions=i.positions,r||(t.addClass(et).html("<div class='"+ot+"'><\/div>"),i.resolutionGuides&&u._addResolutionGuides()),u._childContainer=$(u.element[0].querySelector("."+ot)),u._initializeComputed(),r||u._relayoutPositions(),u._attachEventHandlers(),u}return __extends(r,n),r.prototype.dispose=function(){this._childElements.forEach((function(n){n.removeClass(g);ko.cleanNode(n[0]);n.remove()}));ko.cleanNode(this._childContainer[0]);this._childContainer.remove();this.element.removeClass(et);n.prototype.dispose.call(this)},Object.defineProperty(r.prototype,"_childElements",{get:function(){var t=this._childContainer.children("."+g),n=[];return $.each(t,(function(t,i){n.push($(i))})),n},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropPlaceholder",{get:function(){return this._dropPlaceholder},enumerable:!1,configurable:!0}),r.prototype.createTiles=function(n,t){var u=this;if(n.length===0)return[];var i=new Array(n.length),e=l.createFragment(n.map((function(n,t){return s.Once({condition:i[t]=s.makeWritableComputation(!1),falseFn:function(){return h.Tile({vm:n.vm})}})}))),r=this.ltm.createChildLifetime();return s.subscribeAndRun(r,[s.makeLiftedArrayComputation(i).cEvery(y.identity)],(function(n){n&&r.dispose()})),c.appendToElement({element:this._childContainer[0],ltm:r,weaveNode:e,weaveContext:{diContainer:t},opName:"Tiles"}),n.map((function(n,r){var e=$(document.getElementById(n.vm.tsxRootElementId)),o=f.createTileWidget(e,n.vm,t,!0,n.getActions),s=i[r];return o.ltm.registerForDispose((function(){return s(!0)})),u._postProcessAddChild(e),o}))},r.prototype.addChild=function(n){if(!n)throw new Error("Cannot add a null child.");var t=n.element?n.element:n;this._childContainer.append(t);this._postProcessAddChild(t)},r.prototype._postProcessAddChild=function(n){n.css("visibility","hidden");n.addClass(g);var t=this._getChildDimensions(n),i=this.options;try{i.positions=this._engine.append(w(n),t.rowSpan,t.colSpan)}catch(r){ft.warning("New element could not be appended to the grid. {0}".format(r.toString()));n.removeClass(g);n.remove();return}i.positions=this._engine.positions;this._refreshElementSize(n);this._setContainerSize();this._relayoutPositions();this.element.trigger("layoutUpdated");n.css("visibility","")},r.prototype.removeChild=function(n,t){var f=MsPortalFx.findIndex(this._childElements,(function(t){return w(t)===n})),r=this._childElements[f],u;return r?(u=this.options,u.positions=this._engine.remove(n),this.element.trigger("layoutUpdated"),i.hide(r).removeClass(g),t?r.detach():r.remove(),this._setContainerSize(),this._relayoutPositions(),!0):!1},r.prototype.resizeChild=function(n,i,r,u){var f=this.options,h=f.rowSize,c=f.columnSize,o=f.gutterSize,l=MsPortalFx.find(this._childElements,(function(t){return w(t)===n})),a,y;if(l){a=MsPortalFx.find(this._engine.positions,(function(t){return t.id===n}));i=Math.max(i,c);r=Math.max(r,h);var p=t.calculateSpan(r,h,o),b=t.calculateSpan(i,c,o),v=this._engine.resize(n,b,p,u);f.positions=v;var s=MsPortalFx.find(v,(function(t){return t.id===n})),k=t.calculateSize(s.rowSpan,h,o),d=t.calculateSize(s.colSpan,c,o);this._setContainerSize(!0);this._relayoutPositions();u&&((a.rowSpan!==s.rowSpan||a.colSpan!==s.colSpan)&&this.element.trigger("layoutUpdated"),y=tt(l,e.Widget),this._setElementSize(y,l,d,k))}},r.prototype.moveChild=function(n,t,i,r){var f=w(n),u=this._getChildDimensions(n),e=this._engine.move(f,{col:t,row:i},u.colSpan,u.rowSpan,r);this.options.positions=e;this._setContainerSize(!0);this._relayoutPositions();r&&this.element.trigger("layoutUpdated")},r.prototype.refreshLayout=function(){this.options.positions=this._engine.positions;this._setContainerSize();this._relayoutPositions();this._refreshSizes()},r.prototype.saveViewSettings=function(){var n=this.options;return n.positions=this._engine.positions,n.getViewSettings()},r.prototype.createDropPlaceholder=function(n,t){this._dropPlaceholder&&this.disposeDropPlaceholder();this._dropPlaceholder=$(FxImpl.createElement("div",{"class":"fxs-flowlayout-drop-placeholder"})).css({width:n,height:t});this._childContainer.append(this._dropPlaceholder)},r.prototype.disposeDropPlaceholder=function(){this._dropPlaceholder&&this._dropPlaceholder.remove();this._dropPlaceholder=null},r.prototype.moveDropPlaceholder=function(n){this._setElementPositioningCss(this.dropPlaceholder,n)},r.prototype.resizeDropPlaceholder=function(n,i){var u=this.options,f=u.rowSize,e=u.columnSize,r=u.gutterSize,o=t.calculateSpan(i,f,r),s=t.calculateSpan(n,e,r),h=t.calculateSize(o,f,r),c=t.calculateSize(s,e,r);this._dropPlaceholder.css({width:c,height:h})},r.prototype.getDomOrderedChildren=function(){return this._engine.getNaturalDomElementOrder()},r.prototype.discardStateOfUnusedChildren=function(){var n=[],t={stateDiscarded:!1};return this._engine&&(n=n.concat(this._engine.discardUnusedPositions())),n.length&&(t.stateDiscarded=!0,t.message="Removed Positions: "+JSON.stringify(n)),t},r.prototype._initializeComputed=function(){var t=this,n=this.options,i=this.ltm;s.subscribeAndRun(i,[n.minRows,n.maxRows,n.minColumns,n.maxColumns],(function(){return t._setContainerSize()}));n.positionUpdatedSignal.subscribe(i,(function(){t._engine.positions=n.positions}))},r.prototype._getChildDimensions=function(n){var i=this.options,s=tt(n,f.Widget),r=s&&s.options,e=r&&r.size(),h,u,c,l;return o.isFixedSize(e)?(h=o.getSize(e),u=e===99?o.getGridPixelSize(r.gridWidth(),r.gridHeight()):h.size):u=this._getChildAccurateDimensions(n),c=t.calculateSpan(u.height,i.rowSize,i.gutterSize),l=t.calculateSpan(u.width,i.columnSize,i.gutterSize),{rowSpan:c,colSpan:l}},r.prototype._getChildAccurateDimensions=function(n){if(!n[0])return ft.warning("Attempted to measure a non-existant item in _getChildAccurateDimensions. Assuming 0 as size."),{height:0,width:0};var t=n[0].getBoundingClientRect(),i=Math.round(t.height),r=Math.round(t.width);return{height:i,width:r}},r.prototype._setContainerSize=function(n){var i=this.options,r=this._engine.getMaxOccupiedPositions(n?i.positions:null),e=Math.max(i.minRows.value,r.row),o=Math.max(i.minColumns.value,r.col),u=t.calculateSize(e,i.rowSize,i.gutterSize),f=t.calculateSize(o,i.columnSize,i.gutterSize);this._tsxRender?(i.childContainerHeight(u+"px"),i.childContainerWidth(f+"px")):this._childContainer.css({height:u,width:f})},r.prototype._relayoutPositions=function(){for(var r,n,t,u,i=0;i<this._childElements.length;i++)n=this._childElements[i],r=w(n),t=MsPortalFx.find(this.options.positions,(function(n){return n.id===r})),u=t?t.position:{row:0,col:0},this._setElementPositioningCss(n,u)},r.prototype._setElementPositioningCss=function(n,t){var i=this.options,r=t.col*(i.columnSize+i.gutterSize),u=t.row*(i.rowSize+i.gutterSize),f;f=this._isRtl()?{right:r,top:u}:{left:r,top:u};n.css(f)},r.prototype._refreshSizes=function(){this._childElements.forEach(this._refreshElementSize,this)},r.prototype._refreshElementSize=function(n){var i=this.options,r=tt(n,e.Widget);if(r){var f=w(n),u=MsPortalFx.find(i.positions,(function(n){return n.id===f})),o=t.calculateSize(u.rowSpan,i.rowSize,i.gutterSize),s=t.calculateSize(u.colSpan,i.columnSize,i.gutterSize);this._setElementSize(r,n,s,o)}},r.prototype._setElementSize=function(n,t,i,r){n?n.setSize(i,r):t.css({width:i,height:r})},r.prototype._moveFocusInDirection=function(n){var e=$(document.activeElement).closest("."+f.widgetClassName),r=w(e),u,t,i;r&&(u=this._engine.getAdjacentElement(r,n),t=MsPortalFx.find(this._childElements,(function(n){return u===w(n)})),t)&&(i=tt(t,f.Widget),i&&i.setFocus())},r.prototype._attachEventHandlers=function(){var t=this,n=this.element,i=function(n,i,r,u,f){t.resizeChild(i,r,u,f===undefined?!0:f);n.stopPropagation()},r=function(n){var r=$(n.target),u,i;r.is("input[type=text], textarea, select")||r.closest(".fxs-contextMenu").length||(u=n.which,i=b[u]||0,i!==0&&(n.preventDefault(),n.stopPropagation(),t._moveFocusInDirection(i)))};n.on("fxsizechange",i);n.on("keydown",r);this.ltm.registerForDispose((function(){n.off("fxsizechange",i);n.off("keydown",r)}))},r.prototype._addResolutionGuides=function(){var t=this,n=this.options.resolutionGuidesOffset;[{x:1024,y:768},{x:1366,y:768},{x:1440,y:900},{x:1920,y:1080},{x:3840,y:2160},].forEach((function(i){var r=$(FxImpl.createElement("div",{"class":"fxs-flowlayout-resolutionguide fxs-flowlayout-resolutionguide-"+i.x+"x"+i.y+" fxs-hide-in-normal"}));(n.x||n.y)&&r.css({top:n.y+"px",left:n.x+"px"});t.element.prepend(r)}))},r})(e.Widget);t.Widget=ct,(function(n){function t(n){return n.position.row}function i(n){return n.position.row+n.rowSpan}function r(n){return n.position.col}function u(n){return n.position.col+n.colSpan}n.top=t;n.bottom=i;n.left=r;n.right=u})(p||(p={}));var rt=(function(){function n(){this._occupancyGrid=[]}return n.prototype.reset=function(n){var t=this;this._occupancyGrid.length=0;n&&n.forEach((function(n){t.markOccupancy(n)}))},n.prototype.isRectangleFree=function(n,t,i,r){for(var u,e=n+r,o=t+i,f=n;f<e;f++)for(u=t;u<o;u++)if(this.isPositionOccupied(f,u))return!1;return!0},n.prototype.isPositionOccupied=function(n,t){return!!this._occupancyGrid[n]&&!!this._occupancyGrid[n][t]},n.prototype.getItemAt=function(n,t){var i=this._occupancyGrid[n];return i?i[t]:null},n.prototype.markOccupancy=function(n,t){for(var r,f=p.top(n),e=p.bottom(n),o=p.left(n),s=p.right(n),u=this._occupancyGrid,i=o;i<s;i++)for(r=f;r<e;r++)u[i]||(u[i]=[]),u[i][r]||(u[i][r]=null),u[i][r]=t?null:n},n})(),nt={},k=(function(){function n(n){this._occupancyGrid=new rt;this._items=[];this._filledPositions={};this._gridOptions=n}return n.prototype.append=function(n,t,i){var r=this._getExistingItem(n),u,f,e;if(this._filledPositions[n]=!0,r)return this._items;if(u=this._maxRows(),f=this._maxCols(),!this._gridOptions.allowOverflow&&(t>u||i>f))throw new Error("The element cannot fit in this grid. ElementRowSpan: {0}, ElementColSpan: {1}, GridMaxRowSpan: {2}, GridMaxColSpan: {3}".format(t,i,u,f));if(e=this._findNextAvailablePositionForRectangle(t,i),!e)throw new Error("The element cannot fit in the remaining space available in the grid.");return r={id:n,position:e,rowSpan:t,colSpan:i},this._items.push(r),this._occupancyGrid.markOccupancy(r),this._items},n.prototype.move=function(n,t,i,r,u){var o,s={id:n,position:t,colSpan:i,rowSpan:r},e,f;return this._applyGridConstraints(s),f=new it(this._items,s,this._gridOptions),e=f.resolved?f.getItems():this._items,u&&(f.resolved&&(this._items.length=0,(o=this._items).push.apply(o,e||[])),this._occupancyGrid.reset(this._items),this.collapseGaps()),e},n.prototype.resize=function(n,t,i,r){var y,e=this._getExistingItem(n),o=e.position,p={id:e.id,position:{col:o.col,row:o.row},colSpan:t,rowSpan:i},f=p.position,u,s,h,w,c,v;if(this._applyGridConstraints(p),f.row<0||f.col<0)return this._items;var b=Math.max(0,t-e.colSpan),k=Math.max(0,i-e.rowSpan),l=f.col,a=f.row;for(this._gridOptions.allowGaps||(l=Math.min(l,Math.max(0,o.col-b)),a=Math.min(a,Math.max(0,o.row-k))),s=l;s<=f.col;s++){for(h=a;h<=f.row;h++)if((w={id:n,position:{col:s,row:h},colSpan:t,rowSpan:i},c=new it(this._items,w,this._gridOptions),c.resolved)&&((!u||c.shiftCost<u.shiftCost)&&(u=c),u&&u.shiftCost===0))break;if(u&&u.shiftCost===0)break}return v=u?u.getItems():this._items,r&&(u&&(this._items.length=0,(y=this._items).push.apply(y,v||[])),this._occupancyGrid.reset(this._items),this.collapseGaps()),v},n.prototype.remove=function(n){var i=this._getExistingItem(n),t;return(this._filledPositions[n]=!1,t=this._items.indexOf(i),t===-1)?this._items:(this._items.splice(t,1),this._occupancyGrid.markOccupancy(i,!0),this.collapseGaps(),this._items)},n.prototype.collapseGaps=function(){if(!this._gridOptions.allowGaps){var n={grid:this,isPositionOccupied:function(n,t){return this.grid._occupancyGrid.isPositionOccupied(n,t)},getMaxPositions:function(){return this.grid.getMaxOccupiedPositions()},getMinSize:function(){return{col:this.grid._minCols(),row:this.grid._minRows()}},getItemAt:function(n,t){return this.grid._occupancyGrid.getItemAt(n,t)},shiftItem:function(n,t){n.position.col-=t}},t={grid:this,isPositionOccupied:function(n,t){return this.grid._occupancyGrid.isPositionOccupied(t,n)},getMaxPositions:function(){var n=this.grid.getMaxOccupiedPositions();return{col:n.row,row:n.col}},getMinSize:function(){return{col:this.grid._minRows(),row:this.grid._minCols()}},getItemAt:function(n,t){return this.grid._occupancyGrid.getItemAt(t,n)},shiftItem:function(n,t){n.position.row-=t}};this._orientation()===d.Horizontal?(this._collapseGapsWithGridVisitor(n),this._collapseGapsWithGridVisitor(t)):(this._collapseGapsWithGridVisitor(t),this._collapseGapsWithGridVisitor(n))}},n.prototype.getNaturalDomElementOrder=function(){for(var n,t,u,i=[],f=this.getMaxOccupiedPositions(),r=0;r<f.row;r++)for(n=0;n<f.col;n++)t=this._occupancyGrid.getItemAt(n,r),t&&(u=t.id,i.indexOf(u)===-1&&i.push(u),n+=t.colSpan-1);return i},n.prototype.getAdjacentElement=function(n,t){var i=this._getExistingItem(n),r,u;return i?(r=nt[t],u=r?r(this,i):i,u.id):n},Object.defineProperty(n.prototype,"positions",{get:function(){return this._items},set:function(n){this._items.length=0;this._items=n?n:[];this._occupancyGrid.reset(this._items)},enumerable:!1,configurable:!0}),n.prototype.discardUnusedPositions=function(){var n=this,t=[];return this._items.slice(0).forEach((function(i){n._filledPositions[i.id]||(t.push(i),n.remove(i.id))})),t},n.prototype._orientation=function(){return this._gridOptions.orientation},n.prototype._minRows=function(){return this._gridOptions.minRows.value},n.prototype._maxRows=function(){return this._gridOptions.maxRows.value},n.prototype._minCols=function(){return this._gridOptions.minColumns.value},n.prototype._maxCols=function(){return this._gridOptions.maxColumns.value},n.prototype.getMaxOccupiedPositions=function(n){for(var e=n||this._items,r=0,u=0,i,f,t=0;t<e.length;t++)i=e[t],f=i.position,r=Math.max(r,f.col+i.colSpan),u=Math.max(u,f.row+i.rowSpan);return{col:r,row:u}},n.prototype._getExistingItem=function(n){return MsPortalFx.find(this._items,(function(t){return t.id===n}))},n.prototype._applyGridConstraints=function(n){var t,i;this._gridOptions.allowOverflow||(i=n.position,t=p.bottom(n)-this._maxRows(),t>0&&(i.row-=t),t=p.right(n)-this._maxCols(),t>0&&(i.col-=t))},n.prototype._findNextAvailablePositionForRectangle=function(n,t){var f=this._maxCols()-t+1,e=this._maxRows()-n+1,i,r,u;if(this._orientation()===d.Horizontal){for(r=0;r<f;r++)for(i=0;i<e;i++)if(this._isRectangleFree(r,i,n,t))return{col:r,row:i};if(this._gridOptions.allowOverflow)return u=this.getMaxOccupiedPositions(),{col:0,row:u.row}}else{for(i=0;i<e;i++)for(r=0;r<f;r++)if(this._isRectangleFree(r,i,n,t))return{col:r,row:i};if(this._gridOptions.allowOverflow)return u=this.getMaxOccupiedPositions(),{col:u.col,row:0}}},n.prototype._isRectangleFree=function(n,t,i,r){var u=n+r,f=t+i;return!this._gridOptions.allowOverflow&&(f>this._maxRows()||u>this._maxCols())?!1:this._occupancyGrid.isRectangleFree(n,t,i,r)},n.prototype._collapseGapsWithGridVisitor=function(n){var i=n.getMaxPositions(),r=i.col,l=i.row,u=[],a=!1,v,f,o,t,s,e,h,c;if(!(r<=n.getMinSize().col))for(o=0;o<r;o++){for(f=null,t=0;t<l;t++){if(a=!1,u[t]=this._findGap(t,o,r,n),s=u[t].colSpan,s===0)return;if((!f||s<f)&&(f=s),t>0&&!this._gapsAreContiguous(u[t-1],u[t]))break;a=!0}if(a){for(v={},e=0;e<l;e++)for(h=p.right(u[e]);h<r;h++)c=n.getItemAt(h,e),c&&(v[c.id]=c);$.each(v,(function(t,i){n.shiftItem(i,f)}));this._occupancyGrid.reset(this._items);i=n.getMaxPositions();r=i.col;l=i.row}}},n.prototype._gapsAreContiguous=function(n,t){var i=p.left(t),r=p.right(t),u=p.left(n),f=p.right(n);return f>=i&&u<=r},n.prototype._findGap=function(n,t,i,r){for(var u=t,f={id:"",position:{row:n,col:0},rowSpan:1,colSpan:0};u<i;){if(!r.isPositionOccupied(u,n))break;u++}for(f.position.col=u;u<i;){if(r.isPositionOccupied(u,n))break;f.colSpan++;u++}return f},n._scanAdjacentUp=function(n,t){for(var i,f,r=t.position,e=r.col,o=r.row-1,s=r.col+t.colSpan,u=o;u>=0;u--)for(i=e;i<s;i++)if(f=n._occupancyGrid.getItemAt(i,u),f)return f;return t},n._scanAdjacentRight=function(n,t){for(var i,f,r=t.position,e=r.col+t.colSpan,o=r.row,s=n.getMaxOccupiedPositions().col,h=r.row+t.rowSpan,u=e;u<s;u++)for(i=o;i<h;i++)if(f=n._occupancyGrid.getItemAt(u,i),f)return f;return t},n._scanAdjacentDown=function(n,t){for(var i,f,r=t.position,e=r.col,o=r.row+t.rowSpan,s=r.col+t.colSpan,h=n.getMaxOccupiedPositions().row,u=o;u<h;u++)for(i=e;i<s;i++)if(f=n._occupancyGrid.getItemAt(i,u),f)return f;return t},n._scanAdjacentLeft=function(n,t){for(var i,f,r=t.position,e=r.col-1,o=r.row,s=r.row+t.rowSpan,u=e;u>=0;u--)for(i=o;i<s;i++)if(f=n._occupancyGrid.getItemAt(u,i),f)return f;return t},n})();t.FlowLayoutPositioningEngine=k;nt[1]=k._scanAdjacentUp;nt[2]=k._scanAdjacentRight;nt[3]=k._scanAdjacentDown;nt[4]=k._scanAdjacentLeft;it=(function(){function n(n,t,i){var u=this,r;this.shiftCost=0;this.resolved=!1;this._resolvedItems=[];this._occupancyGrid=new rt;this._gridOptions=i;n.forEach((function(n){var i;t.id!==n.id&&(i=$.extend(!0,{},n),u._resolvedItems.push(i),u._occupancyGrid.markOccupancy(i))}));this.resolved=this._resolveConflict(t);r=$.extend(!0,{},t);this._resolvedItems.push(r);this._occupancyGrid.markOccupancy(r)}return n.prototype.getItems=function(){return this._resolvedItems},n.prototype._orientation=function(){return this._gridOptions.orientation},n.prototype._maxRows=function(){return this._gridOptions.maxRows.value||999},n.prototype._maxCols=function(){return this._gridOptions.maxColumns.value||999},n.prototype._resolveConflict=function(n){var t=!1;return this._orientation()===d.Horizontal?(t=this._tryMoveConflictsLeft(n,{})||t,t=this._tryMoveConflictsUp(n,{})||t,t=this._tryMoveConflictsDown(n,{})||t,t=this._tryMoveConflictsRight(n,{})||t):(t=this._tryMoveConflictsUp(n,{})||t,t=this._tryMoveConflictsLeft(n,{})||t,t=this._tryMoveConflictsRight(n,{})||t,t=this._tryMoveConflictsDown(n,{})||t),t},n.prototype._tryMoveConflictsUp=function(n,t){var u,r,i,e,f;for(t[n.id]=!0,u=p.left(n);u<p.right(n);u++)for(r=p.top(n);r<p.bottom(n);r++)if(i=this._occupancyGrid.getItemAt(u,r),i&&!t[i.id]){if((t[i.id]=!0,r=p.bottom(i),e=p.top(n)-p.bottom(i),f=this._getConflictArea(i,0,e),p.bottom(f)>this._maxRows()||p.top(f)<0)||!this._tryMoveConflictsUp(f,t))return!1;this._moveItem(i,0,e);t[i.id]=!1}return!0},n.prototype._tryMoveConflictsDown=function(n,t){var u,r,i,e,f;for(t[n.id]=!0,u=p.left(n);u<p.right(n);u++)for(r=p.bottom(n)-1;r>=p.top(n);r--)if(i=this._occupancyGrid.getItemAt(u,r),i&&!t[i.id]){if((t[i.id]=!0,r=p.top(i),e=p.bottom(n)-p.top(i),f=this._getConflictArea(i,0,e),p.bottom(f)>this._maxRows()||p.top(f)<0)||!this._tryMoveConflictsDown(f,t))return!1;this._moveItem(i,0,e);t[i.id]=!1}return!0},n.prototype._tryMoveConflictsLeft=function(n,t){var u,r,i,e,f;for(t[n.id]=!0,u=p.top(n);u<p.bottom(n);u++)for(r=p.left(n);r<p.right(n);r++)if(i=this._occupancyGrid.getItemAt(r,u),i&&!t[i.id]){if((t[i.id]=!0,r=p.right(i),e=p.left(n)-p.right(i),f=this._getConflictArea(i,e,0),p.right(f)>this._maxCols()||p.left(f)<0)||!this._tryMoveConflictsLeft(f,t))return!1;this._moveItem(i,e,0);t[i.id]=!1}return!0},n.prototype._tryMoveConflictsRight=function(n,t){var u,r,i,e,f;for(t[n.id]=!0,u=p.top(n);u<p.bottom(n);u++)for(r=p.right(n)-1;r>=p.left(n);r--)if(i=this._occupancyGrid.getItemAt(r,u),i&&!t[i.id]){if((t[i.id]=!0,r=p.left(i),e=p.right(n)-p.left(i),f=this._getConflictArea(i,e,0),p.right(f)>this._maxCols()||p.left(f)<0)||!this._tryMoveConflictsRight(f,t))return!1;this._moveItem(i,e,0);t[i.id]=!1}return!0},n.prototype._getConflictArea=function(n,t,i){var u=i<0,f=t<0,r=n.position;return{id:n.id,position:{row:u?r.row+i:r.row,col:f?r.col+t:r.col},rowSpan:n.rowSpan+Math.abs(i),colSpan:n.colSpan+Math.abs(t)}},n.prototype._moveItem=function(n,t,i){this._occupancyGrid.markOccupancy(n,!0);var r=n.position;r.col+=t;r.row+=i;this._occupancyGrid.markOccupancy(n);this.shiftCost+=n.colSpan*n.rowSpan},n})();t.FlowLayoutPositionConflictResolver=it}));
define("MsPortalImpl/Widgets/Widgets.StartBoard",["require","exports","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.RightClick","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Widgets/Widgets.FlowLayout","MsPortalImpl/Widgets/Widgets.LayoutBase","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.Timers","MsPortalImpl/UI/UI.DesktopManager","Weave","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";var p;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.ViewModel=void 0;a.injectCss(v);var w=MsPortalFx.Base,b=w.Diagnostics,k=b.createLog(n),y=i.Dashboard,d=window.fx.environment,g=(function(n){function t(t,r,u,s,h,c,a){var v=n.call(this,t)||this,y;return v.loading=h,v.notFound=c,v.diContainer=a,v.title=l.makeWritableComputation(i.Dashboard.defaultTitle),v.dashboardList=l.makeWritableComputation(),v.headerMode=l.makeWritableComputation(0),v.isShared=l.makeWritableComputation(!1),v.notFoundMessage=l.makeWritableComputation(""),v.subscriptionsInfo=l.makeWritableComputation(""),v.dashboardErrorMessage=l.makeWritableComputation(""),v.dashboardChanged=l.makeWritableComputation(!1),v.dashboardSaveInProgress=l.makeWritableComputation(!1),v.dashboardWritable=l.makeWritableComputation(!0),v.finishDashboardEdit=$.noop,v.locked(!1),y=v.flowLayoutOptions=new e.ViewModel("fxs-flowlayout-instanceid"),y.allowReorder=!0,y.allowOverflow=!0,y.allowGaps=!0,y.resolutionGuides=!0,y.resolutionGuidesOffset.y=-88,y.orientation=o.Orientation.Vertical,y.minColumns(4),y.maxColumns(6),y.minRows(4),y.locked(!1),v.filtersWidgetViewModel=u,v.dashboardDropMenuViewModel=new f.ViewModel(undefined,undefined,".fxs-startboard-dropdown-dashboard, .fxs-startboard-button-browse"),v.dashboardDropMenuViewModel.alignMenu=0,v.dashboardDropMenuViewModel.telemetrySource="Dashboard",v.commands=s,v.applyViewSettings(r),v}return __extends(t,n),t.prototype.getViewSettings=function(){return{NormalState:{layoutSettings:this.flowLayoutOptions.getViewSettings()}}},t.prototype.applyViewSettings=function(n){n&&n.NormalState&&n.NormalState.layoutSettings&&this.flowLayoutOptions.applyViewSettings(n.NormalState.layoutSettings)},t.prototype.setWidget=function(n){this._widget=n},t.prototype.getWidget=function(){return this._widget},t.prototype.exitOrganizeMode=function(){this.diContainer.get(c.DesktopManagerMode).value(0);var n=this._widget.element.find(".fxs-startboard-button-edit>.azc-toolbarButton-container");n.length&&n.focus()},t})(s.ViewModel);t.ViewModel=g;p=(function(n){function t(t,f,o){var s=n.call(this,t,f,!0)||this,c;return s._focusToDropMenu=o,s._layout=null,s._setFocusOnAnimationFrame=h.throttleByAnimationFrame((function(){var t,n;s._$lastFocused&&$.contains(s.element[0],s._$lastFocused[0])&&u.isVisible(s._$lastFocused)&&(s._$lastFocused.focus(),t=!0);t||(n=s._layout.element.findFirstTabbable(),n.length===1?n.focus():s._focusToDropMenu())})),f.setWidget(s),c=s.ltm,s._features=f.diContainer.get(FxImpl.Features),l.subscribeAndRun(c,[f.title],(function(n){document.title=i.Portal.windowTitleFormat.format(n,d.branding.title)})),s._layout=new e.Widget($(t[0].querySelector(".fxs-startboard-layout")),f.flowLayoutOptions,!0),s._initializeCommands(c,t),s._attachEventHandlers(t),c.registerForDispose([r.setup(t,ko.observableArray(f.commands)),]),s}return __extends(t,n),t.prototype.dispose=function(){this._layout.dispose();n.prototype.dispose.call(this)},t.prototype.createTiles=function(n){return this._layout.createTiles(n,this.options.diContainer)},t.prototype.addChild=function(n){if(!n)throw new Error("Can't add null child.");this._layout.addChild(n)},t.prototype.removeChild=function(n){return this._layout.removeChild(n)},t.prototype.moveChild=function(n,t,i,r){this._layout.moveChild(n,t,i,r)},t.prototype.setFocus=function(){this._features.isEnabled("skipautofocus")||this._setFocusOnAnimationFrame()},t.prototype.saveViewSettings=function(){return this.options.getViewSettings()},t.prototype.discardStateOfUnusedChildren=function(){return k.assert(!!this._layout,"FlowLayout not defined."),this._layout?this._layout.discardStateOfUnusedChildren():{stateDiscarded:!1}},t.prototype.getDomOrderedChildren=function(){return this._layout.getDomOrderedChildren()},t.prototype._attachEventHandlers=function(n){var t=this;this.ltm.registerForDispose(n.setEvents(["layoutUpdated",function(i){n.trigger(s.Widget.viewSettingsChanged,t.saveViewSettings());i.stopPropagation()},],["focusout",function(n){t._$lastFocused=$(n.target)},]))},t.prototype._initializeCommands=function(n){var r=this,t=this.options,i=t.dashboardDropMenuViewModel,u=h.debounce((function(){r._focusToDropMenu()}));i.isMenuOpen.subscribe(n,(function(n){n&&t.refreshDashboardList&&(t.dashboardList(undefined),t.refreshDashboardList((function(n){t.dashboardList(n);u()})))}));l.subscribeAndRun(this.ltm,[t.title],(function(n){i.buttonTooltip(n);i.buttonLabel(y.switcherLabel);i.buttonDescribedBy(y.switcherDescribedby.format(n))}))},t})(s.Widget);t.Widget=p}));
define("MsPortalImpl/Widgets/Widgets.Panorama",["require","exports","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Widgets/ReactFrame.Prewarmer","Weave","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Panorama.css"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h,c,l;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.ViewModel=void 0;o.injectCss(s);h="Can't add null child.";c=(function(n){function t(t,i,r,u){var f=n.call(this,t)||this;return f.startboardLoading=e.makeWritableComputation(!1),f.startboardNotFound=e.makeWritableComputation(!1),f.allServicesMenuInput=ko.observable(),f.applyViewSettings(r),f.displayMode=u,f.settingsFlyoutState=i||e.makeWritableComputation(0),f}return __extends(t,n),t.prototype.getViewSettings=function(){return{}},t.prototype.applyViewSettings=function(){return},t.prototype.getStartBoardArea=function(){return $(this._widget.element[0].querySelector(".fxs-startboard-target"))},t.prototype.getJourneyArea=function(){return $(this._widget.element[0].querySelector(".fxs-journey-target"))},t.prototype.getStartBoardWidget=function(){return i.Widget.getWidget(this.getStartBoardArea(),r.Widget)},t.prototype.getJourneyWidget=function(){var n=i.Widget.getWidgets(this.getJourneyArea());if(n.length>1)throw new Error("The journey target has been initialized with more than one widget.");return n[0]},t.prototype.setWidget=function(n){this._widget=n},t.prototype.getWidget=function(){return this._widget},t})(u.ViewModel);t.ViewModel=c;l=(function(n){function t(t,i){var r=n.call(this,t,i,!0)||this;return i.setWidget(r),f.setFrameRoot(r.element[0].querySelector(".fxs-journey-layout")),r}return __extends(t,n),t.prototype.addChild=function(n){if(!n)throw new Error(h);this.options.getJourneyWidget().addChild(n)},t.prototype.insertChild=function(n,t){if(!n)throw new Error(h);this.options.getJourneyWidget().insertChild(n,t)},t.prototype.removeChild=function(n){var t=this.options.getJourneyWidget();return t&&t.removeChild(n)},t.prototype.saveViewSettings=function(){return this.options.getViewSettings()},t})(u.Widget);t.Widget=l}));
define("MsPortalImpl/Widgets/Widgets.Portal.State",["require","exports","Fx/DependencyInjection","Weave"],(function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PortalState=void 0;var u=(function(){function t(){this.displayMode=r.makeWritableComputation("None");this.inOrganizeMode=ko.observable(!1);this.settingsFlyoutState=r.makeWritableComputation(0)}return __decorate([__metadata("fx:diagnostics",[n,"PortalState"]),i.Class()],t)})();t.PortalState=u}));
define("MsPortalImpl/Services/Services.Storage",["require","exports","Fx/DependencyInjection"],(function(n,t,i){"use strict";function h(){return r.forEach((function(n){var t=u[n.name];t.count=t.keySize=t.valueSize=0})),u}var o,f,e,r,u,s;Object.defineProperty(t,"__esModule",{value:!0});t.StorageService=t.ComponentName=void 0;o=MsPortalFx.Base.Diagnostics.createLog(n);f=JSON.stringify,(function(n){n[n.DesktopManager=2]="DesktopManager";n[n.AssetMruList=3]="AssetMruList";n[n.ExtensionManager=4]="ExtensionManager";n[n.Router=5]="Router";n[n.UserSettings_Journeys=6]="UserSettings_Journeys";n[n.UserSettings_EditScopes=7]="UserSettings_EditScopes";n[n.Relex=8]="Relex";n[n.ManifestVersions=9]="ManifestVersions";n[n.Redirect=10]="Redirect";n[n.Cdn=11]="Cdn";n[n.UserSettings_NewJourneys=12]="UserSettings_NewJourneys";n[n.Telemetry=13]="Telemetry";n[n.Dashboard=14]="Dashboard";n[n.Avatar=15]="Avatar";n[n.UserSettingsService=16]="UserSettingsService";n[n.AppBanner=19]="AppBanner";n[n.IEBanner=20]="IEBanner"})(e=t.ComponentName||(t.ComponentName={}));r=MsPortalFx.getEnumArray(e);u={};r.forEach((function(n){u[n.name]={count:0,keySize:0,valueSize:0}}));s=(function(){function t(n,t){function u(n){return e[n]+"_"}function s(n,t){return u(n)+(t||"")}function i(i){return i===1?n:t}function c(n,t,i){for(var u,r=0;r<n.length;r++)u=n.key(r),t.call(i,n.getItem(u),u,n)}function l(n){var u=h(),t=0,e="",i;c(n,(function(n,i){var h=MsPortalFx.find(r,(function(n){return MsPortalFx.startsWith(i,n.name)})),o,s;h&&(o=u[h.name],o.count++,o.keySize+=i.length,s=f(n).length,o.valueSize+=s,s>t&&(t=s,e=i))}));try{i=f(u)}catch(o){i="Could not stringify the summary. Exception: "+MsPortalFx.getLogFriendlyMessage(o)}return"Summary: {0}. The longest value (key == {1}) took {2} bytes. The total storage length is {3}.".format(i,e,t,n.length)}this.getValue=function(n,t,r){return i(r).getItem(s(n,t))};this.getAllComponentItems=function(n,t){var r=u(n),e=i(t),f={},o=r.length;return c(e,(function(n,t){if(t.startsWith(r)){var i=t.substring(o,t.length);f[i]=n}})),f};this.setValue=function(n,t,r,u){var e=i(u),h=s(n,t),f;try{e.setItem(h,r)}catch(c){f=new Error("Storage.setItem failed.");f.innerError=c;f.storageState=l(e);f.key=h||t;o.error(f)}};this.clearValue=function(n,t,r){var u=i(r),f=s(n,t),e=u.getItem(f);return u.removeItem(f),e};this.clearAllComponentItems=function(n,t){var e=u(n),r=i(t),f=[];c(r,(function(n,t){t.startsWith(e)&&f.push(t)}));f.forEach((function(n){return r.removeItem(n)}))};this.clearAll=function(){t.clear();n.clear()}}return t.create=function(){return new t(MsPortalImpl.sessionStorage,MsPortalImpl.localStorage)},__decorate([__metadata("fx:diagnostics",[n,"StorageService"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",t)],t,"create",null),t})();t.StorageService=s}));
define("MsPortalImpl/Widgets/Widgets.ContextMenu.Component",["require","exports","Weave/DirectMode","MsPortalImpl/Resources/ImplScriptResources","Weave","Fx/Weave","FxInternal/Weave/Util"],(function(n,t,i,r,u,f,e){"use strict";function o(n){var t=n.vm,o=n.className,h=u.composeComputation([f.toComputation(t.getOrderedMenuItemsComputed()),f.toComputation(t.getOrderedMenuItemsCommandsComputed())],(function(n,t){return n.concat(t)}));return i("div",{className:["fxs-contextMenu","fxs-popup","fxs-portal-bg-txt-br","msportalfx-shadow-level2","msportalfx-unselectable",o]},i("ul",{role:"menu",className:"fxs-contextMenu-itemList","aria-label":r.ContextMenu.ariaLabel},i(u.ForEach,{collection:h,fn:function(n){var t=n.item,o=n.index,h=n.length,u=f.toComputation(t.enabled),r=u.compose(e.negation),c=o.compose(s);return i("li",{role:"menuitem",className:["fxs-contextMenu-item msportalfx-command-like-button",{"fxs-portal-hover":u,"fxs-contextMenu-itemDisabled":r,"msportalfx-command-like-button-disabled":r,"fxs-contextMenu-extensioncommand":t._extension}],tabindex:"0",title:f.toComputation(t.tooltip),"aria-disabled":r,"aria-label":f.toComputation(t.ariaLabel),"aria-posinset":c,"aria-setsize":h,data:t},i("div",{className:"fxs-contextMenu-icon",image:f.toComputation(t.icon)}),i("div",{className:"fxs-contextMenu-text"},f.toComputation(t.text)))}})))}function s(n){return n+1}Object.defineProperty(t,"__esModule",{value:!0});t.ContextMenu=void 0;t.ContextMenu=o}));
define("MsPortalImpl/Widgets/Widgets.ContextPane.Component",["require","exports","Weave/DirectMode","Fx/Weave/Components/LoadingIndicator"],(function(n,t,i,r){"use strict";function u(n){var t=n.vm,u=n.className,f=t.opened,e=t.loading;return i("div",{className:["fxs-contextpane fxs-portal-bg-txt-br az-noprint",u,{"fxs-contextpane-visible":f,"fxs-contextpane-loading":e},],role:"complementary","aria-labelledby":"fxsContextPaneTitle"},i("div",{className:"fxs-contextpane-loadindicator"},i(r.LoadingIndicator,null)))}Object.defineProperty(t,"__esModule",{value:!0});t.ContextPane=void 0;t.ContextPane=u}));
define("MsPortalImpl/Services/Services.BrowseCuration",["require","exports","FxHubs/RpcEndPoints","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r){"use strict";function h(n){if(n&&!v.test(n)){u.warning("Invalid curation file name: <"+n+">, skipping this curation file.");return}return n}function p(n,t,i){var r=Array.isArray(t)?t:[t];return{base:n,associated:r,infoTextOverride:i}}function c(n){var r="Failed to get the browse curation file <"+t.browseCurationFile+">",i=r;n&&n.statusText?i+=": "+(n.status||"")+" ("+n.statusText+")":n&&n.message&&(i+=": "+n.message);u.warning(i);e.ClientNotification.publish({title:s.noCurationTitle,description:s.noCuration,status:e.NotificationStatus.Warning})}function w(){i.Curation.getSharedCurationEndpoint.register(l.client,"HubsExtension",(function(){return t.getSharedCuration()}))}Object.defineProperty(t,"__esModule",{value:!0});t.initializeRpc=t.testReset=t.getSharedCuration=t.getBrowseCuration=t.handleInvalidCurationFileError=t.getAllServicesAdditionalData=t.getMergedAssetType=t.browseCurationFile=void 0;var f=MsPortalFx.Base,l=FxImpl.Rpc,e=MsPortalFx.Hubs.Notifications,a=window,o=a.fx.environment,u=f.Diagnostics.createLog(n),v=/^[a-z\_]+[a-z\d\-\_]*$/i,s=r.BrowseCuration,y=MsPortalFx.lowerCaseAllStrings;t.browseCurationFile=h(MsPortalFx.getFeatureValue("browsecuration"))||h(o.browseCuration)||"default";t.getMergedAssetType=p;t.getAllServicesAdditionalData=MsPortalFx.memoizeQ((function(){return MsPortalFx.require("MsPortalImpl/Services/BrowseCuration/AllServicesCardData").then((function(n){return n.getAdditionalAssetTypeAndCategoryData()})).catch((function(n){var t="Failed to get the additional data file";return n&&n.statusText?t+=": "+(n.status||"")+" ("+n.statusText+")":n&&n.message&&(t+=": "+n.message),u.warning(t),{}}))}));t.handleInvalidCurationFileError=c;t.getBrowseCuration=MsPortalFx.memoizeQ((function(){return MsPortalFx.require("MsPortalImpl/Services/BrowseCuration/"+t.browseCurationFile).then((function(n){return n.getCuration()})).catch((function(n){return c(n),{}}))}));t.getSharedCuration=MsPortalFx.memoizeQ((function(){var n=r.SearchTypeDisplayText,i=r.SearchTypeKeywords,u=r.SearchTypeSubText;return t.getBrowseCuration().then((function(t){var r=(t&&t.search||[]).map((function(t){var r=(t.id||"").toLowerCase(),e=r&&n[r];if(e)return{id:t.id,displayName:e,subText:u[r],keywords:(i[r]||"").split(","),icon:typeof t.icon=="string"?f.Images.ImageUri(t.icon):t.icon,link:(t.link||"").format({accountPortal:o.links.accountPortal})}})).filter(MsPortalFx.identity);return{searchCuration:r,mergedAssetTypes:y(t&&t.mergedAssetTypes)}}))}));t.testReset=MsPortalFx.noop;t.initializeRpc=w}));
define("MsPortalImpl/Services/Services.Recents",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.Settings","FxHubs/RpcEndPoints","MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers","MsPortalImpl/Services/Services.SecurityTokens"],(function(n,t,i,r,u,f,e){"use strict";function v(n){f.lazyUserDataMemo(n).then((function(n){n.recentResources&&u.AssetTypes.setRecentResourcesEndPoint.invoke(FxImpl.Rpc.client,"HubsExtension",{recentResourcesMap:n.recentResources})}))}var s,h;Object.defineProperty(t,"__esModule",{value:!0});t.DEV=t.MruTokensSettingsManager=t.RecentServicesManager=t.loadRecentsFromLazyData=void 0;var c=MsPortalFx.Base,l=c.Diagnostics,o=l.createLog(n),a=5;t.loadRecentsFromLazyData=v;s=(function(){function t(n){this._settingsManager=n}return t.prototype.addService=function(n){var t=this;MsPortalFx.tryImmediateResolve(this._ensureServices(),(function(){n=n.toLowerCase();var i=t._services;MsPortalFx.remove(i,(function(t){return t.assetId===n}));i.length>=10&&i.pop();i.unshift({assetId:n,timeStamp:Date.now()});t._settingsManager.setSetting(16,"recentServices",{version:1,data:t._services})}))},t.prototype.getServices=function(){var n=this;return MsPortalFx.tryImmediateResolve(this._ensureServices(),(function(){return n._services}))},t.prototype._ensureServices=function(){var n=this;return this._services===undefined?MsPortalFx.tryImmediateResolve(Q(this._settingsManager.querySetting(16,"recentServices")),(function(t){n._services=(t||{}).data||[]})):Q()},__decorate([__metadata("fx:diagnostics",[n,"RecentServicesManager"]),i.Class(),__metadata("design:paramtypes",[r.SettingsManager])],t)})();t.RecentServicesManager=s;h=(function(){function t(n,t){var i=this,r,u;this._settingsManager=n;r=this._mruTokensMap={};u=this._mruTokensQueue=[];this._loadInitialSettingsPromise=Q(this._settingsManager.querySetting(16,"mruTokens").then((function(n){MsPortalFx.forEachKey(n,(function(n,t){r[n]=t;t.forEach((function(t){u.push({extension:n,resource:t})}))}))})));t.saveMruTokenFunc=function(n){if(!n){o.warning("The 'entry' to save to MRU token settings was null.");return}if(!n.extension){o.warning("The 'entry.extension' to save to MRU token settings was null.");return}n.resource&&i._loadInitialSettingsPromise.then((function(){i.addMruEntry(n)}))}}return t.prototype.addMruEntry=function(n){var r=n.extension,u=n.resource,o,f;if(r!=="fx"&&u){var i=this._mruTokensQueue,t=this._mruTokensMap,e=t[r]||[];e.indexOf(u)>=0?(MsPortalFx.remove(i,(function(n){return n.resource===u&&n.extension===r})),i.unshift(n)):(i.length>=a&&(o=i.pop(),f=o.extension,MsPortalFx.remove(t[f],(function(n){return n===o.resource})),t[f].length||delete t[f]),i.unshift(n),e.push(u),t[r]=e,this._settingsManager.setSetting(16,"mruTokens",t))}},__decorate([__metadata("fx:diagnostics",[n,"MruTokensSettingsManager"]),i.Class(),__metadata("design:paramtypes",[r.SettingsManager,e.SecurityTokensManager])],t)})();t.MruTokensSettingsManager=h}));
define("MsPortalImpl/UI/Hubs/UI.BrowseManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.AssetTypes"],(function(n,t,i,r){"use strict";function u(n,t){var i=n.toLocaleLowerCase(),r=t.toLocaleLowerCase();return i===r?0:i<r?-1:1}var f;Object.defineProperty(t,"__esModule",{value:!0});t.BrowseManager=t.compareAssetTypeForSort=void 0;var e=MsPortalFx.Base,o=e.Constants,s=o.ResourceTypes.ResourceGroups,h=s.toLowerCase(),c=MsPortalFx.forEachKey;t.compareAssetTypeForSort=u;f=(function(){function t(n){var i=this,t;this._assetTypeService=n;this._browsePackages={};t=this._ltm=new FxImpl.TriggerableLifetimeManager;t.registerForDispose((function(){c(i._browsePackages,(function(n,t){t.cancel();t.dispose()}))}))}return t.prototype.dispose=function(){this._ltm.dispose()},t.prototype.getFilteredAssetTypes=function(){var i=this,n=[],t=[];return this._assetTypeService.assetTypes.forEach((function(t){var r=t.assetTypeManifest;i._assetTypeMeetsRequirements(r)&&n.push(t)})),n.length&&t.push.apply(t,MsPortalFx.stableSort(n,(function(n,t){return u(n.compositeDisplayName.service||n.compositeDisplayName.plural,t.compositeDisplayName.service||t.compositeDisplayName.plural)}))),t},t.prototype._assetTypeMeetsRequirements=function(n){var r,t,i,u,f;return n?(r=n.browseType,r===undefined)?!1:(t=n.resourceType,!t)?!0:(i=t.resourceTypeName,u=i.toLowerCase(),u===h)?!0:(f=i.split("/"),f.length<2)?!1:!0:!1},__decorate([__metadata("fx:diagnostics",[n,"BrowseManager"]),i.Class(),__metadata("design:paramtypes",[r.AssetTypeService])],t)})();t.BrowseManager=f}));
define("MsPortalImpl/Resources/PortalNotificationsTelemetry",["require","exports"],(function(n,t){"use strict";var i,r,u;Object.defineProperty(t,"__esModule",{value:!0});t.DEV=t.ActionModifier=t.ActionModifierInternal=t.Action=t.ActionInternal=t.Source=void 0,(function(n){n.HatsHelper="HatsHelper";n.HaTSurvey="HaTSurvey";n.NotificationHub="NotificationHub";n.PortalNotifications="PortalNotifications";n.ToastTray="ToastTray";n.UpdateContactabilityDialog="UpdateContactabilityDialog"})(i||(i={}));t.Source=i,(function(n){n.AdvisorNotificationShown="AdvisorNotificationShown";n.CloudDeprecationModalFailure="CloudDeprecationModalFailure";n.DeprecatedNotificationApiCalled="DeprecatedNotificationApiCalled";n.DevSATDismissed="DevSATDismissed";n.DevSATLaunched="DevSATLaunched";n.DevSATNotShown="DevSATNotShown";n.DevSATShown="DevSATShown";n.FeedbackClicked="FeedbackClicked";n.InProgressNotification="InProgressNotification";n.InvokeHatsModal="InvokeHatsModal";n.IrisNotification="IrisNotification";n.ModalDialogDismissed="ModalDialogDismissed";n.ModalDialogOpened="ModalDialogOpened";n.NotificationClicked="NotificationClicked";n.NotificationDismissAllClicked="NotificationDismissAllClicked";n.NotificationDismissedFromPane="NotificationDismissedFromPane";n.NotificationHasMiscProperties="NotificationHasMiscProperties";n.NotificationMenuClosed="NotificationMenuClosed";n.NotificationMenuOpen="NotificationMenuOpen";n.NotificationMoreEventsLinkClicked="NotificationMoreEventsLinkClicked";n.NPSDismissed="NPSDismissed";n.NPSNotShown="NPSNotShown";n.NPSScoreClicked="NPSScoreClicked";n.NPSShown="NPSShown";n.NPSSubmitted="NPSSubmitted";n.PrivacyPolicyClick="PrivacyPolicyClick";n.RecommendationAdded="RecommendationAdded";n.RecommendationClicked="RecommendationClicked";n.RecommendationSurfaced="RecommendationSurfaced";n.ResourceIdLinkConversion="ResourceIdLinkConversion";n.ServerEventMappedToNotification="ServerEventMappedToNotification";n.ServiceHealthAlertNotification="ServiceHealthAlertNotification";n.ToastAdded="ToastAdded";n.ToastClicked="ToastClicked";n.ToastDismissed="ToastDismissed";n.UpdateContactabilityCountryInfo="UpdateContactabilityCountryInfo";n.UpdateContactabilityUpdateEmailClick="UpdateContactabilityUpdateEmailClick"})(r=t.ActionInternal||(t.ActionInternal={}));t.Action=r,(function(n){n.ActionsBeaconCall="ActionsBeaconCall";n.ActionsBeaconCallFailed="ActionsBeaconCallFailed";n.ActionsBeaconCallSuccess="ActionsBeaconCallSuccess";n.AdvisorNotificationReceived="AdvisorNotificationReceived";n.Cancelled="Cancelled";n.Completed="Completed";n.ContactabilityNotificationReceived="ContactabilityNotificationReceived";n.ControlNotificationReceived="ControlNotificationReceived";n.ExtensionMissingTasks="ExtensionMissingTasks";n.FeedbackDislike="FeedbackDislike";n.FeedbackLike="FeedbackLike";n.HatsNotificationReceived="HatsNotificationReceived";n.HiddenInIE11="HiddenInIE11";n.ImpressionsBeaconCall="ImpressionsBeaconCall";n.ImpressionsBeaconCallFailed="ImpressionsBeaconCallFailed";n.ImpressionsBeaconCallSuccess="ImpressionsBeaconCallSuccess";n.InProgressFinished="InProgressFinished";n.InProgressStarted="InProgressStarted";n.InvalidIrisTelemetryUri="InvalidIrisTelemetryUri";n.LargeModalsHidden="LargeModalsHidden";n.Mark="Mark";n.ModalsHiddenWhenZoomed="ModalsHiddenWhenZoomed";n.NoExtensionTaskMatches="NoExtensionTaskMatches";n.NotificationApi="NotificationApi";n.NotificationManager="NotificationManager";n.NotificationNotShown_InvalidBatchFormat="NotificationNotShown_InvalidBatchFormat";n.NotificationNotShown_InvalidContent="NotificationNotShown_InvalidContent";n.NotificationNotShown_NoNotificationsOrCultureMismatch="NotificationNotShown_NoNotificationsOrCultureMismatch";n.NotificationNotShown_NoSchema="NotificationNotShown_NoSchema";n.NotificationNotShown_NoTitleOrDescription="NotificationNotShown_NoTitleOrDescription";n.NotificationDismissed="NotificationDismissed";n.NotificationShown="NotificationShown";n.NotStarted="NotStarted";n.NPSScoreInvalid="NPSScoreInvalid";n.NPSScoreValid="NPSScoreValid";n.PublishIrisNotification="PublishIrisNotification";n.SmallModalsHidden="SmallModalsHidden";n.TriggeringModal="TriggeringModal";n.UpdateEmailFailed="UpdateEmailFailed";n.UpdateEmailSucceeded="UpdateEmailSucceeded"})(u=t.ActionModifierInternal||(t.ActionModifierInternal={}));t.ActionModifier=u}));
define("_generated/Less/MsPortalImpl/Themes/Themes.Reset.css",["module"],(function(n){"use strict";return{css:'.fxs-display-none{display:none !important}.fxs-hide-accessible-label{overflow:hidden;position:absolute;top:-1000px;left:-1000px;width:0;height:0}html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{font-size:100%;font-weight:inherit}html{-webkit-text-size-adjust:100%;text-size-adjust:100%}html,body{height:100%}body{font-family:az_ea_font,\'Segoe UI\',az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,\'Open Sans\',\'Helvetica Neue\',sans-serif;font-weight:400;margin:0;padding:0;overflow:hidden}button,input,select,textarea{font-family:az_ea_font,\'Segoe UI\',az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,\'Open Sans\',\'Helvetica Neue\',sans-serif;font-weight:400;border-radius:0}input::-ms-clear{display:none}button,[type="button"],[type="reset"],[type="submit"]{font-size:13px;line-height:1.385;background:none;color:inherit}img{overflow:hidden;max-height:100%;max-width:100%}textarea{overflow:auto}img,a img,:link img,:visited img{border:0}a[href]{-webkit-touch-callout:default}a[href]:not([tabindex="-1"]):focus,area[href]:not([tabindex="-1"]):focus,input:not([disabled]):not([tabindex="-1"]):focus,select:not([disabled]):not([tabindex="-1"]):focus,textarea:not([disabled]):not([tabindex="-1"]):focus,button:not([disabled]):not([tabindex="-1"]):focus,iframe:not([tabindex="-1"]):focus,[contentEditable=true]:not([tabindex="-1"]):focus{outline-offset:-1px}[tabindex="0"]:focus{outline-offset:-1px}tbody tr[tabindex]:not([tabindex=\'-1\']):focus{box-shadow:none}a{text-decoration:none}b,strong{font-weight:700}pre,code{font-family:Consolas,"Courier New",monospace;font-size:13px}legend,fieldset{border:0;margin:0;padding:0}hr{border-width:0;border-top-width:1px;border-top-style:solid}[role="button"],[role="link"],.fxs-fxclick{cursor:pointer}a[href]:hover,[role="link"].fxs-fxclick:hover{text-decoration:underline}::placeholder{opacity:1}@supports (outline-offset:-1px){:focus{outline-width:1px;outline-style:solid}}@supports (-webkit-touch-callout:none){*{-webkit-touch-callout:none}}svg{overflow:hidden}',moduleId:n.id}}));
define("MsPortalImpl/Base/Themes",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.GeneralSettings","FxInternal/Css","_generated/Less/MsPortalImpl/Themes/Themes.Reset.css"],(function(n,t,i,r,u,f,e){"use strict";function h(n,t,i,r,u,f){return{colorCode:n,imageUri:nt.getContentUri(et+t),svg:i,name:r,title:u,mode:f}}function k(n,t,i){it({source:n,action:t,data:i})}var l,d,g;Object.defineProperty(t,"__esModule",{value:!0});t.ThemeManager=void 0;l=MsPortalFx.isFeatureEnabled("theme2");f.injectCss(e);var o=MsPortalFx.Base,nt=o.Resources,tt=o.Diagnostics.Telemetry,it=tt.trace,c=window,rt="fxs-theme-",ut="fxs-mode-light ext-mode-light",ft="fxs-mode-dark ext-mode-dark",a="fxs-mode-standardcontrast ext-mode-standardcontrast",v="fxs-mode-highcontrast ext-mode-highcontrast",y="fxs-highcontrast-dark ext-highcontrast-dark",p="fxs-highcontrast-light ext-highcontrast-light",s=r.Themes.Names,et="Content/Images/MsPortalImpl/Themes/",w="_generated/Less/MsPortalImpl/Themes/Themes.{0}.css",ot="_generated/Less/MsPortalImpl/Themes/Theme2.css",st="_generated/Less/MsPortalImpl/Themes/Theme2.{0}.css",b="_generated/Less/MsPortalImpl/Themes/Theme2.Colors.{0}.css",ht="(-ms-high-contrast: active)",ct="(-ms-high-contrast: black-on-white)",lt="(-ms-high-contrast: white-on-black)",at=window.fx.environment,vt={name:"HighContrastMode",mode:1},yt={name:"HighContrastMode",mode:0};d=(function(){function t(n,t){var u=this,w,f,tt,it,b,e;this._lifetime=new FxImpl.TriggerableLifetimeManager;var r=t["fxs-theme"],i=t.highContrastKey,d=h("#f1f1f8","Theme_Light.png",o.Images.Themes.Light(),"light",s.light,0),g=h("#333","Theme_Dark.png",o.Images.Themes.Dark(),"dark",s.dark,1),nt=this._themes=[h("#0078d4","Theme_Azure.png",o.Images.Themes.Azure(),"azure",s.azure,0),h("#215b7d","Theme_Blue.png",o.Images.Themes.Blue(),"blue",s.blue,0),d,g,],l=MsPortalFx.find(nt,(function(n){return n.name===(r()||u.getDefaultTheme()).name}));MsPortalFx.isNullOrUndefined(l)&&(l=nt[1]);this.currentTheme=r;r(l);this.highContrastMode=i;ko.reactor(this._lifetime,[r,i],(function(t,i){var o,s;t=t||u._themes[0];var r=i!==0,f=i===2,e=i===1;r&&(t=f?g:d);o=u._injectStyles(t);s=f?u._injectStyles(vt):e?u._injectStyles(yt):Q({});Q.all([s,o]).then((function(){var i=t.mode?ft:ut;n.removeClass(w).addClass(w=rt+t.name+" "+i).toggleClass(a,!r).toggleClass(v,r).toggleClass(y,f).toggleClass(p,e)}))}));r.subscribe(this._lifetime,(function(){k("Shell","SelectedTheme",r().name)}));i.subscribe(this._lifetime,(function(){k("Shell","SelectedHighContrastMode",i())}));b=[f=c.matchMedia(ht),tt=c.matchMedia(ct),it=c.matchMedia(lt),];e=function(){tt.matches?i(1):it.matches||f.matches?i(2):i(0)};f.media!=="not all"&&(b.forEach((function(n){return n.addListener(e)})),f.matches&&e());this._lifetime.registerForDispose((function(){n.removeClass(w+" "+a+" "+v+" "+y+" "+p);b.forEach((function(n){return n.removeListener(e)}))}))}return t.prototype.getThemes=function(){return this._themes},t.prototype.getDefaultTheme=function(){var t=at.chrome.defaultTheme,n;return t&&(n=this._themes.filter((function(n){return n.name===t})),n&&n.length>0)?n[0]:this._themes[1]},t.prototype._injectStyles=function(t){var r=t.name,o=t.mode,i=r.charAt(0).toUpperCase()+r.slice(1),u=o?"DarkMode":"LightMode",e;return e=l?i==="HighContrastMode"?[st.format(i),b.format(i+"."+u),]:[ot,b.format(i),]:[w.format(i),w.format(u),],Q.all(e.map((function(t){return MsPortalFx.require(t,n)}))).then((function(n){return f.injectCss.apply(void 0,n)}))},t.prototype.dispose=function(){this._lifetime.dispose()},t})();g=(function(){function t(){}return t.createManager=function(n){return new d($([window.document.body,window.document.head]),n)},__decorate([__metadata("fx:diagnostics",[n,"ThemeManager"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[u.GeneralSettings]),__metadata("design:returntype",t)],t,"createManager",null),t})();t.ThemeManager=g}));
define("MsPortalImpl/Dialogs/MessageBoxInternal",["require","exports"],(function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MessageBoxExtended=void 0;var i=MsPortalFx.ViewModels.Dialogs,r=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(i.MessageBox);t.MessageBoxExtended=r}));
define("_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox.css",["module"],(function(n){"use strict";return{css:".fxs-messagebox{font-size:14px;box-sizing:border-box;border-width:1px;border-style:solid;line-height:normal;position:relative;overflow:hidden}.fxs-progressbox{color:#fff}.fxs-messagebox-title{padding:12px 20px 7px;margin:0;border-bottom:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-progressbox-text,.fxs-modal-template,.fxs-messagebox-template,.fxs-messagebox-text{padding:0 20px 8px;word-wrap:break-word}.fxs-messagebox-title.fxs-display-none+.fxs-modal-template,.fxs-messagebox-title.fxs-display-none+.fxs-messagebox-template,.fxs-messagebox-title.fxs-display-none+.fxs-messagebox-text{padding-top:12px}.fxs-messagebox-buttons{padding:8px 20px 16px}.fxs-messagebox-buttons .fxs-button{margin-right:8px}.fxs-progressbox-progressbar{padding:7px 20px 24px}.azc-balloon-dialog .fxs-messagebox{box-shadow:unset;border:0}.fxs-messagebox-confirmation{padding:10px 20px 0;display:block}.fxs-formdialog-description{padding:0 0 15px}.fxs-formdialog-form{max-width:458px}",moduleId:n.id}}));
define("MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Common","Fx/Controls/Button","Fx/Controls/CheckBox","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox.css","MsPortalImpl.Controls/Controls/SimpleButton"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";function ft(n,t){var r=n.closest("."+d),i;for(r.length>0&&h.waitForBindings(r[0]).then((function(){var t=s.Widget.getWidget(r,w),n=r.findFirstTabbable();n.closest(".fxs-messagebox-buttons").length>0?t.element.find(".fxs-portal-button-primary").focus():n.focus()})),i=t||document.activeElement;i&&typeof i.focus!="function";)i=$(i).closest("[tabindex]")[0];nt=i}function st(n,t,i,r){var u=new k;return u.title(i.title),i.templateViewModel?(u.template(i.text),u.templateViewModel(i.templateViewModel)):u.text(i.text),u.buttons=i.buttons,u.onButtonClick=function(n){t(n)},u.modal=r.modal,u.trustedTemplate=r.trustedTemplate,u.defaultButtonText=i.defaultButtonText,u.cancelButtonText=i.cancelButtonText,u.extraButtonText=i.extraButtonText,u.confirmationRequired=i.confirmationRequired,u.confirmationMessage=i.confirmationMessage,u.hideTitle=i.hideTitle,u.scopeClass=r.scopeClass,u.sourceTarget=r.sourceTarget,new w(n,u)}function ht(n,t,i,r){var f;i.positionHint=i.positionHint||3;f=new k;f.title(i.title);typeof i.content=="object"?(f.template(i.content.htmlTemplate),f.templateViewModel(i.content.viewModel)):typeof i.content=="string"&&f.text(i.content);Array.isArray(i.buttons)?(f.customBtns=[],i.buttons.forEach((function(n){var t=n.displayText||p[n.button];f.customBtns.push({kind:3,text:t,result:n.button,disabled:n.disabled})})),f.customBtns.length&&(f.customBtns[0].kind=1,f.customBtns.length>1&&(MsPortalFx.last(f.customBtns).kind=2))):f.buttons=i.buttons;f.modal=r.modal;f.trustedTemplate=r.trustedTemplate;f.hideTitle=i.hideTitle;f.scopeClass=r.scopeClass;var e=new w(n,f),o=e.buttonVms()[0],s=o&&o.result;return f.onButtonClick=function(i){s===i?u.ensureFormFieldValidation(n,!0).then((function(r){r?t(i):u.focusOnFirstInvalidField(n)})):t(i)},e}var k,w;Object.defineProperty(t,"__esModule",{value:!0});t.createMessageBoxWithCallback2=t.createMessageBoxWithCallback=t.Widget=t.ViewModel=t.setFocusOnMessageBox=void 0;a.injectCss(v);var et=MsPortalFx.Base.Diagnostics,b=et.createLog(n),tt=MsPortalFx.getIdGenerator("messagebox"),y=f.Dialogs.ButtonText,p=[];p[0]=y.abort;p[1]=y.cancel;p[2]=y.ignore;p[3]=y.no;p[4]=y.ok;p[5]=y.retry;p[6]=y.yes;var it="fxs-portal-bg-txt-br",rt="msportalfx-shadow-level2",ut="fxs-popup",d="fxs-messagebox",g="fxs-messagebox-text",ot=i("div",null,i("h2",{"data-bind":{text:"data.title",visible:"!data.hideTitle"},"class":"fxs-messagebox-title az-text-header1 msportalfx-tooltip-overflow"}),i(r.KoIf,{condition:"data.trustedTemplate"},i(r.KoIfNot,{condition:"data.template"},i("div",{"data-bind":{sanitizedHtml:"data.text"},"class":g})),i(r.KoIf,{condition:"data.template"},i("div",{"class":"fxs-modal-template","data-bind":{trustedHtml:{html:"data.template",data:"data.templateViewModel",isolated:"true"}}}))),i(r.KoIfNot,{condition:"data.trustedTemplate"},i(r.KoIfNot,{condition:"data.template"},i("div",{"data-bind":{text:"data.text"},"class":g})),i(r.KoIf,{condition:"data.template"},i("div",{"class":"fxs-messagebox-template","data-bind":{untrustedHtml:{html:"data.template",data:"data.templateViewModel",isolated:"true"},keyedCss:{scopingClasses:"data.scopeClass"}}}))),i(r.KoIf,{condition:"data.confirmationRequired"},i("div",{"data-bind":{pcControl:"func.checkboxVm"},"class":"fxs-messagebox-confirmation"})),i("div",{"class":"msportalfx-form fxs-messagebox-buttons","data-bind":{foreach:"func.buttonVms",visible:"func.buttonVms().length >= 1"}},i("div",{"data-bind":{pcControl:"$data.vm",attr:{"data-result":"$data.result"}}}))),nt=document.activeElement;t.setFocusOnMessageBox=ft;k=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.title=ko.observable(),t.text=ko.observable(),t.template=ko.observable(),t.templateViewModel=ko.observable(),t.trustedTemplate=!1,t.modal=!1,t.buttons=1,t.confirmationRequired=!1,t.hideTitle=!1,t.scopeClass="",t}return __extends(t,n),Object.defineProperty(t.prototype,"onButtonClick",{get:function(){return this._buttonClick},set:function(n){if(this._buttonClick)throw new Error("The onButtonClick callback has already been set.");this._buttonClick=n},enumerable:!1,configurable:!0}),t})(s.ViewModel);t.ViewModel=k;w=(function(n){function t(t,i){var r=n.call(this,t,i)||this,u,f,s;return r.buttonVms=ko.observableArray([]),t.html(ot).addClass(d).addClass(ut).addClass(it).addClass(rt),u=r.ltm,f=function(n){var i=r.element[0],t=$(n).closest(".azc-dockedballoon-balloon").attr("id"),u=!r.options.modal&&!(i===n)&&!$.contains(i,n)&&!(t&&(r.element.find(".azc-dockedballoon-anchor[aria-owns='"+t+"']").length||r.element.find(".azc-dockedballoon-anchor[aria-controls='"+t+"']").length));return u?2:0},r._dismissHandle={dismissFn:function(){if(r.cancelBtn)ko.unwrap(r.cancelBtn.onClick)();else if(typeof r.options.onButtonClick=="function")r.options.onButtonClick(1)},shouldDismissOnMouseDownFn:f,shouldDismissOnMouseWheelFn:f,restoreFocus:function(){var n=r.element[0],t=document.activeElement;$.contains(n,t)&&e.validatePreviousFocusedElement(r._dismissHandle,nt)&&nt.focus()},logName:"messagebox"},i.confirmationRequired&&(r.checkboxVm=l.create(u,{label:i.confirmationMessage,labelOnRight:!0})),r._getButtonHtml(i.buttons,u),r._bindDescendants(),r._setAria(),s=document.activeElement,i.sourceTarget&&(r.element[0]===i.sourceTarget||i.sourceTarget.contains(document.activeElement)||(s=i.sourceTarget)),ft(t,s),new o.KeyboardNavigation(r.ltm,{element:t,tabTriggers:2}),e.register(r._dismissHandle),u.registerForDispose((function(){e.unregister(r._dismissHandle)})),i.confirmationRequired&&(r.checkboxVm.value(!1),ko.reactor(u,(function(){r.defaultBtn.disabled(!r.checkboxVm.value())}))),r}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(d,ut,it,rt);n.prototype.dispose.call(this)},t.prototype.generateBtns=function(n,t){var r=this,i,u;t.length!==0&&(i=this.buttonVms,u=function(n,t,i){return c.create(n,{text:i.text,style:t?0:1,disabled:i.disabled,onClick:function(){if(typeof r.options.onButtonClick=="function")r.options.onButtonClick(i.result);r._dismissHandle.restoreFocus()}})},i().forEach((function(n){n.vm.dispose()})),i().length=0,i([]),this.defaultBtn=null,this.cancelBtn=null,this.extraBtn=null,t.forEach((function(t,f){f===0&&t.kind!==1&&b.error("The first button should be the default button for this dialog.");r.defaultBtn&&t.kind===1&&b.error("Only one default button should be defined.");r.cancelBtn&&t.kind===2&&b.error("Only one cancel button should be defined.");switch(t.kind){case 1:i.push({vm:u(n,!0,t),result:t.result});r.defaultBtn=MsPortalFx.last(i()).vm;break;case 2:i.push({vm:u(n,!1,t),result:t.result});r.cancelBtn=MsPortalFx.last(i()).vm;break;case 3:default:i.push({vm:u(n,!1,t),result:t.result});r.extraBtn=MsPortalFx.last(i()).vm}})),t.length===1&&(this.cancelBtn=this.defaultBtn),MsPortalFx.isNullOrUndefined(this.cancelBtn)&&b.error("Cancel button should be defined."))},t.prototype._getButtonHtml=function(n,t){var i=this.options;if(i.customBtns)this.generateBtns(t,i.customBtns);else{switch(n){case 0:this.generateBtns(t,[{kind:1,text:y.retry,result:5},{kind:2,text:y.abort,result:0},{kind:3,text:y.ignore,result:2}]);break;case 1:this.generateBtns(t,[{kind:1,text:y.ok,result:4}]);break;case 2:this.generateBtns(t,[{kind:1,text:y.ok,result:4},{kind:2,text:y.cancel,result:1}]);break;case 3:this.generateBtns(t,[{kind:1,text:y.retry,result:5},{kind:2,text:y.cancel,result:1}]);break;case 4:this.generateBtns(t,[{kind:1,text:y.yes,result:6},{kind:2,text:y.no,result:3}]);break;case 5:this.generateBtns(t,[{kind:1,text:y.yes,result:6},{kind:3,text:y.no,result:3},{kind:2,text:y.cancel,result:1}]);break;default:throw new Error("Could not locate message box button of type {0}.".format(n));}this.defaultBtn&&i.defaultButtonText&&this.defaultBtn.text(i.defaultButtonText);this.cancelBtn&&i.cancelButtonText&&this.cancelBtn.text(i.cancelButtonText);this.extraBtn&&i.extraButtonText&&this.extraBtn.text(i.extraButtonText)}return},t.prototype._setAria=function(){var n=this.element,t=n.findByClassName(g),i=tt(),r=tt();n.attr({role:"dialog","aria-labelledby":r,"aria-describedby":t.length?i:null});n.find("h2").attr("id",r);t.attr("id",i);this.ltm.registerForDispose((function(){n.removeAttr("role aria-labelledby aria-describedby tabindex")}))},t})(s.Widget);t.Widget=w;t.createMessageBoxWithCallback=st;t.createMessageBoxWithCallback2=ht}));
define("MsPortalImpl/Widgets/Dialogs/Widgets.FormDialog",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox","FxInternal/Controls/Section","Fx/Controls/Section","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function p(n,t,i){var r=new v(i);return r.onButtonClick=function(i){i===4?u.ensureFormFieldValidation(n,!0).then((function(r){r?t(i):u.focusOnFirstInvalidField(n)})):t(i)},new l(n,r)}var l;Object.defineProperty(t,"__esModule",{value:!0});t.createFormDialogWithCallback=t.Widget=t.ViewModel=void 0;h.injectCss(c);var a="fxs-formdialog",y=i(r.Root,null,i("div",{"class":"fxs-formdialog-description fxs-messagebox-text","data-bind":{text:"description"}}),i("div",{"class":"fxs-formdialog-form msportalfx-form","data-bind":{pcControl:"formSection"}})),v=(function(n){function t(t){var i=n.call(this)||this;if(i.lifetime=new FxImpl.TriggerableLifetimeManager,MsPortalFx.isNullOrUndefined(t))throw new Error("dialogOptions must be specified for rendering a form dialog.");var f=[[t.row1column1,t.row1column2],[t.row2column1,t.row2column2],],r=i.lifetime,h=f.map((function(n){var t=n.filter(MsPortalFx.identity).map((function(n){return e.create(r,{style:0,children:[n]})}));if(t.length)return e.create(r,{style:3,children:t})})).filter(MsPortalFx.identity),u=o.create(r,{children:h});return i.title(t.title),i.customBtns=[{kind:1,result:4,text:s.Dialogs.okButtonText,disabled:ko.computed(r,(function(){return!u.valid()}))},{kind:2,result:1,text:s.Dialogs.cancelButtonText},],i.template(y),i.templateViewModel({description:t.description,formSection:u}),i.trustedTemplate=!0,i}return __extends(t,n),t.prototype.dispose=function(){this.lifetime.dispose()},t})(f.ViewModel);t.ViewModel=v;l=(function(n){function t(t,i){var r=n.call(this,t,i)||this;return t.addClass(a),r}return __extends(t,n),t.prototype.dispose=function(){this.options.dispose();this._cleanElement(a);n.prototype.dispose.call(this)},t})(f.Widget);t.Widget=l;t.createFormDialogWithCallback=p}));
define("_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup.css",["module"],(function(n){"use strict";return{css:".fxs-listpopup{display:inline-block;cursor:default;position:absolute;left:0;width:200px;max-height:300px;z-index:200;overflow-y:auto;box-sizing:border-box}.fxs-listpopup-list{list-style-type:none;padding:0;max-height:300px}.fxs-listpopup-item{font-size:13px;line-height:normal;display:flex;align-items:center;flex:0 0 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;position:relative;box-sizing:border-box;padding:0 10px;border:0;overflow:visible;text-align:left;height:35px;cursor:pointer}",moduleId:n.id}}));
define("MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Widgets/Widgets.WidgetBase","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup.css"],(function(n,t,i,r,u,f,e,o,s){"use strict";function it(n,t,i,r){var u=new d;return u.dialogOptions=r,u.onItemSelected=function(){i(4)},u.onLostFocus=n,new h(t,u)}var h;Object.defineProperty(t,"__esModule",{value:!0});t.createListPopupWithCallback=t.Widget=t.ViewModel=void 0;o.injectCss(s);var g=MsPortalFx.Base.Diagnostics,c=".fxs-commandBar-item",l=".azc-toolbarButton-container:first",a="fxs-listpopup",nt=g.createLog(n),v="fxs-portal-bg-txt-br",y="msportalfx-shadow-level2",p="fxs-popup",w="fxs-listpopup-list",b="fxs-listpopup-item",k="."+b,tt=i("ul",{"class":w,"data-bind":{foreach:"func._items"},role:"menu"},i("li",{role:"menuitemradio","class":[b,"fxs-portal-hover"],tabindex:"-1","data-bind":{text:"text",css:{"fxs-listpopup-item-selected fxs-portal-selected fxs-portal-activated fxs-br-primary":"text === $root.data.dialogOptions.selectedItem()"},event:{click:"onClick",keydown:"onKeyDown"},attr:{title:"text","aria-setsize":"$parent.func._items().length","aria-posinset":"$index() + 1","aria-checked":'text === $root.data.dialogOptions.selectedItem() ? "true" : "false"'}}})),d=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(e.ViewModel);t.ViewModel=d;h=(function(n){function t(t,i){var e=n.call(this,t,i)||this;i.dialogOptions||nt.error("dialogOptions must be specified for rendering a list popup.");var o=document.activeElement,s=function(n){return n===o||$.contains(o,n)?0:!(t[0]===n)&&!$.contains(t[0],n)?2:0},h=e._dismissHandle={dismissFn:function(){var n=i.onLostFocus;n&&n()},shouldDismissOnFocusOutFn:s,shouldDismissOnMouseDownFn:s,shouldDismissOnMouseWheelFn:s,restoreFocus:function(){r.validatePreviousFocusedElement(h,o)&&o.focus()},logName:"listpopup"};return e._items=ko.computed(e.ltm,(function(){var n=function(n){typeof i.onItemSelected=="function"&&(i.dialogOptions.selectedItem(n),i.onItemSelected(),h.restoreFocus())};return i.dialogOptions.listItems().map((function(t){return{text:t,onClick:function(i,r){r.stopPropagation();n(t)},onKeyDown:function(i,r){if((r.keyCode===13||r.keyCode===32)&&u.getModifierKeys(r)===0)r.stopPropagation(),n(t);else return!0}}}))})),t.addClass(a+" "+p+" "+v+" "+y).html(tt),new f.KeyboardNavigation(e.ltm,{element:t.find("."+w),tabTriggers:12,itemSelector:k}),t.closest(c).find(l).attr("aria-expanded","true"),e._bindDescendants(),Q.nextTick((function(){e.setFocus()})),r.register(h),e}return __extends(t,n),t.prototype.dispose=function(){r.unregister(this._dismissHandle);this._cleanElement(a,p,v,y);this.element.removeAttr("tabindex").closest(c).find(l).attr("aria-expanded","false");n.prototype.dispose.call(this)},t.prototype.setFocus=function(){this.element.find(k).first().focus()},t})(e.Widget);t.Widget=h;t.createListPopupWithCallback=it}));
define("MsPortalImpl/Widgets/Dialogs/Widgets.ProgressBox",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox.css"],(function(n,t,i,r,u,f,e,o){"use strict";function v(n,t){var i=new c(t.text,t.completionPercentage);return i.title(t.title),i.customBtns=[],new s(n,i)}var s;Object.defineProperty(t,"__esModule",{value:!0});t.createProgressBox=t.Widget=t.ViewModel=void 0;e.injectCss(o);var l=u.Dialogs.ProgressBar,h="fxs-progressbox",a=i(r.Root,null,i("div",{"data-bind":{text:"data.text"},"class":"fxs-progressbox-text fxs-messagebox-text"}),i("div",{"data-bind":{text:"data.completionText"},"class":"fxs-progressbox-progressbar"})),c=(function(n){function t(t,i){var r=n.call(this)||this;return r.text=ko.observable(),r.completionPercentage=ko.observable(-1),ko.isObservable(t)&&(r.text=t),ko.isObservable(i)&&(r.completionPercentage=i),r.completionText=ko.pureComputed((function(){var n=r.completionPercentage();return n<0||n>100?"":l.percentComplete.format(n)})),r.template(a),r.templateViewModel({data:{text:r.text,completionText:r.completionText}}),r.trustedTemplate=!0,r}return __extends(t,n),t})(f.ViewModel);t.ViewModel=c;s=(function(n){function t(t,i){var r=n.call(this,t,i)||this;return t.addClass(h),r}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(h);n.prototype.dispose.call(this)},t})(f.Widget);t.Widget=s;t.createProgressBox=v}));
define("_generated/MsPortalImpl/Svg/Startup/Error.svg",["require","exports"],(function(){"use strict";return{type:77,data:"<svg viewBox='0 0 2048 2048' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M960 0q133 0 255 34t230 96 194 150 150 195 97 229 34 256q0 133-34 255t-96 230-150 194-195 150-229 97-256 34q-133 0-255-34t-230-96-194-150-150-195-97-229T0 960q0-133 34-255t96-230 150-194 195-150 229-97T960 0zm0 1792q114 0 220-30t199-84 169-130 130-168 84-199 30-221q0-114-30-220t-84-199-130-169-168-130-199-84-221-30q-115 0-221 30t-198 84-169 130-130 168-84 199-30 221q0 114 30 220t84 199 130 169 168 130 199 84 221 30zM896 512h128v640H896V512zm0 768h128v128H896v-128z'/><\/g><\/svg>"}}));
define("MsPortalImpl/UI/UI.DialogManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Dialogs/MessageBoxInternal","MsPortalImpl/Base/Themes","MsPortalImpl/Widgets/Dialogs/Widgets.FormDialog","MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup","MsPortalImpl/Services/Services.PortalIdleState","MsPortalImpl/Widgets/Dialogs/Widgets.ProgressBox","_generated/MsPortalImpl/Svg/Startup/Error.svg","_generated/MsPortalImpl/Svg/Startup/Warning.svg","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox","MsPortalImpl/Base/Base.SvgHelper","FxInternal/Composition/ContainerViewModel"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){"use strict";function w(n){return"The {0} used to render the dialog was not specified.".format(n)}function tt(n,t){var i=MsPortalFx.getUniqueId();return MsPortalFx.replaceAll(MsPortalFx.replaceAll(MsPortalFx.replaceAll(n,t,i),"msportalfx-svg-c01",t),i,"msportalfx-svg-c01")}function st(n,t,i,r,u){var o;switch(i.type){case 1:o=v.createMessageBoxWithCallback(t,u,i,r);break;case 2:o=s.createProgressBox(t,i);break;case 4:o=e.createListPopupWithCallback((function(){n.dismissOpenDialog()}),t,u,i);break;case 3:o=f.createFormDialogWithCallback(t,u,i);break;case p.Dlg2:o=v.createMessageBoxWithCallback2(t,u,i,r)}return o}function ht(n,t){var i=n.closest(".fxs-tile").data(l.CompositionInstanceDataName),r;return i&&l.isPartComposition(i)?r=i.locator:t||et.error("Unable to determine the extension that opened the dialog. "+MsPortalFx.getCurrentCallStack(!0)),r}function ct(n){var r=n.closest(".fxs-bladecontent"),t=a.Widget.getWidgets(r),i;return t&&t.length&&(i=t[0],n=$(rt(i.getForm()))),n}function lt(n,t){it("DialogOpened",n,t)}function b(n,t,i){it("DialogClosed",n,i,t+"")}function it(n,t,i,r){i=i?"/"+i:"fxDefault";var u=(t&&t.toFriendlyString())+"/"+i;ut.trace({source:ot,name:u,action:n,extension:t&&t.getExtensionName(),data:r})}function rt(n){return n&&(n instanceof Element?n:n.element)}function at(n){if(n)return n instanceof Element?{element:n,ltm:(ko.dataFor(n).func||ko.contextFor(n).$ctl).ltm}:n}var g,nt;Object.defineProperty(t,"__esModule",{value:!0});t.DialogManager=t.MessageBox=void 0;var k=MsPortalFx.Base,d=k.Diagnostics,ut=d.Telemetry,ft=$(window.document.body),et=d.createLog(n),ot="Shell";t.MessageBox=r.MessageBoxExtended;g=(function(){function n(n,t){this._portalIdleService=n;this._diContainer=t}return Object.defineProperty(n.prototype,"hasOpenDialog",{get:function(){return!!this._dismissOpenDialog},enumerable:!1,configurable:!0}),n.prototype.dismissOpenDialog=function(n){this._dismissOpenDialog&&(this._dismissOpenDialog(n),this._dismissOpenDialog=null)},n.prototype.showModalDialog=function(n){var f=this,e=$(FxImpl.createElement("div",{"class":"fxs-portal-shield-icon"})),l=$(FxImpl.createElement("div")),a=$(FxImpl.createElement("div",{"class":"fxs-portal-shield-modaldialog"})),o,i,s,u,r;return a.append(e,l),o=$(FxImpl.createElement("div",{"class":"fxs-portal-shield-middle"})),i=$(FxImpl.createElement("div",{"class":"fxs-portal-shield"})),o.append(a),i.append(o),ft.append(i),n.showErrorIcon?(s=y.getSvgReferenceOrFallBackToData(MsPortalFx.extend2(h,{data:tt(h.data,"msportalfx-svg-c22")})),u="fxs-portal-shield-icon-error"):(s=y.getSvgReferenceOrFallBackToData(MsPortalFx.extend2(c,{data:tt(c.data,"msportalfx-svg-c10")})),u="fxs-portal-shield-icon-warning"),e.empty().addClass(u).append(s),this._currentCancelToken&&(this._currentCancelToken.cancel(),this._currentCancelToken=null),r=new t.MessageBox(n.title,n.description,n.buttons),r.defaultButtonText=n.defaultButtonText,r.cancelButtonText=n.cancelButtonText,r.templateViewModel=n.templateViewModel,this._portalIdleService.signalIdle(),this._showDialog(l,r,{modal:!0,trustedTemplate:!0,locator:null}).then((function(t){var r=n.uiShield&&n.uiShield.hidePromise;return r?(f._currentCancelToken=new k.Promises.CancelationToken,k.Promises.wrapWithCancelablePromise(r,f._currentCancelToken).then((function(){i.remove()}))):i.remove(),e.removeClass(u),t})).finally((function(){f._portalIdleService.signalBusy()}))},n.prototype.showDialog=function(n,t,i,r){if(!n)throw new Error(w("dialogOptions"));if(!t)throw new Error(w("formTarget"));if(!i)throw new Error(w("sourceTarget"));r=r||{};r.modal=!1;r.sourceTarget=i;this.dismissOpenDialog();var u=$(rt(t.getForm())),f=this._showDialog(u,n,r,t);return t.showForm(i,{modal:!1,positionHint:n.positionHint||6}),f},n.prototype.showShellDialog=function(n,t,i,r){var u;if(!n)return Q.reject(w("dialogOptions"));if(!t)return Q.reject(w("formTarget"));if(!i)return Q.reject(w("sourceTarget"));u=Q.defer();r=r||{};this.dismissOpenDialog();var f=at(t.getForm()),o=f.element,s=f.ltm,e=$(o),h=this._showDialog(e,n,r,t);return t.showForm(i,{modal:r.modal||!1,positionHint:n.positionHint||6}),s.registerForDispose([e.setEvents(["closed",function(){u.resolve(1)},]),]),h.then(u.resolve).catch(u.reject),u.promise},n.prototype._showDialog=function(n,t,i,r){var f=this;return MsPortalFx.tryImmediateResolve(this._diContainer.getAsync(u.ThemeManager),(function(){var e=Q.defer(),c=function(n){i.syncCallback&&i.syncCallback(n);e.resolve(n)},h=function(){r&&r.hideForm()},o=t.telemetryName,u=i.locator,s;return u||i.modal||(u=ht(n,i.sideload)),t.type!==4&&(n=ct(n)),s=st(f,n,t,i,c),lt(u,o),s?(f._dismissOpenDialog=function(n){s.dispose();h();MsPortalFx.isNullOrUndefined(n)?(b(u,"Dismissed",o),e.reject()):(c(n),b(u,n,o))},e.promise.then((function(n){return s.dispose(),f._dismissOpenDialog=null,h(),b(u,n,o),n}))):(h(),b(u,"InvalidDialogType",o),e.reject("Invalid type specified in dialogOptions.")),e.promise}))},n})();nt=(function(){function t(){}return t.create=function(n,t){return new g(n,t)},__decorate([__metadata("fx:diagnostics",[n,"DialogManager"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.PortalIdleStateService,i.Container]),__metadata("design:returntype",t)],t,"create",null),t})();t.DialogManager=nt}));
define("MsPortalImpl/UI/Hubs/UI.NotificationManager",["require","exports","Fx/DependencyInjection","Fx/ResourceManagement","FxInternal/AsyncLoader","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Resources/PortalNotificationsTelemetry","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/Commands/Base.PortalFunctions","Weave"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";function dt(n){var t;return n&&(t=kt.get(n),t||kt.set(n,t={extensionName:undefined,userVote:v.makeWritableComputation()})),t}function li(n){return pt=n.get(w)}function ai(){return pt}function vi(n){n.notificationId||(n.notificationId=et.generateClientNotificationId())}function gt(n,t){var i=o.getBladeDeepLink(t.extension,t.detailBlade,t.detailBladeInputs,{allowObjectsInLinks:!0});n.get(a.RoutePortalFunc).invoke(i,y)}function rt(n){return n&&n.trim()}function ni(n){if(n.additionalProperties||(n.additionalProperties={}),!n.additionalProperties[ht]){var t=n.asset,i=t&&t.assetId,u=r.ArmId.parse(i,!0).subscription;n.additionalProperties[ht]=u}}function ti(n){return ni(n),FxImpl.ViewModels.getBladeSelection("Microsoft_Azure_ActivityLog","ActivityLogBlade",{queryInputs:{correlatedEvents:{correlationId:n.correlationIds[0],duration:n.timestamp.getMinutes(),subscriptionId:(n.additionalProperties||{})[ht]||null}}})}function yi(n,t,i){var w=t.isRecommendation?p.RecommendationClicked:p.NotificationClicked,f,s,r,h,u;if(ri(t,w),f=t.asset||{},s=f.assetType,s){var l=s.toLowerCase(),b=f.extensionName,v=b.toLowerCase(),k=n.get(e.ExtensionManager),d=i||!k.getExtension("Microsoft_Azure_Monitoring")||v==="Microsoft_Azure_Billing".toLowerCase()&&l===at.SubscriptionDetail.toLowerCase()||v==="HubsExtension".toLowerCase()&&l===at.Deployments.toLowerCase();if(d){n.get(a.RoutePortalFunc).invoke(o.getAssetDeepLink(n,f),y);return}}if(r=t.uri,r){h=t.uriAction||ft.Resources.isUriAbsolute(r)&&wt||ot.NavigatePortal;h===wt?n.get(c.WindowManager).openWindow(r):h===ot.OpenInCurrentTab?si.location.href=r:n.get(a.RoutePortalFunc).invoke(r,y);return}u=t.linkedBlade;u||i||(u=ti(t));u&&gt(n,u)}function pi(n){switch(n){case 0:return g.Error;case 1:return g.Warning;case 2:return g.Success;case 3:return k;case 4:return g.Information}}function ri(n,t){var i=n.additionalProperties||{},r=n.correlationIds,u=n.asset||{};MsPortalFx.extend(i,{status:g[n.status],correlationId:r&&r.join(","),asset:u});b.trace({source:y,action:t,data:i})}function ut(n,t){b.trace({source:y,action:p.DeprecatedNotificationApiCalled,data:{extensionName:n,handlerCalled:t}})}function wi(n,t){var i=n===null||n===void 0?void 0:n.additionalProperties,r=(n===null||n===void 0?void 0:n.percentComplete)>-Infinity,u=(n===null||n===void 0?void 0:n.descriptionAsHtml)!==undefined;(i||r||u)&&b.trace({source:y,action:p.NotificationHasMiscProperties,data:{additionalProperties:i,hasPercentComplete:r,hasSetDescriptionAsHtml:u,extensionName:t}})}function nt(n,t){if(n&&t)return n+"."+t}var lt,ii,ui,w,d;Object.defineProperty(t,"__esModule",{value:!0});t.addNotificationHandler=t.addNotification2Handler=t.updateNotificationHandler=t.showModalNotificationHandler=t.addClientNotificationsDefinition=t.addClientNotificationDefinition=t.NotificationHandler=t.NotificationManager=t.getNotificationManager=t.createNotificationManager=t.getNotificationData=void 0;var fi=FxImpl.Constants,ft=MsPortalFx.Base,ei=ft.Constants,at=ei.AssetNames,vt=ft.Diagnostics,b=vt.Telemetry,yt=MsPortalFx.Hubs.Notifications,et=yt.ClientNotification,g=yt.NotificationStatus,tt=FxImpl.Hubs.Notifications,ot=tt.ClientNotificationUriAction,st=FxImpl.NotificationManager,oi=h.Source,p=h.Action,it=h.ActionModifier,si=window,bi=vt.createLog(n),pt,y=oi.NotificationHub,ht="subscriptionId",wt=ot.OpenInNewTab,k=g.InProgress,hi=s.NotificationManager,bt=MsPortalFx.isFeatureEnabled("servereventdescriptionashtml"),ci=MsPortalFx.isFeatureEnabled("allowresourceidstolinks"),ct=Object.keys,kt=new WeakMap;t.getNotificationData=dt;t.createNotificationManager=li;t.getNotificationManager=ai;lt=function(n){return function(t,i){var r=i.srcWindowId,u;r&&(u=MsPortalFx.merge(t),u.forEach((function(t){t.notificationId=r+"#"+t.notificationId;n._addOrUpdateNotification(t,r)})))}};ii=(function(){function n(n,t){this.extensionWindowId=n;this.notificationDefinition=t}return n})();ui=(function(){function n(){this.notificationTable=Object.create(null)}return n.prototype._encode=function(n){return n.join("~")},n.prototype.add=function(n){var t=this._encode(n);this.notificationTable[t]||(this.notificationTable[t]=Date.now(),b.trace({source:y,action:p.InProgressNotification,actionModifier:it.InProgressStarted,data:{createdAt:this.notificationTable[t],ids:t}}))},n.prototype.report=function(n,t){var i=this._encode(n),r=this.notificationTable[i];r&&(b.trace({source:y,action:p.InProgressNotification,actionModifier:it.InProgressFinished,data:{createdAt:r,duration:Date.now()-r,ids:i,status:t}}),this.notificationTable[i]=0)},n})();w=(function(){function t(n,t){var i=this;this._rpcClient=n;this._diContainer=t;this.notifications=ko.observableArray();this._notificationDefinitions={};this._extensionNotifications={};this._serverEventToNotificationMap={};this._extensionsHeldByCorrelationId={};this._notificationsLifetime=new FxImpl.TriggerableLifetimeManager;this._inProgressLookupTable=new ui;this.addNotifications=function(n,t){var r=t;r&&i.itemsPromise.finally((function(){var t=n.notifications.map((function(n){return i._mapFxNotificationV1ToClientNotification(n)}));t=t.filter((function(n){return!!n}));t.forEach((function(n){return i._addOrUpdateNotification(n,r)}))}))};this.addNotification2=function(n,t){var r=t;r&&i.itemsPromise.finally((function(){var t=i._mapNotificationV2ToClientNotification(r,n.id,n.name,n.status,n.subStatus,n.assetId,n.properties);i._addOrUpdateNotification(t,r)}))};this.updateNotification=function(n){i.itemsPromise.finally((function(){var t=MsPortalFx.find(i.notifications(),(function(t){return(t.correlationIds||[]).some((function(t){return t.toLowerCase()===n.id}))}));if(t){var u=n.propertyName.toLowerCase(),f=n.propertyValue,r=t.correlationIds;u==="correlationid"?(r||(t.correlationIds=r=[]),r.push(f),i._addOrUpdateNotification(t)):u==="percentcomplete"&&(t.percentComplete=f,i._addOrUpdateNotification(t))}}))};this.showModalNotification=function(n,t){var r=t.notification;return i.addClientNotification(r),n.getAsync(l.DialogManager).then((function(n){return i.addClientNotification(r),n.showModalDialog({title:r.title,description:r.description,buttons:2,defaultButtonText:t.primaryButtonText,cancelButtonText:t.secondaryButtonText,showErrorIcon:!0})})).then((function(u){var f=undefined;return u===4?f=t.primaryButtonClickAction:u===1&&(f=t.secondaryButtonClickAction),f===1?i.handleNotificationClick(r):f===2&&n.get(c.WindowManager).redirect({uri:"/",reason:"ModalNotificationClickAction_RefreshPortal"}),u}))};this.addServerEvents=function(n){n.forEach((function(n){n&&i.itemsPromise.finally((function(){i._addServerEvent(n)}))}))};this._rpcClient=t.get(FxImpl.Rpc.Client);this.itemsPromise=t.get(f.ManifestCache).getManifests("assetTypes",(function(n,t){return i._collectNotificationDefinitions(n,t)}))}return t.prototype.listenForClientNotifications=function(){var n=this;this._rpcClient.registerRpcEndPoint(fi.RpcMethods.getClientNotifications,{allowedOrigin:["Microsoft_Azure_Monitoring","Microsoft_Azure_Insights"],handler:function(t,i){return b.trace({source:y,action:"ListenForClientNotificationsHandler",data:{extensionName:i===null||i===void 0?void 0:i.srcWindowId}}),n.notifications()}})},t.prototype.addClientNotification=function(n){ni(n);this._addOrUpdateNotification(n)},t.prototype.showNotificationDetails=function(n){gt(this._diContainer,ti(n))},t.prototype.handleNotificationClick=function(n,t){yi(this._diContainer,n,t)},t.prototype.definitionCount=function(){return ct(this._notificationDefinitions).length},t.prototype.newDefinitionCount=function(){return ct(this._extensionNotifications).length},t.prototype.serverEventsCount=function(){return ct(this._serverEventToNotificationMap).length},t.prototype.removeNotification=function(n){var t=MsPortalFx.find(this.notifications(),(function(t){return(t.correlationIds||[]).some((function(t){return t===n}))}));t&&this.notifications.remove(t)},t.prototype._addOrUpdateNotification=function(t,i){var r=this,u;t&&rt(t.title)&&rt(t.description)&&(u=function(){var f,n,u;if(t.clickable=!!t.asset||!!t.linkedBlade||!!t.uri,vi(t),(((f=t.inlineForm)===null||f===void 0?void 0:f.buttons)||[]).forEach((function(n,t){n.id=n.id||t.toString()})),t.timeSinceNotified||(t.timeSinceNotified=v.makeWritableComputation(hi.aFewSecondsAgo)),t.descriptionAsHtml||(t.descriptionAsHtml=!1),(t.correlationIds||[]).length||(t.correlationIds=[et.generateClientNotificationId()]),t.status===k?r._inProgressLookupTable.add(t.correlationIds):r._inProgressLookupTable.report(t.correlationIds,t.status),n=r.notifications(),u=MsPortalFx.find(n,(function(n){var i=n.correlationIds||[];return i.filter((function(n){return t.correlationIds.indexOf(n)!==-1})).length>0})),u)if(u.timestamp.getTime()<t.timestamp.getTime()||u.status===k)MsPortalFx.remove(n,u);else return;else wi(t,i);n.unshift(t);t.status!==k&&(n=MsPortalFx.stableSort(n,(function(n,t){return n.status===k?t.status===k?0:-1:t.status===k?1:t.timestamp.getTime()-n.timestamp.getTime()})));n.length>100&&n.pop();r.notifications(n);t.isRecommendation&&ri(t,p.RecommendationAdded);i&&(dt(t).extensionName=i,r._holdOntoExtension(i,t))},t.inlineForm?MsPortalFx.require(n.normalize("./UI.ActionableNotifications")).then((function(n){var i=r._notificationsLifetime;n.makeActionable(i,t,r._diContainer);u()})):(t.formSection=undefined,u()))},t.prototype._addServerEvent=function(n){var t,i;n.source&&n.operationName&&(t=this._serverEventToNotificationMap[nt(n.source,n.operationName)],t&&(i=this._mapNotificationV2ToClientNotification(t.extensionWindowId,n.correlationId,t.notificationName,n.status,n.subStatus,n.assetId,n.properties,n.timestamp,!0),i&&this.addClientNotification(i)))},t.prototype._collectNotificationDefinitions=function(n,t){var i=this,u=t.notifications,r;u&&u.forEach((function(t){var r=nt(t.eventSource,t.eventType);i._notificationDefinitions[r]||(i._notificationDefinitions[r]=new ii(n,t))}));r=t.notifications2;r&&r.forEach((function(t){var u=t.name,e=nt(n,u),r,f;i._extensionNotifications[e]=t;r=t.serverEvent;r&&r.operation&&r.source&&(f=nt(r.source,r.operation),i._serverEventToNotificationMap[f]={extensionWindowId:n,notificationName:u})}))},t.prototype._holdOntoExtension=function(n,t){var i=this,r=t.correlationIds,o,s,u,f;r&&(t.status===k?(o=r.some((function(n){return!!i._extensionsHeldByCorrelationId[n]})),o||(s=this._diContainer.get(e.ExtensionManager),u=s.getExtension(n),u&&(f=this._rpcClient.acquireWindow(u.name,6e5),r.forEach((function(n){i._extensionsHeldByCorrelationId[n]=f;f.onDispose((function(){i._extensionsHeldByCorrelationId[n]&&delete i._extensionsHeldByCorrelationId[n]}))}))))):r.forEach((function(n){var t=i._extensionsHeldByCorrelationId[n];t&&t.dispose()})))},t.prototype._mapNotificationV2ToClientNotification=function(n,t,i,r,u,f,e,o,s){var w,k,l,h,a,c,v,d,g;if(s===void 0&&(s=!1),l=this._extensionNotifications[nt(n,i)],l&&(a=l.messages.filter((function(n){return n.status.toLowerCase()===r.toLowerCase()})),u?h=MsPortalFx.find(a,(function(n){return n.subStatus&&n.subStatus.toLowerCase()===u.toLowerCase()})):a.length===1&&(h=a[0]),h))return c=h.message,e&&(c=c.format(e)),v=s&&bt,ci&&(b.trace({source:y,action:p.ResourceIdLinkConversion,actionModifier:it.NotificationManager,data:{descriptionAsHtml:v,enableServerEventDescriptionAsHtml:bt,isServerEvent:s}}),c=et.transformResourceIdUrisToLinks(c),v=!0),d={title:h.title,description:c,timestamp:o||new Date,isRecommendation:!1,status:pi(h.type),correlationIds:[t],additionalProperties:[],isServerEvent:s,descriptionAsHtml:v},!!(h.assetType||l.assetType)&&f&&(g=h.assetType||l.assetType,d.asset={extensionName:n,assetType:g,assetId:f}),b.trace({source:y,action:p.ServerEventMappedToNotification,actionModifier:it.NotificationManager,data:{extensionName:n,operationName:(k=((w=i===null||i===void 0?void 0:i.split("."))!==null&&w!==void 0?w:[])[1])!==null&&k!==void 0?k:i,status:r,subStatus:u}}),d},t.prototype._mapFxNotificationV1ToClientNotification=function(n){var t=this._formatNotificationV1FromExtensionManifest(n),i,r;if(t)return i={title:t.label,description:t.description,timestamp:t.timestamp,isRecommendation:!1,percentComplete:t.percentOperationComplete,status:t.state,correlationIds:[],additionalProperties:{}},r=t.clientDetails,t.assetId&&r&&(i.asset={extensionName:r.assetOwner,assetType:r.assetType,assetId:t.assetId}),t.correlationId&&i.correlationIds.push(t.correlationId),t.operationId&&i.correlationIds.push(t.operationId),t.subscriptionId&&(i.additionalProperties.subscriptionId=t.subscriptionId),i},t.prototype._formatNotificationV1FromExtensionManifest=function(n){var i=n.eventType,u=n.source,r,t;return u&&i&&(r=this._notificationDefinitions[nt(u,i)],t=void 0,r?(t=r.notificationDefinition,n.label=t.label,n.description=t.message.format(n.descriptionArgs),n.clientDetails=t.assetType?{assetOwner:r.extensionWindowId,assetType:t.assetType}:null):(n.label=n.label||i,n.description=n.description||i,n.assetId||(n.clientDetails=null))),rt(n.label)&&rt(n.description)?n:void 0},__decorate([__metadata("fx:diagnostics",[n,"NotificationManager"]),i.Class(),__metadata("design:paramtypes",[FxImpl.Rpc.Client,i.Container])],t)})();t.NotificationManager=w;d=(function(){function t(){}return t.prototype.notificationCallback=function(n){var t=n.diContainer.get(w);return lt(t)(n.messageArg,n.messageContext)},t.prototype.notificationsCallback=function(n){var t,i=n.diContainer.get(w);return ut((t=n===null||n===void 0?void 0:n.messageContext)===null||t===void 0?void 0:t.srcWindowId,"notificationsCallback"),lt(i)(n.messageArg,n.messageContext)},t.prototype.showModalNotification=function(n){var t,i=n.diContainer.get(w);return ut((t=n===null||n===void 0?void 0:n.messageContext)===null||t===void 0?void 0:t.srcWindowId,"showModalNotification"),i.showModalNotification(n.diContainer,n.messageArg)},t.prototype.updateNotification=function(n){var t=n.diContainer.get(w);return t.updateNotification(n.messageArg)},t.prototype.addNotification2=function(n){var t,i=n.diContainer.get(w);return ut((t=n===null||n===void 0?void 0:n.messageContext)===null||t===void 0?void 0:t.srcWindowId,"addNotification2"),i.addNotification2(n.messageArg,n.messageContext.srcWindowId)},t.prototype.addNotifications=function(n){var t,i=n.diContainer.get(w);return ut((t=n===null||n===void 0?void 0:n.messageContext)===null||t===void 0?void 0:t.srcWindowId,"addNotifications"),i.addNotifications(n.messageArg,n.messageContext.srcWindowId)},__decorate([__metadata("fx:diagnostics",[n,"NotificationHandler"]),i.Class()],t)})();t.NotificationHandler=d;t.addClientNotificationDefinition=u.defineHandler(tt.addClientNotificationDefinition,(function(n){var t=n.diContainer.get(d);t.notificationCallback(n)}));t.addClientNotificationsDefinition=u.defineHandler(tt.addClientNotificationsDefinition,(function(n){var t=n.diContainer.get(d);t.notificationsCallback(n)}));t.showModalNotificationHandler=u.defineHandler(tt.showModalNotification,(function(n){var t=n.diContainer.get(d);return t.showModalNotification(n)}));t.updateNotificationHandler=u.defineHandler(st.updateNotificationEndPoint,(function(n){var t=n.diContainer.get(d);return t.updateNotification(n)}));t.addNotification2Handler=u.defineHandler(st.addNotification2EndPoint,(function(n){var t=n.diContainer.get(d);return t.addNotification2(n)}));t.addNotificationHandler=u.defineHandler(st.addNotificationsEndPoint,(function(n){var t=n.diContainer.get(d);return t.addNotifications(n)}))}));
define("MsPortalImpl/UI/Hubs/UI.FavoritesManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Services/Services.BrowseCuration","MsPortalImpl/UI/Hubs/UI.BrowseManager","MsPortalImpl/UI/Hubs/UI.NotificationManager","Weave","FxHubs/ResourceManagement"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function y(n,t,i){return t===b.BrowseResourceGroupBlade&&(t=b.ResourceGroups),st.getAssetTypeOrResourceTypeIdByWindowId(n,t)+(i?"."+i.toLowerCase():"")}function tt(n,t){return t&&n.kindMap&&n.kindMap[(t||"").toLowerCase()]}function it(n,t){return t&&(t.serviceDisplayName||t.pluralDisplayName||g.assetPlusKindFormat.format(n.compositeDisplayName.service,t.name))||n.compositeDisplayName.service}function rt(n,t){return t&&t.icon||n.icon}function ut(n,t){return t&&t.keywords||n.assetTypeManifest.keywords}function ft(n,t,i,r,f){var l=i.get(u.AssetTypeService),o=n.assetTypeManifest,s=o&&c.supportsOption(o.options,1),e=tt(n,t),a=e&&c.supportsOption(e.options,1),v=e&&c.supportsOption(e.options,4),y=e?s?!v:a:s,h=it(n,e);return{id:r||n.id,image:rt(n,e),isFavorite:ko.observable(!1),isFilteredOut:ko.observable(!1),isHidden:ko.observable(y),label:h,labelId:h.replace(at,""),keywords:(ut(n,e)||"").split(","),matches:ko.observable(),uri:l.getAssetTypeDeepLink(n,t),opensExternal:o.browseType===3,isPreview:n.isPreview,assetType:n,kind:t,resourceType:o.resourceType&&o.resourceType.resourceTypeName,boost:f,relevanceScore:ko.observable()}}function p(n,t,i){var o,c,u,e,l,s;if(!t)return null;var a=t,h=t,r=i.get(f.RedirectMap).getAssetRedirect(t);return r&&(t=y(r.toExtension,r.toAsset,r.toKind)),r&&(o=i.get(w),o.remove(a),o.add(t),ct.trace({source:"SideBar",action:"FavoriteRedirected",name:h,data:{from:h,to:t}})),e=t.indexOf("."),e>0&&(u=t,t=u.substring(0,e),c=u.substring(e+1)),l=t.toLowerCase(),s=MsPortalFx.find(n,(function(n){return n.id.toLowerCase()===l})),s&&ft(s,c,i,u)}function pt(n,t,i){var e=[],r=[[],["Microsoft_AAD_IAM_AzureActiveDirectory","Microsoft_Azure_Monitoring_AzureMonitoring","Microsoft_Azure_Security_SecurityDashboard","Microsoft_Azure_Billing_Billing","Microsoft_Azure_Support_HelpAndSupport",],["Microsoft_Azure_Expert_AzureAdvisor",],],u;if(i&&n.version()<r.length-1){var f=n.favorites,s=f().toLowerCase(),o=l(f());for(u=(n.version()||0)+1;u<r.length;u++)r[u].forEach((function(n){var t=n.toLowerCase();s.indexOf(t)<0&&(o.push(n),e.push(n))}));f(a(o))}t(e);n.version(r.length-1)}var w;Object.defineProperty(t,"__esModule",{value:!0});t.FavoritesManager=t.findFavoriteItem=t.getFavoriteType=t.getAssetTypeKeywords=t.getAssetTypeIcon=t.getAssetTypeDisplayText=t.getAssetTypeKind=t.getAssetId=void 0;var v=MsPortalFx.Base,et=MsPortalFx.Extension,ot=v.Constants,b=ot.AssetNames,st=FxImpl.Assets,ht=MsPortalFx.Hubs.Notifications.NotificationStatus,k=v.Diagnostics,ct=k.Telemetry,lt=MsPortalFx.tryImmediateResolve,wt=et.BrowseType,d=v.Promises.cancelOnDispose,g=r.Favorites,nt=g.Notification,bt=k.createLog(n),l=JSON.parse,a=JSON.stringify,at=/\s+/g,vt=MsPortalFx.find,yt={};FxImpl.getAssetTypeMappingData=function(){return yt};t.getAssetId=y;t.getAssetTypeKind=tt;t.getAssetTypeDisplayText=it;t.getAssetTypeIcon=rt;t.getAssetTypeKeywords=ut;t.getFavoriteType=ft;t.findFavoriteItem=p;w=(function(){function t(n,t,i){var r=this;this._assetTypeService=n;this._browseManager=t;this._diContainer=i;this.favorites=h.makeArrayComputation();this._notificationsForItems=ko.observable();this._ltm=new FxImpl.TriggerableLifetimeManager;this._missingFavoritesWithIndex={};this._assetTypes=ko.observable();this._initialFavorites=[];this.remove=function(n){var t=r._savedFavorites().length&&l(r._savedFavorites())||[],i=t.indexOf(n);i!==-1&&(t.splice(i,1),r._savedFavorites(a(t)))};this.add=function(n){var t=l(r._savedFavorites())||[];t.includes(n)||(t.push(n),r._savedFavorites(a(t)))};this.move=function(n){var t=l(r._savedFavorites())||[],i=r.favorites.value[n],u=t.indexOf(i.id);t.splice(n,0,t.splice(u,1)[0]);r._savedFavorites(a(t))};this._savedFavorites=ko.observable("")}return t.prototype.initializeFavorites=function(n){var t=this._savedFavorites=MsPortalFx.isFeatureEnabled("skipsavedfavorites")?ko.observable(""):n.favorites,i=!!(t&&t());i&&(MsPortalFx.isFeatureEnabled("skipfavoritesupgrade")||pt(n,this._notificationsForItems,i),this._initialFavorites=l(t()));this.loadFavorites();this._registerDependency()},t.prototype.loadFavorites=function(){var n=this,f=function(t){var i=[];return t.forEach((function(n){switch(typeof n){case"string":if(n.startsWith("{"))try{var t=l(n);typeof t.typeId=="string"&&t.typeId&&i.push(t.typeId)}catch(r){}else i.push(n);break;case"object":n&&typeof n.typeId=="string"&&i.push(n.typeId)}})),n._savedFavorites(a(i)),i},i=this._savedFavorites&&this._savedFavorites().length&&f(l(this._savedFavorites()))||[],t=[],o=Q.isFulfilled(this._assetTypeService.assetTypesComplete),r=function(i,r){var u=p(n._assetTypes(),i,n._diContainer);u?(u.isFavorite(!0),t.push(u)):n._missingFavoritesWithIndex[i]=r},u=function(){var i=n._notificationsForItems()||[],r=i.slice(0);i.forEach((function(n){var i=vt(t,(function(t){return n===t.id})),u,f;i&&(u=nt.titleFmt.format(i.label),f=i.assetType.assetTypeManifest||{},s.getNotificationManager().addClientNotification({title:u,description:nt.Description[(f.name||"").toLowerCase()]||u,status:ht.Information,timestamp:new Date,uri:i.uri}),MsPortalFx.remove(r,n))}));n._notificationsForItems(r);n.favorites.setAll(t)};return i.length?(i.forEach((function(n,t){n&&r(n,t)})),u(),Q()):d(this._ltm,e.getBrowseCuration()).then((function(t){var i=n._initialFavorites;t.favorites.forEach((function(n){var t=y(n.extensionName,n.assetType,n.kind);i.push(t)}));n._initialFavorites.forEach((function(n,t){r(n,t)}));n._savedFavorites(a(i));u()}))},t.prototype.dispose=function(){this._ltm.dispose()},t.prototype._registerDependency=function(){var n=this;this._assetTypes([]);lt(d(this._ltm,this._assetTypeService.assetTypesComplete),(function(){var t=n._browseManager.getFilteredAssetTypes()||[];t.length&&n._assetTypes(t);MsPortalFx.forEachKey(n._missingFavoritesWithIndex,(function(i,r){if(r!==-1){var u=p(t,i,n._diContainer);u&&(u.isFavorite(!0),r=Math.min(r,n.favorites.value.length),n.favorites.insert(r,u),n._missingFavoritesWithIndex[i]=-1)}}))}))},__decorate([__metadata("fx:diagnostics",[n,"FavoritesManager"]),i.Class(),__metadata("design:paramtypes",[u.AssetTypeService,o.BrowseManager,i.Container])],t)})();t.FavoritesManager=w}));
define("_generated/MsPortalImpl/Svg/Library/Polychromatic/AllServices.svg",["require","exports"],(function(){"use strict";return{type:385,data:"<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><defs><linearGradient id='e150ce2c-494d-4db6-b843-d0d873d58c11' x1='1.65' x2='1.65' y1='6.09' y2='3.44' gradientUnits='userSpaceOnUse'><stop offset='0' stop-color='#5e9624'/><stop offset='.4' stop-color='#65a227'/><stop offset='1' stop-color='#76bc2d'/><\/linearGradient><linearGradient id='b90b390d-fef8-4462-93e3-67c23cf69f69' x1='1.65' x2='1.65' y1='10.47' y2='7.83' gradientUnits='userSpaceOnUse'><stop offset='0' stop-color='#5e9624'/><stop offset='.54' stop-color='#6aa928'/><stop offset='1' stop-color='#76bc2d'/><\/linearGradient><linearGradient id='b1f3cf53-cb64-4f2c-bfab-fd24a0c86402' x1='1.65' x2='1.65' y1='15.02' y2='12.37' gradientUnits='userSpaceOnUse'><stop offset='0' stop-color='#5e9624'/><stop offset='.54' stop-color='#6aa928'/><stop offset='1' stop-color='#76bc2d'/><\/linearGradient><\/defs><rect width='13.97' height='1.45' x='3.73' y='4.04' fill='#8a8a8a' rx='.73'/><rect width='13.97' height='1.45' x='3.73' y='8.42' fill='#8a8a8a' rx='.73'/><rect width='13.97' height='1.45' x='3.73' y='12.97' fill='#8a8a8a' rx='.73'/><rect width='2.64' height='2.64' x='.32' y='3.44' fill='url(#e150ce2c-494d-4db6-b843-d0d873d58c11)' rx='1.32'/><rect width='2.64' height='2.64' x='.32' y='7.83' fill='url(#b90b390d-fef8-4462-93e3-67c23cf69f69)' rx='1.32'/><rect width='2.64' height='2.64' x='.32' y='12.37' fill='url(#b1f3cf53-cb64-4f2c-bfab-fd24a0c86402)' rx='1.32'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Library/Polychromatic/Dashboard.svg",["require","exports"],(function(){"use strict";return{type:350,data:"<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><defs><linearGradient id='a09b0f0f-3d24-4aad-8fda-73f9dc8561f7' x1='9' x2='9' y1='790.787' y2='774.125' gradientTransform='matrix(1 0 0 -1 0 791.516)' gradientUnits='userSpaceOnUse'><stop offset='0' stop-color='#6cc6b9'/><stop offset='.46' stop-color='#6ac4b7'/><stop offset='.64' stop-color='#62bdb0'/><stop offset='.77' stop-color='#56b1a4'/><stop offset='1' stop-color='#258277'/><\/linearGradient><\/defs><path fill='url(#a09b0f0f-3d24-4aad-8fda-73f9dc8561f7)' d='M.549 2.636h16.912a.518.518 0 0 1 .539.489v11.75a.518.518 0 0 1-.539.489H.549A.528.528 0 0 1 0 14.875V3.145a.529.529 0 0 1 .548-.509z'/><rect width='1.532' height='9.349' x='12.459' y='4.206' opacity='.9' rx='.147' class='msportalfx-svg-c01'/><rect width='8.572' height='1.937' x='1.628' y='11.629' opacity='.6' rx='.159' class='msportalfx-svg-c01'/><rect width='1.532' height='5.524' x='14.808' y='8.031' opacity='.9' rx='.113' class='msportalfx-svg-c01'/><path d='M9.117 4.772l-2.13 3.79-2.253-2.295-2.322 3.011.544.427 1.842-2.376 2.338 2.386L9.72 5.119l-.603-.347z' class='msportalfx-svg-c01'/><ellipse cx='4.761' cy='6.795' rx='.876' ry='.881' class='msportalfx-svg-c01'/><ellipse cx='7.136' cy='8.979' rx='.876' ry='.881' class='msportalfx-svg-c01'/><ellipse cx='9.341' cy='5.055' rx='.876' ry='.881' class='msportalfx-svg-c01'/><ellipse cx='2.775' cy='9.363' rx='.876' ry='.881' class='msportalfx-svg-c01'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Startup/Home.svg",["require","exports"],(function(){"use strict";return{type:335,data:"<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><defs><linearGradient id='b787b15c-863f-4e78-ac5e-558b4b5bea3b' x1='9' x2='9' y1='17.66' y2='.34' gradientUnits='userSpaceOnUse'><stop offset='0' stop-color='#0078d4'/><stop offset='.17' stop-color='#1c84dc'/><stop offset='.38' stop-color='#3990e4'/><stop offset='.59' stop-color='#4d99ea'/><stop offset='.8' stop-color='#5a9eee'/><stop offset='1' stop-color='#5ea0ef'/><\/linearGradient><\/defs><path fill='url(#b787b15c-863f-4e78-ac5e-558b4b5bea3b)' d='M17.8 8.29L9.41.5a.61.61 0 0 0-.82 0L.2 8.29a.62.62 0 0 0 .47 1.06h1.72a.3.3 0 0 1 .3.3v7.4a.61.61 0 0 0 .61.61h11.4a.61.61 0 0 0 .61-.61v-7.4a.3.3 0 0 1 .3-.3h1.72a.62.62 0 0 0 .47-1.06z'/><path fill='#e6e6e6' d='M7.07 12.4h3.86a.36.36 0 0 1 .32.38v4.88h-4.5v-4.88a.36.36 0 0 1 .32-.38z'/><path fill='#005ba1' d='M.67 9.35h.53l7.39-6.86a.61.61 0 0 1 .82 0l7.39 6.86h.53a.62.62 0 0 0 .47-1.06L9.41.5a.61.61 0 0 0-.82 0L.2 8.29a.62.62 0 0 0 .47 1.06z'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Startup/MonochromeHome.svg",["require","exports"],(function(){"use strict";return{type:398,data:"<svg viewBox='0 0 2048 2048' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M1024 165l941 942-90 90-83-82v805h-640v-640H896v640H256v-805l-83 82-90-90 941-942zm640 1627V987l-640-640-640 640v805h384v-640h512v640h384z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Widgets/Widgets.SideBar",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/Hubs/UI.FavoritesManager","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/MsPortalImpl/Svg/Startup/Home.svg","_generated/MsPortalImpl/Svg/Startup/MonochromeHome.svg","MsPortalImpl/Services/Services.Recents","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Services/Services.GeneralSettings","_generated/MsPortalImpl/Svg/Library/Polychromatic/Dashboard.svg","_generated/MsPortalImpl/Svg/Library/Polychromatic/AllServices.svg","Weave","MsPortalImpl/Services/Services.BrowseCuration","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css","MsPortalImpl/Base/Base.BrowserDetection"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){"use strict";function bt(n){switch(n){case 0:return"SideBarFlyout";case 1:return"SideBarCollapsed";case 2:return"SideBarExpanded"}}function d(n,t,i){g.Diagnostics.Telemetry.trace({source:"SideBar",name:t,action:n,data:i})}function et(n,t,i){var f=i.favoritesManager.favorites,e=f.value,r=it(n,e),u=it(t,e),o;return r>=0&&u>=0&&r!==u?(d("SideBarFavoriteMoved",t,{oldIndex:u,newIndex:r}),o=f.value[u],f.removeAt(u),f.insert(r,o),i.favoritesManager.move(r),r):-1}function kt(n,t,i){var u=$(document.activeElement).parent(),f=i===40?u.next(ut):u.prev(ut),e,r;f.length>0&&(e=f.attr("data-id"),r=et(e,n,t),r>=0&&Q.fcall((function(){var i=t.favoritesManager.favorites.value[r].uri,n=$.querySelectorAll("."+at+" [href|='"+i+"']")[0];n&&n.focus()})))}function dt(n,t){return t<500||n<640?0:n<1024?1:2}function it(n,t){for(var i=0;i<t.length;++i)if(t[i]&&t[i].id===n)return i;return-1}var ft,ot;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.reorderFavorite=t.ViewModel=void 0;w.injectCss(b);var g=MsPortalFx.Base,st=g.Images,ht=g.Promises.cancelOnDispose,ct=window,rt=ct.fx.environment,lt="fxs-sidebar-flyout",at="fxs-sidebar-bar",ut="li.fxs-sidebar-item",nt=u.SideBar,vt="fxs-sidebar-menu-container",yt="fxs-sidebar-menu",pt="fxs-sidebar-menu-activated",wt=MsPortalFx.isFeatureEnabled("allServicesWithOverview"),tt=MsPortalFx.isNullOrUndefined;ft=(function(t){function e(n,i,f){var e=t.call(this)||this,h,c;return e.diContainer=n,e.favoritesManager=i,e._recentsManager=f,e.sideBarMenuText=y.makeWritableComputation(),e.menuBladeId=ko.observable(),e.menuBladePartContainer=ko.observable(),e.allServiceLinkClicked=ko.observable(!1),e.isCollapsed=y.makeWritableComputation(!0),e.layoutMode=ko.observable(),e.hamburgerMode=y.makeWritableComputation(!0),e.focusBehavior=ko.observable(!0),e.sideBarMenuIsActivated=ko.observable(!1),e.hamburgerButton=new y.ElementRef,e.openFavorite=function(n,t,i){var r,u,f;if(r=typeof n=="number"?e.favoritesManager.favorites.value[n]:n,r){if(r.opensExternal)return e.openExternal(r.uri),!0;if(!t&&!i)return u=r.assetType,f=r.kind,u&&e._recentsManager.addService(u.id+(f?"."+f:"")),e.launchBlade(r.uri,r),!0}},h=MsPortalFx.isFeatureEnabled("brandingsidebar")?rt.branding.browseLabel:nt.allServices,c=MsPortalFx.isFeatureEnabled("monochromehomeicon")?s:o,e.topSectionLinks=[!rt.chrome.hideCreateButton&&{classes:"fxs-sidebar-create",title:nt.createTooltip,text:nt.createResource,icon:st.Add({customClass:"msportalfx-fill-success"}),href:r.getGalleryDeepLink("hub"),onClick:function(){d("SideBarNewMenuOpened")}},MsPortalFx.isFeatureEnabled("azurehome")&&{classes:"fxs-sidebar-home",title:u.AzureHome.azureHome,text:u.AzureHome.home,icon:c,href:r.getHomeDeeplink(),onClick:function(){d("AzureHomeLinkClicked")}},!MsPortalFx.isFeatureEnabled("hidedashboards")&&{classes:"fxs-sidebar-dashboard",title:u.NavBar.home,text:u.NavBar.home,icon:a,href:r.getDefaultDashboardDeeplink(),onClick:function(){d("DashboardNavigation")}},!MsPortalFx.isFeatureEnabled("hideallservices")&&{classes:"fxs-sidebar-browse",title:h,text:h,icon:v,href:r.getAllServicesDeeplink(),onClick:function(){d("AllServicesMenuOpened");e.allServiceLinkClicked(!0)}},].filter(MsPortalFx.identity),e.favorites=i.favorites,e.effectiveFavorites=e.favorites.cFilter((function(n){return!!n})),e.hamburgerMode(!l.isSideBarDocked(n)),e}return __extends(e,t),e.prototype.setCollapsed=function(n,t){t===void 0&&(t=!0);this.focusBehavior(t);this.isCollapsed(n)},e.prototype.showAllServices=function(n){var t=this;MsPortalFx.tryImmediateResolve(this._getSidebarFlyout(),(function(i){var r=t.allServiceLinkClicked;i.onDisplay(n,r());r(!1)}))},e.prototype.openCreate=function(){d("SideBarNewMenuOpened");this.launchBlade(r.getGalleryDeepLink("hub"))},e.prototype.reorderFavorites=function(n){var t=$(document.activeElement).parent().attr("data-id");kt(t,this,n)},e.prototype.openExternal=function(n){window.open(n,"_blank")},e.prototype.setWidget=function(n){this._widget=n},e.prototype.getRootElement=function(){return this._widget&&this._widget.element},__decorate([__metadata("fx:diagnostics",[n,"ViewModel"]),i.Class(),__metadata("design:paramtypes",[i.Container,f.FavoritesManager,h.RecentServicesManager])],e)})(e.ViewModel);t.ViewModel=ft;t.reorderFavorite=et;ot=(function(t){function i(n,i,r){var f=t.call(this,n,i,!0)||this,e,o,s;return f._diContainer=r,f._renderGuard=!1,i.setWidget(f),e=f.ltm,f._lastFocusedElement=document.activeElement,f._settings=i.diContainer.get(l.GeneralSettings),i.hamburgerMode(!l.isSideBarDocked(i.diContainer)),f.render(window.innerWidth,window.innerHeight),f._settings.sideBarLayout.subscribe(e,(function(){i.hamburgerMode(!l.isSideBarDocked(i.diContainer));i.hamburgerMode.value||i.layoutMode()!==2?i.setCollapsed(!0):i.layoutMode()===2&&i.setCollapsed(f._settings.sideBarCollapsedKey());f.render()})),y.subscribe(e,[i.isCollapsed],(function(n){n?c.unregister(f._dismissHandle):i.focusBehavior()&&c.register(f._dismissHandle);f.render();d("SideBarCollapsedChanged","",n?"collapsed":"expanded")})),o=function(n){return(i.hamburgerMode.value||i.layoutMode()!==2)&&!(f.element[0]===n)&&!$.contains(f.element[0],n)?2:0},f._dismissHandle={dismissFn:function(){i.setCollapsed(!0);c.unregister(f._dismissHandle)},shouldDismissOnFocusOutFn:o,shouldDismissOnMouseDownFn:o,shouldDismissOnMouseWheelFn:o,logName:"sidebar"},s=function(){k.isAndroidOrMobile||f.render(window.innerWidth,window.innerHeight)},window.addEventListener("resize",s),e.registerForDispose((function(){return window.removeEventListener("resize",s)})),f._attachEventHandlers(),i._getSidebarFlyout=MsPortalFx.memoizeQ((function(){return Q.all([MsPortalFx.require("MsPortalImpl/Widgets/Widgets.SideBarFlyout"),wt&&MsPortalFx.require("MsPortalImpl/Services/BrowseCuration/AllServicesCardData"),MsPortalFx.require("MsPortalImpl/Services/BrowseCuration/"+p.browseCurationFile).catch((function(n){p.handleInvalidCurationFileError(n)})),]).then((function(n){var u=n[0],e=new u.ViewModel,o=g.Diagnostics.Telemetry.start({source:"AllServicesMenu",action:"AllServicesMenuLoadWithKO"}),t,r;return performance.mark("AllServicesMenuLoadWithKOStart"),t=new u.Widget(f.element.parent().parent().findByClassName(lt),e,f._diContainer),t.options.launchBlade=i.launchBlade,t.options.openFavorite=i.openFavorite,r=f.ltm.createChildLifetime(),e.isLoading.subscribeAndRun(r,(function(n){n||(r.dispose(),performance.mark("AllServicesMenuLoadWithKOEnd"),performance.measure("AllServicesMenuLoadWithKO","AllServicesMenuLoadWithKOStart","AllServicesMenuLoadWithKOEnd"),g.Diagnostics.Telemetry.completeTrace(o))})),t}))})),ko.reactor(e,[i.menuBladeId,i.layoutMode],(function(t,r){var u=!!t&&r===0;i.sideBarMenuIsActivated(u);n.toggleClass(yt,u)})),i.sideBarMenuIsActivated.subscribe(e,(function(t){n.toggleClass(pt,t);i.sideBarMenuText(t?u.SideBar.menuCollapse:u.SideBar.menuExpand)})),f}return __extends(i,t),i.prototype.render=function(n,t){var f,s,h,e,l,a;if(!this._renderGuard){this._renderGuard=!0;var r=this.options,v=r.isCollapsed,o=r.hamburgerMode,u=r.layoutMode(),i=u;if(tt(n)||tt(t)||(i=dt(n,t),tt(u)||d("SideBarLayoutChanged","",bt(i))),i!==u&&(o.value||i!==2?r.setCollapsed(!0):i===2&&r.setCollapsed(this._settings.sideBarCollapsedKey()),(i===0||u===0)&&r.menuBladeId()&&(i!==0?(f=this.element.findByClassName("fxc-menu"),f.detach(),f.appendTo(r.menuBladePartContainer())):(f=r.menuBladePartContainer().findByClassName("fxc-menu"),f.detach(),f.appendTo(this.element.findByClassName(vt))))),!o.value&&u!==i&&i===2)for(s=document.getElementsByClassName("fxs-part-reactframe"),h=document.createEvent("Event"),h.initEvent("resize",!0,!0),e=0;e<s.length;e++)s[e].dispatchEvent(h);r.focusBehavior()&&(o.value||i===0)&&(v.value?(l=this.element[0],a=document.activeElement,$.contains(l,a)&&c.validatePreviousFocusedElement(this._dismissHandle,this._lastFocusedElement)&&$(this._lastFocusedElement).focus()):this.setFocus());u!==i&&r.layoutMode(i);this._renderGuard=!1}},i.prototype.setFocus=function(){this._lastFocusedElement=document.activeElement;this.options.hamburgerButton.focus()},i.prototype._attachEventHandlers=function(){var t=this;ht(this.ltm,Promise.all([MsPortalFx.require(n.normalize("MsPortalImpl/Widgets/Widgets.HoverCard")),MsPortalFx.require(n.normalize("MsPortalImpl/Widgets/ServiceHoverCard")),])).then((function(n){var i=n[0],r=n[1];i.attach(t.ltm,t.element,".fxs-sidebar-favorite-item",(function(n){var e=t.options.favorites.value,u=e[it($(n.currentTarget).attr("data-id"),e)],o=t.element.find(".fxs-hover-card-balloon[data-name='"+u.id+"']").first(),f=new r.ViewModel(u,$(n.currentTarget),t._diContainer,"SidebarFavorite");return f.favoriteOnDismiss=!0,f.positionHint=4,g.Diagnostics.Telemetry.trace({source:"HoverCard",name:u.id,action:"InitialReveal",data:{hoverCardLocation:"SidebarFavorite"}}),new i.Widget(o,f,t._diContainer)}),t._diContainer)}))},i})(e.Widget);t.Widget=ot}));
define("MsPortalImpl/Widgets/Widgets.Panorama.Component",["require","exports","Weave/DirectMode","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.SideBar","Weave","Weave/Core/Computation","Fx/Weave/Components/LoadingIndicator","MsPortalImpl/Services/Services.BrowseCuration"],(function(n,t,i,r,u,f,e,o,s){"use strict";function a(n){var t=n.vm;return i("main",{className:"fxs-panorama fxs-portal-content"},i(f.Fragment,null,c?i(f.Once,{condition:t.displayMode.compose((function(n){return n==="AllServices"})),trueFn:function(){return i(f.PromiseFragment,{promise:v(t),whilePending:i(o.LoadingIndicator,null)})}}):i("div",{className:"fxs-sidebar-flyout fxs-portal-background",role:"presentation"}),i(f.If,{condition:t.settingsFlyoutState,trueFn:function(){return i(f.PromiseFragment,{promise:y(t),whilePending:i(o.LoadingIndicator,null)})}}),i("div",{className:["fxs-startboard fxs-startboard-target fxs-theme-context-start fxs-portal-text",{"fxs-startboard-notfound":t.startboardNotFound,"fxs-startboard-loading":t.startboardLoading}],"aria-label":r.Dashboard.ariaLabel}),i("div",{className:"fxs-home-target"}),i("div",{className:"fxs-journey-target"},i("div",{className:["fxs-journey-breadcrumb","fxs-portal-bg-txt-br","az-noprint","msportalfx-unselectable","fxs-display-none"]}),i("div",{className:"fxs-journey-layout"}))))}function v(n){return __awaiter(this,void 0,void 0,(function(){var t,r,o,c;return __generator(this,(function(a){switch(a.label){case 0:return[4,Promise.all([MsPortalFx.require("MsPortalImpl/Widgets/Widgets.SideBarFlyout"),MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AllServicesMenu.Component"),l&&MsPortalFx.require("MsPortalImpl/Services/BrowseCuration/AllServicesCardData"),MsPortalFx.require("MsPortalImpl/Services/BrowseCuration/"+s.browseCurationFile).catch((function(n){s.handleInvalidCurationFileError(n)})),])];case 1:return t=a.sent(),r=t[0],o=t[1],c=h.start({source:"AllServicesMenu",action:"AllServicesMenuLoad"}),performance.mark("AllServicesMenuLoadStart"),[2,i(f.GetContext,{fn:function(t){var s=t.diContainer,l=s.get(u.ViewModel),a=o.AllServicesMenu,f=new r.ViewModel;return f.filterInputValue=n.allServicesMenuInput,i("div",{className:"fxs-sidebar-flyout fxs-portal-background",role:"presentation",afterMount:function(n,t){var i=new r.Widget($(n),f,s),u=t.createChildLifetime();i.options.launchBlade=l.launchBlade;i.options.openFavorite=l.openFavorite;t.registerForDispose(i);f.isLoading.subscribeAndRun(u,(function(n){n||(u.dispose(),e.invokeAfterChangePropagation((function(){performance.mark("AllServicesMenuLoadEnd");performance.measure("AllServicesMenuLoad","AllServicesMenuLoadStart","AllServicesMenuLoadEnd");h.completeTrace(c)})))}))}},i(a,{vm:f}))}})]}}))}))}function y(n){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(i){switch(i.label){case 0:return[4,MsPortalFx.require("MsPortalImpl/Weave/Components/SettingsFlyout.Component")];case 1:return t=i.sent(),[2,t.getFlyoutComponent(n)]}}))}))}Object.defineProperty(t,"__esModule",{value:!0});t.Panorama=void 0;var h=MsPortalFx.Base.Diagnostics.Telemetry,c=MsPortalFx.isFeatureEnabled("allservicesweave"),l=MsPortalFx.isFeatureEnabled("allServicesWithOverview");t.Panorama=a}));
define("_generated/MsPortalImpl/Svg/Library/ArrowRight.svg",["require","exports"],(function(){"use strict";return{type:262,data:"<svg viewBox='0 0 14.2 9.7' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M8.6 9l3.7-3.6H0v-1h12.3L8.6.7l.8-.7 4.8 4.9-4.8 4.8z'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Startup/DoubleChevron.svg",["require","exports"],(function(){"use strict";return{type:345,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M14.65 15.53L8 8.88l-6.65 6.65-.7-.71L8 7.47l7.35 7.35-.7.71z'/><path d='M14.65 8.53L8 1.88 1.35 8.53l-.7-.71L8 .47l7.35 7.35-.7.71z'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Startup/Ellipsis.svg",["require","exports"],(function(){"use strict";return{type:176,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M2 7a1 1 0 0 1 .39.08.94.94 0 0 1 .53.53 1 1 0 0 1 0 .78.94.94 0 0 1-.53.53 1 1 0 0 1-.78 0 .94.94 0 0 1-.53-.53 1 1 0 0 1 0-.78.94.94 0 0 1 .53-.53A1 1 0 0 1 2 7zm6 0a1 1 0 0 1 .39.08.94.94 0 0 1 .53.53 1 1 0 0 1 0 .78.94.94 0 0 1-.53.53 1 1 0 0 1-.78 0 .94.94 0 0 1-.53-.53 1 1 0 0 1 0-.78.94.94 0 0 1 .53-.53A1 1 0 0 1 8 7zm6 0a1 1 0 0 1 .39.08.94.94 0 0 1 .53.53 1 1 0 0 1 0 .78.94.94 0 0 1-.53.53 1 1 0 0 1-.78 0 .94.94 0 0 1-.53-.53 1 1 0 0 1 0-.78.94.94 0 0 1 .53-.53A1 1 0 0 1 14 7z'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Startup/Hamburger.svg",["require","exports"],(function(){"use strict";return{type:313,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M1 4.5v-1h14v1zm0 4v-1h14v1zm0 4v-1h14v1z'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Startup/Hyperlink.svg",["require","exports"],(function(){"use strict";return{type:31,data:"<svg viewBox='0 0 16 15' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M14.3 1H10V0h6v6h-1V1.7l-8 8-.7-.7z'/><path d='M11 8v5a.9.9 0 0 1-1 1H2a.9.9 0 0 1-1-1V6a.9.9 0 0 1 1-1h6l1-1H2a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7z'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Startup/Star.svg",["require","exports"],(function(){"use strict";return{type:283,data:"<svg viewBox='0 0 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M6 .3l1.5 4.3 4.5.1-3.6 2.7 1.3 4.3L6 9.1l-3.7 2.6 1.3-4.3L0 4.7l4.5-.1z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Widgets/Widgets.SideBar.Component",["require","exports","Weave/DirectMode","Weave","MsPortalImpl/Widgets/Widgets.SideBar","_generated/MsPortalImpl/Svg/Startup/Hyperlink.svg","_generated/MsPortalImpl/Svg/Startup/Ellipsis.svg","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Services/Services.GeneralSettings","_generated/MsPortalImpl/Svg/Library/ArrowRight.svg","_generated/MsPortalImpl/Svg/Startup/DoubleChevron.svg","_generated/MsPortalImpl/Svg/Startup/Star.svg","_generated/MsPortalImpl/Svg/Startup/Hamburger.svg"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){"use strict";function p(n){function it(n){var i=n.event,t=i.dataTransfer;t&&(t.setData("text","fxs-draganddrop"),t.effectAllowed="move");k=i.currentTarget.getAttribute("data-id")}function b(){(t.hamburgerMode.value||t.layoutMode()!==2)&&t.setCollapsed(!0)}function rt(n){var i=n.event,r=i.currentTarget.parentElement.getAttribute("data-id"),u=t.favorites.value,f=u[w(r,u)];if(MsPortalFx.Base.Diagnostics.Telemetry.trace({source:"SideBar",name:r,action:"SideBarItemOpened",data:{isFavorite:f.isFavorite()}}),h.isCtrlOrCommandOnly(i)||i.shiftKey)return!0;t.openFavorite(f)&&i.preventDefault();b()}var t=n.vm,d=n.className,g=f,nt=e,p=t.isCollapsed,tt=r.composeComputation([t.hamburgerMode,p],(function(n,t){return!n||!t})),k;return i("div",{className:[{"fxs-sidebar-is-collapsed":p},d],role:"presentation",onDragOver:function(n){var t=n.event;t.preventDefault()},onDrop:function(n){var i=n.event,f=i.target,r=$(f).closest(".fxs-sidebar-droppable")[0];i.preventDefault();r&&u.reorderFavorite(r.getAttribute("data-id"),k,t)}},i("nav",{className:"fxs-sidebar-bar msportalfx-shadow-level3","aria-label":s.SideBar.svcNavLabel,onKeyDown:function(n){var t=n.event,i;t.keyCode===32&&h.getModifierKeys(t)!==4&&(i=t.target,i.click(),i.classList.contains("fxs-sidebar-filter-input")||t.preventDefault(),t.stopPropagation())}},i("div",{className:"fxs-sidebar-header"},i("button",{className:"fxs-sidebar-item-link fxs-sidebar-hamburger fxs-sidebar-button",title:s.SideBar.hamburger,"aria-label":s.SideBar.hamburger,onClick:b,ref:t.hamburgerButton},i("div",{className:"fxs-sidebar-icon",image:y})),i("a",{className:"fxs-sidebar-menu-toggle-link",href:"#",title:t.sideBarMenuText,"aria-label":t.sideBarMenuText,onClick:function(n){var i=n.event;i.preventDefault();t.sideBarMenuIsActivated(!t.sideBarMenuIsActivated())}},i("div",{className:"fxs-sidebar-menu-icon fxs-sidebar-icon",image:MsPortalFx.Base.Images.CustomImageWithOptions(l,{palette:99})}),i("div",{className:"fxs-sidebar-menu-text fxs-sidebar-label"},t.sideBarMenuText)),i("div",{className:"fxs-sidebar-divider2"})),i(r.Once,{condition:tt,trueFn:function(){return i(r.Fragment,null,i("div",{className:"fxs-sidebar-top fxs-sidebar-menu-activated-hidden"},i("button",{className:"fxs-sidebar-collapse-button fxs-sidebar-button",title:p.compose((function(n){return n?s.SideBar.expand:s.SideBar.collapse})),image:a,onClick:function(){var i=t.isCollapsed.value,n=!i;t.layoutMode()===2&&t.diContainer.get(c.GeneralSettings).sideBarCollapsedKey(n);t.setCollapsed(n)}}),t.topSectionLinks.map((function(n){return i("a",{className:"fxs-sidebar-item-link "+n.classes,href:n.href,title:n.title,"aria-label":n.title,onClick:function(){n.onClick();b()}},i("div",{className:"fxs-sidebar-icon",image:n.icon}),i("div",{className:"fxs-sidebar-label"},n.text))}))),MsPortalFx.isFeatureEnabled("hidefavoritesdivider")?null:i("div",{className:"fxs-sidebar-favorites-section fxs-sidebar-menu-activated-hidden"},i("div",{className:"fxs-sidebar-divider"}),i("div",{className:"fxs-sidebar-fav-icon",image:v}),i("span",{className:"fxs-sidebar-myfavorites"},s.SideBar.myFavorites),i("div",{className:"fxs-sidebar-divider"})),i("div",{className:"fxs-sidebar-middle fxs-sidebar-menu-activated-hidden"},i("ul",{className:"fxs-sidebar-favorites fxs-sidebar-list","aria-label":s.SideBar.svcList,afterMount:function(n,t){var i=new MutationObserver(function(){var i=n.querySelector('.fxs-sidebar-item-link[tabindex="0"]'),t;i||(t=n.querySelector(".fxs-sidebar-item-link"),t&&t.setAttribute("tabindex","0"))});i.observe(n,{childList:!0});t.registerForDispose((function(){return i.disconnect()}));new o.KeyboardNavigation(t,{element:$(n),tabTriggers:12,itemSelector:".fxs-sidebar-item-link"})}},i(r.ForEach,{collection:t.effectiveFavorites,fn:function(n){var t=n.item;return i("li",{className:"fxs-sidebar-item fxs-sidebar-favorite-item fxs-sidebar-draggable fxs-sidebar-droppable",draggable:"true","data-id":t.id,onDragStart:it},i("a",{tabindex:"-1",className:"fxs-sidebar-item-link",href:t.uri,title:t.label,"aria-label":t.label,onClick:rt},i("div",{className:"fxs-sidebar-icon",image:t.image}),i("div",{className:"fxs-sidebar-label"},t.label),t.opensExternal?i("div",{className:"fxs-sidebar-external",image:g}):null,i("div",{className:"fxs-sidebar-handle",image:nt})),i("div",{className:"fxs-hover-card-balloon",style:{display:"hidden"},"data-name":t.id,"data-source":"SidebarFavorite"}))}}))))}}),i("div",{className:"fxs-sidebar-menu-container"}),i("div",{className:"fxs-sidebar-shadow"})))}function w(n,t){for(var i=0;i<t.length;++i)if(t[i]&&t[i].id===n)return i;return-1}Object.defineProperty(t,"__esModule",{value:!0});t.SideBar=void 0;t.SideBar=p}));
define("MsPortalImpl/Resources/Resources.Images",["require","exports"],(function(n,t){"use strict";function u(n){return function(){return MsPortalFx.getImages(i,n)}}var i,r;Object.defineProperty(t,"__esModule",{value:!0});i=[{MsPortalImpl:[{AdvisorNotifications:[{AdvisorDashboard:["cscz.png","dede.png","enus.png","eses.png","frfr.png","huhu.png","itit.png","jajp.png","kokr.png","nlnl.png","plpl.png","ptbr.png","ptpt.png","ruru.png","svse.png","trtr.png","zhcn.png","zhtw.png"]}]},{AvatarMenu:[{AvatarMenu:["defaultAvatarSmall.png"]}]},{Blade:[{Blade:["icon.gif"]}]},{ControlsWizard:[{ControlsWizard:["loadingImage.gif"]}]},{General:[{FlowLayout:["gridShadow.png"]}]},{Notice:[{Notice:["comingSoon.png","noSubscription.png","unauthorized.png"]}]},{PartError:[{PartError:["icon.png"]}]},{PartGallery:[{PartGallery:["collectionPartWithRollup.svg","collectionSummary.svg","donutChart.svg","donutChartPartial.svg","extensions.svg","gridWithMoreData.svg","map.svg","multiLineChartMultiTrendLine.svg","multiScatterChart.svg","multiStackedBarChart.svg","mutliLineChart.svg","pricingTier.svg","quotaGauge.svg","resourceMap.svg","singleAreaChart.svg","singleAreaChartSingleThreshold.svg","singleAreaChartSingleTrendline.svg","singleBarChartLarge.svg","singleBarChartSmall.svg","singleLineChart.svg","singleScatterChart.svg","singleScatterSingleThreshold.svg","singleValueGauge.svg","splitBarChart.svg","stackedAreaChart.svg"]}]},{ProvisioningPart:[{ProvisioningPart:["running.gif"]}]}]}];r=["AdvisorDashboard","AvatarMenu","Blade","ControlsWizard","FlowLayout","Notice","PartError","PartGallery","ProvisioningPart"];r.forEach((function(n){t["get"+n]=u(n)}))}));
define("MsPortalImpl/Widgets/Widgets.DropMenu.Component",["require","exports","Weave/DirectMode","MsPortalImpl/Widgets/Widgets.DropMenu","Fx/Weave","Weave","FxInternal/Weave/Util"],(function(n,t,i,r,u,f,e){"use strict";function o(n){var r,t=n.vm,h=MsPortalFx.getUniqueId(),o=u.toComputation(t.isMenuOpen),c=o.compose(e.negation),l=MsPortalFx.getUniqueId(),s=u.toComputation(t.buttonDescribedBy);return i("div",{className:"fxs-dropmenu",role:"presentation"},i("button",{id:t.buttonId,"aria-controls":h,className:["fxs-dropmenu-button","fxs-popup-button",t.buttonClass,],"aria-haspopup":"true","aria-expanded":o,title:u.toComputation(t.buttonTooltip),"aria-label":n.buttonLabel||u.toComputation(t.buttonLabel),"aria-describedby":s.compose((function(n){return n?l:null})),onClick:function(n){var i=n.event;i.preventDefault();t.toggle()}},n.button),i(f.If,{condition:s,concealmentBehavior:"remove",trueFn:function(){return i("div",{id:l,className:"az-display-none"},s)}}),i("div",{id:h,className:["fxs-dropmenu-content","fxs-text-link","fxs-popup","fxs-portal-bg-txt-br","msportalfx-shadow-level2",t.alignMenu===0?"fxs-dropmenu-right":"fxs-dropmenu-left",(r={"fxs-dropmenu-is-open":o},r[t.togglesVisibility?"fxs-dropmenu-invisible":"fxs-dropmenu-hidden"]=c,r),],role:"menu","aria-hidden":c,"aria-label":u.toComputation(t.menuLabel),onClick:function(n){var r=n.event,u=r.currentTarget,i=r.target;for(i&&!i.matches&&(Element.prototype.matches=Element.prototype.msMatchesSelector);i&&!i.matches(t.itemSelector)&&i!==u;)i=i.parentElement;i&&i.matches(t.itemSelector)&&t.close()}},n.content))}function s(n){return i("div",{className:n.className,afterMount:function(t,i){i.registerForDispose(new r.Widget($(t),n.vm,!0))}},i(o,{button:n.button,buttonLabel:n.buttonLabel,content:n.content,vm:n.vm}))}Object.defineProperty(t,"__esModule",{value:!0});t.DropMenu=t.DropMenuInner=void 0;t.DropMenuInner=o;t.DropMenu=s}));
define("MsPortalImpl/Widgets/Widgets.AvatarMenu.Component",["require","exports","Weave/DirectMode","MsPortalImpl/Widgets/Widgets.DropMenu.Component","Fx/Weave","Weave","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Resources/Resources.Images"],(function(n,t,i,r,u,f,e,o){"use strict";function s(n){function a(){s=Date.now()}var t=n.vm,v=n.className,s=0,h,c=function(){return h&&h()},l=o.getAvatarMenu().defaultAvatarSmall,y=f.composeComputation([t.userIdentity,t.avatarImage],(function(n,t){return n&&!n.isAnonymous?(t||n.defaultAvatarUri||"").trim()||l:l})),p=i("div",{className:["fxs-avatarmenu-header",{"fxs-avatarmenu-open":u.toComputation(t.dropMenuOptions.isMenuOpen)}],title:t.tooltip,onTouchStart:a,onMouseDown:a,onTouchEnd:c,onMouseUp:c},i("div",{className:"fxs-avatarmenu-tenant-container"},i("div",{className:"fxs-avatarmenu-username"},t.displayName),i("div",{className:"fxs-avatarmenu-tenant"},t.tenantDisplayName)),i("div",{className:"fxs-avatarmenu-tenant-image-container"},i("img",{className:"fxs-avatarmenu-tenant-image",src:y,alt:""}))),w=i("div",{className:"fxs-flyout"});return i(f.GetContext,{fn:function(n){var u=n.diContainer;return i("div",{className:["fxs-avatarmenu",v],afterMount:function(n,i){h=function(){s&&Date.now()-s>t.showDiagnosticsDelay&&MsPortalFx.require("MsPortalImpl/UI/UI.Portal.Actions").then((function(i){i.showDebugPrompt(u,n,t)}));s=0};i.registerForDispose((function(){return h=null}))}},i(r.DropMenuInner,{vm:t.dropMenuOptions,buttonLabel:f.composeComputation([t.displayName,t.tenantDisplayName],(function(n,t){return e.AvatarMenu.label+" "+(t?e.AvatarMenu.userWithTenantLabel.format(t):e.AvatarMenu.userLabel.format(n))})),button:p,content:w}))}})}Object.defineProperty(t,"__esModule",{value:!0});t.AvatarMenu=void 0;t.AvatarMenu=s}));
define("_generated/MsPortalImpl/Svg/Startup/Close.svg",["require","exports"],(function(){"use strict";return{type:55,data:"<svg viewBox='0 0 15.8 15.8' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M8.7 7.9l7.1 7.1-.8.8-7.1-7.1-7.1 7.1L0 15l7.1-7.1L0 .8.8 0l7.1 7.1L15 0l.8.8z'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Startup/Search.svg",["require","exports"],(function(){"use strict";return{type:248,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M10.5 0l1.5.2a3.8 3.8 0 0 1 1.3.6l1.1.8.9 1.1a6.9 6.9 0 0 1 .5 1.3 7.7 7.7 0 0 1 .2 1.5 7.7 7.7 0 0 1-.2 1.5 6.9 6.9 0 0 1-.5 1.3l-.9 1.1-1.1.9-1.3.5-1.5.2a5.8 5.8 0 0 1-1.9-.3 5.4 5.4 0 0 1-1.6-1L.9 15.9H.1a.8.8 0 0 1 0-.8L6.3 9a5.4 5.4 0 0 1-1-1.6A5.8 5.8 0 0 1 5 5.5 7.7 7.7 0 0 1 5.2 4a3.8 3.8 0 0 1 .6-1.3 4.4 4.4 0 0 1 .8-1.1L7.7.8A3.8 3.8 0 0 1 9 .2zm0 10a3.9 3.9 0 0 0 1.8-.4 4.2 4.2 0 0 0 1.4-.9 4.2 4.2 0 0 0 .9-1.4 3.9 3.9 0 0 0 .4-1.8 3.3 3.3 0 0 0-.4-1.7 3.8 3.8 0 0 0-.9-1.5 4.2 4.2 0 0 0-1.4-.9 3.9 3.9 0 0 0-1.8-.4 3.3 3.3 0 0 0-1.7.4 3.8 3.8 0 0 0-1.5.9 3.8 3.8 0 0 0-.9 1.5A3.3 3.3 0 0 0 6 5.5a3.9 3.9 0 0 0 .4 1.8 4.2 4.2 0 0 0 .9 1.4 3.8 3.8 0 0 0 1.5.9 3.3 3.3 0 0 0 1.7.4z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Widgets/Widgets.Search.Component",["require","exports","Weave/DirectMode","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Weave/Util","Fx/Weave","Weave","_generated/MsPortalImpl/Svg/Startup/Search.svg","_generated/MsPortalImpl/Svg/Startup/Close.svg"],(function(n,t,i,r,u,f,e,o,s){"use strict";function h(n){function a(n){n.event.preventDefault();t.isExpanded(!0);l.focus()}var t=n.vm,v=n.className,h=r.KeyboardShortcuts.search,y=f.toComputation(t.filter).compose(u.negation),c=MsPortalFx.isFeatureEnabled("asyncsearch")||MsPortalFx.isFeatureEnabled("globalsearch")?r.Search.globalPlaceholder:r.Search.placeholder,l=new e.ElementRef;return i("div",{className:["fxs-search",v,{"fxs-search-activated":t.isExpanded,"fxs-search-showmenu":f.toComputation(t.showMenu)},],role:"search","aria-label":h},i("div",{className:["fxs-search-wrapper",{"fxs-searching":f.toComputation(t.showSearching)}]},i("div",{"aria-hidden":"true",className:"fxs-search-icon-mini",image:o}),i("div",{className:"fxs-search-box fxs-topbar-input"},i("input",{type:"text",className:"azc-input","aria-label":c,placeholder:c,autocomplete:"off",maxlength:100,ref:l})),i("div",{className:"fxs-search-indicator"},i("div",null),i("div",null),i("div",null)),i("div",{role:"presentation",className:["fxs-search-clear",{"fxs-display-none":y}],image:s})),i("a",{href:"#",className:"fxs-search-icon fxs-topbar-button",role:"button",title:h,"aria-label":h,image:o,onFocus:a,onMouseDown:a}),i("div",{className:"fxs-search-menu fxs-dropmenu-content fxs-portal-background msportalfx-shadow-level4"}))}Object.defineProperty(t,"__esModule",{value:!0});t.Search=void 0;t.Search=h}));
define("MsPortalImpl/Weave/Components",["require","exports","Weave","WeaveDOM/Core/InternalUtil","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Weave/Util"],(function(n,t,i,r,u,f){"use strict";function s(n){return typeof n.content=="string"?h(n.content,n.require,n.skipSanitization||!1):n.content?n.content.compose((function(t){return h(t,n.require,n.skipSanitization||!1)})):void 0}function h(n,t,i){return{type:"html",data:{content:n,moduleName:t.normalize(),skipSanitization:i}}}function c(n){return{type:"external",applyBindingHandler:v,content:n.content,skipSanitization:n.skipSanitization||!1}}function l(n){return i.isComputation(n.content)?n.content.compose((function(t){return e(t,n.require,!1)})):e(n.content,n.require,!1)}function a(n){return i.isComputation(n.content)?n.content.compose((function(t){return e(t,n.require,!0)})):e(n.content,n.require,!0)}function e(n,t,i){return n?typeof n=="string"?i?n:s({skipSanitization:!1,content:n,require:t}):c({skipSanitization:!1,content:n,require:t}):null}function v(t,f,e){var v=f.dynamicNodeId,w=this.skipSanitization,c=t.getDynamicNodeMetadata(v),a=c.selfLtm.innerLtmRoot,s=c.commentStart,h=c.commentEnd,l;i.subscribeAndRun(a,[this.content],(function(i){if(l&&l.dispose(),l=a.createChildLifetime(),o(s,h),t.clear(f),i&&i.htmlTemplate){var v=w?i.htmlTemplate:e.diContainer.get(u.KOAllowedTemplateSanitizer).sanitize({value:i.htmlTemplate,localRequire:n,windowContext:$(s.parentElement),diContainer:e.diContainer,contextData:{weaveCommentNodeText:c.commentStart.textContent}}).sanitizedMarkup;r.insertHtmlBeforeNode(h,v);y(l,i.viewModel,e,(function(n){o(s,h);p(n,s,h)}))}}));a.registerForDispose((function(){o(s,h)}))}function y(n,t,i,r){if(ko.isObservable(t)){var u;t.subscribeAndRun(n,(function(t){if(u&&u.dispose(),u=n.createChildLifetime(),ko.isObservable(t)){var e;t.subscribeAndRun(u,(function(n){e&&e.dispose();e=u.createChildLifetime();r(f.weaveContextToKoContext(i,e,n))}))}else r(f.weaveContextToKoContext(i,u,t))}))}else r(f.weaveContextToKoContext(i,n,t))}function o(n,t){for(var i=n.nextSibling,r;i!==t;)r=i.nextSibling,ko.cleanNode(i),i=r}function p(n,t,i){var e=t.nextSibling,u=e,o=ko.bindingProvider.instance,s=o.preprocessNode,f;if(s){while(u&&u!==i)f=ko.virtualElements.nextSibling(u),s.call(o,u),u=f;u=e}while(u&&u!==i)f=ko.virtualElements.nextSibling(u),(r.isNodeType(u,1)||r.isNodeType(u,8))&&ko.applyBindings(n,u),u=f}Object.defineProperty(t,"__esModule",{value:!0});t.TextOrKo=t.HtmlOrKo=t.Ko=t.ShellHtml=void 0;t.ShellHtml=s;t.Ko=c;t.HtmlOrKo=l;t.TextOrKo=a}));
define("MsPortalImpl/Widgets/Widgets.ToastViewModel",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/PortalNotificationsTelemetry","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","Weave"],(function(n,t,i,r,u,f,e){"use strict";function o(n){var t=n&&n.timeoutID;t&&clearTimeout(t.value)}function s(n){var t,r=((t=n===null||n===void 0?void 0:n.data)===null||t===void 0?void 0:t.value)||null,i=(r||{}).inlineForm;((i===null||i===void 0?void 0:i.buttons)||[]).forEach((function(n){n.id&&n.id.startsWith("ToastClicked")&&(n.id="NotificationClicked"+n.id.substring(12))}))}function c(n,t){var i=Array.isArray(t)?t:[t];i.length&&i.forEach((function(t){var y=n.items.value,w=t.icon,b=t.title,k=t.description,d=t.descriptionAsHtml,g=t.uri,nt=t.time,r=t.ids||[],h=t.data||null,f=t.duration||0,tt=t.htmlContent||"",it=t.clickable!==!1,rt=t.descriptiveText||u.Toast.description.format(t.title),ut=t.notificationId,i,s;if(f!==3){if(r.length>0&&(i=MsPortalFx.find(y,(function(n){var t=n.ids.value;return r.some((function(n){return t.indexOf(n)>-1}))}))),i)i.icon(w),i.title(b),i.description(k),i.descriptionAsHtml(d),i.uri(g),i.time(nt),i.ids(r),i.data(h),i.clickable(it),i.htmlContent(tt),i.descriptiveText(rt),i.duration(f),i.formSection(t.formSection),o(i),n.startRemoveTimer(i);else{s={icon:e.makeWritableComputation(w),title:e.makeWritableComputation(b),description:e.makeWritableComputation(k),descriptionAsHtml:e.makeWritableComputation(d),uri:e.makeWritableComputation(g),time:e.makeWritableComputation(nt),ids:e.makeWritableComputation(r),data:e.makeWritableComputation(h),htmlContent:e.makeWritableComputation(tt),timeoutID:e.makeWritableComputation(null),clickable:e.makeWritableComputation(it),onDismissFn:t.onDismissFn,descriptiveText:e.makeWritableComputation(rt),duration:e.makeWritableComputation(f),formSection:e.makeWritableComputation(t.formSection),notificationId:ut};(y.length<n.displayCount||p(n,f))&&n.items.unshift(s);var c=(h||{}).inlineForm,ft=t.formSection,v=ft&&ft.buttons;v&&c&&MsPortalFx.isArrayOrObservableArray(c.buttons)&&c.buttons.forEach((function(t,i){if(!t.endpoint){var r=v[i].onClick;v[i].onClick=function(){r();n.removeToast(s)}}}));n.startRemoveTimer(s)}MsPortalFx.Base.Diagnostics.Telemetry.trace({source:l.ToastTray,action:a.ToastAdded,data:{notificationId:ut}});n.addOSToast&&n.addOSToast(t)}}))}function p(n,t){for(var i,u,f=n.items.value,r=0;r<=t+0;r++)for(i=f.length-1;i>=0;i--)if(u=f[i],u.duration.value===r)return n.removeToast(u),!0;return!1}var h;Object.defineProperty(t,"__esModule",{value:!0});t.addToasts=t.ViewModel=t.clearItemTimeout=void 0;var l=r.Source,a=r.Action,v=5e3,y=3e4;t.clearItemTimeout=o;h=(function(t){function r(n){n===void 0&&(n={});var i=t.call(this)||this;return i.items=e.makeArrayComputation(),i.eventHandlers=ko.observableArray(),i.addOSToast=null,i.displayCount=n.displayCount||4,i}return __extends(r,t),r.create=function(){return new r},r.prototype.addToasts=function(n){c(this,n)},r.prototype.removeToast=function(n){o(n);s(n);this.items.remove(n)},r.prototype.removeAllToasts=function(){this.items.value.forEach((function(n){o(n);s(n)}));this.items.clear()},r.prototype.startRemoveTimer=function(n){var i=this,t=n.duration?n.duration.value:0;t!==2&&n.timeoutID(setTimeout((function(){i.items.remove(n);s(n)}),t===1?y:v))},__decorate([__metadata("fx:diagnostics",[n,"ViewModel"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",r)],r,"create",null),r})(f.ViewModel);t.ViewModel=h;t.addToasts=c}));
define("MsPortalImpl/Widgets/Widgets.Toast.Component",["require","exports","MsPortalImpl/Widgets/Widgets.ToastViewModel","Weave/DirectMode","_generated/MsPortalImpl/Svg/Startup/Close.svg","MsPortalImpl/Resources/PortalNotificationsTelemetry","WeaveDOM/DirectRender/DataAttribute","Weave","FxInternal/Weave/Util","Fx/Weave","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Weave/Components","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){"use strict";function b(t){var v=MsPortalFx.getFeatureValue("rapidtoasts"),f,y;return v==="0"||v==="true"?null:(f=t.vm,y=t.className,r(o.GetContext,{fn:function(t){var b=t.diContainer,v=h.toComputation(b.get(c.GeneralSettings).notificationToastEnabledKey);return r(o.Once,{condition:o.composeComputation([v,f.items],(function(n,t){return n&&t&&t.length>0})),trueFn:function(){return r("div",{role:"presentation",className:y,afterMount:function(n,t){var i=$(n);f.eventHandlers.map(t,(function(n,t){n.registerForDispose(i.setEvents([t.events,t.selector,function(n){return t.handler(n,e.getElementData($(n.target).closest(".fxs-toast-item")[0]))},]))}))}},r("ul",{role:"presentation",className:["fxs-toast",{"fxs-display-none":v.compose(s.negation)}]},r(o.ForEach,{collection:f.items,fn:function(t){var e=t.item,s=function(){return i.clearItemTimeout(e)},h=function(){return e.duration&&f.startRemoveTimer(e)};return r("li",{data:e,className:"fxs-toast-item fxs-popup fxs-portal-bg-txt-br msportalfx-shadow-level4",role:"alert","aria-live":"polite","aria-atomic":"true","aria-label":e.descriptiveText,onFocusIn:s,onFocusOut:h,onMouseEnter:s,onMouseLeave:h},r(o.If,{condition:e.htmlContent,concealmentBehavior:"remove",trueFn:function(){return r("div",{className:"fxs-toast-content","aria-hidden":"true"},r(a.ShellHtml,{content:e.htmlContent,skipSanitization:!0,require:n}))},falseFn:function(){return r("div",{className:"fxs-toast-wrapper"},r("div",{className:"fxs-toast-header"},r("div",{className:"fxs-toast-icon",image:e.icon}),r(o.If,{condition:e.clickable,concealmentBehavior:"remove",trueFn:function(){return r("a",{href:"#",className:"fxs-toast-title fxs-toast-link",onClick:function(n){var t=n.event;(t.preventDefault(),e.clickable.value)&&(MsPortalFx.Base.Diagnostics.Telemetry.trace({source:p.ToastTray,action:w.ToastClicked,data:{notificationId:e.notificationId||e.data&&e.data.value.notificationId}}),$(t.currentTarget).trigger("fxtoastclick"),f.removeToast(e))}},e.title)},falseFn:function(){return r("div",{className:"fxs-toast-title fxs-portal-text"},e.title)}})),r(o.If,{condition:e.descriptionAsHtml,concealmentBehavior:"remove",trueFn:function(){return r("div",{className:"fxs-toast-description fxs-portal-title"},r(a.ShellHtml,{content:e.description,skipSanitization:!1,require:n}))},falseFn:function(){return r("div",{className:"fxs-toast-description fxs-portal-title"},e.description)}}),e.formSection?e.formSection.compose((function(n){return n?n.section("msportalfx-form fxs-notification-inlineform"):null})):null)}}),r("button",{className:"fxs-toast-close fxs-portal-svg","aria-label":l.NotificationMenu.dismissToast,image:u,title:l.NotificationMenu.dismissToast,onClick:function(n){var t=n.event;t.preventDefault();e.onDismissFn?e.onDismissFn():MsPortalFx.Base.Diagnostics.Telemetry.trace({source:p.ToastTray,action:w.ToastDismissed,data:{notificationId:e.notificationId}});f.removeToast(e)}}))}})))}})}}))}Object.defineProperty(t,"__esModule",{value:!0});t.Toast=void 0;v.injectCss(y);var p=f.Source,w=f.Action;t.Toast=b}));
define("_generated/MsPortalImpl/Svg/Internal/UpdateIcon.svg",["require","exports"],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 14 14' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><circle cx='7' cy='7' r='6.5' fill='none' stroke='#000'/><g fill='none' stroke='#000' clip-path='url(#clip0)'><path d='M4.778 6.611L7 4.39l2.222 2.22M7 4.389v5.778'/><\/g><defs><clipPath id='clip0'><path d='M3 3.5h8v8H3z' class='msportalfx-svg-c01'/><\/clipPath><\/defs><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Startup/Bug.svg",["require","exports"],(function(){"use strict";return{type:391,data:"<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><rect width='10' height='12' x='4' y='5' fill='none' stroke='#000' rx='5'/><path fill='none' stroke='#000' d='M14 8.25a2 2 0 0 1 2 2v1.5m-14 0v-1.5a2 2 0 0 1 2-2M14.5 2.5V4a2 2 0 0 1-2 2H12M6 6h-.5a2 2 0 0 1-2-2V2.5m10.5 10a3 3 0 0 1 0 4m-10 0a3 3 0 0 1 0-4M6 1l1.5 1.5M12 1l-1.5 1.5M7.65 5.4a2 2 0 0 1 0-3 2 2 0 0 1 2.7 0 2 2 0 0 1 0 3'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Startup/Chevron.svg",["require","exports"],(function(){"use strict";return{type:158,data:"<svg viewBox='0 0 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M8.2 6l-5.5 5.5.6.5 6-6-6-6-.6.5z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Widgets/Widgets.TopBar.Component",["require","exports","Weave","MsPortalImpl/Resources/ImplScriptResources","_generated/MsPortalImpl/Svg/Startup/Bug.svg","_generated/MsPortalImpl/Svg/Startup/Hamburger.svg","_generated/MsPortalImpl/Svg/Library/ArrowRight.svg","_generated/MsPortalImpl/Svg/Startup/Chevron.svg","_generated/MsPortalImpl/Svg/Internal/UpdateIcon.svg","MsPortalImpl/Services/Services.GeneralSettings","Weave/DirectMode","MsPortalImpl/Widgets/Widgets.Search.Component","MsPortalImpl/Widgets/Widgets.AvatarMenu.Component","MsPortalImpl/Widgets/Widgets.Toast.Component","FxInternal/Weave/Util","Fx/Weave","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.AuthStateManager","Fx/Weave/Components/Button"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){"use strict";function ut(n){var t=n.vm,o=ft(),nt=o.electronActions,tt=o.historyActions,it=t.loadingIdList.compose(y.isEmptyArray);return c(i.LifetimeManagerScoped,{fn:function(n){return c(i.GetContext,{fn:function(o){var ut=o.diContainer,ft=ut.get(FxImpl.Features),ht=ft.isEnabled("canmodifyextensions"),at=ut.get(b.AuthStateManager),ct=ft.getValue("showbugreportlink"),vt=ct==="force"||ct==="true"&&at.isMicrosoftOrAmeTenant&&!ft.isEnabled("ci"),et=i.makeWritableComputation(),ot=i.makeWritableComputation(),st,lt;return ut.get(h.GeneralSettings).landingPage.subscribeAndRun(n,(function(){var n=h.isLandingPageDashboard(ut);et(n?r.Dashboard.defaultTitle:r.AzureHome.home);ot(n?"#dashboard":"#home")})),st=function(){d("CustomizeModeExited",{dashboardChanged:!!t.dashboardChanged.value,onDashboard:!!t.dashboardVisible.value});t.exitOrganizeMode()},lt=ut.get(w.DesktopManagerMode).value,c("div",{className:["fxs-topbar az-noprint msportalfx-unselectable",{"fxs-topbar-devmode fxs-bg-warning":ht,"fxs-topbar-dashboard-changed":t.dashboardChanged.compose((function(n){return n&&!g})),"fxs-topbar-dashboard-visible":t.dashboardVisible.compose((function(n){return n&&!g})),"fxs-topbar-search-activated":t.searchViewModel.isExpanded},],role:"presentation"},g?null:c(i.Once,{condition:p.toComputation(lt).compose((function(n){return n===1})),trueFn:function(){return c("div",{className:"fxs-topbar-exit-customize"},c("div",{className:"fxs-topbar-exit-customize-message"},r.TopBar.exitCustomizeText),c(k.Button,{className:"fxs-topbar-exit-customize-button",text:r.ShellCommands.exitOrganizeMode,onClick:st,style:0}))}}),c("div",{className:["fxs-topbar-content",{"fxs-hide-in-customize":!g}],role:"banner","aria-labelledby":"bannerlabel"},rt.chrome.hideSidebarNav?null:c("a",{href:"#","aria-label":r.TopBar.hamburger,title:r.TopBar.hamburger,className:["fxs-topbar-sidebar-collapse-button","fxs-topbar-button msportalfx-svg-flip-horizontal fxs-topbar-search-activated-hidden"],image:f,role:"button",onClick:function(n){var t=n.event;t.preventDefault();d("TopBarHamburgerButtonClicked");$(t.currentTarget).trigger("fxtogglesidebar")},onKeyDown:function(n){var t=n.event;t.keyCode===32&&($(t.currentTarget).trigger("click"),t.preventDefault(),t.stopPropagation())}}),c("div",{className:"fxs-topbar-history-container"},tt.map((function(n){return c("a",{href:"#",className:["fxs-topbar-button",n.classNames],role:"button",title:n.name,"aria-label":n.name,image:p.toValueOrComputation(n.icon),onClick:function(t){var i=t.event;i.preventDefault();n.clickHandler()}})}))),ft.getValue("internalonly")!=="false"?c("a",{className:"fxs-topbar-preview fxs-topbar-home fxs-topbar-search-activated-hidden",id:"bannerlabel",title:et,href:ot,role:"link",onClick:function(){return d("BannerButtonClicked")}},c("div",{className:"fxs-topbar-internal fxs-internal-short"},r.TopBar.internalText),c("div",{className:"fxs-topbar-internal fxs-internal-full"},fx.environment.branding.productName," (",r.TopBar.internalText,")")):c("h1",{className:"fxs-topbar-brand fxs-topbar-search-activated-hidden",id:"bannerlabel"},c("a",{className:"fxs-topbar-home",title:et,href:ot,role:"link"},fx.environment.branding.productName)),ht?c("a",{className:"fxs-topbar-exitdevmode fxs-topbar-debug-button fxs-topbar-search-activated-hidden",href:"#",role:"button",onClick:function(n){var i=n.event;i.preventDefault();t.exitDevMode()}},r.TopBar.exitDevModeLinkText):null,vt?c("a",{href:"#",className:"fxs-topbar-reportbug fxs-topbar-debug-button fxs-topbar-search-activated-hidden",role:"button",title:r.TopBar.reportBugTitle,"aria-label":r.TopBar.reportBug,onClick:function(n){var i=n.event;i.preventDefault();t.reportBug()}},c("span",{className:"fxs-topbar-reportbug-icon",image:u}),c("span",{className:"fxs-topbar-reportbug-text"},r.TopBar.reportBug)):null,c(i.If,{condition:t.canUpgradeSubscription,concealmentBehavior:"remove",trueFn:function(){return c("a",{href:t.upgradeableSubscription.compose((function(n){return"#blade/Microsoft_Azure_Billing/SubscriptionUpgradeBlade/azureSubscriptionId/"+n.subscriptionId+"/appId/AzPortal_UpgradeBtn"})),className:"fxs-topbar-upgradebutton fxs-topbar-search-activated-hidden",role:"button",title:r.TopBar.upgradeText,"aria-label":r.TopBar.upgradeButtonText,onClick:function(){MsPortalFx.Base.Diagnostics.Telemetry.trace({action:"FreeTrialUpgradeClicked",source:"TopBar",data:{subscriptionId:t.upgradeableSubscription.value.subscriptionId,creditsRemaining:t.upgradeableSubscription.value.remaining}})}},c("span",{className:"fxs-topbar-upgradebutton-icon",image:s}),c("span",{className:"fxs-topbar-upgradebutton-text"},r.TopBar.upgradeButtonText))}}),c("div",{className:"fxs-topbar-placeholder fxs-topbar-search-activated-hidden"}),c("a",{href:"#",tabindex:"-1",className:"fxs-search-back-icon fxs-topbar-button msportalfx-svg-flip-horizontal",role:"button",title:r.TopBar.back,"aria-label":r.TopBar.back,image:e,onClick:function(n){var t=n.event;return t.preventDefault()}}),c(l.Search,{className:"fxs-topbar-search",vm:t.searchViewModel}),c("div",{className:"fxs-topbar-buttons-container fxs-topbar-search-activated-hidden"},t.actionDefinitions.map((function(n){return n.showNotification?c("div",{className:p.toComputation(n.active||ko.observable(!1)).compose((function(t){return n.classNames+(t?" fxs-topbar-active":"")})),onClick:function(t){var i=t.event;i.preventDefault();n.clickHandler()}},c("a",{href:"#",className:"fxs-topbar-button",role:"button",title:n.name,"aria-label":n.name,image:p.toValueOrComputation(n.icon)}),c("div",{className:"fxs-notificationspane-progressbar fxs-display-none"},c("div",null)),p.toComputation(n.showNotification).compose((function(n){return n?c("div",{className:"fxs-notificationspane-button-unreadcount fxs-notificationspane-button-unreadcount-circle"}):null}))):c("a",{href:"#",className:["fxs-topbar-button",n.classNames],role:"button",title:n.name,"aria-label":n.name,"aria-expanded":n.ariaExpanded,"aria-controls":n.ariaControls,image:p.toValueOrComputation(n.icon),onClick:function(t){var i=t.event;i.preventDefault();n.clickHandler()}})}))),c(v.Toast,{className:"fxs-topbar-toast",vm:t.toastViewModel}),c("div",{className:"fxs-topbar-actionsmenu fxs-topbar-search-activated-hidden"}),c(a.AvatarMenu,{className:["fxs-topbar-avatarmenu","fxs-topbar-search-activated-hidden"],vm:t.avatarMenuVM}),c("div",{className:"fxs-topbar-electron-container"},nt.map((function(n){return c("a",{href:"#",className:["fxs-topbar-button",n.classNames],role:"button",title:n.name,"aria-label":n.name,image:p.toValueOrComputation(n.icon),onClick:function(t){var i=t.event;i.preventDefault();n.clickHandler()}})})))),g?null:c(i.Once,{condition:t.dashboardChanged,trueFn:function(){var h=t.dashboardWritable.compose((function(n){return n?r.TopBar.saveDashboardButton:r.TopBar.saveDashboardCopyButton})),l=t.dashboardWritable.compose((function(n){return n?r.TopBar.saveMessage:r.TopBar.saveCopyMessage})),f=t.displayMode,n=p.toComputation(t.isInOrganizeMode),u=f.compose((function(n){return n!=="Dashboard"})),e=i.composeComputation([n,u],(function(n,t){return!n&&t})),o=f.compose((function(n){return n==="Dashboard"})),s=o.compose(y.negation),a=i.composeComputation([n,u,o],(function(n,t,i){return!n&&!t&&i}));return c("div",{className:"fxs-topbar-dashboard"},c("div",{className:"fxs-topbar-dashboard-message"},l),c(k.Button,{className:["fxs-topbar-dashboard-done-customize",{"fxs-display-none":n.compose(y.negation)}],text:r.TopBar.exitCustomizeButton,onClick:st,style:0,visible:n}),c("a",{href:"#dashboard",className:["fxs-button fxs-topbar-dashboard-view",{"fxs-display-none":u.compose(y.negation),"fxs-portal-button-primary":e,"fxs-button-default":e.compose(y.negation)}],onClick:function(){return d("DashboardView")}},r.TopBar.viewDashboardButton),c(k.Button,{className:["fxs-topbar-dashboard-save",{"fxs-display-none":s}],text:h,style:a.compose((function(n){return n?0:1})),onClick:function(){var n=t.dashboardWritable.value,i=n?1:2,r=n?"DashboardPublish":"DashboardSaveACopy";d(r);t.finishDashboardEdit(i)}}),c(k.Button,{className:["fxs-topbar-dashboard-discard",{"fxs-display-none":s}],text:r.TopBar.discardDashboardButton,style:1,onClick:function(){d("DashboardDiscard");t.finishDashboardEdit(3)}}))}}),c("div",{className:["fxs-loading5dots-container fxs-blade-progress-translucent",{"fxs-display-none":it}]},c("div",null),c("div",null),c("div",null),c("div",null),c("div",null)))}})}})}function d(n,t){tt.Diagnostics.Telemetry.trace({source:"TopBar",action:n,data:t})}function ft(){var n=window.portalAppApi,i=window.nodeRequire&&window.nodeRequire("electron"),u=[],f=[];if(n||i){var e=ko.observable(),h=nt.Restore(),c=nt.Maximize(),t=!n&&i.remote.getCurrentWindow(),s=function(){return(n||t)&&e((n||t).isMaximized()?h:c)};s();window.addEventListener("resize",s);u=[{name:r.TopBar.minimize,icon:nt.Minimize(),classNames:"",clickHandler:function(){return(n||t).minimize()}},{name:r.TopBar.maximize,icon:e,classNames:"",clickHandler:function(){return n?n.maximizeOrUnmaximize():t.isMaximized()?t.unmaximize():t.maximize()}},{name:r.TopBar.close,icon:nt.Close(),classNames:"fxs-topbar-close",clickHandler:function(){return(n||t).close()}},];f=[{name:r.TopBar.back,icon:o,classNames:"fxs-topbar-back",clickHandler:function(){return window.history.back()}},{name:r.TopBar.forward,icon:o,classNames:"",clickHandler:function(){return window.history.forward()}},];MsPortalFx.require("MsPortalImpl/Electron/ContextMenu")}return{electronActions:u,historyActions:f}}Object.defineProperty(t,"__esModule",{value:!0});t.TopBar=void 0;var tt=MsPortalFx.Base,nt=tt.Images,it=window,rt=it.fx.environment,g=MsPortalFx.isFeatureEnabled("dashboardsaveexperience");t.TopBar=ut}));
define("MsPortalImpl/Widgets/Widgets.Portal.html",["require","exports","Weave/DirectMode","Weave","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Widgets/Widgets.SideBar.Component","MsPortalImpl/Widgets/Widgets.ContextPane.Component","MsPortalImpl/Widgets/Widgets.Panorama.Component","MsPortalImpl/Widgets/Widgets.ContextMenu.Component","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Widgets/Widgets.TopBar.Component","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Services/Services.Storage"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";function w(n,t,a,v){var rt=window.fx.getTimestamp(),ut=l.isIOS&&!l.isSafari&&MsPortalFx.getEnvironmentValue("branding").iosAppId&&!k(a),ft=l.isIe&&MsPortalFx.isFeatureEnabled("iedeprecatedbanner")&&!d(a),et=a.get(FxImpl.Features).isEnabled("outagebanner"),ot=a.get(FxImpl.Features).isEnabled("infobanner"),st=i(r.PromiseFragment,{promise:g(ot)}),y,w,it;t.contextMenuViewModel.registerForCleanup(v);y=i(r.Fragment,null,ut?i(r.PromiseFragment,{promise:b()}):null,i(r.PromiseFragment,{promise:p(!1)}),st,i(c.TopBar,{vm:t.topBar}),i("div",{className:"fxs-global-notification-banner fxs-blade-statusbg fxs-bg-warning az-noprint"},et?i(r.PromiseFragment,{promise:nt(a)}):null),ft?i(r.PromiseFragment,{promise:tt()}):null,i("div",{className:"fxs-portal-tip az-noprint"}),i("div",{className:["fxs-portal-main",{"fxs-topbar-dashboard-changed":t.topBar.dashboardChanged}]},i(f.SideBar,{className:"fxs-sidebar az-noprint msportalfx-unselectable",vm:t.sideBar}),i(o.Panorama,{vm:t.panorama}),i(e.ContextPane,{className:"fxs-portal-contextpane-right msportalfx-shadow-level3",vm:t.rightContextPane}),i(e.ContextPane,{className:"fxs-portal-contextpane-shell msportalfx-shadow-level3",vm:t.shellContextPane})),i("div",{className:"fxs-portal-console az-noprint",id:"consoleRegionId",role:"presentation"}),i(s.ContextMenu,{className:"fxs-commands-contextMenu az-noprint",vm:t.contextMenuViewModel}),i(r.PromiseFragment,{promise:p(!0)}));w=window.fx.getTimestamp();u.applyToElement({element:n,ltm:v,weaveNode:y,weaveContext:{diContainer:a},opName:"portal"});it=a.get(h.PortalStartupMarkers);it.portalTsx={beforeStart:rt,tsxFnEnd:w}}function b(){return __awaiter(this,void 0,void 0,(function(){var n;return __generator(this,(function(t){switch(t.label){case 0:return[4,MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AppBanner.Component")];case 1:return n=t.sent().AppBanner,[2,i(n,null)]}}))}))}function k(n){var t=n.get(a.StorageService).getValue(a.ComponentName.AppBanner,"dismiss",0);return t&&parseInt(t)>=Date.now()-6048e5}function d(n){var t=n.get(a.StorageService).getValue(a.ComponentName.IEBanner,"dismiss",0);return t&&parseInt(t)>=Date.now()-12096e5}function g(n){return __awaiter(this,void 0,void 0,(function(){var t,r,u;return __generator(this,(function(f){switch(f.label){case 0:return n?[4,MsPortalFx.Base.Security.getUserInfo()]:[3,3];case 1:return(t=f.sent(),r=!!~y.indexOf(t===null||t===void 0?void 0:t.directoryId),!r)?[3,3]:[4,MsPortalFx.require("MsPortalImpl/Widgets/Widgets.GlobalInfoBanner.Component")];case 2:return u=f.sent().GlobalInfoBanner,[2,i(u,null)];case 3:return[2,null]}}))}))}function p(n){return __awaiter(this,void 0,void 0,(function(){var r,t,u;return __generator(this,(function(f){switch(f.label){case 0:return[4,MsPortalEarly.preload];case 1:return(r=f.sent(),t=r&&r.securityClassification,!t)?[3,3]:[4,MsPortalFx.require("MsPortalImpl/Widgets/Widgets.GlobalSecurityBanner.Component")];case 2:return u=f.sent().GlobalSecurityBanner,[2,n?i("div",{className:"fxs-global-security-banner-bottom"},i(u,{classification:t})):i("div",{className:"fxs-global-security-banner-top"},i(u,{classification:t}))];case 3:return[2,null]}}))}))}function nt(n){return __awaiter(this,void 0,void 0,(function(){var t,r,u;return __generator(this,(function(f){switch(f.label){case 0:return[4,MsPortalEarly.preload];case 1:return t=f.sent(),r=t&&t.outages||[],[4,MsPortalFx.require("MsPortalImpl/Widgets/Widgets.GlobalNotificationBanner.Component")];case 2:return u=f.sent().GlobalNotificationBanner,[2,i(u,{notifications:r,container:n})]}}))}))}function tt(){return __awaiter(this,void 0,void 0,(function(){var n;return __generator(this,(function(t){switch(t.label){case 0:return[4,MsPortalFx.require("MsPortalImpl/Widgets/Widgets.IEDeprecatedBanner.Component")];case 1:return n=t.sent().IEDeprecatedBanner,[2,i(n,null)]}}))}))}var v,y;Object.defineProperty(t,"__esModule",{value:!0});t.renderPortal=void 0;y=((v=fx===null||fx===void 0?void 0:fx.environment)===null||v===void 0?void 0:v.writesDisallowedTenants)||[];t.renderPortal=w}));
define("MsPortalImpl/Widgets/Widgets.AsyncSearch",["require","exports","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","Weave","Weave/Core/Computation","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s,h,c;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.ViewModel=t.searchBoxClass=t.searchClass=void 0;e.injectCss(o);t.searchClass="fxs-search";t.searchBoxClass="fxs-search-box";s=i.Search;h=(function(n){function t(){var t=n.call(this)||this;return t._ltm=new FxImpl.TriggerableLifetimeManager,t._dropdownInitialized=Q.defer(),t.isExpanded=u.makeWritableComputation(!1),t.showMenu=ko.observable(!1),t.showResults=ko.observable(!1),t.showSearching=ko.observable(!1),t.showAllSubscriptionsSearch=ko.observable(!1),t.showChangeSubscriptions=ko.observable(!1),t.isSearchComplete=ko.observable(!1),t.text=s,t.filter=ko.observable(""),t.searchInFilterText=ko.observable(),t.subscriptionSummary=ko.observable(),t.mruItems=ko.observableArray(),t.searchHistory=ko.observableArray(),t.recentServices=ko.observableArray(),t.additionalSearchProviders=ko.observableArray(),t.leftPanel=ko.observableArray(),t.rightPanel=ko.observableArray(),t.pillsCollection=ko.observable(),t.currentPill=ko.observable(),t.isPillsInSearchEnabled=MsPortalFx.isFeatureEnabled("pillsinglobalsearch"),t.menuId=MsPortalFx.getUniqueId(),t}return __extends(t,n),t.prototype.isDropdownInitialized=function(){return this._dropdownInitialized.promise},t.prototype.dispose=function(){this._ltm.dispose()},t.prototype.setFocus=function(){this._widget&&this._widget.setFocus()},t.prototype.setWidget=function(n){this._widget=n},t.prototype.getWidget=function(){return this._widget},t.prototype.getRootElement=function(){return this._widget.element},t})(r.ViewModel);t.ViewModel=h;c=(function(n){function i(i,r,u){var f=n.call(this,i,r,!0)||this,e,o;return f._documentCategoryDisplayName=s.documentation,r.setWidget(f),r.showMenu.subscribe(f.ltm,(function(n){n||(r.filter(""),f._textField&&f._textField.val(""))})),window.fx.environment.chrome.hideSearchBox&&i.addClass("fxs-display-none"),f._textField=$(i[0].querySelector("."+t.searchBoxClass+" input")),e=function(){o.dispose();r.showMenu(!0);MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AsyncSearchDeferred").then((function(n){n.initialize(f.ltm,u,r,f._textField);r._dropdownInitialized.resolve()}))},i[0].addEventListener("focusin",e),o=f.ltm.createChildLifetime(),o.registerForDispose((function(){return i[0].removeEventListener("focusin",e)})),f}return __extends(i,n),i.prototype.setFocus=function(){var t=this,n;this.options.isExpanded(!0);n=document.activeElement;f.invokeAfterChangePropagation((function(){n===document.activeElement&&t._textField.focus()}))},i})(r.Widget);t.Widget=c}));
define("MsPortalImpl/Services/Services.FavoritesSettings",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.SettingsProcessor","FxInternal/AsyncLoader","FxInternal/DirectoryManagement","Fx/Telemetry"],(function(n,t,i,r,u,f,e,o){"use strict";var h,s,c;Object.defineProperty(t,"__esModule",{value:!0});t.saveUserDirectorySettingsHandler=t.getUserDirectorySettingsHandler=t.UserDirectorySettings=t.UserDirectorySettingsManager=t.FavoritesSettings=t.FavoritesSettingsManager=void 0;var v=MsPortalFx.Base.Diagnostics.createLog(n),l=!1,a=(function(t){function f(){return t!==null&&t.apply(this,arguments)||this}return __extends(f,t),f.create=function(n){return u.create(f,n,new h,8,!0)},__decorate([__metadata("fx:diagnostics",[n,"FavoritesSettingsManager"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[r.SettingsManager]),__metadata("design:returntype",Object)],f,"create",null),f})(u.SettingsProcessor);t.FavoritesSettingsManager=a;h=(function(){function t(){this.favorites=ko.observable("");this.version=ko.observable(0)}return t.create=function(n){return n.value},__decorate([__metadata("fx:diagnostics",[n,"FavoritesSettings"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[a]),__metadata("design:returntype",t)],t,"create",null),t})();t.FavoritesSettings=h;s=(function(t){function f(){return t!==null&&t.apply(this,arguments)||this}return __extends(f,t),f.create=function(n){return u.create(f,n,new c,7,!0)},__decorate([__metadata("fx:diagnostics",[n,"UserDirectorySettingsManager"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[r.SettingsManager]),__metadata("design:returntype",Object)],f,"create",null),f})(u.SettingsProcessor);t.UserDirectorySettingsManager=s;c=(function(){function t(){this.favoriteDirectoriesList=ko.observableArray();this.userDefaultDirectory=ko.observable();this.signInToLastVisitedDirectory=ko.observable(!0);this.recentDirectoriesList=ko.observableArray()}return t.create=function(n){return n.value},t.prototype.addRecentDirectory=function(n){if(!l&&n){var i=n.toLowerCase(),t=this.recentDirectoriesList(),r=t.indexOf(i);r>-1&&t.splice(r,1);t.unshift(i);this.recentDirectoriesList(t.slice(0,3));l=!0}},__decorate([__metadata("fx:diagnostics",[n,"UserDirectorySettings"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s]),__metadata("design:returntype",t)],t,"create",null),t})();t.UserDirectorySettings=c;t.getUserDirectorySettingsHandler=f.defineHandler(e.getUserDirectorySettingsEndPoint,(function(n){var t=n.diContainer.get(s).value;return o.trace({source:"Services.FavoritesSettings",action:"getUserDirectorySettingsRpc",data:{callingExtension:n.messageContext.srcWindowId}}),Q({favoriteDirectoriesList:t.favoriteDirectoriesList(),userDefaultDirectory:t.userDefaultDirectory()})}));t.saveUserDirectorySettingsHandler=f.defineHandler(e.saveUserDirectorySettingsEndPoint,(function(n){var t=n.messageArg,u=!1,i=Object.create(null),r,f,e;i.callingExtension=n.messageContext.srcWindowId;try{r=n.diContainer.get(s).value;t.favoriteDirectoriesList&&(i.newFavoritesCount=t.favoriteDirectoriesList.length,i.oldFavoritesCount=r.favoriteDirectoriesList().length,r.favoriteDirectoriesList(t.favoriteDirectoriesList));t.userDefaultDirectory&&(f=r.userDefaultDirectory(),e=f&&f.id,e!==t.userDefaultDirectory.id&&(i.oldDefaultId=e,i.newDefaultId=t.userDefaultDirectory.id,r.userDefaultDirectory(t.userDefaultDirectory)));u=!0}catch(h){v.error('Failed to save user directory settings. Error: "'+MsPortalFx.getLogFriendlyMessage(h)+'"')}return o.trace({source:"Services.FavoritesSettings",action:"saveUserDirectorySettingsRpc",data:MsPortalFx.extend(i,{saveSuccess:u})}),Q(u)}))}));
define("_generated/MsPortalImpl/Svg/Library/Feedback.svg",["require","exports"],(function(){"use strict";return{type:228,data:"<svg viewBox='0 0 16 14' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M11.8 0a4.5 4.5 0 0 1 1.6.3l1.4.9.9 1.4a4.7 4.7 0 0 1 .3 1.7 4.5 4.5 0 0 1-.3 1.6 4.2 4.2 0 0 1-.9 1.4L8 14 1.2 7.3a4.2 4.2 0 0 1-.9-1.4A4.5 4.5 0 0 1 0 4.3a4.7 4.7 0 0 1 .3-1.7l.9-1.4L2.6.3A4.7 4.7 0 0 1 4.3 0h1.1l.9.5a2.4 2.4 0 0 1 .9.6L8 2l.8-.8a2.4 2.4 0 0 1 .9-.6l.9-.5zM14 6.5a2.5 2.5 0 0 0 .8-1 5 5 0 0 0 .2-1.2 2.8 2.8 0 0 0-.3-1.3 2.4 2.4 0 0 0-.6-1 2.6 2.6 0 0 0-1.1-.7L11.8 1l-1.2.2-1 .6-.8.7-.8.9-.8-.8-.9-.8-.9-.6L4.3 1a2.8 2.8 0 0 0-1.3.3 3.9 3.9 0 0 0-1.1.6A3.9 3.9 0 0 0 1.3 3 2.8 2.8 0 0 0 1 4.3a5 5 0 0 0 .2 1.2 2.5 2.5 0 0 0 .8 1l6 6.1z'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Library/LaunchCurrent.svg",["require","exports"],(function(){"use strict";return{type:227,data:"<svg viewBox='0 0 16 15' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M14.3 1H10V0h6v6h-1V1.7l-8 8-.7-.7z'/><path d='M11 8v5a.9.9 0 0 1-1 1H2a.9.9 0 0 1-1-1V6a.9.9 0 0 1 1-1h6l1-1H2a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7z'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Library/Mail.svg",["require","exports"],(function(){"use strict";return{type:267,data:"<svg viewBox='0 0 16 10' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M16 0v10H0V0zm-1 9V2.1L8 5.6 1 2.1V9zM1.1 1L8 4.4 14.9 1z'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Library/Person.svg",["require","exports"],(function(){"use strict";return{type:44,data:"<svg viewBox='0 0 14 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M9.4 9.4a6.9 6.9 0 0 1 1.9 1 7.5 7.5 0 0 1 1.5 1.6 5.6 5.6 0 0 1 .9 1.9A7.1 7.1 0 0 1 14 16h-1a6.4 6.4 0 0 0-.5-2.4 7.6 7.6 0 0 0-1.2-1.9 7.6 7.6 0 0 0-1.9-1.2A6.4 6.4 0 0 0 7 10l-1.6.2-1.5.6-1.2.9-.9 1.2-.6 1.5A7.8 7.8 0 0 0 1 16H0a8.3 8.3 0 0 1 .3-2.2 6.4 6.4 0 0 1 1-1.8 7 7 0 0 1 1.4-1.6l1.9-1-1.1-.8-.8-1a5 5 0 0 1-.5-1.3A5.1 5.1 0 0 1 2 5a4.1 4.1 0 0 1 .4-1.9 3.8 3.8 0 0 1 1.1-1.6A3.8 3.8 0 0 1 5.1.4 4.1 4.1 0 0 1 7 0a4.1 4.1 0 0 1 1.9.4 3.8 3.8 0 0 1 1.6 1.1 3.8 3.8 0 0 1 1.1 1.6A4.1 4.1 0 0 1 12 5a5.1 5.1 0 0 1-.2 1.3 5 5 0 0 1-.5 1.3l-.8 1zM3 5a4.1 4.1 0 0 0 .3 1.6 3.4 3.4 0 0 0 .9 1.2 3.4 3.4 0 0 0 1.2.9A4.1 4.1 0 0 0 7 9a4.1 4.1 0 0 0 1.6-.3 3.4 3.4 0 0 0 1.2-.9 3.4 3.4 0 0 0 .9-1.2A4.1 4.1 0 0 0 11 5a4.1 4.1 0 0 0-.3-1.6 3.4 3.4 0 0 0-.9-1.2 3.4 3.4 0 0 0-1.2-.9A4.1 4.1 0 0 0 7 1a4.1 4.1 0 0 0-1.6.3 3.4 3.4 0 0 0-1.2.9 3.4 3.4 0 0 0-.9 1.2A4.1 4.1 0 0 0 3 5z'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Library/Signout.svg",["require","exports"],(function(){"use strict";return{type:226,data:"<svg viewBox='0 0 14 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M9.2 2.3l1.9 1a12.1 12.1 0 0 1 1.6 1.6 6.6 6.6 0 0 1 .9 1.9A5.7 5.7 0 0 1 14 9a12.3 12.3 0 0 1-.2 1.9 8 8 0 0 1-.8 1.6 3.8 3.8 0 0 1-1.1 1.4 3.8 3.8 0 0 1-1.4 1.1l-1.6.8L7 16l-1.9-.2-1.6-.8a3.8 3.8 0 0 1-1.4-1.1A3.8 3.8 0 0 1 1 12.5a4.6 4.6 0 0 1-.7-1.6A6.3 6.3 0 0 1 0 9a5.7 5.7 0 0 1 .4-2.2 6.6 6.6 0 0 1 .9-1.9 12.1 12.1 0 0 1 1.6-1.6l1.9-1 .4 1a4.6 4.6 0 0 0-1.7.9 5.7 5.7 0 0 0-1.4 1.3 8 8 0 0 0-.8 1.6A5.8 5.8 0 0 0 1 9a7.8 7.8 0 0 0 .2 1.6l.6 1.4a4 4 0 0 0 1 1.2 4 4 0 0 0 1.2 1l1.4.6L7 15l1.6-.2 1.4-.6a4 4 0 0 0 1.2-1 4 4 0 0 0 1-1.2l.6-1.4A7.8 7.8 0 0 0 13 9a5.8 5.8 0 0 0-.3-1.9 8 8 0 0 0-.8-1.6 5.7 5.7 0 0 0-1.4-1.3 4.6 4.6 0 0 0-1.7-.9zM7.5 8h-1V0h1z'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Startup/DirectoryFilter.svg",["require","exports"],(function(){"use strict";return{type:392,data:"<svg viewBox='0 0 19.723 20' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M3.578 0a1.766 1.766 0 0 0-.744.166A2.153 2.153 0 0 0 2.217.6a2.13 2.13 0 0 0-.433.621 1.762 1.762 0 0 0-.165.739V4H0v1.418h1.619v6.589H0v1.415h1.619v2.044a1.893 1.893 0 0 0 .154.762 1.969 1.969 0 0 0 .42.623 1.944 1.944 0 0 0 .625.421 1.91 1.91 0 0 0 .75.152h7.459v-1.415H6.485V1.416h9.13v6h1.415V0zm1.5 16.009H3.7a.645.645 0 0 1-.26-.051.686.686 0 0 1-.212-.144.711.711 0 0 1-.145-.214 1.861 1.861 0 0 1-.047-.387v-1.791h.7v-1.415h-.7V5.418h.7V4h-.7V2.084a.493.493 0 0 1 .054-.22.88.88 0 0 1 .39-.391.5.5 0 0 1 .22-.057h1.382z'/><path d='M19.514 8.63H8.826v1.894l.061.061 3.454 4.442V20h3.867v-4.973l3.454-4.442.061-.061V8.63zm-4.637 5.755l-.061.061v4.164h-1.085v-4.168l-.061-.061-3.376-4.364h7.961z'/><\/g><\/svg>"}}));
define("MsPortalImpl/ViewModels/AvatarMenuCommon",["require","exports","_generated/MsPortalImpl/Svg/Startup/DirectoryFilter.svg","_generated/MsPortalImpl/Svg/Library/Feedback.svg","MsPortalImpl/Resources/ImplScriptResources","_generated/MsPortalImpl/Svg/Library/LaunchCurrent.svg","_generated/MsPortalImpl/Svg/Library/Mail.svg","_generated/MsPortalImpl/Svg/Library/Person.svg","_generated/MsPortalImpl/Svg/Library/Signout.svg","MsPortalImpl/Widgets/Widgets.WidgetBase","Weave"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ViewModel=void 0;var l=MsPortalFx.Base,a=l.Images,v=fx.environment,y=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.avatarImage=c.makeWritableComputation(),t.contactInfoEnabled=ko.observable(!1),t.hideTenant=c.makeWritableComputation(),t.icons={contactInfo:e,feedback:r,launchCurrent:f,person:a.CustomImageWithOptions(o,{palette:99}),signout:s,switchDirectory:i},t.links=v.links,t.listOfTenants=c.makeArrayComputation(),t.showDiagnosticsDelay=2e3,t.text=u.AvatarMenu,t.userIdentity=c.makeWritableComputation(),t.userInfo=c.makeWritableComputation(),t}return __extends(t,n),t})(h.ViewModel);t.ViewModel=y}));
define("MsPortalImpl/Widgets/Widgets.SimpleAvatarMenuFlyout",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Common","Weave"],(function(n,t,i,r,u,f,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Widget=void 0;var o="fxs-avatarmenu-dropdown",s=i("div",{"class":"fxs-avatarmenu-dropdown"},i("ul",{"class":"fxs-avatarmenu-list-system fxs-portal-border fxs-dropmenu-line-separator",role:"presentation"},i("li",{"class":"fxs-portal-hover",role:"presentation"},i("a",{href:"","class":"fxs-avatarmenu-signout fxs-avatarmenu-dropdown-item",role:"menuitem","data-bind":{attr:{title:"data.text.signOutLabel"}}},i("div",{"class":"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.signOutLabel"}}),i("div",{"class":"fxs-dropmenu-image fxs-fill-error","data-bind":{image:"data.icons.signout"}})))),i("div",{"class":"fxs-avatarmenu-scrollviewer"},i("div",{"class":"fxs-avatarmenu-list-system"},i("ul",{role:"presentation"},i("li",{"class":"fxs-portal-hover","data-bind":{visible:"changePasswordLink"},role:"presentation"},i("a",{tabindex:"-1","class":"fxs-avatarmenu-changepassword fxs-avatarmenu-dropdown-item",role:"menuitem",target:"_blank",rel:"noopener noreferrer","data-bind":{attr:{href:"changePasswordLink",title:"data.text.changePasswordLabel"}}},i("div",{"class":"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.changePasswordLabel"}}),i("div",{"class":"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"data.icons.launchCurrent"}}))),i("li",{"class":"fxs-portal-hover","data-bind":{visible:"data.contactInfoEnabled"},role:"presentation"},i("a",{tabindex:"-1","class":"fxs-avatarmenu-contactinfo fxs-avatarmenu-dropdown-item",role:"menuitem",href:""},i("div",{"class":"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.contactInfo"}}),i("div",{"class":"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"data.icons.contactInfo"}}))),i("li",{"class":"fxs-portal-hover",role:"presentation"},i("a",{tabindex:"-1","class":"fxs-avatarmenu-myaccess fxs-avatarmenu-dropdown-item",role:"menuitem",href:""},i("div",{"class":"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.myAccessLabel"}}),i("div",{"class":"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"data.icons.person"}}))),i("li",{"class":"fxs-portal-hover","data-bind":{visible:"!!data.links.submitAnIdea"},role:"presentation"},i("a",{tabindex:"-1","class":"fxs-avatarmenu-feedback fxs-avatarmenu-dropdown-item",role:"menuitem",href:"",target:"_blank",rel:"noopener noreferrer","data-bind":{attr:{href:"data.links.submitAnIdea",title:"data.text.feedbackLabel"}}},i("div",{"class":"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.feedbackLabel"}}),i("div",{"class":"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"data.icons.feedback"}}))),i("li",{"class":"fxs-portal-hover","data-bind":{visible:"data.links.accountPortal"},role:"presentation"},i("a",{tabindex:"-1","class":"fxs-avatarmenu-billing fxs-avatarmenu-dropdown-item",role:"menuitem",href:"",rel:"noopener noreferrer"},i("div",{"class":"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.billingLabel"}}),i("div",{"class":"fxs-dropmenu-image fxs-portal-svg","data-bind":{visible:"data.links.accountPortal && data.links.accountPortal.startsWith('#')"}}))),i(r.KoIf,{condition:"showSwitchDirectoryOption"},i("li",{"class":"fxs-portal-hover",role:"presentation"},i("a",{tabindex:"-1","class":"fxs-avatarmenu-switchdirectory fxs-avatarmenu-dropdown-item",role:"menuitem",href:""},i("div",{"class":"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.switchDirectoryLabel"}}),i("div",{"class":"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"data.icons.switchDirectory"}})))))))),h=(function(n){function t(t,i){var r=n.call(this,t,i)||this,f=r.ltm,u;return t.html(s),u=ko.observable(),e.subscribeAndRun(f,[i.userIdentity],(function(n){n&&u(n.changePasswordUri)})),r._bindDescendants({changePasswordLink:u,showSwitchDirectoryOption:!MsPortalFx.isFeatureEnabled("hideswitchdiroption")}),r._attachEventHandlers(),r}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(o);n.prototype.dispose.call(this)},t.prototype._attachEventHandlers=function(){var n=this.options,i=n.links,r=this.element,t="click";this.ltm.registerForDispose(r.setEvents([t,".fxs-avatarmenu-signout",function(t){n.signedOut();t.preventDefault()}],[t,".fxs-avatarmenu-billing",function(t){n.openAccountPortal();i.accountPortal.startsWith("#")&&t.preventDefault()}],[t,".fxs-avatarmenu-switchdirectory",function(t){t.preventDefault();n.switchDirectory()}],[t,".fxs-avatarmenu-myaccess",function(t){t.preventDefault();n.showMyAccessBlade()}],[t,".fxs-avatarmenu-contactinfo",function(t){t.preventDefault();n.showContactInfoBlade()}]))},t.prototype.setFocus=function(){var n=this;f.waitForBindings(this.element[0]).then((function(){n.element.find(".fxs-avatarmenu-signout").focus()}))},t})(u.Widget);t.Widget=h}));
define("MsPortalImpl/Widgets/Widgets.AvatarMenu",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/ViewModels/AvatarMenuCommon","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.SimpleAvatarMenuFlyout","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Services/Services.FavoritesSettings","Weave","FxInternal/Weave/Util","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";function g(n){return(n||"").toLowerCase()}function st(n){var t=n.firstName||"",i=n.lastName||"";return!t&&!i||y.test(t)&&y.test(i)?"":u.AvatarMenu.displayNameFormat.format(t,i)}function ht(n,t){return h.composeComputation([n.userIdentity,n.hideTenant,n.listOfTenants,],(function(i,r,u){var c,e,s,h,l;if(!i)return"";var o=n.text.Tooltip,a=o.tenant,f=[];return(i.firstName||i.lastName)&&f.push(o.name.format(i.firstName||"",i.lastName||"")),c=FxImpl.features.isEnabled("displaypreferredusername")?i.preferredUsername||i.emailAddress:i.emailAddress,c&&f.push(o.email.format(c)),r||(e=MsPortalFx.find(u,(function(n){return i.tenantId===n.id})),e&&!r&&(f.push(a.format(e.displayName,e.id)),s=e.domainName||"",h=i.tenantDomain,f.push(h&&g(s)!==g(h)?a.format(s,h):o.domain.format(s)))),l=f.join("\n"),t(l),l}))}var y,nt,tt;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.ViewModel=void 0;l.injectCss(a);var it=MsPortalFx.Base,p=it.Diagnostics,v=p.Telemetry,rt=fx.environment,w=rt.meControl,ut=p.createLog(n),b="TopBar",k=v.start,ft=v.endTrace,d=v.completeTrace,et=i("div",{"class":"fxs-flyout","data-bind":{stopBindings:"true"}}),ot=i("div",{"class":"fxs-avatarmenu-header","data-bind":{attr:{title:"tooltip"},css:{"fxs-avatarmenu-open":"isMenuOpen"}}},i("div",{"class":"fxs-avatarmenu-tenant-container"},i("div",{"class":"fxs-avatarmenu-username","data-bind":{text:"displayName"}}),i("div",{"class":"fxs-avatarmenu-tenant","data-bind":{text:"currentTenantDisplayName"}})),i("div",{"class":"fxs-avatarmenu-tenant-image-container"},i("img",{"class":"fxs-avatarmenu-tenant-image","data-bind":{attr:{src:"avatarUri"}},alt:""})));y=/^(f(irst)?|l(ast)?)\s?name$/i;nt=(function(n){function t(){var t=n.call(this)||this;return t.displayName=t.userIdentity.compose((function(n){n=n||{};var i=FxImpl.features.isEnabled("displaypreferredusername")?n.preferredUsername||n.emailAddress:n.emailAddress;return i||st(n)||t.text.defaultDisplayName})),t.tenantDisplayName=h.makeWritableComputation(""),t.dropMenuOptions=new o.ViewModel(ot,et,".fxs-avatarmenu-dropdown-item"),t.dropMenuOptions.buttonId="fxs-avatarmenu-button",t.dropMenuOptions.buttonClass="fxs-menu-account",t.tooltip=ht(t,t.dropMenuOptions.buttonTooltip),t}return __extends(t,n),t})(r.ViewModel);t.ViewModel=nt;tt=(function(n){function t(t,i,r){var u=n.call(this,t,i,!0)||this,e,v,f,a,l;return u._isMeControlOpen=ko.observable(!1),u.meControlState=0,e=u.ltm,v=c.hasValueAsync(e,i.userIdentity),!MsPortalFx.isFeatureEnabled("usesimpleavatarmenu")&&w.baseUri&&w.aadAuthority&&(u.meControlState=1),a=i.dropMenuOptions,u._dropMenuWidget=new o.Widget(t,a,!0,!0),a.isMenuOpen.subscribe(e,(function(n){var t=u.element.findByClassName("fxs-flyout"),o=function(n,i){var r=u.element.find("#mectrl_main_body").parent().parent();r.remove();ft(i,"failed",{message:n.message,stack:n.stack});ut.warning(MsPortalFx.getLogFriendlyMessage(n));u.meControlState=2;f&&f.dispose();u._loadSimpleAvatarMenu(t)},i;u.meControlState===1?!f&&n&&(i=k({source:b,action:"MeControlAvatarMenuOpen"}),v.then((function(n){return MsPortalFx.require("MsPortalImpl/Widgets/Widgets.MeControl").then((function(o){return f=new o.Widget(t,u.options,r,n,u._isMeControlOpen),e.registerForDispose(f),f.getInitializedPromise().then((function(){d(i)}))}))})).catch((function(n){o(n,i)}))):u._loadSimpleAvatarMenu(t)})),l=i.tenantDisplayName,c.hasValueAsync(e,i.userInfo).then((function(n){var u=n.directoryId&&n.directoryId.toLowerCase(),t=n.uniqueDirectoryName||"";i.hideTenant.value?l(""):t&&t.toLowerCase()!==u?l(t):r.getAsync(s.UserDirectorySettings).then((function(n){var t=n.userDefaultDirectory()||{};(t.id||"").toLowerCase()===u&&l(t.displayName)}))})),h.subscribe(u.ltm,[i.displayName,l],(function(){u.trigger("fxavatartextchange")})),u}return __extends(t,n),t.prototype._loadSimpleAvatarMenu=function(n){var t=k({source:b,action:"SimpleAvatarMenuOpen"});this._simpleFlyout||(this._simpleFlyout=new f.Widget(n,this.options),this.ltm.registerForDispose(this._simpleFlyout));this._dropMenuWidget.setFocus();d(t)},t.prototype.dispose=function(){this._dropMenuWidget.dispose();this._cleanElementClasses(["fxs-avatarmenu"]);n.prototype.dispose.call(this)},t.prototype.getDropMenuOpenObservable=function(){return this.meControlState===1?this._isMeControlOpen:this._dropMenuWidget.options.isMenuOpen},t})(e.Widget);t.Widget=tt}));
define("MsPortalImpl/Widgets/Widgets.Search",["require","exports","_generated/MsPortalImpl/Svg/Startup/Hyperlink.svg","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/MsPortalImpl/Svg/Startup/Search.svg","_generated/MsPortalImpl/Svg/Startup/Close.svg","_generated/MsPortalImpl/Svg/Startup/Chevron.svg","Weave","Weave/Core/Computation","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";var a,v,y;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.ViewModel=t.searchBoxClass=t.searchClass=void 0;c.injectCss(l);t.searchClass="fxs-search";t.searchBoxClass="fxs-search-box";a=r.Search;v=(function(n){function t(){var t=n.call(this)||this;return t._ltm=new FxImpl.TriggerableLifetimeManager,t._dropdownInitialized=Q.defer(),t.isExpanded=s.makeWritableComputation(!1),t.showMenu=ko.observable(!1),t.showResults=ko.observable(!1),t.showSearching=ko.observable(!1),t.showExternalColumn=ko.observable(!1),t.showAllSubscriptionsSearch=ko.observable(!1),t.showChangeSubscriptions=ko.observable(!1),t.icons={search:f,close:e,chevron:o,hyperlink:i},t.text=a,t.filter=ko.observable(),t.searchInFilterText=ko.observable(),t.subscriptionSummary=ko.observable(),t.mruItems=ko.observableArray(),t.results=ko.observableArray(),t}return __extends(t,n),t.prototype.initOptions=function(n){this._initOptions=n},t.prototype.isDropdownInitialized=function(){return this._dropdownInitialized.promise},t.prototype.dispose=function(){this._ltm.dispose()},t.prototype.setFocus=function(){this._widget&&this._widget.setFocus()},t.prototype.setWidget=function(n){this._widget=n},t.prototype.getWidget=function(){return this._widget},t.prototype.getRootElement=function(){return this._widget.element},t})(u.ViewModel);t.ViewModel=v;y=(function(n){function i(i,r){var u=n.call(this,i,r)||this,f;return r.setWidget(u),window.fx.environment.chrome.hideSearchBox&&i.addClass("fxs-display-none"),u._textField=$(i[0].querySelector("."+t.searchBoxClass+" input")),f=function(){i.off("focusin",f);r.showMenu(!0);var n=r._initOptions;(n&&n()||Q()).then((function(){MsPortalFx.require("MsPortalImpl/Widgets/Widgets.SearchDefered").then((function(n){r._dropdownInitialized.resolve();n.initialize(u.ltm,r,u._textField)}))}))},u.ltm.registerForDispose(i.setEvents(["focusin",f])),u}return __extends(i,n),i.prototype.setFocus=function(){var t=this,n;this.options.isExpanded(!0);n=document.activeElement;h.invokeAfterChangePropagation((function(){n===document.activeElement&&t._textField.focus()}))},i})(u.Widget);t.Widget=y}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.TopbarActionsMenu.css",["module"],(function(n){"use strict";return{css:".fxs-topbaractions-item{display:flex}.fxs-topbaractions-item .fxs-dropmenu-image{padding-left:10px}.fxs-topbaractions-flyout{max-height:calc(100vh - 40px);overflow-x:hidden;overflow-y:auto}",moduleId:n.id}}));
define("MsPortalImpl/Widgets/Widgets.TopbarActionsMenu",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.DropMenu","_generated/MsPortalImpl/Svg/Startup/Ellipsis.svg","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.TopbarActionsMenu.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.ViewModel=void 0;e.injectCss(o);var h=i("div",{"class":"fxs-topbaractions-dropmenu"}),c=i("div",{"class":"fxs-topbaractions-button fxs-topbar-button","data-bind":{image:"ellipsis",css:{"fxs-topbar-active":"isMenuOpen"}}}),l=i("div",{"class":"fxs-topbaractions-flyout"},i("ul",{"class":"fxs-topbaractions-list-commands",role:"presentation","data-bind":{foreach:"topbarActions"}},i("li",{"class":"fxs-portal-hover",role:"presentation"},i("a",{href:"#","class":"fxs-topbaractions-item",role:"menuitem","data-bind":{attr:{"aria-label":"name",title:"name"},css:"classNames",click:"clickHandler"}},i("div",{"class":"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"name"}}),i("div",{"class":"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"icon"}}))))),a=".fxs-topbaractions-item",v="fxs-topbaractions-dropmenu",y=(function(n){function t(t){var i=n.call(this)||this;return i.ariaLabel=ko.observable(),i.dropMenuOptions=new u.ViewModel(c,l,a),i.topbarActions=t||[],i}return __extends(t,n),t})(r.ViewModel);t.ViewModel=y;s=(function(n){function t(t,i){var r=n.call(this,t,i)||this,e=r.element;return e.html(h),i.dropMenuOptions.setItemFocusWhenOpen=!0,i.dropMenuOptions.buttonTooltip(i.ariaLabel()),i.dropMenuOptions.buttonLabel(i.ariaLabel()),r.ltm.registerForDispose(new u.Widget(t.findByClassName(v),i.dropMenuOptions,!1,!0)),ko.applyBindingsToDescendants({topbarActions:i.topbarActions,ellipsis:f,isMenuOpen:i.dropMenuOptions.isMenuOpen},e[0]),r}return __extends(t,n),t.prototype.openMenu=function(n){(n===void 0&&(n=!0),this.element.hasClass("fxs-display-none"))||(n||(this.options.dropMenuOptions.autoDismissMenu=!1),this.options.dropMenuOptions.open(),n||(this.options.dropMenuOptions.autoDismissMenu=!0))},t.prototype.closeMenu=function(){this.options.dropMenuOptions.close()},t})(r.Widget);t.Widget=s}));
define("_generated/MsPortalImpl/Svg/Library/Gear.svg",["require","exports"],(function(){"use strict";return{type:103,data:"<svg viewBox='0 0 15.9 15.9' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M13.9 7.7V8l2 1.3-1.2 3-2.4-.3-.3.3.5 2.4-3 1.2-1.3-2h-.5l-1.3 2-3-1.2.6-2.4-.4-.3-2.4.5-1.2-3 2-1.3v-.4L0 6.4l1.2-3 2.4.6a.8.8 0 0 1 .4-.4l-.6-2.4 3-1.2 1.3 2h.5l1.3-2 3 1.2-.5 2.4.3.4 2.4-.6 1.2 3zm-.9 1V7.2l1.8-1.1-.7-1.7-2.1.5a1.2 1.2 0 0 0-.5-.5 1.2 1.2 0 0 0-.5-.5l.5-2.1-1.7-.7-1.1 1.8H7.2L6.1 1.1l-1.7.7.5 2.1a1.2 1.2 0 0 0-.5.5 1.2 1.2 0 0 0-.5.5l-2.1-.5-.7 1.7 1.8 1.1v1.5L1.1 9.8l.7 1.7 2.1-.5.5.5.5.5-.5 2.1 1.7.7L7.2 13h1.5l1.1 1.8 1.7-.7L11 12l.5-.5.5-.5 2.1.5.7-1.7zM8 5l1.1.2a2.2 2.2 0 0 1 .9.7 3.1 3.1 0 0 1 .7.9 4.3 4.3 0 0 1 .2 1.2 4.3 4.3 0 0 1-.2 1.1 2.2 2.2 0 0 1-.7.9 2.2 2.2 0 0 1-.9.7l-1.1.2-1.2-.2a3.1 3.1 0 0 1-.9-.7 2.2 2.2 0 0 1-.7-.9A4.3 4.3 0 0 1 5 8a4.3 4.3 0 0 1 .2-1.2 3.1 3.1 0 0 1 .7-.9 3.1 3.1 0 0 1 .9-.7zm0 5h.8l.6-.5.5-.6A2.5 2.5 0 0 0 10 8a2.8 2.8 0 0 0-.1-.9l-.5-.6-.6-.4a1.3 1.3 0 0 0-.8-.2 1.5 1.5 0 0 0-.9.2l-.6.4-.4.6a1.5 1.5 0 0 0-.2.9 1.3 1.3 0 0 0 .2.8l.4.6.6.5z'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Startup/Console.svg",["require","exports"],(function(){"use strict";return{type:333,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M15 2v12H1V2h14m1-1H0v14h16V1z'/><path d='M12.5 12h-4c-.3 0-.5-.2-.5-.5s.2-.5.5-.5h4c.3 0 .5.2.5.5s-.2.5-.5.5zM7.8 8.1s0-.1 0 0v-.5L3.7 4.3c-.2-.2-.5-.2-.7 0-.2.3-.1.6.1.7l3.5 3-3.5 3c-.2.2-.2.5-.1.7.1.1.2.2.4.2.1 0 .2 0 .3-.1l3.9-3.3v-.1c.2-.2.2-.2.2-.3 0 .1 0 0 0 0z'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Startup/DirectoryFilteredSet.svg",["require","exports"],(function(){"use strict";return{type:393,data:"<svg viewBox='0 0 19.723 20' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M19.514 8.63H8.826v1.894l.061.061 3.454 4.442V20h3.867v-4.973l3.454-4.442.061-.061V8.63zm-4.637 5.755l-.061.061v4.164h-1.085v-4.168l-.061-.061-3.376-4.364h7.961z'/><path d='M13.67 14.381l.061.061v4.168h1.086v-4.164l.06-.061 3.378-4.369h-7.962l3.377 4.365z' class='msportalfx-svg-c33'/><path d='M3.578 0a1.766 1.766 0 0 0-.744.166A2.153 2.153 0 0 0 2.217.6a2.13 2.13 0 0 0-.433.621 1.762 1.762 0 0 0-.165.739V4H0v1.418h1.619v6.589H0v1.415h1.619v2.044a1.893 1.893 0 0 0 .154.762 1.969 1.969 0 0 0 .42.623 1.944 1.944 0 0 0 .625.421 1.91 1.91 0 0 0 .75.152h7.459v-1.415H6.485V1.416h9.13v6h1.415V0zm1.5 16.009H3.7a.645.645 0 0 1-.26-.051.686.686 0 0 1-.212-.144.711.711 0 0 1-.145-.214 1.861 1.861 0 0 1-.047-.387v-1.791h.7v-1.415h-.7V5.418h.7V4h-.7V2.084a.493.493 0 0 1 .054-.22.88.88 0 0 1 .39-.391.5.5 0 0 1 .22-.057h1.382z'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Startup/Feedback.svg",["require","exports"],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 2048 2048' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M958 1328q101 40 184 106t142 153 91 187 33 210v64h-128v-64q0-119-45-224t-124-183-183-123-224-46q-119 0-224 45t-183 124-123 183-46 224v64H0v-64q0-109 32-210t92-187 142-152 184-107q-45-31-81-72t-61-88-38-100-14-108q0-93 35-174t96-142 142-96 175-36q93 0 174 35t142 96 96 142 36 175q0 55-13 107t-39 100-61 89-81 72zm-254-48q66 0 124-25t101-68 69-102 26-125q0-66-25-124t-69-101-102-69-124-26q-66 0-124 25t-102 69-69 102-25 124q0 66 25 124t68 102 102 69 125 25zM2048 0v1024h-256l-384 384v-384h-128V896h256v203l203-203h181V128H640v230q-32 4-64 10t-64 18V0h1536z'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Startup/Help.svg",["require","exports"],(function(){"use strict";return{type:130,data:"<svg viewBox='2 2 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M8 2a6 6 0 1 1 0 12A6 6 0 0 1 8 2zm0 1a5 5 0 1 0 0 10A5 5 0 0 0 8 3zm0 7.5A.75.75 0 1 1 8 12a.75.75 0 0 1 0-1.5zm0-6a2 2 0 0 1 2 2c0 .73-.212 1.14-.754 1.708l-.264.27C8.605 8.87 8.5 9.082 8.5 9.5a.5.5 0 0 1-1 0c0-.73.212-1.14.754-1.708l.264-.27C8.895 7.13 9 6.918 9 6.5a1 1 0 0 0-2 0 .5.5 0 0 1-1 0 2 2 0 0 1 2-2z'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Startup/Notifications.svg",["require","exports"],(function(){"use strict";return{type:342,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M14 12v1h-4a2.4 2.4 0 0 1-.2.8l-.4.6-.6.4-.8.2-.8-.2-.6-.4-.4-.6A2.4 2.4 0 0 1 6 13H2v-1h1V6a5.9 5.9 0 0 1 .2-1.3 6.1 6.1 0 0 1 .5-1.2 3.9 3.9 0 0 1 .8-1 3.9 3.9 0 0 1 1-.8l1.2-.5L8 1l1.3.2 1.2.5a3.9 3.9 0 0 1 1 .8 3.9 3.9 0 0 1 .8 1 6.1 6.1 0 0 1 .5 1.2A5.9 5.9 0 0 1 13 6v6zm-2 0V6a4.5 4.5 0 0 0-.3-1.6 2.7 2.7 0 0 0-.9-1.2 2.7 2.7 0 0 0-1.2-.9 4.4 4.4 0 0 0-3.2 0 2.7 2.7 0 0 0-1.2.9 2.7 2.7 0 0 0-.9 1.2A4.5 4.5 0 0 0 4 6v6zm-4 2h.4l.3-.2.2-.3A.7.7 0 0 0 9 13H7a.6.6 0 0 0 .1.4l.2.3.3.2z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Widgets/Widgets.TopBar",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","Weave","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.AvatarMenu","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Search","MsPortalImpl/Widgets/Widgets.AsyncSearch","MsPortalImpl/Widgets/Widgets.TopbarActionsMenu","_generated/MsPortalImpl/Svg/Library/Gear.svg","_generated/MsPortalImpl/Svg/Startup/Console.svg","_generated/MsPortalImpl/Svg/Startup/DirectoryFilter.svg","_generated/MsPortalImpl/Svg/Startup/DirectoryFilteredSet.svg","_generated/MsPortalImpl/Svg/Startup/Feedback.svg","_generated/MsPortalImpl/Svg/Startup/Help.svg","_generated/MsPortalImpl/Svg/Startup/Notifications.svg","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Base/Base.Events","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/Services/Services.Subscriptions","Fx/Weave","MsPortalImpl/Widgets/Widgets.Portal.State","MsPortalImpl/Widgets/Widgets.ToastViewModel","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft){"use strict";function et(n,t){var i=(t?n.findByClassName(t):n)[0];return i?i.offsetWidth:0}function ti(n,t){var i=[];return yt&&i.push({name:ht.console,icon:a,classNames:"fxs-topbar-console",ariaExpanded:!1,ariaControls:"consoleRegionId",clickHandler:function(){t.settingsFlyoutState(0);t.consoleButtonClick()}}),st("hidedirectorypanebutton")||ct.chrome.hideDirectoryPaneButton||i.push({name:st("settingsflyout")?f.UiSettings.Flyout.directoriesTitle:gt.title,icon:t.directoryFilterIcon,classNames:"fxs-topbar-directory fxs-menu-directory",clickHandler:function(){t.settingsFlyoutState(0);t.directoryButtonClick&&t.directoryButtonClick()}}),ct.chrome.hideNotificationButton||i.push({name:ht.notifications,icon:b,classNames:"fxs-topbar-notifications",clickHandler:function(){t.settingsFlyoutState(0);t.notificationButtonClick&&t.notificationButtonClick()},showNotification:ko.observable(!1)}),i.push({name:ht.settings,icon:l,classNames:["fxs-topbar-settings fxs-menu-settings",{"fxs-topbar-active":t.settingsFlyoutState}],clickHandler:function(){t.settingsButtonClick&&t.settingsButtonClick()}}),ct.chrome.hideHelpButton||i.push(n.get(lt)),dt&&i.push({name:ht.feedback,icon:p,classNames:"fxs-topbar-feedback fxs-menu-feedback",clickHandler:function(){t.settingsFlyoutState(0);t.feedbackButtonClick&&t.feedbackButtonClick()}}),i}function ii(n){var e,l,k,ot;n.topbarWidth-=n.electronWidth+n.historyWidth;var t=n.topbarWidth,st=n.commandIconsWidth,o=n.searchBarWidth,s=o.min,ht=o.max,ct=o.collapsed,h=o.margin,d=n.avatarMenuWidth,lt=d.normal,at=d.imageOnly,i=n.others,vt=i.debugModeWidth,g=i.reportBugExpendedWidth,yt=i.reportBugIconWidth,pt=i.previewWidth,wt=i.previewShortWidth,bt=i.sidebarHamburgerWidth,kt=i.upgradeIconWidth,a=i.upgradeExpandedWidth,v=800,nt=0,y=g>0?g+7:0,p=yt>0?33:0,w=a>0?a+7:0,tt=kt>0?33:0,it=bt+n.logoWidth+n.others.previewWidth+vt+y+w+7,b=h+st+lt,rt=h+40+at,r=it+v+b,u=r-y-w+p+tt-v+s,f=u-b+rt,ut=f-s-h+40,ft=ut-pt+wt,et=ft-p,dt=et-tt,c=t>=u?v:ht;return t>=f&&(e=it,l=b,t<r&&(e=e-y+p-a+w),t<u&&(l=rt),k=(t-c)/2,ot=k+c,nt=k<e?Math.max(0,t-e-l-c,t-r):Math.max(0,t-ot-l)),{searchBar:{expanded:t>=f,width:t>=f?Math.min(c,Math.max(s,t-f+s)):ct,rightToCommands:nt+h},commandIconsVisible:t>=u,avatarMenuExpanded:t>=u,others:{reportABugVisible:t>=ft,debugModeVisible:t>=et,previewExpanded:t>=ut,reportBugExpanded:t>=r,upgradeVisible:t>=dt,upgradeExpanded:t>=r}}}var wt,lt;Object.defineProperty(t,"__esModule",{value:!0});t.HelpAction=t.Widget=t.ViewModel=void 0;ut.injectCss(ft);var bt=window,ct=bt.fx.environment,at="fxs-topbar-avatarmenu",vt="fxs-avatarmenu-imageonly",ot="fxs-display-none",st=MsPortalFx.isFeatureEnabled,ht=f.TopBar,kt="fxs-topbar-actionsmenu",yt=st("azureconsole"),dt=st("feedback"),pt=st("asyncSearch"),gt=f.Directory,ni=(function(t){function r(n,i,r){var f=t.call(this)||this;return f.toastViewModel=n,f.reportBug=$.noop,f.exitDevMode=$.noop,f.directoryFilterIcon=ko.observable(v),f.dashboardChanged=u.makeWritableComputation(!1),f.dashboardWritable=u.makeWritableComputation(!1),f.dashboardVisible=u.makeWritableComputation(!1),f.exitOrganizeMode=$.noop,f.finishDashboardEdit=$.noop,f.settingsButtonClick=$.noop,f.loadingIdList=u.makeArrayComputation(),f.searchViewModel=pt?new h.ViewModel:new s.ViewModel,f.avatarMenuVM=new e.ViewModel,f.consoleButtonClick=MsPortalFx.noop,f.canUpgradeSubscription=u.makeWritableComputation(!1),f.upgradeableSubscription=u.makeWritableComputation(),f.displayMode=r.displayMode,f.isInOrganizeMode=r.inOrganizeMode,f.settingsFlyoutState=r.settingsFlyoutState,f.actionDefinitions=ti(i,f),f}return __extends(r,t),r.prototype.dispose=function(){this.searchViewModel.dispose()},r.prototype.setWidget=function(n){this._widget=n},r.prototype.getWidget=function(){return this._widget},r.prototype.getRootElement=function(){return this._widget&&this._widget.element},__decorate([__metadata("fx:diagnostics",[n,"ViewModel"]),i.Class(),__metadata("design:paramtypes",[rt.ViewModel,i.Container,it.PortalState])],r)})(o.ViewModel);t.ViewModel=ni;wt=(function(n){function t(t,i,r){var o=n.call(this,t,i,!0)||this,a,l,p,w;return o._reactiveLayoutInitialized=!1,a=o.ltm,i.setWidget(o),o.toggleConsole=MsPortalFx.noop,yt&&(i.consoleButtonClick=o.toggleConsole=function(){r.get(g.ToggleCloudShell).invoke(undefined)}),st("hidedirectorypanebutton")||ct.chrome.hideDirectoryPaneButton||(l=r.get(nt.SubscriptionsUserContext),Q.spread([l.getAllSubscriptionsCount(),l.getGlobalSelectedSubscriptions(),l.useGlobalResourceFiltersPromise,],(function(n,t,r){if(r)return i.directoryFilterIcon(v);t.subscribeAndRun(a,(function(t){i.directoryFilterIcon(t.length===n.value?v:y)}))}))),o._topbarActionsViewModel=new c.ViewModel(i.actionDefinitions),o._topbarActionsViewModel.ariaLabel(f.TopBar.actionsMenuButtonLabel),p=new e.Widget(o._findByClassName(at),i.avatarMenuVM,r),w=pt?new h.Widget(o._findByClassName("fxs-topbar-search"),i.searchViewModel,r):new s.Widget(o._findByClassName("fxs-topbar-search"),i.searchViewModel,r),a.registerForDispose([p,w,]),o.topBarHasExpandedItem=u.composeComputation([tt.toComputation(i.searchViewModel.showMenu),tt.toComputation(o._topbarActionsViewModel.dropMenuOptions.isMenuOpen),tt.toComputation(p.getDropMenuOpenObservable()),o.options.settingsFlyoutState,],(function(n,t,i,r){return n||t||i||!!r})),o}return __extends(t,n),t.prototype._findByClassName=function(n){return $(this.element[0].querySelector("."+n))},t.prototype.initReactiveLayout=function(){var n=this;if(!this._reactiveLayoutInitialized){this._reactiveLayoutInitialized=!0;var f=!0,i,e,r,o,s,h,l,a,v,y,p,w=this._findByClassName("fxs-topbar-search"),b=this._findByClassName("fxs-topbar-buttons-container"),u=this._findByClassName(at),g=this._findByClassName("fxs-internal-full"),nt=this._findByClassName("fxs-topbar-exitdevmode"),tt=this._findByClassName("fxs-topbar-reportbug"),rt=this._findByClassName("fxs-topbar-reportbug-text"),it=this._findByClassName("fxs-internal-short"),ut=this._findByClassName("fxs-topbar-sidebar-collapse-button"),t=k.throttleByAnimationFrame((function(){var d,ft=n._findByClassName("fxs-topbar-upgradebutton"),ht=n._findByClassName("fxs-topbar-upgradebutton-text"),k,t,st;f&&(f=!1,r=et(n.element,"fxs-avatarmenu-tenant-image-container"),e=et(b),o=et(n.element,"fxs-topbar-brand"),s=et(g),h=et(it),l=et(nt),a=et(tt),v=et(n.element,"fxs-topbar-reportbug-icon"),y=et(ft),p=et(n.element,"fxs-topbar-upgradebutton-icon"));i?k=i:u.hasClass(vt)?k=180+r:(k=u.width(),n._findByClassName("fxs-avatarmenu-tenant").text()&&n._findByClassName("fxs-avatarmenu-username").text()&&(i=k));t=ii({topbarWidth:n.element.width(),logoWidth:o,searchBarWidth:{min:280,max:400,collapsed:40,margin:15},commandIconsWidth:e,avatarMenuWidth:{normal:k,imageOnly:r},others:{previewWidth:s,previewShortWidth:h,debugModeWidth:l,reportBugExpendedWidth:a,reportBugIconWidth:v,upgradeExpandedWidth:y,upgradeIconWidth:p,sidebarHamburgerWidth:et(ut)},electronWidth:n._findByClassName("fxs-topbar-electron-container").width(),historyWidth:n._findByClassName("fxs-topbar-history-container").width()});n.element.toggleClass("fxs-topbar-state-searchcollapsed",!t.searchBar.expanded);w.css("margin-right",t.searchBar.expanded?t.searchBar.rightToCommands:"");w.css("max-width",t.commandIconsVisible?800:400);u.toggleClass(vt,!t.avatarMenuExpanded);b.toggleClass(ot,!t.commandIconsVisible);tt.toggleClass(ot,!t.others.reportABugVisible);nt.toggleClass(ot,!t.others.debugModeVisible);g.toggleClass(ot,!t.others.previewExpanded);it.toggleClass(ot,t.others.previewExpanded);rt.toggleClass(ot,!t.others.reportBugExpanded);ft.toggleClass(ot,!t.others.upgradeVisible);ht.toggleClass(ot,!t.others.upgradeExpanded);t.commandIconsVisible||n.options.dropMenuWidget||(n.options.dropMenuWidget=new c.Widget(n._findByClassName(kt),n._topbarActionsViewModel),n.ltm.registerForDispose(n.options.dropMenuWidget));st=n._findByClassName("fxs-topbaractions-dropmenu");st.toggleClass(ot,t.commandIconsVisible);(d=n.options.dropMenuWidget)===null||d===void 0?void 0:d.closeMenu()}));this.ltm.registerForDispose([this.element.setEvents(["fxavatartextchange",t]),$(window).setEvents(["resize",t]),$(document).setEvents([d.fullscreen,t]),]);t()}},t.prototype.dispose=function(){this._cleanElement();n.prototype.dispose.call(this)},t})(o.Widget);t.Widget=wt;lt=(function(){function t(n,t){this.name=ht.help;this.icon=w;this.classNames="fxs-topbar-helpmenu";this.showNotification=ko.observable(!1);this.active=ko.observable(!1);this.clickHandler=function(){t.settingsFlyoutState(0);n.getAsync(r.get("MsPortalImpl/UI/UI.HelpPane","HelpPane")).then((function(n){return n.toggle()}))}}return __decorate([__metadata("fx:diagnostics",[n,"HelpAction"]),i.Class(),__metadata("design:paramtypes",[i.Container,it.PortalState])],t)})();t.HelpAction=lt}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Portal.css",["module"],(function(n){"use strict";return{css:".fxs-portal{position:fixed;left:0;right:0;top:0;bottom:0;overflow:hidden;z-index:0;display:flex;flex-direction:column;font-size:13px;line-height:normal}.fxs-portal-main{display:flex;flex-flow:row nowrap;align-items:stretch;position:relative;flex:1 1 auto;min-height:0;height:100%}.fxs-portal-content{flex:1 1 auto;position:relative;overflow:hidden;z-index:1}.fxs-portal-controlloadfailed>svg{vertical-align:bottom;height:18px}.fxs-portal-tip-content{max-width:400px}.fxs-portal-tip.azc-balloon .azc-balloon-content{padding:0}.fxs-portal-shield{position:fixed;width:100%;height:100%;background-color:rgba(0,0,0,.7);z-index:7;display:table}.fxs-portal-shield-middle{display:table-cell;vertical-align:middle}.fxs-portal-shield-icon{position:absolute;height:40px;width:40px;top:-20px;display:flex;justify-content:center;align-items:center}.fxs-portal-shield-icon>svg{width:20px;height:20px}.fxs-portal-shield-icon-warning{background-color:#ffdfb8}.fxs-portal-shield-icon-error{background-color:#fdd8db}.fxs-portal-shield-modaldialog{width:430px;max-width:100vw;margin:auto;padding:20px;position:relative}.fxs-input{padding:0;margin:0;box-sizing:border-box;border-width:1px;border-style:solid;outline:none;height:24px;text-indent:10px}.fxs-button.fxt-button:focus,.azc-button.fxt-button:focus{outline:none}.fxt-button{min-width:80px;border-radius:2px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.fxs-button{position:relative;box-sizing:border-box;height:24px;font-size:13px;line-height:20px;font-weight:600;cursor:pointer;border-width:1px;border-style:solid;padding:0 20px;margin:0}.fxs-button.fxs-button-disabled{cursor:default}.fxs-inner-solid-border{position:relative}.fxs-inner-solid-border:focus::after{content:\"\";position:absolute;top:1px;left:1px;right:1px;bottom:1px;display:block;border-width:1px;border-style:solid;pointer-events:none}.fxs-inner-solid-border:focus::after.fxs-button-default{border-color:#605e5c}.fxs-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-full-height{height:100%}.fxs-full-width{width:100%}@keyframes fxs-progress-animatedEllipses{0%{transform:scale(1);opacity:.3}36.1%{transform:scale(1.06);opacity:1}50%{transform:scale(1.06);opacity:1}86.1%{transform:scale(1);opacity:.3}}@keyframes fxs-progress-animatedEllipsesShadow{0%{opacity:0}36.1%{opacity:.4}50%{opacity:.4}86.1%{opacity:0}}fxs-progress,.fxs-progress{position:absolute;width:100%;height:100%;top:0;z-index:194}.fxs-progress-nozindex{z-index:initial}.fxs-progress-dots{position:absolute;top:calc(50% - 10px/2);width:100%;line-height:0;text-align:center}.fxs-progress-dots-dot{display:inline-block;height:10px;width:10px;animation:fxs-progress-animatedEllipses 1.8s infinite;background-color:#3471ff;margin:0 5px;border-radius:5px;opacity:.3;position:relative}.fxs-progress-dots-dot::after{content:'';position:absolute;left:0;border-radius:5px;width:100%;height:100%;opacity:0;box-shadow:0 3px 3px 0 #0078d4;animation:fxs-progress-animatedEllipsesShadow 1.8s infinite}.fxs-progress-dots-dot:nth-child(1){animation-delay:0s}.fxs-progress-dots-dot:nth-child(2){animation-delay:.125s}.fxs-progress-dots-dot:nth-child(3){animation-delay:.25s}.fxs-progress-small .fxs-progress-dots,.fxs-bladecontent-unlocked .fxs-tile .fxs-progress-dots,.fxs-startboard-layout .fxs-tile .fxs-progress-dots{top:calc(50% - 6px/2)}.fxs-progress-small .fxs-progress-dots-dot,.fxs-bladecontent-unlocked .fxs-tile .fxs-progress-dots-dot,.fxs-startboard-layout .fxs-tile .fxs-progress-dots-dot{height:6px;width:6px;margin:0 3px;border-radius:3px}.fxs-progress-small .fxs-progress-dots-dot::after,.fxs-bladecontent-unlocked .fxs-tile .fxs-progress-dots-dot::after,.fxs-startboard-layout .fxs-tile .fxs-progress-dots-dot::after{border-radius:3px;box-shadow:0 2px 2px 0 #0078d4}.azc-fabric .azc-formControl{border-radius:2px !important}.azc-fabric .azc-textBox-wrapper .azc-input,.azc-fabric .azc-password-wrapper .azc-input,.azc-fabric .azc-numericTextBox-wrapper .azc-input{border-radius:2px}",moduleId:n.id}}));
define("MsPortalImpl/Widgets/Widgets.Portal",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Interactions/Interactions.ContextMenuTouch","MsPortalImpl/Interactions/Interactions.FullScreenMode","MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip","MsPortalImpl/Interactions/Interactions.KeyboardOnlyOutlines","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.ContextPane","MsPortalImpl/Widgets/Widgets.Panorama","MsPortalImpl/Widgets/Widgets.Portal.State","MsPortalImpl/Widgets/Widgets.SideBar","MsPortalImpl/Widgets/Widgets.TopBar","MsPortalImpl/Base/Base.Events","MsPortalImpl/Widgets/Widgets.Portal.html","MsPortalImpl/Widgets/Widgets.ContextMenu","MsPortalImpl/Weave/DirectRender","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Portal.css","Weave"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt){"use strict";var ct;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.ViewModel=void 0;d.injectCss(g);var rt=window,lt=rt.fx.environment,tt=rt.fx.getTimestamp,ft=MsPortalFx.Base.Diagnostics,et=ft.Telemetry,at=ft.createLog(n),vt="HomeScriptLoad",ot="HomeScriptLoadStart",st="HomeScriptLoadEnd",ut="AzureHomeLoad",it={start:ut+"Start",end:ut+"End"},yt=MsPortalFx.isFeatureEnabled("allservicesweave"),ht=(function(t){function r(n,i,r,u){var f=t.call(this)||this;return f.sideBar=n,f.topBar=i,f._diContainer=r,f._widgetCreatePromise=Q.defer(),f.customEvents=new p.CustomEvents,f.rightContextPane=new c.ViewModel(f._diContainer),f.shellContextPane=new c.ViewModel(f._diContainer),f.contextMenuViewModel=new b.ViewModel,f.displayMode=u.displayMode,f.inOrganizeMode=u.inOrganizeMode,f.settingsFlyoutState=u.settingsFlyoutState,f.panorama=new l.ViewModel("fxs-panorama-instanceid",f.settingsFlyoutState,null,f.displayMode),f}return __extends(r,t),r.prototype.getDisplayMode=function(){return this.displayMode.value},r.prototype.setRootPageDisplayType=function(n){this._rootPageDisplayType=n},r.prototype.getRootPageDisplayType=function(){var n=this._rootPageDisplayType;return n!=="Home"&&n!=="Dashboard"&&n!=="AllServices"&&(n=s.isLandingPageDashboard(this._diContainer)?"Dashboard":"Home"),n},r.prototype.showStartboard=function(n){if(this.displayMode.value!=="Dashboard"&&(this.displayMode("Dashboard"),!n)){var t=this.panorama.getStartBoardWidget();t&&t.setFocus()}},r.prototype.setWidget=function(n){this._widget=n;this.customEvents.setElement(n.element);this._widgetCreatePromise.resolve(!0)},r.prototype.getRootElement=function(){return this._widget&&this._widget.element},r.prototype.onWidgetCreate=function(){return this._widgetCreatePromise.promise},__decorate([__metadata("fx:diagnostics",[n,"ViewModel"]),i.Class(),__metadata("design:paramtypes",[v.ViewModel,y.ViewModel,i.Container,a.PortalState])],r)})(h.ViewModel);t.ViewModel=ht;ct=(function(t){function h(n,i,r){var h=t.call(this,n,i,!0)||this,a,ht,b,pt;i.setWidget(h);i.setRootPageDisplayType(i.displayMode.value);a=i.displayMode;n.addClass("fxs-portal fxs-desktop-normal");i.inOrganizeMode.subscribe(h.ltm,(function(t){n.toggleClass("fxs-desktop-organize",t);n.toggleClass("fxs-desktop-normal",!t)}));w.renderPortal(n[0],i,r,h.ltm);var kt=r.get(s.GeneralSettings),d=h.ltm,ft=i.sideBar;kt.sideBarLayout.subscribeAndRun(d,(function(){var t=!s.isSideBarDocked(r);n.toggleClass("fxs-sidebar-hamburger-mode",t).toggleClass("fxs-sidebar-docked-mode",!t)}));ht=h._findByClassName("fxs-sidebar");ht.toggleClass("fxs-display-none",!!lt.chrome.hideSidebarNav);var wt=new v.Widget(ht,ft,r),g=i.topBar,p=FxImpl.features.isNativePerf&&rt.performance,dt=h._findByClassName("fxs-topbar"),bt=new y.Widget(dt,g,r,h._findByClassName("fxs-portal-console")),ct=i.panorama,gt=new l.Widget(h._findByClassName("fxs-portal-content"),ct),ni=new c.Widget(h._findByClassName("fxs-portal-contextpane-right"),i.rightContextPane),ti=new c.Widget(h._findByClassName("fxs-portal-contextpane-shell"),i.shellContextPane);return u.register(n),e.register(n),o.register(),nt.subscribe(d,[a],(function(n){n!=="Journey"&&(i.setRootPageDisplayType(n),r.get(f.FullScreenMode).exit());h.element.toggleClass("fxs-show-journey",n==="Journey");h.element.toggleClass("fxs-show-startboard",n==="Dashboard");h.element.toggleClass("fxs-show-home",n==="Home");h.element.toggleClass("fxs-show-allservices",n==="AllServices");g.dashboardVisible(n==="Dashboard")})),pt=function(n){var t=tt();p&&(p.mark(it.start),p.mark(ot));Q.all([MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AzureHome"),MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AzureHome.Component"),]).spread((function(i,u){var s;p&&(p.mark(st),p.measure(vt,ot,st));var f=tt(),e=h._findByClassName("fxs-home-target"),o=new i.ViewModel(h.options.sideBar.launchBlade,r),c=tt();k.applyToElement({element:e[0],ltm:d,weaveNode:u.AzureHomeInner({vm:o}),weaveContext:{diContainer:r},opName:"AzureHome"});d.registerForDispose(b=new i.Widget(e,o,r));s=tt();b.setFocus();b.getFirstLoadPerfIndicators().then((function(i){p&&(p.mark(it.end),p.measure(ut,it.start,it.end));var r=i.assetsLoadedTs-i.startLoadingTs,u=i.recentsLoadedTs-i.startLoadingTs;et.trace({source:"Shell",action:"AzureHomeLoad",data:{assets:r,recents:u,render:s-c,scripts:f-t,fullyReady:Math.max(r,u)}});n&&et.trace({source:"Shell",action:"TotalTimeToInitialRoute",name:"Home",duration:tt(),data:{startScriptLoadTime:t,scriptsLoadedTime:f,assetsLoadedTime:i.assetsLoadedTs,recentsLoadedTime:i.recentsLoadedTs}})}))})).catch((function(n){at.error("failed to load and initialize azure-home",null,MsPortalFx.getLogFriendlyMessage(n))}));pt=MsPortalFx.noop},h.ltm.registerForDispose([bt,gt,ni,ti,wt,function(){u.unregister(n);e.unregister(n);o.unregister()},h.element.setEvents(["fxloadingontopbar",function(n,t){t.cancel?g.loadingIdList.removeIf((function(n){return n===t.id})):g.loadingIdList.push(t.id);var i=ct.getJourneyWidget();i&&i.loadingHint(t.id,!t.cancel)},],["fxshowjourney",function(){(i.settingsFlyoutState(0),a.value!=="Journey")&&a("Journey")},],["fxshowdefaulthomepage",function(n,t){(i.settingsFlyoutState(0),a.value!=="Home")&&(t=t||{},a("Home"),pt(t.invokedByInitRoute),b&&(b.reloadRecents(),t.skipFocus||b.setFocus()))},],["fxshowcustomhomepage",function(){(i.settingsFlyoutState(0),a.value!=="Home")&&a("Home")},],["fxshowdashboard",function(){(i.settingsFlyoutState(0),a.value!=="Dashboard")&&a("Dashboard")},],["fxshowallservices",function(n,t){i.settingsFlyoutState(0);a("AllServices");var r=t&&t.filter;yt?ct.allServicesMenuInput(r):ft.showAllServices(r)},],["fxtoggleconsole",function(){bt.toggleConsole()},],["fxtogglesidebar",function(){ft.setCollapsed(!wt.options.isCollapsed.value)},]),]),h}return __extends(h,t),h.create=function(n,t,i){return new h(n.portal,t,i)},h.prototype._findByClassName=function(n){return $(this.element[0].querySelector("."+n))},__decorate([__metadata("fx:diagnostics",[n,"Widget"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[r.RootElements,ht,i.Container]),__metadata("design:returntype",h)],h,"create",null),h})(h.Widget);t.Widget=ct}));
define("MsPortalImpl/Widgets/Widgets.Portal.init",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Widgets/Widgets.Portal"],(function(n,t,i,r){"use strict";function u(n){return n.get(r.ViewModel)}Object.defineProperty(t,"__esModule",{value:!0});t.getPortalViewModel=void 0;ko.components.register("fxs-progress",{template:i("div",{"class":"fxs-progress-dots"},i("div",{"class":"fxs-progress-dots-dot"}),i("div",{"class":"fxs-progress-dots-dot"}),i("div",{"class":"fxs-progress-dots-dot"}))});t.getPortalViewModel=u}));
define("MsPortalImpl/UI/UI.ContextPane",["require","exports","Fx/DependencyInjection","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Portal.init","Weave"],(function(n,t,i,r,u,f,e,o){"use strict";var s,h,c,l;Object.defineProperty(t,"__esModule",{value:!0});t.ShellContextPane=t.RightContextPane=t.ContextPaneImpl=t.ContextPane=void 0;s=(function(){function n(){}return n})();t.ContextPane=s;h=(function(){function n(n,t){var i=this,u,f;this._viewModel=t;this._onMinimizeCallbacks=$.Callbacks();this.opened=this._viewModel.opened;this.loading=this._viewModel.loading;u={dismissFn:function(){i.close()},logName:"contextPane"};f=e.getPortalViewModel(n);MsPortalFx.tryImmediateResolve(f.onWidgetCreate(),(function(){var n=i._containerLifetime=t.getWidget().ltm;i._contentLifetime=n.createChildLifetime();o.subscribeAndRun(n,[t.opened],(function(n){n?r.register(u):r.unregister(u)}))}));t.close=function(n){n.stopPropagation();i.close()};t.getWidget()&&t.getRootElement().on("minimized",(function(){i._onMinimizeCallbacks.fire()}))}return n.prototype.hasContent=function(n){return this._contentProvider===n},n.prototype.getContent=function(){return this._contentProvider},Object.defineProperty(n.prototype,"contentLifetime",{get:function(){return this._contentLifetime},enumerable:!1,configurable:!0}),n.prototype.tryOpen=function(n,t){var f=this,i,r;return this._contentProvider===n?(this._viewModel.getWidget().setFocus(),Q(!0)):(i=t?!0:this._tryRemoveContent(),i)?(this._contentProvider=n,t?this._contentProviderStack.push(n):this._contentProviderStack=[n],this._previouslyFocusedElement=document.activeElement,r=this._viewModel,r.opened(!0),r.loading(!0),n.onAddingContent(this._viewModel,t).finally((function(){return u.waitForBindings(f._viewModel.getRootElement()[0]).finally((function(){r.loading(!1)}))})).then((function(){return f._viewModel.getWidget().setFocus(),i}))):Q(i)},n.prototype.close=function(n){var t,i;return this._contentProvider?(t=!0,n?this._clearContent():t=this._tryRemoveContent(),t&&(i=this._viewModel,i.childElementCount.value===0&&i.opened(!1),i.loading(!1),this._restoreFocus()),t):!0},n.prototype.onMinimized=function(n){this._onMinimizeCallbacks.add(n)},n.prototype._clearContent=function(){var t=this._contentProvider,n;t&&t.onRemovingContent(this._viewModel);this._contentProviderStack.pop();this._contentProvider=this._contentProviderStack.length===0?null:MsPortalFx.last(this._contentProviderStack);n=this._contentLifetime;n&&(n.dispose(),this._contentLifetime=this._containerLifetime.createChildLifetime())},n.prototype._tryRemoveContent=function(){var n=this._contentProvider,t;return n?(t=!n.canRemoveContent||n.canRemoveContent(),t&&this._clearContent(),t):!0},n.prototype._restoreFocus=function(){var i=this._previouslyFocusedElement,n,r,t;if(i){if(n=$(i).closest(".fxs-blade"),n.length&&(n=n.parent().children(".fxs-blade").last(),r=f.Widget.getWidgets(n),t=r.length&&r[0],t&&t.setFocus)){t.setFocus();return}(document.activeElement===document.body||$.contains(this._viewModel.getRootElement()[0],document.activeElement))&&i.focus()}},n})();t.ContextPaneImpl=h;c=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.create=function(n){var t=e.getPortalViewModel(n);return new h(n,t.rightContextPane)},__decorate([__metadata("fx:diagnostics",[n,"RightContextPane"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.Container]),__metadata("design:returntype",r)],r,"create",null),r})(s);t.RightContextPane=c;l=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.create=function(n){var t=e.getPortalViewModel(n);return new h(n,t.shellContextPane)},__decorate([__metadata("fx:diagnostics",[n,"ShellContextPane"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.Container]),__metadata("design:returntype",r)],r,"create",null),r})(s);t.ShellContextPane=l}));
define("MsPortalImpl/Services/Services.AssetManagement",["require","exports","Fx/ResourceManagement","FxHubs/RpcEndPoints","Fx/DependencyInjection","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.ArmEvents","FxInternal/AsyncLoader"],(function(n,t,i,r,u,f,e,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.notifyAssetDeletedHandler=t.AssetManager=void 0;var h=MsPortalFx.Base,c=h.Diagnostics.createLog(n),l=(function(){function t(n){var t=this;this.assetTypeService=n;this._assetDeletedCallbacks=$.Callbacks();this.handleAssetDeletedLocal=function(n,r,u,o){var s,h,l;o.reason=o.reason||"Received asset deletion notification from the extension '"+r+"'";s=o.assetId;h=o.assetType;h==="*Impl_Resource*"?(l=i.ArmId.parse(s,!0),l.resourceType&&t.assetTypeService.mapResourceIdToAssetId(s).then((function(i){t.handleAssetDeleted(i.extensionName,i.assetType,i.assetId,o.reason);n.get(e.ArmEvents).createResourceDeletedEvent([i])})).catch((function(n){(n&&n.message||"").indexOf(f.failedToFindAssetTypePrefix)!==0&&c.warning(n)}))):(t.handleAssetDeleted(u,h,s,o.reason),n.get(e.ArmEvents).createResourceDeletedEvent([{extensionName:u,assetType:h,assetId:s}]))}}return t.prototype.onAssetDeleted=function(n){this._assetDeletedCallbacks.add(n)},t.prototype.markAssetDeleted=function(n,t,i,r){this.handleAssetDeleted(n,t,i,r)},t.prototype.handleAssetDeleted=function(n,t,i,r){this._assetDeletedCallbacks.fire(n,t,i,r)},__decorate([__metadata("fx:diagnostics",[n,"AssetManagerImpl"]),u.Class(),__metadata("design:paramtypes",[f.AssetTypeService])],t)})(),s=(function(){function t(){}return t.create=function(n){return n},__decorate([__metadata("fx:diagnostics",[n,"AssetManager"]),u.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[l]),__metadata("design:returntype",t)],t,"create",null),t})();t.AssetManager=s;t.notifyAssetDeletedHandler=o.defineHandler(r.Events.notifyAssetDeletedDefinition,(function(n){var t=n.messageContext.srcWindowId,i=n.diContainer.get(s);MsPortalFx.makeArray(n.messageArg).forEach((function(r){i.handleAssetDeletedLocal(n.diContainer,t,t,r)}))}))}));
define("MsPortalImpl/Services/Services.Settings.Schema",["require","exports"],(function(){"use strict";var n;return (function(n){n.avatarKey="avatar_base64encoded";n.desktopSettingsKey="sprint2";n.startBoardSettingsKey="Startboard"})(n||(n={})),n}));
define("MsPortalImpl/Base/Telemetry",["require","exports"],(function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isDesktopTraceEnabled=void 0;t.isDesktopTraceEnabled=!!MsPortalFx.trace.desktop}));
define("MsPortalImpl/Services/Services.EditScopeManagement",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/Extension/ExtensionManager"],(function(n,t,i,r,u){"use strict";function h(n,t){return"{0}-{1}-{2}".format("editScopes",n,t)}function o(n){var t=n.split("-"),i=t.slice(1,t.length-1).join("-"),r=t[t.length-1];return{editScopeId:i,extension:r}}var e;Object.defineProperty(t,"__esModule",{value:!0});t.updateEditScopeIsSavingState=t.saveSerializedEditScope=t.loadSerializedEditScope=t.EditScopeManager=t.EditScopeManagerImpl=void 0;var c=FxImpl,f=c.Data,l=FxImpl.Rpc,s=(function(){function n(n,t){var i=this;this._editScopes={};this._extensionManager=n;this._rpcClient=t;n.onUnload((function(n){return i._onExtensionUnloaded(n),!0}))}return n.prototype.onEditScopeCreated=function(n){this._ensureEditScope(n,!0)},n.prototype.onEditScopeDisposed=function(n){var t=this,i=this._getDirtyExtensionSettings(n);i.forEach((function(i){var r=t._extensionManager.getExtension(o(i.key).extension);r&&r.isLoaded()&&f.onEditScopeDiscardedEndPoint.invoke(t._rpcClient,r.name,n)}));this._deleteEditScope(n)},n.prototype.getStateObservable=function(n){var r=this,t=this._ensureEditScope(n),i;return t.stateObservable||(i=ko.observable(),t.stateObservable=ko.pureComputed((function(){i();var u=r._getDirtyExtensionSettings(n).length>0;return u?t.savingRefCount()>0?2:1:0})),this._loadEditScope(n).then((function(){i(!0)}))),t.stateObservable},n.prototype.logEditsToConsole=function(n){var t=this._editScopes[n]&&this._editScopes[n].settings;t&&t.extensionSettings().forEach((function(n){var t=o(n.key);console.debug('Edits for editScopeId: {0}, extension: "{1}"'.format(t.editScopeId,t.extension));f.logEditsToConsole(n.settings)}))},n.prototype.loadEditScopeForExtension=function(n,t){var i=this;return this._loadEditScope(n).then((function(){var f=i._editScopes[n],r,e,u;return f?(r=f.settings,r?(e=h(n,t),u=MsPortalFx.find(r.extensionSettings(),(function(n){return n.key===e})),u?u.settings:null):null):null}))},n.prototype.saveEditScopeForExtension=function(n,t,i){var r=this._editScopes[n],e,u,f;this._canEditScopeBeUpdated(r)&&(u=h(n,t),f=MsPortalFx.findIndex(r.settings.extensionSettings(),(function(n){return n.key===u})),f<0?r.settings.extensionSettings.push({key:u,settings:i}):(e=r.settings.extensionSettings()[f],e.settings=i,r.settings.extensionSettings.splice(f,1,e)),r.settings.keys.indexOf(u)<0&&r.settings.keys.push(u))},n.prototype.updateEditScopeIsSavingStateForExtension=function(n,t,i){var r=this._editScopes[n],u;r&&(u=r.savingRefCount()||0,i?r.savingRefCount(u+1):u>0&&r.savingRefCount(u-1))},n.prototype.trackingEditScope=function(n){return!!this._editScopes[n]},n.prototype._canEditScopeBeUpdated=function(n){return n?!!n.loadPromise:!1},n.prototype._deleteEditScope=function(n){delete this._editScopes[n]},n.prototype._loadEditScope=function(n){var t=this._ensureEditScope(n);return t.justCreated&&(t.settings={keys:[],extensionSettings:ko.observableArray()},t.loadPromise=Q(),t.justCreated=!1),t.loadPromise||(t.loadPromise=this._getAndProcessSettings(n)),t.loadPromise},n.prototype._getAndProcessSettings=function(n){return this._editScopes[n].settings={keys:[],extensionSettings:ko.observableArray()},Q()},n.prototype._getDirtyExtensionSettings=function(n){var t=this._editScopes[n]&&this._editScopes[n].settings,i=t&&t.extensionSettings().filter((function(n){var t=n.settings;return t&&t.edits.length>0}));return i||[]},n.prototype._onExtensionUnloaded=function(n){var i,t,r,u;for(i in this._editScopes)t=this._editScopes[i],r=t.savingRefCount()>0,r&&(u=t.settings&&t.settings.extensionSettings().some((function(t){return n===o(t.key).extension&&t.settings.edits.length>0})),u&&(this._clearEditScopeEdits(i),t.savingRefCount(0)))},n.prototype._clearEditScopeEdits=function(n){var i=this._editScopes[n],t;this._canEditScopeBeUpdated(i)&&(t=i.settings&&i.settings.extensionSettings,t().forEach((function(n){n.settings=null})),t(t()))},n.prototype._ensureEditScope=function(n,t){t===void 0&&(t=!1);var i=this._editScopes[n];return i||(i=this._editScopes[n]={savingRefCount:ko.observable(0),justCreated:t}),i},n})();t.EditScopeManagerImpl=s;e=(function(){function t(){}return t.create=function(n,t){return new s(n,t)},__decorate([__metadata("fx:diagnostics",[n,"EditScopeManager"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[u.ExtensionManager,l.Client]),__metadata("design:returntype",t)],t,"create",null),t})();t.EditScopeManager=e;t.loadSerializedEditScope=r.defineHandler(f.loadSerializedEditScopeEndPoint,(function(n){return n.diContainer.get(e).loadEditScopeForExtension(n.messageArg,n.messageContext.srcWindowId)}));t.saveSerializedEditScope=r.defineHandler(f.saveSerializedEditScopeEndPoint,(function(n){n.diContainer.get(e).saveEditScopeForExtension(n.messageArg.editScopeId,n.messageContext.srcWindowId,n.messageArg.edits)}));t.updateEditScopeIsSavingState=r.defineHandler(f.updateEditScopeIsSavingStateEndPoint,(function(n){n.diContainer.get(e).updateEditScopeIsSavingStateForExtension(n.messageArg.editScopeId,n.messageContext.srcWindowId,n.messageArg.isSaving)}))}));
define("MsPortalImpl/UI/Compositions/UI.Composition.Graph",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition"],(function(n,t,i,r,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CompositionGraph=void 0;var f=(function(){function t(){this._entries=new Map;this._idIndex=new Map}return t.prototype.getStartBoard=function(){return this._startBoard},t.prototype.find=function(n){return this._idIndex.get(n)},t.prototype.findBlades=function(n,t){var f=[],i;return n instanceof r.Locator?this._entries.forEach((function(t,i){i.getCompositionType()===u.CompositionType.Blade&&i.locator.equals(n)&&f.push(i)})):(i=this._entries.get(n),f=(i===null||i===void 0?void 0:i.opened.slice())||[]),f.filter((function(n){return(t?n.flags:~n.flags)&32}))},t.prototype.setStartBoard=function(n){if(!this._entries.has(n)){var t={instance:n,opened:[]};this._addEntry(t);this._startBoard=n}},t.prototype.addBlade=function(n,t){var i=this._entries.get(n),f,r;i||(i={instance:n,openedBy:t,opened:[]},this._addEntry(i));(t.getCompositionType()===u.CompositionType.Part||t.getCompositionType()===u.CompositionType.StartboardPart)&&(f=this._entries.get(t),f&&f.opened.push(n));r=t.getCompositionType()===u.CompositionType.StartboardPart||t.getCompositionType()===u.CompositionType.Part?t.parent:t;r&&r.getCompositionType()===u.CompositionType.Lens&&(r=r.parent);r&&(i=this._entries.get(r),i||(i={instance:r,opened:[]},this._addEntry(i)),i.opened.push(n),i.instance.getCompositionType()===u.CompositionType.Blade&&i.instance.onDetailContainersChanged())},t.prototype.addPart=function(n){var i=this,t=this._entries.get(n);t||(t={instance:n,opened:[]},this._addEntry(t));n.registerForDispose((function(){return i.removePart(n)}))},t.prototype.removeBlade=function(n,t){var r=this,i;t===void 0&&(t=!0);i=this.findBlades(n,!!(n.flags&32));i.forEach((function(n){return r.removeBlade(n,!1)}));this._deleteEntry(n);this._entries.forEach((function(i){var f=MsPortalFx.remove(i.opened,n),r;f.length&&t&&(r=i.instance.getCompositionType()===u.CompositionType.Blade&&i.instance,r&&!r.isDisposed()&&r.onDetailContainersChanged())}))},t.prototype.removeAllBlades=function(n){var r=this,t=this._entries.get(n),i;t&&(i=t.opened.slice(),i.forEach((function(n){~n.flags&32&&r.removeBlade(n)})))},t.prototype.removePart=function(n){this._deleteEntry(n)},t.prototype._addEntry=function(n){this._entries.set(n.instance,n);this._idIndex.set(n.instance.id,n.instance)},t.prototype._deleteEntry=function(n){this._entries.delete(n);this._idIndex.delete(n.id)},__decorate([__metadata("fx:diagnostics",[n,"CompositionGraph"]),i.Class()],t)})();t.CompositionGraph=f}));
define("MsPortalImpl/UI/Compositions/UI.Composition.Finder",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Graph"],(function(n,t,i,r,u){"use strict";function e(n){return n.getCompositionType()===r.CompositionType.Startboard||n.getCompositionType()===r.CompositionType.Blade}Object.defineProperty(t,"__esModule",{value:!0});t.Finder=void 0;var f=(function(){function t(n){this._graph=n}return t.prototype.find=function(n){return this._graph.find(n)},t.prototype.findPart=function(n,t){var i=MsPortalFx.find(t.children,(function(t){return t.id===n})),r,u,f;if(!i)for(r=0,u=t.children;r<u.length;r++)if(f=u[r],i=MsPortalFx.find(f.children,(function(t){return t.id===n})),i)break;return i},t.prototype.findBlades=function(n,t){return t===void 0&&(t=!1),this._graph.findBlades(n,t)},t.prototype.findSiblingBlades=function(n,t){return t===void 0&&(t=!1),this._graph.findBlades(this.findPartsContainer(n),t)},t.prototype.findPartsContainer=function(n){if(!n)return this._graph.getStartBoard();while(n&&!e(n))n=n.parent;return n},__decorate([__metadata("fx:diagnostics",[n,"Finder"]),i.Class(),__metadata("design:paramtypes",[u.CompositionGraph])],t)})();t.Finder=f}));
define("MsPortalImpl/UI/UI.DesktopManagerView",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/Widgets/Widgets.Portal.init"],(function(n,t,i,r,u,f){"use strict";function s(n,t){r.isDesktopTraceEnabled&&o.verbose("[DesktopManager] {0}\n  {1}\n  Model: {2}.".format(n,t.toString(),ko.toJSON(t.getInputsOnlyViewModel())))}var e,o,h;Object.defineProperty(t,"__esModule",{value:!0});t.DesktopManagerView=void 0;e=MsPortalFx.Base.Diagnostics;o=e.createLog(n);h=(function(){function t(n,t){var i=this;this._contextPane=t;this._portal=f.getPortalViewModel(n);this._panorama=this._portal.panorama;this._portal.customEvents.addHandler(null,"fxautosettings",(function(n,t){i._autoOpenedBy=t}))}return t.prototype.composeStartBoard=function(n){n&&n.compose(this._panorama.getWidget())},t.prototype.addPartToStartBoard=function(n){n.compose(this._panorama.getStartBoardWidget())},t.prototype.addBlade=function(n,t){var i,r,u;return(s("Adding blade to desktop.",n),i=n.parent,r=i.children,e.Telemetry.trace({action:"JourneyLength",source:"Desktop",data:{count:r.length,blades:r.map((function(n){var t=n.locator;return{bladeName:t.name,extension:t.getExtensionName()}}))},journeyId:i&&i.id}),n.flags&1)?this._contextPane.tryOpen(n,(n.flags&16)!=0).then(MsPortalFx.noop):(this._autoOpenedBy&&(u=n.masterContainer,u&&u.instanceId===this._autoOpenedBy.masterBladeId&&(t||(t={}),t.autoOpenedByBlade=this._autoOpenedBy.masterBladeId,t.autoOpenedByPart=this._autoOpenedBy.masterPartId),this._autoOpenedBy=null),n.compose(this._panorama.getJourneyWidget(),t),Q())},t.prototype.removeBlade=function(n){s("Removing blade from desktop.",n);var t=this._contextPane;t.hasContent(n)?t.close(!0):this._panorama.getWidget().removeChild(n.id)},t.prototype.removeAllBlades=function(n){var t=this._panorama.getJourneyWidget();t&&t.removeChildren(n)},__decorate([__metadata("fx:diagnostics",[n,"DesktopManagerView"]),i.Class(),__metadata("design:paramtypes",[i.Container,u.RightContextPane])],t)})();t.DesktopManagerView=h}));
define("MsPortalImpl/UI/UI.JourneyManager",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Telemetry","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.Graph","MsPortalImpl/UI/UI.DesktopManagerView","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Widgets/Widgets.Portal.init"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";function k(n,t,i,r,u){return w.startTrace({source:n,action:t,name:i,assetType:r,journeyId:u})}function d(n){return n&&n.locator&&n.locator.toFriendlyString()}var b;Object.defineProperty(t,"__esModule",{value:!0});t.JourneyManager=t.getLastResourceIdInJourney=void 0;var p=u.Desktop,v=MsPortalFx.Base.Diagnostics.createLog(n),g=MsPortalFx.deepEquals,y={noActiveJourney:"Desktop has no active journey.",noBladeInJourney:"Blade '{0}' does not exist in the current journey.",noTileInDesktop:"Tile with id '{0}' was not found on the desktop."},nt=MsPortalFx.getUniqueId,w=MsPortalFx.Base.Diagnostics.Telemetry;t.getLastResourceIdInJourney=r.defineHandler(FxImpl.Extension.getLastResourceIdInJourneyEndPoint,(function(n){var t=n.diContainer.get(b).activeJourney();return t&&t.getCurrentResourceId()}));b=(function(){function t(n,t,i,r,u){var e=this;this._diContainer=n;this._browser=t;this._finder=i;this._compositionGraph=r;this._view=u;this.activeJourney=ko.observable(null);this._loadingJourneyGuid=null;this._portal=a.getPortalViewModel(n);var f,s,h=0,o=!1,c=function(){var n=e._portal;e._moveMenuBladeWidget(n);n.customEvents.trigger("fxjourneychanged",o)},l=function(n){h++||(f=e.activeJourney(),s=f&&f.children&&f.children.length);o=n},v=function(n){if(!--h){var t=f&&f.children&&f.children.length;n||f===e.activeJourney()&&s===t||c();f=undefined;o=!1}};this._changeJourney=function(n,t,i){l(t);try{return n()}finally{v(i)}}}return t.prototype.configure=function(n){this._startBoard=n},t.prototype.setActiveJourney=function(n){this.activeJourney(n);n&&f.isFullscreen()&&f.exitFullscreen()},t.prototype.openBlade=function(n,t){return __awaiter(this,void 0,void 0,(function(){var u,r,f,i=this;return __generator(this,(function(o){switch(o.label){case 0:return(u=n.containerType===0,!!this._createJourney)?[3,2]:[4,this._loadModules()];case 1:o.sent();o.label=2;case 2:this._finder.findBlades(n).forEach((function(n,i){if(n.locator.equals(t.locator)&&n.masterPartId===t.masterPartId&&n.masterInvocationProperty===t.masterInvocationProperty&&i===0&&n.locator.equals(t.locator)){var r=n.containerWidget;return r&&r.setFocus(),e.isDesktopTraceEnabled&&v.verbose("[DesktopManager] Found a previously opened detail blade."+"\n  Existing blade: {0}. Model: {1}.".format(n.toString(),ko.toJSON(n.getInputsOnlyViewModel()))+"\n  Requested Descriptor: {0}.".format(ko.toJSON(t))),Q(n)}}));o.label=3;case 3:return(o.trys.push([3,6,,7]),r=this._createNewJourneyPromise,!r)?[3,5]:[4,this._createNewJourneyPromise];case 4:r=o.sent();o.label=5;case 5:return r,[3,7];case 6:return f=o.sent(),[3,7];case 7:return u&&this._finder.findBlades(n).length===0||!!(t.flags&32)?[2,this.createJourney(t.masterPartId,t).then((function(n){if(n&&n.children&&n.children.length>0)return n.children[0];throw new MsPortalFx.Errors.Error("Failed to create new journey");}))]:[2,this._changeJourney((function(){var r=i._createBlade(i._diContainer,t,n),e=i._finder.findPart(t.masterPartId,n),f;return i._compositionGraph.addBlade(r,e||n),f=u?0:1+i._findFirstItemIndex(i.activeJourney().children,n.id,y.noBladeInJourney.format(n.id)),i.activeJourney().addChild(r,f),i._view.addBlade(r,{assetType:t.originAssetType,index:f,focus:!0}).catch((function(n){v.error(n)})),r}))]}}))}))},t.prototype.createJourney=function(n,t,i){return __awaiter(this,void 0,void 0,(function(){var o,r,h,f,s,e,l,c,a,u=this;return __generator(this,(function(p){switch(p.label){case 0:return(h=!!((t===null||t===void 0?void 0:t.flags)&32),!!this._createJourney)?[3,2]:[4,this._loadModules()];case 1:p.sent();p.label=2;case 2:if(r||(o=this._startBoard,r=MsPortalFx.find(o.children,(function(t){return t.id===n}))),!r&&n){v.error(y.noTileInDesktop.format(n));v.verbose(ko.toJSON(this.getDiagnosticsData(),null,2));throw new MsPortalFx.Errors.Error(y.noTileInDesktop.format(n));}return(f=Q.defer(),i||(i=nt(),this._loadingJourneyGuid=i,this._createNewJourneyPromise=f.promise),f.promise.finally((function(){u._loadingJourneyGuid===i&&(u._loadingJourneyGuid=null,u._createNewJourneyPromise=null)})),s=!1===(r===null||r===void 0?void 0:r.isComposed),!s)?[3,4]:[4,r.await(7)];case 3:s=p.sent();p.label=4;case 4:if(s,h||this.tryDeactivateJourney(i))try{e=this._createJourney(this._diContainer,r);l=k("Desktop","JourneyOpened",d(r),undefined,e.id);h?this._helpPaneJourney=e:this.setActiveJourney(e);c=t.openedByContext;a=c&&c.openedAsHome;this._changeJourney((function(){var n=u._createBlade(u._diContainer,t,o);e.addChild(n);e.compose(u._portal.panorama.getWidget());u._compositionGraph.addBlade(n,r||o);u._view.addBlade(n,{assetType:t.originAssetType,focus:!0}).catch((function(n){v.error(n)}));f.resolve(e)}),a);w.completeTrace(l)}catch(b){f.reject(b)}else f.reject(new MsPortalFx.Errors.Error("tryDeactivateJourney returned false"));return[2,f.promise]}}))}))},t.prototype.getDiagnosticsData=function(){var n=this._startBoard,t=this.activeJourney();return{startboard:n&&n.getDiagnosticsData(),activeJourney:t&&t.getDiagnosticsData()}},t.prototype.showActiveJourney=function(){this.activeJourney()&&this._portal.customEvents.trigger("fxshowjourney")},t.prototype.tryDeactivateJourney=function(n){var t=this.activeJourney(),r,i,u;if(t){if(!this.confirmBladesCanClose(t.children))return!1;for(r=t.children.filter((function(n){return!n.isRestorable()})),i=r.length-1;i>=0;i--)this.forceCloseBlade(r[i]);u=k("Desktop","JourneyDeactivated",d(t.originTile),undefined,t.id);this._closeActiveJourney(!0);w.completeTrace(u)}else this._startBoard&&this._compositionGraph.removeAllBlades(this._startBoard);return this._loadingJourneyGuid=n||null,!0},t.prototype.closeChildBlades=function(n){var r=this.discardEditsOfBlade(n,{includeSelf:!1,includeDescendants:!0}),i,t;if(r.successful)for(i=this._finder.findBlades(n),t=i.length-1;t>=0;t--)this.forceCloseBlade(i[t],1);return r},t.prototype.tryCloseBlade=function(n,t){var i,r;return n.flags&32||MsPortalFx.findIndex((i=this.activeJourney())===null||i===void 0?void 0:i.children,(function(t){return t.id===n.id}))>=0?(r=this.confirmBladesCanClose([n]),r&&this.forceCloseBlade(n,t),r):!0},t.prototype.confirmBladesCanClose=function(n,t){var i=this,u=t||this.activeJourney(),f=MsPortalFx.find(n,(function(n){return!i.canCloseBlade(n,u)})),r;return f?(n.forEach((function(n){if(!i._compositionGraph.find(n.id))throw new Error(y.noBladeInJourney.format(n.id));})),r=[],MsPortalFx.pushUnique(r,MsPortalFx.mapMany(n,(function(n){return i._getAlertMessageRecursive(n)}))),this._browser.confirm(r.join("\n")||p.confirmEditScopeDiscard)):!0},t.prototype.forceCloseBlade=function(n,t,i){var r=this,u;if(!this.activeJourney()&&!this._helpPaneJourney)throw new Error(y.noActiveJourney);u=i&&i.openBlade;this._changeJourney((function(){var i=n.parent,u=r._findFirstItemIndex(i.children,n.id,y.noBladeInJourney.format(n.id)),f=r._finder.findBlades(r._startBoard);f.length===1&&f[0].id===n.id?r.forceDiscardJourney(i.id,t):(u===0?r.forceDiscardJourney(i.id,t):r._closeBladeRecursive(n,u,t),r._compositionGraph.removeBlade(n))}),undefined,u)},t.prototype.canCloseBlade=function(n,t){var u=this,r=t||this.activeJourney(),i;return r?(i=function(n){var f=!!(n.bladeDefinition&&n.bladeDefinition.actionBar),t;return!ko.unwrap(n.editScopeId)&&n.shouldAlertOnClose(f)?!0:n.isInitialized&&!n.children.some((function(n){return n.children.some((function(n){return n.suppressAlert()}))}))&&r.ambientSettings.getItemsInPath(n.journeyPath).some((function(n){var i=n.value,t=i&&i.editScope;return t&&t.dirty&&!t.saving}))?!0:(t=u._finder.findBlades(n),t.length===0)?!1:t.some((function(n){return i(n)}))},!i(n)):!0},t.prototype.forceDiscardJourney=function(n,t){var i=this,r,u;((r=this.activeJourney())===null||r===void 0?void 0:r.id)===n?this._changeJourney((function(){i._closeActiveJourney(!1,t)})):n===((u=this._helpPaneJourney)===null||u===void 0?void 0:u.id)&&this._helpPaneJourney.children.slice(0).forEach((function(n){i._compositionGraph.removeBlade(n);n.isDisposed()||i._closeBladeRecursive(n,0,t,!1)}))},t.prototype.tryDiscardJourney=function(n){var t=!1;return(this.canDiscardJourney(n)||this._browser.confirm(p.confirmEditScopeDiscard))&&(this.forceDiscardJourney(n),t=!0),t},t.prototype.canDiscardJourney=function(n){var t,i=((t=this.activeJourney())===null||t===void 0?void 0:t.id)===n&&this.activeJourney(),r=i&&i.ambientSettings.getObservable().peek().some((function(n){var i=n.value,t=i&&i.editScope;return t&&t.dirty&&!t.saving&&t.disposeOnJourneyDiscard}));return!i||!r},t.prototype.discardEditsOfBlade=function(n,t){return this._discardEditsOfContainer(n,t.force,(function(i){var r=i.value,u=i.path,f=n.journeyPath,e=g(u,f),o=!e&&(r.type===1||u.length>=f.length+2);return r&&r.editScope&&(t.includeSelf&&e||t.includeDescendants&&o)}))},t.prototype.dispose=function(){this.activeJourney()&&(this.activeJourney().dispose(!0),this.activeJourney(null));this._helpPaneJourney&&(this._helpPaneJourney.dispose(),this._helpPaneJourney=null)},t.prototype.getJourneyIdForTile=function(n){var t=this.activeJourney(),i;return t&&t.originTile.id===n&&(i=t.id),i},t.prototype._discardEditsOfContainer=function(n,t,i){var s=this,u=[],r={confirmationRequired:!1,successful:!1},e=this.activeJourney(),f;if(!e)throw new Error(y.noActiveJourney);return f=e.ambientSettings,(n.containerType===0||n.isInitialized)&&(u=f.getItemsInPath(n.journeyPath).filter(i)),r.confirmationRequired=!t&&u.filter((function(n){var t=n.value.editScope;return t.dirty&&!t.saving})).length>0,(!r.confirmationRequired||this._browser.confirm(p.confirmEditScopeDiscard))&&(r.successful=!0,u.forEach((function(n){f.removeItem(n.path);s._diContainer.get(o.EditScopeManager).onEditScopeDisposed(n.value.editScope.editScopeId)}))),r},t.prototype._closeActiveJourney=function(n,t){var u=this,r=this.activeJourney(),i;this.setActiveJourney(null);this._compositionGraph.removeAllBlades(this._startBoard);r&&(r.children.slice(0).forEach((function(i){i.isDisposed()||u._closeBladeRecursive(i,0,t,n)})),r.dispose(n));this._view.removeAllBlades((function(n){v.error("DesktopManager: Found un-tracked blade '{0}' in view after closing active journey. It will be forcefully removed.".format(n))}));i=this._portal.sideBar;i&&(i.menuBladePartContainer(null),i.menuBladeId(null))},t.prototype._closeBladeRecursive=function(n,t,i,r){this._removeBladesFromUIRecursive(n);this._disposeBladesRecursive(n,t,r);r||(n.parent.save(),this._portal.customEvents.trigger("fxbladeclosed",{id:n.id,reason:i,masterPartId:n.masterPartId}))},t.prototype._removeBladesFromUIRecursive=function(n){for(var i=this._finder.findBlades(n),t=i.length-1;t>=0;t--)this._removeBladesFromUIRecursive(i[t]);this._view.removeBlade(n)},t.prototype._disposeBladesRecursive=function(n,t,i){var u=this,r=n.parent.children.indexOf(n,t);i?n.dispose(!0):n.parent.removeChildAt(r,undefined);this._finder.findBlades(n).forEach((function(n){u._disposeBladesRecursive(n,r,i)}))},t.prototype._getAlertMessageRecursive=function(n){var t=this,i=function(n){var i=MsPortalFx.mapMany(t._finder.findBlades(n),(function(n){return n.getAlertOnCloseMessages()}));return MsPortalFx.union(n.getAlertOnCloseMessages(),i)};return i(n)},t.prototype._findFirstItemIndex=function(n,t,i){var r=MsPortalFx.findIndex(n,(function(n){return n.id===t}));if(r===-1){v.verbose(ko.toJSON(this.getDiagnosticsData(),null,2));throw new Error(i);}return r},t.prototype.getJourneyWidget=function(){return this._portal.panorama.getJourneyWidget()},t.prototype._masterIsMenuBlade=function(n){var t=n&&n.masterContainer,i=t&&t.bladeDefinition;return!!(i&&i.menuBlade)},t.prototype._moveMenuBladeWidget=function(n){var c=this.activeJourney(),u=c&&c.children,f=n.sideBar,l=f.menuBladeId,a=ko.unwrap(f.layoutMode),e=f.getRootElement().findByClassName("fxs-sidebar-menu-container"),r=f.menuBladePartContainer,v=function(n,t){r(t);l(n)},t,o,h,y,i;if(u&&u.length){if(t=u[u.length-1],o=t.bladeDefinition,o&&o.menuBlade)return;var p=t.flags&3,w=this._masterIsMenuBlade(t.masterContainer),b=this._masterIsMenuBlade(t),s=p?t.masterContainer&&t.masterContainer.masterContainer:t.masterContainer;if(b){h=s.getMenuWidget();y=$(h.element);a===0&&l()!==s.id&&(i=e.findByClassName("fxc-menu"),i.length&&(i.detach(),r()&&i.appendTo(r())),y.appendTo(e));v(s.id,h.getPartContainer());return}w&&a===0&&(i=e.findByClassName("fxc-menu"),i.length&&i.detach(),r()&&i.appendTo(r()))}v()},t.prototype._loadModules=function(){return __awaiter(this,void 0,void 0,(function(){var n,t,i;return __generator(this,(function(u){switch(u.label){case 0:return!this._createJourney?[4,Promise.all([r.get("MsPortalImpl/UI/Compositions/UI.Composition.Journey","create"),r.get("MsPortalImpl/UI/Compositions/UI.Composition.Blade","create")])]:[3,2];case 1:n=u.sent();t=n[0];i=n[1];this._createJourney=t;this._createBlade=i;u.label=2;case 2:return[2]}}))}))},__decorate([__metadata("fx:diagnostics",[n,"JourneyManager"]),i.Class(),__metadata("design:paramtypes",[i.Container,l.Browser,s.Finder,h.CompositionGraph,c.DesktopManagerView])],t)})();t.JourneyManager=b}));
define("MsPortalImpl/UI/Compositions/UI.Composition.Base",["require","exports","Fx","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Settings.Schema"],(function(n,t,i,r,u,f,e){"use strict";function h(n,t,i){i=i||MsPortalFx.getUniqueId();var r=y[n];return r+=t?"-"+t.name:"",r+("-"+i)}function p(n,t,i,r){return MsPortalFx.tryImmediateResolve(MsPortalFx.require(t,r),(function(t){if(!n||!n.isDisposed())try{return i(t)}catch(r){return Q.reject(r)}}))}function w(n,t){for(var i=n,r;i;)(i.hasOwnProperty(t)||typeof i[t]=="function")&&(r=i),i=i.parent;return r||o.error("Could not locate container with property or function '"+t+"' for composition '"+n+"'."),r}function b(n){return FxImpl.isSerializedObject(n)?FxImpl.fromSerializableObject(n):{}}var c;Object.defineProperty(t,"__esModule",{value:!0});t.createContainerModel=t.Instance=t.compositionRequire=t.createIdentifier=void 0;var l=FxImpl.TriggerableLifetimeManager,a=MsPortalFx.Base,v=a.Diagnostics,y=u.CompositionType,o=v.createLog(n),s=u.getIdMatchFunc;t.createIdentifier=h;t.compositionRequire=p;c=(function(n){function t(t,r,u,e,o,s,c){var l=n.call(this)||this,a;return l._childObjects=ko.observableArray(),l._disposeCallbacks=$.Callbacks("memory once"),l._composedDeferred=i.defer(),l.isComposed=!1,l.diContainer=r,l._sharedSettings=r.get(f.SettingsManager),l.locator=u,l.id=s||h(l.getCompositionType(),u,c&&c.toString()),l.widgetState=ko.observable(o||{}),l._addChildrenInternal(e),a=l._composedDeferred.resolve,l._composedDeferred.resolve=function(n){a.apply(l._composedDeferred,[n]);l.isComposed=!0},l._toStringPrefix="{ Name: "+(t||"<NOT SPECIFIED>")+", Type: ",l}return __extends(t,n),Object.defineProperty(t.prototype,"children",{get:function(){return this._childObjects()},enumerable:!1,configurable:!0}),t.prototype.subscribeChildren=function(n){return this._childObjects.subscribe(this,n)},Object.defineProperty(t.prototype,"templateKey",{get:function(){return""+(this.locator||this.id)},enumerable:!1,configurable:!0}),t.prototype.getPerfData=function(){return{}},t.prototype.getCompositionType=function(){throw new Error("The getCompositionType method is not implemented.");},t.prototype.getCreationState=function(){return this._creationState},t.prototype.toString=function(){var n=this._toStringPrefix,t=this._toStringPostfix||(this._toStringPostfix=", Id: "+this.id+" }");return n+=this.locator||"<null>",n+t},t.prototype.compose=function(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];if(this._composeInvoked)throw new MsPortalFx.Errors.Error("Composition '"+this.id+"' is already composed.");this._composeInvoked=!0;this._compose.apply(this,__spreadArray([n,this._composedDeferred],i))},t.prototype._compose=function(){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];throw new Error("Not implemented.");},t.prototype.resetLayout=function(){var n=this.children;n&&n.forEach((function(n){n.resetLayout()}))},t.prototype.dispose=function(t){this.isDisposed()||(n.prototype.dispose.call(this),this._disposeCallbacks.fire(),t||this._deleteSetting(),this.children.slice(0).forEach((function(n){n.dispose(t)})))},t.prototype._deleteSetting=function(){if(this._store!==undefined)this._sharedSettings.deleteSettings({store:this._store,keys:[this.id]});else if(this.parent){var n=this.parent.children,t=MsPortalFx.find(n,s(this.id));t&&n.remove(t);this.parent.save()}},t.prototype.save=function(n){var t,i;this._store!==undefined?(t=this._sharedSettings,t&&(i=this.toJSON(),t.setSetting(this._store,this.id,JSON.parse(JSON.stringify(i))),n===1&&t.flushSettings())):this.parent&&this.parent.save(n)},t.prototype.await=function(n){switch(n){case 0:return Promise.resolve(!1);case 3:return Promise.resolve(null);case 7:return this._composedDeferred.promise}throw new MsPortalFx.Errors.Error("Await reason not supported");},t.prototype.onDispose=function(n){this._disposeCallbacks.add(n)},t.prototype.offDispose=function(n){this._disposeCallbacks.remove(n)},t.prototype.addChild=function(n,t,i){i===void 0&&(i=!0);n&&this.addChildren([n],t,i)},t.prototype.addChildren=function(n,t,i){i===void 0&&(i=!0);this._addChildrenInternal(n,t);i&&this.save()},t.prototype._addChildrenInternal=function(n,t){var r=this,i;t===void 0&&(t=this.children.length);n&&n.length>0&&(i=this._childObjects(),n.forEach((function(n){i.splice(t,0,n);n.parent=r;t++;r.addChildWidget(n.widget)})),this._childObjects(i))},t.prototype.removeChildren=function(n){for(var t=this.children.length-1;t>=0;t--)this.removeChildAt(t,n,!1);this.save()},t.prototype.removeChildAt=function(n,t,i){if(i===void 0&&(i=!0),n>=0){var r=this._childObjects.splice(n,1)[0];this.removeChildWidget(r.id,t);t||r.dispose();i&&this.save()}},t.prototype.replaceChild=function(n,t){var i=this._childObjects,r;n&&t&&i&&(r=i.indexOf(n),r>=0&&(i.splice(r,1,t),t.parent=this,this.save()))},t.prototype.removeChild=function(n,t,i){if(i===void 0&&(i=!0),n&&this._childObjects){var r=this._childObjects.indexOf(n);this.removeChildAt(r,t,i)}},t.prototype.addChildWidget=function(n){this.widget&&n&&this.widget.addChild(n)},t.prototype.removeChildWidget=function(n,t){this.widget&&this.widget.removeChild(n,t)},t.prototype.getChildById=function(n){return this._childObjects?MsPortalFx.find(this._childObjects(),s(n)):null},t.prototype.toJSON=function(n){var t={},i=this.children,r=n?i.filter(n):i;return this.id!==e.startBoardSettingsKey&&r.forEach((function(n){t[n.id]=n.toJSON()})),{id:this.id,locator:this.locator,widgetState:this.widgetState(),errorMessage:this.unrecoverableErrorMessage,children:r.map((function(n){return n.id})),childSettings:t}},t.prototype.loadFromJson=function(n){this.unrecoverableErrorMessage=n.errorMessage},t.prototype.getBindableContainer=function(){return this._bindableContainer||(this._bindableContainer=w(this,"getViewModel")),this._bindableContainer},t.prototype.getDiagnosticsData=function(){return $.extend(this.toJSON(),{id:this.id,locator:this.locator&&this.locator.toString(),errorMessage:this.unrecoverableErrorMessage,children:(this.children||[]).map((function(n){return n.getDiagnosticsData()}))})},t.prototype.definitionExists=function(n){var t=this.diContainer.get(r.DefinitionFinder),i=this.locator;return t.tryLocate(i,{})?0:t.tryLocate(i.getExtensionLocator(),{})&&n?1:2},t.prototype.discardWidgetStateOfUnusedChildren=function(){if(this.widget){var n=this.widget.discardStateOfUnusedChildren();n&&n.stateDiscarded&&o.warning("Unused widget state was discarded for composition '{0}'. \n{1} \nCurrent Children: {2}\nCurrent Widget State: {3}".format(this,n.message,JSON.stringify((this.children||[]).map((function(n){return""+n}))),JSON.stringify(this.widgetState())))}},t.prototype._markAsComposed=function(){this._composedDeferred.resolve()},t})(l);t.Instance=c;t.createContainerModel=b}));
define("MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding",["require","exports"],(function(n,t){"use strict";function g(n,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return d(b,this,[n,t].concat(r.map(ko.toJS)))}function r(n,t,i){for(var f=t?t.split("."):[],u={exists:n&&f.length>0,value:undefined},r=n,e=0,o=i?ko.utils.peekObservable:ko.unwrap;u.exists&&e<f.length;)r=o(r),r&&r.hasOwnProperty(f[e])?r=r[f[e]]:u.exists=!1,e++;return u.exists&&(u.value=r),u}function e(n,t,i){for(var o=function(i){if(!i||typeof i!="object")throw new Error(tt("A property in model hierarchy is not an object. Path: '{0}'.".format(t),n));return i},f=t.split("."),u=o(n),r,e=0;e<f.length-1;e++)r=f[e],MsPortalFx.isNullOrUndefined(u[r])&&(u[r]={}),u=o(ko.unwrap(u[r]));r=MsPortalFx.last(f);u[r]&&ko.isObservable(u[r])?u[r](i):u[r]=i}function o(n){var t;try{t=ko.toJSON(n)}catch(i){return i.message}return t}function tt(n,t){var i=o(t);return i?"{0}\nModel: '{1}'".format(n,i):n}function it(n,t,i,u){var o=s(u,l),f={};return Array.isArray(t)&&t.forEach((function(t){var u=t.source,c=t&&u&&u.scope===a.CurrentContainer&&u.modelType===i,s=c&&r(n,u.property);s&&s.exists&&(h(o,t.targetProperty,s.value),e(f,t.targetProperty,ko.toJS(s.value)))})),f}function s(n,t){if(t){var e=n.toLowerCase(),i=function(n){return MsPortalFx.isPlainObject(n)&&!MsPortalFx.isEmptyObject(n)?Object.keys(n).every((function(n){return e.indexOf(n.toLowerCase())>=0})):!1},r=i(t.debug),o=i(t.log),u=i(t.verbose),f;return(o||r||u)&&(f={debugId:n,breakOnInputsSet:r,verbose:u}),f}}function h(n,t,i){n&&n.verbose&&!MsPortalFx.canSendThroughPostMessage(i)&&c.verbose("Inputs should be simple data objects without functions/observables: {0} | {1} | {2}".format(n.debugId,t,ko.toJSON(i)))}function y(n){return n&&n.modelType===t.inferredReferenceType}function rt(n){return n.isDynamicBinding&&!y(n.source)}var a,nt,i,f,u,v;Object.defineProperty(t,"__esModule",{value:!0});t.isDynamicBindingWithNonLocalSource=t.isOverridesOrContainerModelSourceReference=t.inferredReferenceType=t.extractTraceOptions=t.mapSourceModelToTargetModel=t.PropertyBindings=t.setModelValue=t.getModelValue=t.PropertyBinding=t.PropertyTransformerArgs=t.ObservableChangeArgs=t.ReferenceCardinality=t.ReferenceScope=void 0;var p=FxImpl.TriggerableLifetimeManager,w=MsPortalFx.Base,c=w.Diagnostics.createLog(n),l=MsPortalFx.trace.inputsset,b=Array.prototype.splice,k=FxImpl.quickApplyArrayEdits,d=MsPortalFx.applyCall;(function(n){n[n.CurrentContainer=0]="CurrentContainer";n[n.MasterContainer=1]="MasterContainer";n[n.DetailsContainer=2]="DetailsContainer"})(a=t.ReferenceScope||(t.ReferenceScope={})),(function(n){n[n.OneToOne=0]="OneToOne";n[n.OneToMany=1]="OneToMany";n[n.ManyToOne=2]="ManyToOne"})(nt=t.ReferenceCardinality||(t.ReferenceCardinality={}));i=(function(){function n(n,t){this.kind=n;this.propertyName=t}return n.forObject=function(t,i,r){var u=new n(0,t);return u.propertyValue=i,u.propertyOldValue=r,u},n.forArray=function(t,i){var r=new n(1,t);return r.propertyArrayEdits=i||[],r},n.forNewArray=function(t,i){var r=new n(1,t);return r.propertyValue=i,r},n})();t.ObservableChangeArgs=i;f=(function(){function n(n,t,i,r,u){this.cancel=!1;this.propertyChanges=[];this.sourceModelId=n;this.sourceModel=t;this.sourceProperty=i;this.targetModel=r;this.targetProperty=u}return n})();t.PropertyTransformerArgs=f;u=(function(){function n(n,t,i,r,u,f){this.transformers=[];this.compositionBindingDefinition=null;this._callbacks=$.Callbacks();this._errCallbacks=$.Callbacks();this._awaitBound=Q.defer();this._tgtHasValue=!1;this.sourceProperty=n;this.targetProperty=t;this.targetModel=i;this._tgtModelName=r;this.transformers=u;this._tgtPropExists=f;this._traceOptions=s(r,l)}return n.prototype.sourceModelName=function(){return this._srcModelName},Object.defineProperty(n.prototype,"sourceModel",{get:function(){return this._srcModel},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isBound",{get:function(){return!!this._srcModel},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"awaitBound",{get:function(){return this._awaitBound.promise},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"targetHasValue",{get:function(){return this._tgtHasValue},enumerable:!1,configurable:!0}),n.prototype.addValueChangedHandler=function(n){n&&this._callbacks.add(n)},n.prototype.removeValueChangedHandler=function(n){this._callbacks.remove(n)},n.prototype.addErrorHandler=function(n){n&&this._errCallbacks.add(n)},n.prototype.bind=function(n,t,r,u,f){var e=this,h,c,o,s;if(r===void 0&&(r=!0),this.isBound){this._err("Property binding is already bound.");return}return this.addValueChangedHandler(u),this.addErrorHandler(f),this._validateBinding(n,t)?(this._srcModelName=n,this._srcModel=t,h=this._getSrcValue(),c=ko.utils.peekObservable(h),r&&c!==undefined&&this._changeTgtModel(i.forObject(this.targetProperty,c)),ko.isObservable(h)?(o=h,this._bindingLifetime=new p,o.subscribe(this._bindingLifetime,(function(n){var t,u,r;Array.isArray(n)?(u=n,t=n.slice(0)):t=n;(o.splice||o.map)&&(r="arrayChange");s&&s.dispose();s=e._bindingLifetime.createChildLifetime();o.subscribe(s,(function(n){var f,h;s.dispose();s=undefined;r==="arrayChange"&&(f=n,n=o());Array.isArray(t)&&Array.isArray(n)?u===n?(f=f||ko.utils.compareArrays(t,n,{sparse:!0}),h=i.forArray(e.targetProperty),h.propertyArrayEdits=ko.utils.adjustArrayEdits(f),e._changeTgtModel(h)):e._changeTgtModel(i.forNewArray(e.targetProperty,n)):e._changeTgtModel(i.forObject(e.targetProperty,o(),t))}),null,r)}),null,"beforeChange")):r||this._err("Error when binding. The value is not an observable and importInitialValue is false."),this._awaitBound.resolve()):this._awaitBound.reject(),this},n.prototype.unbind=function(){this._bindingLifetime&&this._bindingLifetime.dispose();this._srcModel=null;this._srcModelName=null;this._callbacks.empty();this._errCallbacks.empty()},n.prototype.toString=function(){return"\n\nDetails:\nSource model id: '{0}'.\nSource property: '{1}'.\nTarget model id: '{2}'.\nTarget property: '{3}'.\nSource model: '{4}'.\nTarget model: '{5}'.".format(this._srcModelName||"<UNBOUND>",this.sourceProperty,this._tgtModelName,this.targetProperty||"<DYNAMIC>",this._srcModel?o(this._srcModel):"<UNBOUND>",o(this.targetModel))},n.prototype._changeTgtModel=function(n){var i=this,u=new f(this._srcModelName,this._srcModel,this.sourceProperty,this.targetModel,this.targetProperty),t,o;n&&u.propertyChanges.push(n);this._processTransformers(u)&&((u.propertyChanges||[]).forEach((function(n){var u,f,s;n.propertyName&&(u=i._traceOptions,n.kind===0?(i._tgtHasValue=n.propertyValue!==undefined,h(u,n.propertyName,n.propertyValue),e(i.targetModel,n.propertyName,ko.toJS(n.propertyValue))):(t=r(i.targetModel,n.propertyName).value,o=ko.unwrap(t),f=n.propertyArrayEdits,Array.isArray(o)?f?(u&&u.verbose&&f.forEach((function(t){t.status==="added"&&h(u,n.propertyName,t.value)})),ko.isObservable(t)&&t.valueWillMutate(),i._tgtHasValue=!0,k(o,f,{inplaceFixup:!1,spliceFunc:g}),ko.isObservable(t)&&t.valueHasMutated()):n.propertyValue&&(i._tgtHasValue=!0,s=n.propertyValue,t.splice?t.splice.apply(t,[0,o.length].concat(s)):t(s)):i._err("[Property Binding] Array change detected on source property, but target property is not an array.")))})),this._callbacks.fire(u.propertyChanges))},n.prototype._processTransformers=function(n){return this.transformers.some((function(t){return t(n),n.cancel})),!n.cancel},n.prototype._getSrcValue=function(){return r(this._srcModel,this.sourceProperty).value},n.prototype._validateBinding=function(n,t){var i,r=this.compositionBindingDefinition,u=!(r&&r.optional);return this._validateModel(n,t,this.sourceProperty,u,(function(n){i=n}))?this.sourceProperty?this._validateModel(this._tgtModelName,this.targetModel,this.targetProperty,this._tgtPropExists,(function(n){i=n}))||(i="[Property Binding] Invalid target model - {0}".format(i)):i="[Property Binding] Invalid source model - Source property must be defined.":i="[Property Binding] Invalid source model - {0}".format(i),i&&this._err(i),!i},n.prototype._validateModel=function(n,t,i,u,f){var e;return n?t?i&&u&&!r(t,i).exists&&(e="Model is missing property '{0}'.".format(i)):e="Model is undefined.":e="Model is missing an identifier.",e&&f&&f(e+"\nModel id: '{0}'.".format(n||"N/A")),!e},n.prototype._err=function(n){this.isBound&&(n+=""+this);var t=MsPortalFx.trace;(MsPortalFx.isDevelopmentMode||t&&t.diagnostics)&&c.error(n);this._errCallbacks.fire(n)},n})();t.PropertyBinding=u;t.getModelValue=r;t.setModelValue=e;v=(function(){function n(n,t,i){var r=this;this._properties=[];this._propertyChangedCallbacks=$.Callbacks();this._aggregatePropertyChangedHandler=function(n){r._propertyChangedCallbacks.fire(n)};this._targetModel=t;this._targetModelName=n;this._validateTargetPropertiesExist=i!==!1}return Object.defineProperty(n.prototype,"properties",{get:function(){return this._properties.slice(0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"targetModelName",{get:function(){return this._targetModelName},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"targetModel",{get:function(){return this._targetModel},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"awaitAllBound",{get:function(){var n=this._properties.map((function(n){return n.awaitBound}));return Q.all(n)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"allBound",{get:function(){return this.properties.every((function(n){return n.isBound}))},enumerable:!1,configurable:!0}),n.prototype.addPropertyChangedHandler=function(n){this._propertyChangedCallbacks.add(n)},n.prototype.addProperty=function(n){for(var i,r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return i=new u(n,n,this._targetModel,this._targetModelName,r,this._validateTargetPropertiesExist),i.addValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.push(i),i},n.prototype.mapProperty=function(n,t){for(var r,f=[],i=2;i<arguments.length;i++)f[i-2]=arguments[i];return r=new u(n,t,this._targetModel,this._targetModelName,f,this._validateTargetPropertiesExist),r.addValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.push(r),r},n.prototype.removeProperty=function(n){var t=this._properties.indexOf(n);t>=0&&(this._properties[t].unbind(),this._properties[t].removeValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.splice(t,1))},n.prototype.getProperty=function(n){return MsPortalFx.find(this._properties,(function(t){return t.targetProperty===n}))},n.prototype.unbind=function(){this._properties.forEach((function(n){n.unbind()}));this._propertyChangedCallbacks.empty()},n.prototype.toString=function(){for(var t="",i=this.properties,r=this.properties.length,n=0;n<r;++n)t+="properties[{0}]: {1}".format(n,i[n].toString());return t},n})();t.PropertyBindings=v;t.mapSourceModelToTargetModel=it;t.extractTraceOptions=s;t.inferredReferenceType=-999;t.isOverridesOrContainerModelSourceReference=y;t.isDynamicBindingWithNonLocalSource=rt}));
define("MsPortalImpl/UI/Compositions/UI.Composition.PropertyTransformers",["require","exports","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding"],(function(n,t,i){"use strict";var r;return (function(t){var u=MsPortalFx.Base.Diagnostics,r=u.createLog(n),f;(function(n){function e(){var n=function(n){var t=n.propertyChanges||[],i=t.length===1&&t[0].propertyValue,f=(i||{}).hasOwnProperty("detailBladeInputs");return i&&!f&&r.error(u.invalidNewValue.format(n.sourceModelId,JSON.stringify(n))),f};return function(t){if(n(t)){var i=t.propertyChanges[0],r=i.propertyValue;i.propertyValue=r.detailBladeInputs}}}function o(){return function(n){var t,r,u=n.propertyChanges||[];if(u.length===1&&MsPortalFx.isPlainObject(u[0].propertyValue)){t=n.propertyChanges[0].propertyValue;n.propertyChanges=[];for(r in t)t.hasOwnProperty(r)&&n.propertyChanges.push(i.ObservableChangeArgs.forObject(r,t[r]))}}}function s(){var n=function(n,t){var i=!0;return Array.isArray(t)?t.length!==1&&(i=!1):(r.error(f.invalidNewValue.format(n.sourceModelId,JSON.stringify(t))),i=!1),i};return function(t){var u=ko.unwrap(i.getModelValue(t.sourceModel,t.sourceProperty).value)||[],r;n(t,u)?(r=t.propertyChanges[0],r.kind=0,r.propertyValue=u[0],r.propertyArrayEdits=null):t.cancel=!0}}function h(){var n=null,u=function(n,i){var u=!0;return!i||!i.propertyChanges||i.propertyChanges.length<1?(r.error(t.invalidPropertyChange.format(i.sourceModelId,JSON.stringify(i))),u=!1):Array.isArray(i.propertyChanges[0].propertyValue)||i.propertyChanges[0].propertyArrayEdits&&i.propertyChanges[0].propertyArrayEdits.length>0?(r.error(t.invalidNewValue.format(i.sourceModelId,JSON.stringify(i))),u=!1):Array.isArray(n)||(r.error(t.invalidCurrentValue.format(i.sourceModelId,n)),u=!1),u};return function(t){var e=ko.unwrap(i.getModelValue(t.targetModel,t.targetProperty).value),r,o,f,s=function(n,t){return MsPortalFx.findIndex(n,(function(n){return MsPortalFx.deepEquals(n,t)}))};u(e,t)&&(o=n===undefined?-1:s(e,n),r=t.propertyChanges[0],f=ko.unwrap(r.propertyValue),r.propertyArrayEdits=[],r.kind=1,o>=0&&n!==f&&r.propertyArrayEdits.push({status:"deleted",index:o,moved:null,value:n}),f!==undefined&&s(e,f)===-1&&r.propertyArrayEdits.push({status:"added",index:0,moved:null,value:f}),n=f);t.cancel=!r||!r.propertyArrayEdits||!r.propertyArrayEdits.length}}var u={invalidNewValue:"[DynamicSelectionTransformer] [{0}] Source value does not implement MsPortalFx.ViewModels.DynamicSelection. Transformer Args: '{1}'"},f={invalidNewValue:"[ManyToOneTransformer] [{0}]: Source value '{1}' must be an array."},t={invalidPropertyChange:"[OneToManyMergeTransformer] [{0}]: No property change detected on source. Transformer Args: '{1}'.",invalidNewValue:"[OneToManyMergeTransformer] [{0}]: Source cannot be an array. Transformer args: '{1}'",invalidCurrentValue:"[OneToManyMergeTransformer] [{0}]: Target value '{1}' must be an array."};n.getDynamicSelectionMapper=e;n.getModelToPropertyMapper=o;n.getManyToOne=s;n.getOneToManyMerge=h})(f=t.PropertyTransformers||(t.PropertyTransformers={}))})(r||(r={})),r}));
define("MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder",["require","exports","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.PropertyTransformers"],(function(n,t,i,r,u,f,e){"use strict";function k(n){var t=Q();return{getStateAsyncSequenced:function(){return t=t.then(n,n)}}}var d;Object.defineProperty(t,"__esModule",{value:!0});t.CompositionBinder=t.onInputsSetTimeout=void 0;var a=FxImpl,v=a.TelemetryContext,y=MsPortalFx.Base,p=y.Diagnostics,o=i.ReferenceScope;t.onInputsSetTimeout=5e3;var c=MsPortalFx.trace,w=c.inputsset,b=c.shellinputsset,s=p.createLog(n),l=i.extractTraceOptions,h=i.ReferenceCardinality;(function(n){function tt(n,t,r,u,f){var e=function(i,u){var f=r.mapProperty(i.source.property,i.targetProperty);f.transformers=ri(i);f.compositionBindingDefinition=i;u?f.bind(u.sourceModelName,u.sourceModel):ht(n,t,f)};u&&u.forEach((function(n){var t=f&&f(n),u=n.source.constantValue,h,o,s;t&&t.overridesConstantBindings?e(n,t):u!==undefined?(h="[Constant: {0}]".format(ko.toJSON(u)),o={},i.setModelValue(o,n.source.property,u),s=r.mapProperty(n.source.property,n.targetProperty),s.compositionBindingDefinition=n,s.bind(h,o)):e(n,t)}))}function lt(n,t,r){var u=(t||[]).every((function(n){return r&&i.getModelValue(r,n).exists}));return u||s.error("Model '{0}' is missing properties. Expected properties:'{1}', model:'{2}'".format(n,JSON.stringify(t)||"<null>",JSON.stringify(ko.toJS(r))||"<null>")),u}function at(n,t,r){var u=(t||[]).every((function(n){var t=r&&i.getModelValue(r,n);return t&&t.exists&&ko.unwrap(t.value)!==undefined}));return u||s.error("Model '{0}' is missing required properties or has them set to undefined. Required properties:'{1}', model:'{2}'".format(n,JSON.stringify(t)||"<null>",JSON.stringify(ko.toJS(r))||"<null>")),u}function vt(n){var r={},t,i;for(t in n)n.hasOwnProperty(t)&&(i=ko.toJS(n[t]),r[t]=Array.isArray(i)?ko.observableArray(i):ko.observable(i));return r}function it(n,t,i){return MsPortalFx.mapMany(n,(function(n){return(n.valuesFrom||[]).map((function(u){var f={property:u.property,modelType:u.referenceType,constantValue:u.constantValue,scope:o.CurrentContainer,cardinality:n.valuesFrom.length>1?h.OneToMany:h.OneToOne},s={targetProperty:n.property,source:f,optional:!!n.optional,isIdentityInput:!!n.isIdentityInput},e=u.part,c=t.locator.name;return(u.referenceType===0||u.partCommand)&&(f.partLocator=t.locator.getExtensionLocator().withPartInstance(e||c),r.isPartComposition(t)&&(!e||e===c)&&(f.id=t.id)),u.referenceType===4&&(f.modelId=u.bladeCommand||u.partCommand),i&&i(s,u),s}))}))}function yt(n,t){return(t||[]).forEach((function(t){var i=t.source,r=i&&i.partLocator;r&&(i.partLocator=u.Locator.fromJSON(n,r))})),t}function pt(n){return(n||[]).map((function(n){var t={targetProperty:n.targetProperty};return n.source&&(t.sourceProperty=n.source.property,t.sourcePartLocator=n.source.partLocator&&n.source.partLocator.toString(),t.sourceType=r.referenceTypeMap[n.source.modelType]||n.source.modelType,t.sourceScope=o[n.source.scope],t.sourceCardinality=h[n.source.cardinality]),t}))}function rt(n,t){var i=!1;return r.isPartComposition(n)&&!n.isDisposed()&&(i=t.id?n.id===t.id:n.eligibleForBinding&&n.locator.getExtensionLocator().withPartInstance(n.locator.name).equals(t.partLocator)),i}function wt(n,t){var i=ut(n,t);return i.inputsWatcherConfig&&p(i.inputsWatcherConfig),i}function ut(n,t){var u=[],r={allInputsSet:ko.observable(!1),calledOnInputsSet:ko.observable(!1),failedOnInputsSet:ko.observable(!1),definitionBindings:[],propertyBindings:new i.PropertyBindings(t.bindableTarget.viewModelName,{},!1)};return ft(t.referenceComposition,t.inputs,u,t.customInputBindingValidator)?(r.definitionBindings=it(t.inputs,t.referenceComposition),tt(n,t.referenceComposition,r.propertyBindings,r.definitionBindings,t.customBindHandler),r.inputsWatcherConfig=y({bindableTarget:t.bindableTarget,allInputsSet:r.allInputsSet,calledOnInputsSet:r.calledOnInputsSet,failedOnInputsSet:r.failedOnInputsSet,propertyBindings:r.propertyBindings,referenceComposition:t.referenceComposition,referenceCompositionIsContainer:t.referenceCompositionIsContainer,notifyWhenInputsChangeWithSameValues:!1,beforeViewModelPropertyUpdate:t.beforeViewModelPropertyUpdate,inputsSetCalled:t.inputsSetCalled})):s.error("{0} Reference: {1}.".format(JSON.stringify(u),t.bindableTarget.viewModelName)),r}function bt(n){p(y(n))}function y(n){return MsPortalFx.extend2(n,{propertyBindingsState:undefined,inputsSetTrace:w,shellInputsSetTrace:b,stateReader:!!n.getStateAsync&&k(n.getStateAsync)})}function p(n){var t,i;if(a(n,null,n.calledOnInputsSet()),!n.allInputsSet()){t=ii(n.propertyBindings);n.referenceComposition.onDispose((function(){g(t)}))}i=n;i.onInputsSetDiagnosticsHandle=t;n.propertyBindings.addPropertyChangedHandler((function(){i.onInputsSetCallsSuppressed||a(n,t)}))}function ft(n,t,i,u){var f,e=r.isPartComposition(n);return(t&&t.some((function(n){return n.property?n.valuesFrom&&n.valuesFrom.length===1?e||n.valuesFrom[0].referenceType!==0||n.valuesFrom[0].part?n.valuesFrom[0].referenceType===5&&n.valuesFrom[0].constantValue===undefined?f="'constantValue' must be defined if using 'Constant' reference type.":n.valuesFrom[0].constantValue!==undefined&&n.valuesFrom[0].referenceType!==5?f="'constantValue' can only be be defined when using 'Constant' reference type.":u&&(f=u(n)):f="Input binding that reference a Part must specify the source part name.":f="Input binding must define one and only one source valueFrom property.":f="Input binding must define a target property.",f||n.valuesFrom[0].referenceType!==4||(n.valuesFrom[0].bladeCommand||n.valuesFrom[0].partCommand?n.valuesFrom[0].bladeCommand&&n.valuesFrom[0].partCommand?f="Only one, 'bladeCommand' or 'partCommand' is allowed when using 'Command' reference type.":n.valuesFrom[0].part&&(f="'part' is not allowed when using 'Command' reference type."):f="'bladeCommand' or 'partCommand' is required if using 'Command' reference type."),!!f})),f)?(i.push(f),!1):!0}function c(n,t){var u=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return"| "+t.map((function(n){return(n.toString()+"                    ").slice(0,15)})).join("")},r=["-----------",u("Optional","isBound","hasValue","Input: Value"),],f=t.properties.map((function(n){return"{0}{1}: {2}".format(u(d(n),n.isBound,n.targetHasValue),n.targetProperty,ko.toJSON(n.targetHasValue?i.getModelValue(t.targetModel,n.targetProperty).value:undefined))}));r=r.concat(f);r.push("-----------");s.verbose("{0} Target Model: {1}\n{2}".format(n,t.targetModelName,r.join("\n")))}function a(n,t,i,r,u,f){function o(t){var i;return t&&(t.dontCallViewModelOnInputsSet=u,v.usingState((function(){i=gt(n,t)}),n.referenceComposition.getCreationState())),f?i:undefined}var e=et(n,t,i,!0,r);return e.then(o)}function kt(n){var t=n;t.onInputsSetCallsSuppressed=!0}function dt(n,t,i){var r;t===void 0&&(t=1);i===void 0&&(i=!1);r=n;r.onInputsSetCallsSuppressed=!1;var u=r.onInputsSetDiagnosticsHandle,f=!!(t&1),e=!!(t&2),o=!!(t&4);return a(n,u,f,e,o,i)}function et(n,t,i,r,u){var h=!n.propertyBindings.properties.some(ti),e=l(n.bindableTarget.viewModelName,n.inputsSetTrace),o=e&&e.verbose,f,s;return h?(f=ko.toJS(n.propertyBindings.targetModel),!r&&!MsPortalFx.canSendThroughPostMessage(f))?(n.propertyBindingsState=undefined,Q(null)):(g(t),!i&&n.notifyWhenInputsChangeWithSameValues||u||!MsPortalFx.deepEquals(f,n.propertyBindingsState)?(n.allInputsSet(!0),n.propertyBindingsState=f,s=n.beforeViewModelPropertyUpdate?MsPortalFx.tryImmediateResolve(n.beforeViewModelPropertyUpdate(f),(function(t){if(t)return ot(n,e);o&&c("onInputsSet not called, RBAC check failed.",n.propertyBindings)})):ot(n,e),MsPortalFx.tryImmediateResolve(n.getInputsMetadata&&n.getInputsMetadata()||Q({}),(function(t){return MsPortalFx.tryImmediateResolve(s,(function(i){var r={inputs:f,settings:i,traceOptions:e,viewModelName:n.bindableTarget.viewModelName,inputsMetadata:t,dontCallViewModelOnInputsSet:undefined,dashboardFilters:n.getDashboardFilters&&n.getDashboardFilters(),partFilters:n.getPartFilters&&n.getPartFilters()};return ni(n,r)?r:null}))}))):(o&&c("onInputsSet not called, new values are the same as current values.",n.propertyBindings),Q(null))):(o&&c("onInputsSet not called, missing required properties.",n.propertyBindings),n.propertyBindingsState=undefined,Q(null))}function ot(n,t){var u=n.referenceComposition,i,r;return(!u||!u.isDisposed())&&(i=n.bindableTarget,!i.viewModel||i.viewModel.updatePartInputValues)?(r=n.stateReader,r?r.getStateAsyncSequenced().then((function(n){return n||{}}),(function(){t&&t.verbose&&c("onInputsSet not called, failed to retrieve part settings.",n.propertyBindings);n.failedOnInputsSet(!0)})):Q({})):Q(null)}function gt(n,t){var r=n.bindableTarget.viewModel,u=t.inputs,f=t.settings,e=t.traceOptions,o=t.viewModelName,s=t.inputsMetadata,h=t.dontCallViewModelOnInputsSet,c=t.dashboardFilters,l=t.partFilters,i=r.updatePartInputValues(u,f,e,o,s,h,{dashboard:c||{},part:l});return st(n,t,i),i}function ni(n,t){var e=t.inputs,u=t.settings,f=t.traceOptions,i,r;return u&&(!n.referenceComposition||!n.referenceComposition.isDisposed())?(i=n.bindableTarget.viewModelName,r=l(i,n.shellInputsSetTrace),f&&f.verbose&&c("onInputsSet will be called, all required properties are set.",n.propertyBindings),r&&(s.verbose("Invoking onInputsSet of view model '{0}'.\nInputs: {1}.\nSettings: {2}".format(i,ko.toJSON(e),ko.toJSON(u))),r.breakOnInputsSet),!0):!1}function st(n,t,i){n.calledOnInputsSet(!0);n.inputsSetCalled&&n.inputsSetCalled(t.inputs,i||Q({}))}function ti(n){return n.targetHasValue?!1:!d(n)}function d(n){var t=n.compositionBindingDefinition,r=t&&t.optional,i=t&&t.source,u=i&&i.scope===o.DetailsContainer,f=r||u;return!!f}function ii(n){var i={handle:setTimeout((function(){var t,r,u;g(i);t=[];r=[];n.properties.forEach((function(n){var i=d(n),u="Target Input Name: {0} \nSource Model Name: {1} \nSource Property Name: {2} \nOptional: {3}".format(n.targetProperty,n.isBound?n.sourceModelName():"<UNBOUND>",n.isBound?n.sourceProperty:"<UNBOUND>",i);n.targetHasValue||i?r.push(u):t.push(u)}));u="onInputsSet is taking more time than expected for target model: {0}\n=== Missing Required Properties === \n{1}\n\n=== All Other Properties === \n{2}";s.warning(u.format(n.targetModelName,t.join("\n\n"),r.join("\n\n")))}),t.onInputsSetTimeout)};return i}function g(n){n&&n.handle&&(clearTimeout(n.handle),n.handle=null)}function ri(n){var t=[];return n.source.cardinality===h.OneToMany?t.push(e.PropertyTransformers.getOneToManyMerge()):n.source.cardinality===h.ManyToOne&&t.push(e.PropertyTransformers.getManyToOne()),n.opensDynamicBlades&&t.push(e.PropertyTransformers.getDynamicSelectionMapper()),n.targetProperty||t.push(e.PropertyTransformers.getModelToPropertyMapper()),t}function ht(n,t,i){if(t&&!t.isDisposed()){var r=ui(n,t,i.compositionBindingDefinition.source),u=ct(r,i,i.compositionBindingDefinition.source);u(n,t,r,i,i.compositionBindingDefinition.source)}}function ui(n,t,i){var h=n.get(f.Finder),e=h.findPartsContainer(t),r,u;switch(i.scope){case o.MasterContainer:r=e.masterContainer;break;case o.DetailsContainer:u=h.findBlades(e).filter((function(n){return n&&!(n.flags&2)}));u.length>1?s.error("Unable to bind composition to detail blade, multiple detail blades found. Reference Composition: '{0}', Detail Blades: '{1}'.".format(t.toString(),u.map((function(n){return n.toString()})).join(","))):r=u[0];break;default:r=e}return r}function ct(n,t,i){return n?i.partLocator?i.modelType===4&&t.compositionBindingDefinition.source.scope!==o.MasterContainer?oi:ei:si:fi}function fi(n,t,i,r){var e=n.get(f.Finder),u=e.findPartsContainer(t);MsPortalFx.tryImmediateResolve(u.awaitContainer(t,(function(n){return hi(u,n,r.compositionBindingDefinition.source)})),(function(i){var u=ct(i,r,r.compositionBindingDefinition.source);u(n,t,i,r,r.compositionBindingDefinition.source)}))}function ei(n,t,i,r,u){MsPortalFx.tryImmediateResolve(i.awaitComposedPart(t,(function(n){return rt(n,u)})),(function(i){nt(n,t,i,r)}))}function oi(n,t,i,r){nt(n,t,t,r)}function si(n,t,i,r){nt(n,t,i.getBindableContainer(),r)}function hi(n,t,i){var r=t.masterContainer,u;return t.isDisposed()?!1:t.locator.type!==1?!1:i.scope===o.MasterContainer?n.masterContainer&&n.masterContainer.id===t.id:i.scope===o.DetailsContainer?(u=n.diContainer.get(f.Finder),r&&r.id===n.id&&u.findBlades(n).length===1):r&&r.id===n.id}function nt(n,t,u,f){var v=f.compositionBindingDefinition.source,e=v.modelType,o=v.modelId,y="[Composition: {0}, ModelType:{1}, ModelId:{2}]".format(u.toString(),e,o||"<null>"),p,h,c,l,a;if(e===1||e===8)p=u.getViewModel(e,o),f.bind(y,p);else{h=function(n){u.isDisposed()||f.bind(y,n)};try{c=u.getViewModel(e,o);i.getModelValue(c,f.sourceProperty).exists&&h(c)}catch(w){}f.isBound||u.getViewModelAsync(e,o).then(h,(function(){t.isDisposed()||s.error("Failed to retrieve view model type '{0}' with id '{1}' from composition '{2}' to bind source property '{3}'.".format(r.referenceTypeMap[e]||e,o||"<none>",u.toString(),f.sourceProperty))}))}l=function(){f.unbind();u.offDispose(a)};a=function(){f.unbind();f.compositionBindingDefinition.autoRebindWhenSourceDisposes&&ht(n,t,f);t.offDispose(l)};u.onDispose(a);t.onDispose(l)}n.setupPropertyBindings=tt;n.modelHasProperties=lt;n.modelHasPropertiesWithValue=at;n.createObservableModel=vt;n.mapInputBindingDefinitions=it;n.bindingsFromJSON=yt;n.mapBindingsToFriendlyObjects=pt;n.isSourcePart=rt;n.bindViewModelInputs=wt;n.createBindViewModelResult=ut;n.setupAllInputsSetWatcher=bt;n.createAllInputsSetWatcherConfigExtended=y;n.setupAllInputsSetWatcherFromExtendedConfig=p;n.validateInputBindings=ft;n.callOnInputsSetIfNeeded=a;n.turnOnInputsSetSuppressionOn=kt;n.turnOnInputsSetSuppressionOff=dt;n.loadOnInputsSetParameters=et;n.notifyOnInputsSetCalled=st})(d=t.CompositionBinder||(t.CompositionBinder={}))}));
define("MsPortalImpl/Base/Base.Selectable2.Common",["require","exports","Fx/DependencyInjection"],(function(n,t,i){"use strict";var r,u,f;Object.defineProperty(t,"__esModule",{value:!0});t.OpenBladeTaskArgs=t.OpenBladeConfig=t.OpenBladeResources=void 0;r=(function(){function t(){}return __decorate([__metadata("fx:diagnostics",[n,"OpenBladeResources"]),i.Class("pipeline")],t)})();t.OpenBladeResources=r;u=(function(){function t(){}return __decorate([__metadata("fx:diagnostics",[n,"OpenBladeConfig"]),i.Class("pipeline")],t)})();t.OpenBladeConfig=u;f=(function(){function t(){}return __decorate([__metadata("fx:diagnostics",[n,"OpenBladeTaskArgs"]),i.Class("pipeline")],t)})();t.OpenBladeTaskArgs=f}));
define("MsPortalImpl/Base/Base.Selectable2",["require","exports","Fx/Composition/Selectable","MsPortalImpl/Base/Base.Events","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Base/Base.ItemCache","MsPortalImpl/Base/Base.Selectable2.Common","MsPortalImpl/Base/Base.Pipeline","MsPortalImpl/UI/UI.BladeOpener"],(function(n,t,i,r,u,f,e,o,s){"use strict";function g(n){var t=new FxImpl.TriggerableLifetimeManager;return n.setLifetimeReference(1,t),{selectable:n,dispose:function(){t.dispose()}}}function nt(n,t){return l(n,t)}function l(n,t){var r="Selectable",i=v.disposableData(t,r),u;return i||(u=new p(n,t),i=g(u),v.disposableData(t,r,i)),i.selectable}function tt(n,t,i){var r=f.rotAdd(n,t);i.attr(c,r);n.registerForDispose((function(){i.removeAttr(c)}))}function a(n){n=$(n[0].closest("["+c+"]"));var t=n.attr(c);return f.rotFind(t)}function it(n){var t=y(n);return t&&t.type===20560}function w(n){var t=y(n);return t&&t.type===19792}function rt(n,t,i,f,e){var v=this,y=f+"idmap",h=a(i),o=MsPortalFx.Base.ProxiedObservables.data(h,y),c;o||(o=h?MsPortalFx.Base.ProxiedObservables.data(h,y,{}):{});c=e;o[c]||(o[c]=ko.observable(),t.registerForDispose((function(){return delete o[c]})));var p=o[c],w=function(n){var r=i.closest(".fxs-tile").data(u.CompositionInstanceDataName)||t.createChildLifetime(),f=n;ko.reactor(r,(function(){var t=f.activationState(),i,r;t&&(i=t.previous&&t.previous.item,r=t.current&&t.current.item,i&&o[i]&&o[i](undefined),r&&o[r]&&o[r](n.value()))}))},l=b(n,f,h,w);return{activated:p,invokeClick:function(n,t,u){if(l){var f=(u===null||u===void 0?void 0:u.target)||i[0];l.invokeClickCallback(2,h,n,t,r.getOrCreateFxElement(f,h.internal.elements),c)}else t(null)},openBlade:l?function(t,i){return __awaiter(v,void 0,void 0,(function(){return __generator(this,(function(){return n.get(s.BladeOpener).openBlade(t,{selectable:l,telemetryName:i}),[2]}))}))}:function(){},openContextPane:l?function(t,i){return __awaiter(v,void 0,void 0,(function(){return __generator(this,(function(){return n.get(s.BladeOpener).openBlade(t,{selectable:l,flags:1,telemetryName:i}),[2]}))}))}:function(){}}}function ut(n){var t;if(n){var u=$(n),i=a(u),f=((t=i===null||i===void 0?void 0:i.internal)===null||t===void 0?void 0:t.elements)||ko.observableArray();return r.getOrCreateFxElement(u[0],f)}return null}function b(n,t,r,u){var e,o;if(!r)return undefined;var s=FxImpl.shellInterface(r.container),h=s.selectables(),f=h[t],c=!f;return c&&(e=$.extend(!1,h),f=e[t]=new i.Selectable2({supplyBladeReference:MsPortalFx.noop}),s.selectables(e)),o=l(n,f),c&&u&&u(o),o}var p,c;Object.defineProperty(t,"__esModule",{value:!0});t.getOrCreateOpenBladeSelectable=t.getOrCreateCachedFxElement=t.getFxClickSelectable=t.isProvisioningBladeReference=t.findExtensionViewModel=t.setSelectableContext=t.getOrCreate=t.createListSelectable=void 0;var v=MsPortalFx.Base.ProxiedObservables,y=FxImpl.shellInterface,k=500,d=1,h=o.createDescriptor(e.OpenBladeConfig,e.OpenBladeResources,e.OpenBladeTaskArgs);h.registerAsync("MsPortalImpl/Base/Base.Selectable2.Pipeline","OpenBladeRequestHandler",(function(){return!0}));h.registerAsync("MsPortalImpl/Base/Base.Selectable2.SupplyBladeReference","SupplyBladeReferenceHandler",(function(n,t,i){return!i.bladeRequest}));h.registerAsync("MsPortalImpl/Base/Base.Selectable2.PPV3","ParameterProviderV3SelectableHandler",(function(n,t,i){return it(i.bladeRequest.bladeReference)}),2);h.registerAsync("MsPortalImpl/Base/Base.Selectable2.Provisioning","OpenBladeHandler",(function(n,t,i){return w(i.bladeRequest.bladeReference)}),2);p=(function(n){function t(t,i){var r=n.call(this)||this,c,l;r.id=d++;r.callbacks=ko.observableArray();var e=ko.observable(),a=FxImpl.shellInterface(i),u=ko.observable(!1),p={selectable:r,selectedValue:e,extensionVm:a,callbacks:r.callbacks},v=h.createPipeline(t,r,{},p),y,f,o,s=0;return r.setLifetimeReference=function(n,t){n===(s&n)&&(s|=n,t.registerForDispose({dispose:function(){s^=n;s||r.dispose()}}))},r.value=ko.computed(r,{read:function(){var n=u()?e():undefined;return n!==undefined?(o&&o!==f&&(o=f),f=y):f&&(o=f,f=undefined),n},write:function(n){n===undefined&&(u(!1),e(undefined))}}),r.processRequest=function(n){var t=undefined,i;if(y=n,n){if((n.reason===3||n.reason===4)&&u(!0),n.reason===4){c(n.operationId,!!(n.flags&2),n.initialWidth);return}(n.reason===2||n.reason===3)&&(t=new Promise(function(n){return i=n}),v.startTask({bladeRequest:n,notifyBladeOpenCompleted:function(t){return i({operationId:n.operationId,success:t})}}))}return t},c=function(n,t,i){var f=r.createChildLifetime(),s=setTimeout((function(){var r=16;r|=t?8:0;e({operationId:n||MsPortalFx.getUniqueId(),flags:r,initialWidth:i})}),k),o=function(){f.dispose()};e.subscribe(f,o);u.subscribe(f,o);f.registerForDispose((function(){clearTimeout(s)}))},r.isSelected=ko.computed(r,{read:function(){return u()},write:function(n){if(u()!==n)if(u(n),n===!0){var t=MsPortalFx.getUniqueId();c(t);v.startTask({operationId:t,notifyBladeOpenCompleted:MsPortalFx.noop})}else e(undefined)}}),r.onClick=function(){r.isSelected(!0)},r.invokeClickCallback=function(n,t,r,u,f,e,o,s){t.invokeClickHandler(n,r,u,i,f,e,o,s)},l=function(n){return n?{item:n.selectedItem,metadata:n.controlMetadata}:undefined},r.activationState=ko.computed(r,(function(){r.value();var n=l(o),t=l(f);return{previous:n,current:t}})),a.requestOpenBlade((function(n){return r.processRequest(n)})),r}return __extends(t,n),t.prototype.isClickable=function(){return!0},t})(FxImpl.TriggerableLifetimeManager);t.createListSelectable=nt;t.getOrCreate=l;c="data-fxselectable";t.setSelectableContext=tt;t.findExtensionViewModel=a;t.isProvisioningBladeReference=w;t.getFxClickSelectable=rt;t.getOrCreateCachedFxElement=ut;t.getOrCreateOpenBladeSelectable=b}));
define("_generated/Less/MsPortalImpl/Interactions/Interactions.PrintHandler.css",["module"],(function(n){"use strict";return{css:"@media print{html,#web-container{-webkit-print-color-adjust:exact;color-adjust:exact}body{color-adjust:economy;background:none !important}@page{margin:.4in .2in}.fxs-show-startboard{background-color:inherit}pre,blockquote,tr,img,svg,[role=row],[role=figure],[role=img],.fxc-chart{break-inside:avoid}p,h2,h3,h4,h5,h6{orphans:3;widows:3}h2,h3,h4,h5,h6{break-after:avoid}.fxs-blade,.fxs-blade-content-container,.fxs-blade-content-wrapper{display:block !important}.fxs-journey-target,.fxs-journey-layout,.fxs-bladecontent{display:block !important}.fxs-blade-content-container-default,.fxs-blade-content-container-details{width:100% !important}.fxs-portal-main,.fxs-portal-content{flex:0 0 auto;display:block !important}.fxs-panorama{width:100%}#web-container,.fxs-home-target,.fxs-startboard-target,.fxs-sidebar-flyout,.fxs-journey-target{position:static !important}body,#web-container,.fxs-panorama,.fxs-home-target,.fxs-startboard-target,.fxs-sidebar-flyout,.fxs-journey-target,.fxs-journey-layout,.fxs-blade-content-wrapper{overflow:visible !important}.fxs-menublade .fxs-blade-content-container-default{display:none !important}.fxs-blade{box-shadow:none !important;width:100% !important}.fxs-blade:not(:last-of-type){display:none !important}.fxs-bladecontent-unlocked{background-color:transparent !important}html.fxs-printbladerequest .fxs-blade:not(.fxs-bladetoprint){display:none !important}html.fxs-printbladerequest .fxs-blade.fxs-bladetoprint{display:block !important}.fxs-startboard-layout{padding:25px}}.fxs-printmaxwidth{max-width:750px}",moduleId:n.id}}));
define("MsPortalImpl/Interactions/Interactions.PrintHandler",["require","exports","Fx/DependencyInjection","MsPortalImpl/Widgets/Widgets.Portal","FxInternal/Css","_generated/Less/MsPortalImpl/Interactions/Interactions.PrintHandler.css"],(function(n,t,i,r,u,f){"use strict";function s(){$.querySelectorAll(".fxs-vivaresize:not(.fxs-journey):not(.fxs-blade):not(.fxs-bladecontent):not(.fxs-blade-content)").addClass("fxs-printmaxwidth")}Object.defineProperty(t,"__esModule",{value:!0});t.PrintHandler=void 0;u.injectCss(f);var e=window,h=MsPortalFx.Base.Diagnostics.Telemetry,o=e.document.documentElement,c=(function(){function t(n){this._portalVm=n}return t.prototype.init=function(n){var t=this,i=this._portalVm,f=function(){var u=i.displayMode.value,r=t._telemetryName||"Shell/"+u,o=t._telemetrySource||"BrowserCommand",f=t._menuBladeCtx,n,e;return r==="Shell/Journey"&&(n=MsPortalFx.last(i.panorama.getJourneyWidget().getBlades()),n&&(r=n.getContentWidget().options.getTelemetryName(),f=n.options.isMenuBlade.peek()?n.options.getTelemetryName():null)),e={action:"PrintRequest",source:o,name:r,data:{displayMode:u,menuBladeCtx:f}},t._telemetryName=null,t._telemetrySource=null,t._menuBladeCtx=null,e},r=function(){$.querySelectorAll(".fxs-bladetoprint").removeClass("fxs-bladetoprint");o.classList.remove("fxs-printbladerequest");$.querySelectorAll(".fxs-vivaresize:not(.fxs-journey):not(.fxs-blade):not(.fxs-bladecontent):not(.fxs-blade-content)").removeClass("fxs-printmaxwidth");i.panorama.getJourneyArea().trigger("fxbladerepos")},u=function(){h.trace(f());s()};e.addEventListener("beforeprint",u);e.addEventListener("afterprint",r);n.registerForDispose((function(){e.removeEventListener("afterprint",r);e.removeEventListener("beforeprint",u)}))},t.prototype.printBlade=function(n,t){this._telemetryName=t.name;this._telemetrySource=t.source;this._menuBladeCtx=t.menuBladeCtx;o.classList.add("fxs-printbladerequest");n.classList.add("fxs-bladetoprint");s();Q.delay(333).then(e.print)},t.prototype.printDashboard=function(){this._telemetryName="Shell/Dashboard";this._telemetrySource="Dashboard";e.print()},__decorate([__metadata("fx:diagnostics",[n,"PrintHandler"]),i.Class(),__metadata("design:paramtypes",[r.ViewModel])],t)})();t.PrintHandler=c}));
define("MsPortalImpl/Base/Base.Selectable2.ClickContext",["require","exports"],(function(n,t){"use strict";function i(){return MsPortalFx.require("../UI/Compositions/UI.Composition.Selectable2Registrar",n)}function r(n,t,r,u){var f=ko.observable();return{onClick:function(e){if(f())f().onClick(e);else i().then((function(i){f()||f(i.getListSelectableWithClickHandler(n,t,r,u));f().onClick(e)}))},activationState:ko.pureComputed((function(){return f()?f().activationState():{previous:undefined,current:undefined}}))}}function u(n,t,r,u){function c(){o&&(o=!1,f().onClick());e&&(e=!1,f().isSelected(!0))}function h(){i().then((function(i){if(!f()){var e=i.getSelectableWithClickHandler(n,ko.unwrap(t),r,u);e&&(e.registerForDispose(s),f(e))}f()&&c()}))}function y(){f()?f().onClick():o||(o=!0,h())}var s=new FxImpl.TriggerableLifetimeManager,f=ko.observable(),o,e;ko.isObservable(t)&&t.subscribe(s,(function(){f(undefined)}));var l=ko.computed(s,{read:function(){return f()?f().isSelected():e},write:function(n){f()&&f().isSelected(n);n&&!e&&(e=!0,h())}}),a=ko.pureComputed((function(){return f()?f().isClickable():!1})),v=ko.pureComputed((function(){return f()?f().value():undefined}));return{isSelected:l,isClickable:a,value:v,onClick:y}}Object.defineProperty(t,"__esModule",{value:!0});t.getSelectableWithClickHandler=t.getListSelectableWithClickHandler=void 0;t.getListSelectableWithClickHandler=r;t.getSelectableWithClickHandler=u}));
define("MsPortalImpl/Interactions/Interactions.Command",["require","exports"],(function(n,t){"use strict";var i,r,u;Object.defineProperty(t,"__esModule",{value:!0});t.CommandImpl=t.FileInputOptions=t.CommandContext=void 0;i=(function(){function n(n,t){this.target=n;this.getFormTarget=t}return n})();t.CommandContext=i;r=(function(){function n(n,t){this.accept=n;this.maxFiles=t;this.files=ko.observable(null)}return n})();t.FileInputOptions=r;u=(function(){function n(n,t,i){var u=this,r;this._ariaLabel=ko.observable();this._inheritIcon=ko.observable();this.fxEnabled=ko.observable(!0);this.hasPopup=ko.observable(!1);this.ariaLabel=this._ariaLabel;this.enabled=ko.observable(!0);this.visible=ko.observable(!0);this.unauthorized=ko.observable(!1);this.pressed=ko.observable();this.fileInputOptions=ko.observable(null);this.tooltip=ko.observable();this.isShellCommand=!1;r=this._ltm=n.createChildLifetime();this.text=ko.isObservable(t)?t:ko.observable(t?t:"");this.enabled(i!==undefined?i:!0);this.icon=ko.computed(r,{read:this._inheritIcon,write:function(n){return u._inheritIcon(n&&MsPortalFx.extend2(n,{options:$.extend({palette:99},n.options)}))}})}return Object.defineProperty(n.prototype,"canRebind",{get:function(){return!0},enumerable:!1,configurable:!0}),n.prototype.activate=function(){},n.prototype.execute=function(){},n.prototype.bind=function(n){var t=n&&n.getFormTarget;n.getFormTarget=function(){return t().then((function(t){if(t&&typeof t.showForm!="function")throw new Error("invalid context"+JSON.stringify(n,(function(n,t){return""+n+typeof t})));return t}))};this._currentContext=n},n.prototype.dispose=function(){this._ltm.dispose()},n})();t.CommandImpl=u}));
define("MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.ImplUtils","FxHubs/ResourceManagement","MsPortalImpl/Base/Telemetry","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function y(t,i,u,f,e){var o="Error invoking detail blade for master '"+f+"'. "+u+" Selection model: '"+JSON.stringify(e)+"'";r.logToExtension(n,i,2,o,{rpcClient:t})}function g(n,t){var i=arguments.length===2?c(n,t).value:n,r;return i?(r=[i.selectedValue,i.value,i.isSelected,i.isActivated,i.isCommandSelected,i.hasChildEdits],r.every(ko.isObservable)):!1}function nt(n,t){var i=arguments.length===2?c(n,t).value:n,r;return i?(r=[i.selectableItems,i.selectedItems,i.activatedItems,i.itemsWithChildEdits],r.every(ko.isObservable)):!1}function tt(n){var t=n;return!!t.isLocked()}function it(n){return n.blade?n.selectablePath||"container.selectable":rt(n)}function a(n){var t=n&&n.invocationInputArguments,i=t&&t[0],r=i&&i.valuesFrom,u=r&&r[0];return u&&u.property}function rt(n){var r=a(n),t,i,u;return r&&(t=r.split("."),i=t.length,i>1)?(u=t[i-1],["value","activatedItems","selectedItems","selectedItem"].some((function(n){return n===u}))&&(t=t.slice(0,i-1)),t.join(".")):null}function ut(n){var t,i,r;return n?(t=n.filter((function(n){return n&&!n.selectablePath&&!n.invocationInputArguments})),!t.length&&(i=n.filter((function(n){return n&&n.selectablePath==="container.selectable"})),!i.length&&(r=n.filter((function(n){var t=a(n);return t==="container.selectable.value"||!n.blade&&t==="container.selectable"})),!r.length)))?!1:!0:!1}function ft(n,t,i){var r,f=n.invocationInputArguments,o=f&&f.length!==1,e=f&&!o&&f[0].valuesFrom,u=n.outputArguments;return(o?r="Invocation arguments must exist and have only one element.":e&&e.length>1?r="Multiple 'valuesFrom' not supported for invocation arguments.":!n.blade&&f[0].property?r="Static invocation property is not supported when omitting the details blade name.":e&&e[0].constantValue!==undefined?r="Constants are not allowed on invocation argument.":u&&u.length>0&&(u.some((function(n){return!n.property}))?r="Output arguments must specify a target property.":u.some((function(n){return n.valuesFrom.length!==1}))?r="Output arguments support only one valueFrom property.":u.some((function(n){return n.valuesFrom[0].constantValue!==undefined}))?r="Constants are not allowed on output arguments.":u.some((function(n){return n.valuesFrom[0].referenceType!==1}))&&(r="Output arguments only support source ReferenceType.BladeInput.")),!r&&i&&(r=i(n)),r)?(t.push(r),!1):!0}function et(n,t,i,r){var h=t,c=t,l=t,u,f={},s,a;return ct(n,i.name,r,t)&&(t.extension&&(s=t.extension,s=n.get(e.ExtensionManagerOptions).resolveExtensionName(s),i=o.Locator.forExtension(s)),a=n.get(o.DefinitionFinder),h.detailBlade?u=i.withBlade(h.detailBlade):c.assetType&&a.tryLocate(i.withAssetType(c.assetType),f)?u=k(i.name,f.value):l.resourceId&&n.get(o.LocatorContext).tryLocateAssetDefinitionFromResourceId(l.resourceId,f)?u=k(f.extensionName,f.value):y(n.get(FxImpl.Rpc.Client),i.name,"Unable to locate asset. Error: '{0}'. ".format(f.error),r,t)),u||(u=i.withBlade("##NOT_SPECIFIED##")),u}function ot(n,t,i){var r=t&&t.container,u=i.details;return r&&r.selectable===n?MsPortalFx.find(u,(function(n){return b(n)})):n?MsPortalFx.find(u,(function(i){var r=i.invocationInputArguments,u=i.selectablePath;return r?r.some((function(i){return i.valuesFrom.some((function(i){var r=[];return i.property.split(".").some((function(i){return r.push(i),c(t,r.join(".")).value===n}))}))})):u?c(t,u).value===n:!1})):null}function b(n){var r=a(n),u=n.selectablePath,i=!0;return r?i=r===t.PartContainerSelectableValue_ViewModelPath:u&&(i=u===t.PartContainerSelectable_ViewModelPath),i}function st(n,t,i,r,u){var f,e;if(t.setLifetimeReference(8,i),e=function(){var t,o,e;r.length||(r=i.bladeDefinition&&i.bladeDefinition.outputs||[]);r.length&&(t={},f=new h.PropertyBindings(i.id+"-"+n,t,!1),o=i.getViewModel(1),f.addPropertyChangedHandler((function(){e=MsPortalFx.clone(t,!0)})),r.forEach((function(n){f.mapProperty(n,n).bind(i.id,o,!0)})),e&&u&&u(e),f.addPropertyChangedHandler((function(){var n=MsPortalFx.clone(t,!0);u&&u(n)})))},r.length||u){i.isComposed?e():i.await(7).then(e);i.onDispose((function(){f&&(f.unbind(),f=null)}))}}function ht(n,t,i,r,u,e){function o(){var n=i.get(s.Finder);return n.findSiblingBlades(r.referenceComposition).map((function(n){return"\n    "+n.toString()+". Model: "+ko.toJSON(n.getInputsOnlyViewModel())})).join("")||"<None>"}f.isDesktopTraceEnabled&&n.verbose("[BladeOpener] "+t+("\n Master Identifier: "+r.masterModelId+".")+("\n  Master Property: "+u.source.property)+("\n  Master Value: "+(e!==undefined?ko.toJSON(e):"<undefined>")+".")+("\n  Current Detail Blades from Container: "+o()))}function ct(n,t,i,r){var u,f=r,e=r,o=r;return r?f.detailBlade||e.assetType||o.resourceId?f.detailBlade&&e.assetType?u="'detailBlade' and 'assetType' cannot be specified at the same time.":f.detailBlade&&o.resourceId?u="'detailBlade' and 'resourceId' cannot be specified at the same time.":e.assetType&&o.resourceId?u="'assetType' and 'resourceId' cannot be specified at the same time.":r.detailBladeInputs||(u="Model must define a 'detailBladeInputs' property."):u="Either 'detailBlade', 'assetType' or 'resourceId' must be specified on the model. ":u="Dynamic selection must be specified. ",u&&y(n.get(FxImpl.Rpc.Client),t,u,i,r),!u}function k(n,t){if(!t)return null;var i=t.contracts;return u.supportsContract(i,8)?o.Locator.forExtension("HubsExtension").withBlade(v.BladeNames.Hubs.ResourceMenuBlade):o.Locator.forExtension(t.bladeExtensionName||n).withBlade(t.bladeName)}var v,d,c,l,p,w;Object.defineProperty(t,"__esModule",{value:!0});t.traceInvocationChange=t.bindOutputsToSelectable2=t.detailsIsPartContainer=t.getAssociatedDetailDefinition=t.mapDynamicSelectionToBladeLocator=t.validateDetailsDefinition=t.needContainerSelectable=t.getSelectablePath=t.isSelectableLocked=t.isSelectableSet=t.isSelectable=t.Resources=t.OpenerConfiguration=t.Configuration=t.DefaultConfiguration=t.PartContainerSelectableValue_ViewModelPath=t.PartContainerSelectable_ViewModelPath=void 0;v=MsPortalFx.Base.Constants;d=MsPortalFx.Base.Diagnostics;t.PartContainerSelectable_ViewModelPath="container.selectable";t.PartContainerSelectableValue_ViewModelPath=t.PartContainerSelectable_ViewModelPath+".value";c=h.getModelValue;t.DefaultConfiguration={masterModelId:null,masterModel:null,referenceComposition:null,referenceExtension:null,isBladeOpenedByMaster:null,invocationThrottleDuration:25,configureBladeDescriptor:MsPortalFx.noop,onBladesOpening:MsPortalFx.noop,onBladeOpened:MsPortalFx.noop,addOutputBindings:MsPortalFx.noop,removeOutputBindings:MsPortalFx.noop,getCloseOwnedDetailBladesHandler:MsPortalFx.wrap(null),getCloseOtherDetailBladesHandler:MsPortalFx.wrap(null)};l=(function(){function t(){}return __decorate([__metadata("fx:diagnostics",[n,"Configuration"]),i.Class("pipeline")],t)})();t.Configuration=l;p=(function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),__decorate([__metadata("fx:diagnostics",[n,"OpenerConfiguration"]),i.Class("composition")],r)})(l);t.OpenerConfiguration=p;w=(function(){function t(){}return __decorate([__metadata("fx:diagnostics",[n,"Resources"]),i.Class("pipeline")],t)})();t.Resources=w;t.isSelectable=g;t.isSelectableSet=nt;t.isSelectableLocked=tt;t.getSelectablePath=it;t.needContainerSelectable=ut;t.validateDetailsDefinition=ft;t.mapDynamicSelectionToBladeLocator=et;t.getAssociatedDetailDefinition=ot;t.detailsIsPartContainer=b;t.bindOutputsToSelectable2=st;t.traceInvocationChange=ht}));
define("MsPortalImpl/UI/Commands/UI.ExtensionCommands",["require","exports","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/UI.JourneyManager"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){"use strict";function at(n,t,i,r){var u;return t.lc2?u=new ni(n,i,r):t.viewModel?u=new gt(n,i,r):t.execute?u=new ci(n,i,r):t.navigateUriCallback?u=new wt(n,i,r):t.navigateUri?u=new li(n,i,r):t.listItems?u=new bt(n,i,r):t.targetUri&&t.httpMethod?u=new dt(n,i,r):(r.commandItem.commandDefinition.details||t.bladeName)&&(u=new ht(n,i,r)),u}function ot(n){var u=n,r=null,t,i;if(!(n instanceof st))throw new Error("Command context was not an instance of CompositionInstanceCommandContext. All context objects are expected to be of that type.");return t=u.compositionInstance,i=t&&t.locator,i&&(r={id:i.toFriendlyString(),instanceId:t.instanceId}),r}function ut(n){var t=n&&n.title,i=n&&n.description;o&&o.getNotificationManager()&&o.getNotificationManager().addClientNotification({title:t||k.uriCallbackCommandError,description:i||k.error,status:ii.Error,timestamp:new Date})}function pt(n,t,r){var u=i.sanitizeLinkUri(n,r);u?ft.open(u,t):(b.error(k.invalidUri.format(n)),ut())}function ai(n,t){var i=n;tt(["text","icon","enabled"],(function(n){kt(i[n],n,t)}));kt(i.onInputsSet,"onInputSet",t,!0)}function kt(n,t,i,r){et(n)||typeof n!="function"||!r&&et(n())||vi(t,i)}function vi(n,t){b.warning("The '"+n+"' property of a command viewModel contains a value. This value will be ignored when passing to '"+t+"' dynamic command viewModel.")}function yi(n){var t;return n.name?n.details||(t="OpenBladeCommand must provide a details blade definition."):t="OpenBladeCommand must provide a command name.",t&&b.error("{0} Command: '{1}'. CommandDefinition: '{2}'.".format(t,n.name,JSON.stringify(n))),!t}function pi(n){it=Q(n)}var st,vt,wt,bt,dt,gt,ht,ni;Object.defineProperty(t,"__esModule",{value:!0});t.setBladeOpenerModule=t.ExtensionCommandImplOptions=t.CompositionInstanceCommandContext=t.getCommandSourceTelemetryContext=t.createExtensionCommand=void 0;var g=MsPortalFx.Base,ct=g.Diagnostics,nt=ct.Telemetry,lt=FxImpl.TelemetryContext,ti=g.Resources,ii=MsPortalFx.Hubs.Notifications.NotificationStatus,ri=MsPortalFx.ViewModels,ui=ri.Dialogs,fi=s.CompositionType,ei=c.CompositionBinder,oi=l.ReferenceScope,si=g.Net2,ft=window,b=ct.createLog(n),et=MsPortalFx.isNullOrUndefined,tt=MsPortalFx.uncurryThis(Array.prototype.forEach),it=null,hi={invocationInputArguments:[{valuesFrom:[{referenceType:4,property:"container.selectable"}]}]},w=f.FileDownloadCommand,k=f.UriCallbackCommand,rt=412;t.createExtensionCommand=at;t.getCommandSourceTelemetryContext=ot;st=(function(n){function t(t,i,r){var u=n.call(this,t,i)||this;return u.compositionInstance=r,u}return __extends(t,n),t})(e.CommandContext);t.CompositionInstanceCommandContext=st;vt=(function(){function n(){}return n})();t.ExtensionCommandImplOptions=vt;var d=(function(){function n(n,t,i){var r=this,f,e;this._extension=i.extension;this._viewModelName=i.viewModelName;this.viewModel=t;this.commandItem=i.commandItem;this._commandContainer=i.container;f=this._ltm=n.createChildLifetime();this._propertyBindings=i.propertyBindings;this._diContainer=i.diContainer;e=i.diContainer.get(u.ViewModelManager);f.registerForDispose((function(){r.viewModel&&(e.releaseViewModel(r.viewModel),r.viewModel=null);r._propertyBindings&&(r._propertyBindings.unbind(),r._propertyBindings=null)}))}return n.prototype.init=function(){},n.prototype.execute=function(n){var i=this._diContainer.get(p.JourneyManager).activeJourney(),t=ot(this._context());lt.setContextValue(lt.ContextType.Blade,t);nt.trace({extension:this._extension.name,source:t&&t.id,action:"CommandExecuted",name:this._viewModelName,data:n,journeyId:i&&i.id})},n.prototype.dispose=function(){this._ltm.dispose()},n.prototype._context=function(){return this.commandItem.getCommandContext()},n.prototype._getFormTarget=function(){var n=this._context();return n.getFormTarget()},n.prototype._target=function(){var n=this._context();return n&&n.target},n})(),ci=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u._viewModel=i.content(),u._diContainer.get(v.DesktopManagerMode).value.subscribe(u._ltm,(function(n){u._getFormTarget().then((function(t){n===1&&t&&t.hideForm()}))})),u}return __extends(t,n),t.prototype.execute=function(t,i){var u=this,r;n.prototype.execute.call(this,t,i);r=this._viewModel;r.status()===1?Promise.all([this._diContainer.getAsync(y.DialogManager),this._getFormTarget()]).then((function(n){var t=n[0],i=n[1];u._loadDialog(i,t,ko.unwrap(r.dialog))})):r.status(1);r.execute(i)},t.prototype.init=function(){var n=this,t=this._viewModel,i=this._ltm,r=function(t,i,r){r===0?t.hideForm():r===1&&n._loadDialog(t,i,ko.unwrap(n._viewModel.dialog))},u=function(t,i,r){n._viewModel.status()===1&&n._loadDialog(t,i,r)};this._diContainer.getAsync(y.DialogManager).then((function(f){t.status.subscribe(i,(function(t){n._context()&&n._getFormTarget().then((function(n){r(n,f,t)}))}));ko.isObservable(t.dialog)&&t.dialog.subscribe(i,(function(t){n._getFormTarget().then((function(n){u(n,f,t)}))}))}))},t.prototype._loadDialog=function(n,t,i){var r=this;if(n&&(!MsPortalFx.deepEquals(this._currentDialogOptions,i)||!t.hasOpenDialog)&&(t.hasOpenDialog||(this._previouslyFocusedElement=document.activeElement),this._currentDialogOptions=i,!et(i))){if(!this._target())return;var u=this._commandContainer.locator,f=u&&u.withCommand(this.commandItem.commandName),e=t.hasOpenDialog&&this._previouslyFocusedElement?this._previouslyFocusedElement.contains(this._target())?this._target():this._previouslyFocusedElement:this._target();this.commandItem.pressed(!0);t.showDialog(i,n,e,{locator:f}).then((function(n){r.commandItem.pressed(!1);var t=r._viewModel,i=t&&t.dialogClick;typeof i=="function"&&i.call(t,n)}))}},t})(d),li=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u._viewModel=i.content(),u.canSkipBladeValidation=!0,u}return __extends(t,n),t.prototype.execute=function(t){var i=this._viewModel,r=i.navigateTarget?i.navigateTarget():"_blank";n.prototype.execute.call(this,t);ft.open(i.navigateUri(),r)},t})(d),yt=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u.canSkipBladeValidation=!0,u}return __extends(t,n),t.prototype._getLocator=function(){var n=this._commandContainer.locator;return n&&n.withCommand(this.commandItem.commandName)},t.prototype._showUriCbProgressDlg=function(n,t,i){this._showProgressDlg(n,t,this._uriCbProgressTitle,this._uriCbProgressText,i)},t.prototype._showDownloadProgressDlg=function(n,t,i){this._showProgressDlg(n,t,this._progressTitle,this._progressText,i)},t.prototype._showProgressDlg=function(n,t,i,r){var u=new ui.ProgressBox(i,r);t.showDialog(u,n,this._target(),{locator:this._getLocator()})},t.prototype._getResources=function(n){var t=n.uriCallbackConfirmationDialogOptions||{},i=n.downloadProgressDialogOptions||{};this._uriCbProgressTitle=t.uriCallbackProgressTitle||w.uriCallbackProgressTitle;this._uriCbProgressText=t.uriCallbackProgressText||w.uriCallbackProgressText;this._dnldTitle=t.downloadTitle||w.downloadTitle;this._dnldText=t.downloadText||w.downloadText;this._defaultBtnText=t.defaultButtonText||w.defaultButtonText;this._cancelBtnText=t.cancelButtonText||w.cancelButtonText;this._progressTitle=i.downloadProgressTitle||w.downloadProgressTitle;this._progressText=i.downloadProgressText||w.downloadProgressText},t})(d);wt=(function(t){function r(n,i,r){var u=t.call(this,n,i,r)||this;return u._viewModel=i.content(),u._getResources(u._viewModel),u.canSkipBladeValidation=!0,u}return __extends(r,t),r.prototype.execute=function(r){var u=this;t.prototype.execute.call(this,r);var s=this._viewModel.navigateTarget?this._viewModel.navigateTarget():"_blank",f=this._viewModel,h=f.navigateUriCallback&&f.navigateUriCallback(),v=this.commandItem,c=v.fxEnabled,p=f.showUriCallbackConfirmationDialog&&f.showUriCallbackConfirmationDialog(),l=function(n){n.hideForm();c(!0)},e,o=!0,a={localRequire:n,windowContext:this._extension.name,diContainer:this._diContainer};h&&p?(c(!1),Promise.all([this._diContainer.getAsync(y.DialogManager),this._getFormTarget()]).then((function(n){var i=n[0],t=n[1];return u._dlgMgr=i,u._showUriCbProgressDlg(t,i,r),Promise.resolve(f.navigateUriCallback()()).then((function(n){o=!1;var r=new y.MessageBox(u._dnldTitle,u._dnldText,2);r.defaultButtonText=u._defaultBtnText;r.cancelButtonText=u._cancelBtnText;i.showDialog(r,t,u._context().target,{locator:u._getLocator(),syncCallback:function(i){i===4&&pt(n,s,a);l(t)}});t.showForm(u._target())}),(function(n){ut(n)})).finally((function(){o&&(b.error(k.callbackError.format("navigateUriCallback failed.")),e&&e.close(),u._dlgMgr&&u._dlgMgr.dismissOpenDialog(),l(t))}))})).catch((function(n){b.error(n)}))):h?(c(!1),e=ft.open("about:blank",s),Promise.resolve(h()).then((function(n){o=!1;i.sanitizeUri(n,null,a)?e.location.href=n:(b.error(k.invalidUri.format(n)),ut(),e.close())}),(function(n){ut(n)})).finally((function(){o&&(b.error(k.callbackError.format("navigateUriCallback failed.")),e.close());u._getFormTarget().then((function(n){l(n)}))}))):pt(f.navigateUri(),s,a)},r})(yt);bt=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this,o=u._ltm,s=u.commandItem,f=i.content(),h=s.widgetViewModel,e=h.dialogOptions;return ko.reactor(o,(function(){e.listItems(f.listItems())})),f.selectedItem.subscribe(o,(function(n){e.selectedItem(n)})),e.selectedItem(f.selectedItem()),s.hasPopup(!0),e.selectedItem.subscribe(o,(function(n){f.selectedItem(n)})),u.canSkipBladeValidation=!0,u}return __extends(t,n),t.prototype.execute=function(t){n.prototype.execute.call(this,t)},t})(d);dt=(function(n){function t(t,i,u){var e=n.call(this,t,i,u)||this;return e._viewModel=i.content(),e._getResources(e._viewModel),r.isSafari&&r.webKitVersion<r.safari_11_webKitVersion&&(e.commandItem.fxEnabled(!1),e.commandItem.tooltip(f.FileDownloadCommand.safariDownload)),e.canSkipBladeValidation=!0,e}return __extends(t,n),t.prototype.execute=function(t){var i=this;n.prototype.execute.call(this,t);var r=null,f=this.commandItem,u=f.fxEnabled;u()&&g.Promises.cancelOnDispose(this._ltm,MsPortalFx.require("MsPortalImpl/Commands/FileDownloadUtil")).then((function(n){var f=i._viewModel,o=n.getHttpMethod(f),s=function(n){n.hideForm();u(!0)};if(!o){n.notifyError(f,rt,w.typeError);i._getFormTarget().then((function(n){s(n)}));return}u(!1);f.downloadStatus(null);var h=i._diContainer.getAsync(y.DialogManager),e=i._getFormTarget(),c=Promise.all([h,e]).then((function(n){var r=n[0],u=n[1];return i._getUri(u,r,t)}));return Promise.all([h,c,e]).then((function(u){var s=u[0],e=u[1],l=u[2],c=e&&e.startsWith("data:"),h;if(!ti.isUriAbsolute(e)&&!c){n.notifyError(f,rt,w.absoluteUriError);return}if(f.showDownloadProgressDialog&&f.showDownloadProgressDialog()&&i._showDownloadProgressDlg(l,s,t),h=ot(i._context()),r=nt.startTrace({extension:i._extension.name,source:h&&h.id,action:"StartFileDownload",name:i._viewModelName,data:t}),c)n.dataUriHandler(f,s,e);else return si.ajaxExtended(n.getAjaxOptions(f,e,o)).then((function(t){if(i.viewModel){var u=t.content,e=u&&u.length?u.length:0;return n.onSuccess(f,s,u,t.textStatus,t.jqXHR).then((function(){nt.completeTrace(r,e)}))}}),(function(t){n.onError(f,s,t.textStatus,t.jqXHR.status,t.errorThrown);return nt.cancelTrace(r),Promise.reject(t.errorThrown)}))})).catch((function(n){n&&b.error(n);nt.cancelTrace(r)})).finally((function(){e.then((function(n){s(n)}))}))})).catch((function(n){n&&b.error(n)}))},t.prototype._getUri=function(n,t,i){var u=this,r=this._viewModel,f=r.targetUriCallback&&r.targetUriCallback(),e=r.showUriCallbackConfirmationDialog&&r.showUriCallbackConfirmationDialog();return g.Promises.cancelOnDispose(this._ltm,MsPortalFx.require("MsPortalImpl/Commands/FileDownloadUtil")).then((function(o){if(f)return e&&u._showUriCbProgressDlg(n,t,i),Promise.resolve(f()).then((function(i){var f,s;return i?e?(f=new y.MessageBox(u._dnldTitle,u._dnldText,2),f.defaultButtonText=u._defaultBtnText,f.cancelButtonText=u._cancelBtnText,s=t.showDialog(f,n,u._target(),{locator:u._getLocator()}),s.then((function(n){return n===4?i:Promise.reject()}))):(o.dismissDialog(t,r),i):Promise.reject(w.uriError)})).catch((function(n){o.dismissDialog(t,r);var i=null;return n&&(i=r.errorMessage()||"{0} {1}".format(w.downloadTargetUriCallbackFailed,n),o.notifyError(r,rt,i)),Promise.reject(i)}));var s=r.targetUri&&r.targetUri();return s?s:(o.notifyError(r,rt,w.uriError),Promise.reject(w.uriError))}))},t})(yt);gt=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this,e,f;return u._container=r.container,u._viewModel=i.content(),u._selectionInList=r.selectionInList,e=u._ltm,u._viewModel.viewModel.subscribeAndRun(e,(function(n){var t,o,s,i,r;f&&f.dispose();f=e.createChildLifetime();t=u._nestedCommand;t&&(t.dispose(),u._nestedCommand=undefined);n&&(o=u.viewModel,s={container:u._container,extension:u._extension,viewModelName:u._viewModelName,commandItem:u.commandItem,propertyBindings:null,diContainer:u._diContainer,selectionInList:u._selectionInList},u.commandItem.commandDefinition.details=hi,ai(n,u._viewModelName),i=MsPortalFx.clone(o),i.content=ko.observable(n),r=n,r.bladeName&&i.container.selectable.selectedValue({detailBlade:r.bladeName,detailBladeInputs:r.bladeInputs}),t=u._nestedCommand=at(f,n,i,s),t.init(),u.canSkipBladeValidation=t.canSkipBladeValidation)})),u}return __extends(t,n),t.prototype.execute=function(t){n.prototype.execute.call(this,t);this._nestedCommand?this._nestedCommand.execute(t):b.error("The nested command is missed for the {0} dynamic command.".format(this._viewModelName))},t.prototype.dispose=function(){this._nestedCommand&&this._nestedCommand.dispose()},t})(d);ht=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this,e,f;u._addedOutputPropertyBindings=[];u._outputBindingDefinitions=[];u._viewModel=i;u._containerViewModel=i.container;u._options=r;e=u.commandItem;f=e.commandDefinition;u._commandInstanceId=r.selectionInList?MsPortalFx.newGuid():undefined;var s=yi(f),o=f.details,h=u._validateDetailsDefinition(o);return s&&h?(u._outputBindingDefinitions=ei.mapInputBindingDefinitions(o.outputArguments||[],r.container,(function(n){n.source.scope=oi.DetailsContainer})),u.getBladeOpener()):r.commandItem.setEnabled(!1),u.canSkipBladeValidation=!0,u}return __extends(t,n),t.prototype.getBladeOpener=function(){var n=this,t;return this._ltm?(t=this._ltm,this._bladeOpenerPromise||(it=it||MsPortalFx.require("MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener"),this._bladeOpenerPromise=it.then((function(i){var u=n._options,r=new i.BladeOpener(n._diContainer,n._getBladeOpenerConfig(u.container,u.extension));return r.registerInvocationProperty(n.commandItem.commandDefinition.details),t.registerForDispose(r),r}))),this._bladeOpenerPromise):Promise.reject(new MsPortalFx.Errors.DisposedCanceledError)},t.prototype.execute=function(t){var i=this;n.prototype.execute.call(this,t);this.getBladeOpener().then((function(n){if(!n||i._ltm&&!i._ltm.isDisposed()){var t=i._containerViewModel,r=t&&t.selectable;r?r.isSelected(!0):b.error("OpenBladeCommand '{0}' from extension '{1}' was not initialized with a Selectable.".format(i.commandItem.commandDefinition.name,i._extension.name))}}))},t.prototype._getBladeOpenerConfig=function(n,t){var i=this,u=this.commandItem.commandDefinition.details,f=u?!!u.parameterCollector:!1,r=this._diContainer;return{diContainer:r,masterModelId:"{0}-[{1}-{2}]".format(n.toString(),"OpenBladeCommand",this.commandItem.commandDefinition.name),masterModel:this._viewModel,referenceComposition:n,referenceExtension:t,isBladeOpenedByMaster:function(t){return t.masterCommandName===i.commandItem.commandDefinition.name&&t.masterPartId===n.id&&t.masterCommandId===i._commandInstanceId},configureBindings:function(t){tt(t,(function(t){var r=t.source,u=r&&r.modelType;u===4&&(r.modelId=i.commandItem.commandDefinition.name,s.isPartComposition(n)&&(r.partLocator=n.locator,r.id=n.id))}))},configureBladeDescriptor:function(t){var r,u,o;if(t.masterCommandName=i.commandItem.commandDefinition.name,t.masterCommandId=i._commandInstanceId,t.masterCommandExtension=i._extension,t.masterPartId=n.id,r=t.bindings,Array.isArray(r))for(u=r.length-1;u>=0;u--){var s=r[u],e=s.source,h=e&&e.modelType;h===4&&(t.model[s.targetProperty]=ko.toJS(l.getModelValue(i._viewModel,e.property).value),o=i.commandItem.sourceBindableContainer,!f&&o&&o.isPartListItem&&r.splice(u,1))}},onBladeOpened:function(n){i._setCmdActivated(!0);n.onDispose((function(){i._disposeOutputBindings();i._setCmdActivated(!1)}));n.await(7).then((function(){i._createOutputBindings(n)}))},getCloseOtherDetailBladesHandler:function(t,i){var u,f;if(i.openInContextPane){if(u=r.get(p.JourneyManager),n.getCompositionType()===fi.StartboardPart)return(f=u.activeJourney(),!f||f.isStartedWithContextBlade())?null:function(){return u.tryDeactivateJourney()};if(!r.get(a.RightContextPane).opened.value)return function(){return!0}}return null}}},t.prototype._createOutputBindings=function(n){var t=this;tt(this._outputBindingDefinitions,(function(i){var u=t._propertyBindings,r;u&&(r=u.mapProperty(i.source.property,i.targetProperty).bind(n.toString()+"LaunchCommandOutputBinding",n.getViewModel()),r.compositionBindingDefinition=i,t._addedOutputPropertyBindings.push(r))}))},t.prototype._disposeOutputBindings=function(){var n=this;this._propertyBindings&&tt(this._addedOutputPropertyBindings,(function(t){n._propertyBindings.removeProperty(t)}));this._addedOutputPropertyBindings.length=0},t.prototype._validateDetailsDefinition=function(n){var t=[],i=function(n){var t,i=n.invocationInputArguments;return n.isMultiple?t="Command cannot open multiple blades. isMultiple value must be false.":i&&i[0].valuesFrom[0].referenceType!==4&&(t="Command invocation argument reference type can only be of type Command."),t},r=h.validateDetailsDefinition(n,t,i);return t.length&&b.error("{0} Command: '{1}'. Details: '{2}'.".format(t[0],this.commandItem.commandDefinition.name,JSON.stringify(n))),r},t.prototype._setCmdActivated=function(n){var t=this._commandContainer.getViewModel(),i=t&&t.container,r=i&&i.selectable;r&&r.isCommandSelected(n);this.commandItem.pressed(n)},t})(d);ni=(function(n){function t(t,i,r){var e=n.call(this,t,i,r)||this,o=e._ltm,s=e.commandItem,u=i.content(),h=s.widgetViewModel,f=h.dialogOptions;return ko.reactor(o,(function(){f.listItems(u.listItems())})),u.selectedItem.subscribe(o,(function(n){f.selectedItem(n)})),f.selectedItem(u.selectedItem()),s.hasPopup(!0),f.selectedItem.subscribe(o,(function(n){u.selectedItem(n)})),e}return __extends(t,n),t.prototype.execute=function(t){n.prototype.execute.call(this,t)},t})(ht);t.setBladeOpenerModule=pi}));
define("MsPortalImpl/UI/Compositions/UI.Composition.Security",["require","exports","Fx/ResourceManagement","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Services/Services.Permissions"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){function c(n,t,i,r,u,f,e){if(n&&n.length){if(s[t]===undefined)return FxImpl.QReject("checkPermission: unexpected requirement: "+t);var o=t===s.All;return n.reduce((function(n,t){return n.then((function(s){var a,y,v;if(b(o,s))return n;if(a=void 0,t.permissionType===0)y=t,a=l(y,i,r,u,f,e);else if(t.permissionType===1)v=t,a=c(v.permissions,v.requirement,i,r,u,f,e);else throw new Error("unexpected permission.permissionType: "+t.permissionType);return a.catch((function(n){var t=h.warning;return t.call(h,n,1,["Failed check permissions:","compositionInfo:"+e,"reason: "+n].join("\n")),Q(!0)}))}))}),Q(o))}return Q(!0)}function l(n,t,r,u,e){if(!n)return Q(!1);var h=function(t){return e.get(f.PermissionsManager).hasPermission(t,[n.action],o.Constants.Shell)},s;switch(n.assetId.sourceType){case 0:s=Q(t[n.assetId.property]);break;case 1:s=a(n,t,r,u,e);break;case 2:s=a(n,t,n.assetType||r,n.extensionName||u,e)}return s.then((function(n){if(n=ko.unwrap(n),k(i.ArmId.parse(n,!0)))return h(n);throw o.Diagnostics.createIgnoreUnhandledRejectionError("Asset ID not a resource ID, permissions not checked. Extension <"+u+"> : AssetType <"+r+"> : ID _REDACTED_");}))}function a(n,t,i,f,e){var o="[getAssetIdFromPropertyProvider]:";return e.get(u.ManifestCache).getManifestAsync(f,"assetTypes").then((function(u){var s=MsPortalFx.find(u.assetTypes,(function(n){return n.name===i})),h;if(!s)throw new Error(o+"Unknown extension Asset Type : "+i);return h=e.get(r.ViewModelManager),h.getViewModel(f,s.propertyProviderServiceViewModelLocator||s.propertyProviderServiceViewModel,11).then((function(i){var r=new y;return r.registerForDispose((function(){h.releaseViewModel(i)})),Q.fcall((function(){var r=i.content(),u=r&&r.onInputsSet,f,e;if(typeof u=="function")return f=$.extend({providerKey:n.assetId.providerKey},t),e=u.call(r,f)||Q(),e.then((function(){var u=r.properties(),t=n.assetId.property,i=MsPortalFx.find(u,(function(n){return n.property===t}));if(i)return i.value;throw new Error(o+"Can not find propertyDefinition for assetIdProperty: "+t);}));throw new Error(o+"ViewModel.content.onInputsSet is not a function.");})).finally((function(){r.dispose()}))}))}))}function k(n){return n&&v[n.kind]}var e,y=FxImpl.TriggerableLifetimeManager,o=MsPortalFx.Base,p=o.Diagnostics,w=MsPortalFx.Extension,s=w.SetRequirement,h=p.createLog(n),b=MsPortalFx.xor,v;t.checkPermissions=c;t.checkPermission=l;v=(e={},e[4]=!0,e[6]=!0,e[8]=!0,e[3]=!0,e[1]=!0,e)})(e||(e={})),e}));
define("MsPortalImpl/Widgets/Widgets.CommandBarBase",["require","exports","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/UI/UI.DialogManager"],(function(n,t,i,r){"use strict";var u;return (function(n){function e(n){return typeof n=="string"}var f=MsPortalFx.Base.Diagnostics.Telemetry,t=(function(n){function t(t,i,r,u){var f=this,s=u&&u.commandName,o;return f=n.call(this,t,i.label)||this,o=f._ltm,f._executeLifetime=u&&u.executeLifetime||o,f._model=i,f._locator=r,f.icon=ko.computed(o,{read:function(){var n=ko.unwrap(f._model.icon);return n&&MsPortalFx.extend2(n,{options:$.extend({palette:99},n.options)})},write:f._model.icon}),f.commandName=s||MsPortalFx.getUniqueId(),f.enabled=ko.computed(f._executeLifetime,(function(){var n=i,t=!i.disabled(),r=!n.command||n.command.canExecute();return t&&r})),ko.computed(o,(function(){f.unauthorized(!!ko.unwrap(i.unauthorizedMessage))})),ko.computed(o,(function(){var n=ko.unwrap(i.unauthorizedMessage),t;n||(t=ko.unwrap(i.disabled),n=e(t)?t:null);n=n||ko.unwrap(i.tooltip);f.tooltip(n)})),f.isSeparator=ko.observable(i.type===12),f}return __extends(t,n),Object.defineProperty(t.prototype,"model",{get:function(){return this._model},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._model&&this._model.type},enumerable:!1,configurable:!0}),t.prototype.execute=function(t){f.trace({source:this._locator&&this._locator.toFriendlyString(),action:"CommandExecuted",name:this.model.name||"Toolbar name not specified",extension:this._locator&&this._locator.getExtensionName()});n.prototype.execute.call(this,t)},t})(i.CommandImpl),u;n.ItemViewModel=t;u=(function(n){function t(t,i,r,u,f){var e=n.call(this,t,i,r,f)||this,o;return e.hasOpenDialog=ko.observable(!1),e._diContainer=u,o=i.dialogOptions,e.hasPopup(!!o&&o.type===4),e}return __extends(t,n),Object.defineProperty(t.prototype,"dialogOptions",{get:function(){return this._model.dialogOptions},enumerable:!1,configurable:!0}),t.prototype.execute=function(t){var i=this;MsPortalFx.Base.Promises.cancelOnDispose(this._executeLifetime,Q.all([this._diContainer.getAsync(r.DialogManager),this._currentContext.getFormTarget()]).spread((function(r,u){if(i.hasOpenDialog())r.dismissOpenDialog(),i.hasOpenDialog(!1);else{var f=i._currentContext,o=f&&f.target,e=i._model;i.hasOpenDialog(!0);MsPortalFx.Base.Promises.cancelOnDispose(i._executeLifetime,r.showDialog(i.dialogOptions,u,o,{locator:i._locator})).then((function(n){i.hasOpenDialog(!1);e.command&&e.command.execute(n)}),(function(){i.hasOpenDialog(!1)}))}n.prototype.execute.call(i,t)})))},t})(t);n.DialogButton=u})(u||(u={})),u}));
define("MsPortalImpl/UI/Commands/UI.Commands",["require","exports","Fx/DependencyInjection","FxInternal","FxInternal/Composition/ViewModelComposer","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Extension/DefinitionCache","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Security","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/Commands/UI.ExtensionCommands","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.CommandBarBase","MsPortalImpl/Extension/ExtensionManager"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){"use strict";function bt(n){return n&&n.selectableItems().filter((function(n){return n.isSelected()}))||[]}function kt(n){return p.getCommandSourceTelemetryContext(n)}function dt(n){var t=w.Widget.getWidget(n,null);if(n.hasClass("fxs-bladecontent"))return t}function gt(n){var t=w.Widget.getWidget(n,null);if(n.hasClass("fxs-blade"))return t}function ni(n,t,i){var r=i.commandGroupReference,u=r?r.name:i.commandGroup;return n.getCommandGroup(t,u)}function st(n,t,i,r,u){var f=new pt.DialogButton;return f.dialogOptions=new yt.ListPopup,f.dialogOptions.type=u?4:0,new b.DialogButton(n,f,r.locator.withCommand(t.name),i,{commandName:t.name})}function ti(n,t,i,r,u,f){var e={name:f,details:{invocationInputArguments:[{valuesFrom:[{property:"container.selectable",referenceType:4}]}]}};return ct(n,t,i,(function(n){return new d.OpenBladeCommand(n)}),e,r,u,f)}function ii(n,t,i,r,u,f,e){return ct(n,t,i,(function(){var n=new d.UriCommand;return n.navigateUri=e.uri,n.navigateTarget=e.target,n}),{name:f},r,u,f)}function ct(n,i,r,f,e,o,s,h){var v="__{0}ViewModel__".format(h),c=u.composeViewModel(f,!0),l=new nt(n,s,r,e,o,i),y={container:r,extension:s,viewModelName:v,commandItem:l,propertyBindings:null,diContainer:i,selectionInList:!1},a=p.createExtensionCommand(n,c.content(),c,y);return l.bind(new t.CompositionInstanceCommandContext(null,null,r)),n.registerForDispose([c.container,l,a]),a}var g,ot,nt,ht;Object.defineProperty(t,"__esModule",{value:!0});t.createOpenLinkCommand=t.createOpenBladeCommand=t.ExtensionCommandMenuItemImpl=t.ExtensionMultiselectCommandMenuItemImpl=t.ExtensionCommandMenuItemBase=t.getCommandGroupForDefinitionItem=t.getBladeContainerWidget=t.getBladeContentWidget=t.getCommandSourceTelemetryContext=t.CompositionInstanceCommandContext=t.CommandState=void 0;var it=MsPortalFx.Base,lt=it.Diagnostics,rt=it.Images,at=MsPortalFx.Extension,vt=at.SetRequirement,d=MsPortalFx.ViewModels,yt=d.Dialogs,pt=d.Toolbars,wt=l.CompositionBinder,ut=lt.createLog(n),ft=h.Commands,tt=MsPortalFx.uncurryThis(Array.prototype.forEach),et=(function(){function t(){this.commandsEnabled=ko.observable(!0)}return __decorate([__metadata("fx:diagnostics",[n,"CommandState"]),i.Class()],t)})();t.CommandState=et;t.CompositionInstanceCommandContext=p.CompositionInstanceCommandContext;t.getCommandSourceTelemetryContext=kt;t.getBladeContentWidget=dt;t.getBladeContainerWidget=gt;t.getCommandGroupForDefinitionItem=ni;g=(function(n){function t(t,i,r,u,f){var e=n.call(this,t,r)||this,o,s;return e.diContainer=f,o=ko.observable(!1),e.commandName=i,e._compositionContainer=u,s=e._overrideEnabled=ko.observable(),e.enabled=ko.computed(t,{read:function(){var n=s();return n===undefined&&(n=o()),n},write:function(n){o(n)}}),e._init(f),e}return __extends(t,n),Object.defineProperty(t.prototype,"container",{get:function(){return this._compositionContainer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sourceBindableContainer",{get:function(){return null},enumerable:!1,configurable:!0}),t.prototype._init=function(n){var t=this;ko.reactor(this._ltm,(function(){var i=n.get(et).commandsEnabled();i&&t.diContainer.get(v.DesktopManagerMode).value()!==1?t._overrideEnabled(undefined):t._overrideEnabled(!1)}))},t})(c.CommandImpl);t.ExtensionCommandMenuItemBase=g;ot=(function(n){function t(t,i,r,u,f,e,o){var s=this,h=u.name;s=n.call(this,t,h,u.text,r,e)||this;var c=s._ltm,l=r+"[Command: "+h||u.text+"]",a=bt(o);return s._subcommands=a.map((function(n){var t={viewModel:n.data,viewModelName:l,isPartListItem:!0};return new nt(c,i,r,u,f,e,t)})),ko.reactor(c,(function(){var n=s._subcommands.reduce((function(n,t){return t.enabled()&&n}),!0);s.enabled(n)})),s}return __extends(t,n),t.prototype.bind=function(n){tt(this._subcommands,(function(t){t.bind(n)}))},t.prototype.activate=function(){tt(this._subcommands,(function(n){n.activate()}))},t.prototype.execute=function(n){tt(this._subcommands,(function(t){t.execute(n)}))},t})(g);t.ExtensionMultiselectCommandMenuItemImpl=ot;nt=(function(t){function i(n,i,r,u,f,e,s,h){var c=t.call(this,n,u.name,u.text,r,e)||this;return c._viewModelManager=e.get(o.ViewModelManager),c._extension=i,c._commandDefinition=u,c._commandContainerDefinition=f,c._sourceBindableContainer=s,c._selectionInList=h,c}return __extends(i,t),i.prototype.extensionName=function(){return this._extension&&this._extension.name},Object.defineProperty(i.prototype,"commandDefinition",{get:function(){return ut.assert(!this._commandDefinition.reference,"External CommandDefinition not resolved."),this._commandDefinition},enumerable:!1,configurable:!0}),i.prototype.getInputBindingsFromDefinition=function(n){var i,t=this._getCommandReference(n);return t&&Array.isArray(t.bindings)&&t.bindings.length>0?i=t.bindings:n&&(i=n.bindings),i||[]},Object.defineProperty(i.prototype,"widgetViewModel",{get:function(){return this._widgetViewModel},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"sourceBindableContainer",{get:function(){return this._sourceBindableContainer},enumerable:!1,configurable:!0}),i.prototype.activate=function(){this._loadViewModel()},i.prototype.execute=function(n){var t=this,i=this.widgetViewModel,r=i&&i.dialogOptions;r&&r.type&&i.type===5?this._getFormTarget().then((function(i){var u=t.container.locator,f=u&&u.withCommand(t.commandName);t.diContainer.getAsync(y.DialogManager).then((function(n){return n.showDialog(r,i,t._target(),{locator:f})})).then((function(){t._execute(n)}))})):this._execute(n)},i.prototype.getCommandContext=function(){return this._currentContext},i.prototype._getFormTarget=function(){return this._currentContext&&this._currentContext.getFormTarget()},i.prototype._target=function(){return this._currentContext&&this._currentContext.target},i.prototype._getCommandReference=function(n){var t=this._commandContainerDefinition&&this._commandContainerDefinition.commandGroupReference,i=null;return t&&t.commands&&n.name&&(i=MsPortalFx.find(t.commands,(function(t){return t.name===n.name}))),i},i.prototype._execute=function(n){var i=this,u=this._currentContext.compositionInstance,r;if(!this._extensionCommand){this._loadViewModel();return}r=u&&u.widget;r&&!this._extensionCommand.canSkipBladeValidation?(this._overrideEnabledPropertyWith(!1),s.ensureFormFieldValidation(r.element).then((function(r){t.prototype.execute.call(i,n);i._extensionCommand.execute(n,r)})).finally((function(){i._clearEnabledPropertyOverride()}))):(t.prototype.execute.call(this,n),this._extensionCommand.execute(n))},i.prototype.dispose=function(){var r=this,n=this._viewModelLoadedPromise,i=function(){t.prototype.dispose.call(r)};n&&(n.then(i),this._viewModelLoadedPromise=null);i()},i.prototype.setEnabled=function(n){this._extensionEnabledProperty=n;this._overrideEnabledProperty||this.enabled(n)},i.prototype.getViewModel=function(){var n=this._extensionCommand;return n&&n.viewModel},i.prototype.getViewModelAsync=function(){return this._loadViewModel(),this._viewModelLoadedPromise},Object.defineProperty(i.prototype,"canRebind",{get:function(){var n=this._getContentViewModel(),t=n&&ko.unwrap(n.status);return t!==1},enumerable:!1,configurable:!0}),i.prototype._getContentViewModel=function(){var n=this.getViewModel();return n&&n.content()},i.prototype._overrideEnabledPropertyWith=function(n){this._overrideEnabledProperty=!0;this.enabled(n)},i.prototype._clearEnabledPropertyOverride=function(){this._overrideEnabledProperty&&(this._overrideEnabledProperty=!1,this.enabled(this._extensionEnabledProperty))},i.prototype._resolveCommandDefinition=function(){var t=this;return r.fcall((function(){var i=t._commandDefinition,r,u;if(i.reference)return r=i.reference.extension||t._extension.name,u=i.reference.commandType,t.icon(rt.Loading.EllipsisSquare()),t.text(ft.loading),t.diContainer.get(e.DefinitionCache).getCommand(r,u).then((function(e){MsPortalFx.isNullOrUndefined(e)&&f.logToExtension(n,t._extension.name,2,"Could not resolve the command reference for extension {0} and command name {1}".format(r,u));t._extension=t.diContainer.get(k.ExtensionManager).getExtension(r);var o=t.getInputBindingsFromDefinition(i);t._commandDefinition=MsPortalFx.extend2(e,{name:i.name});o.length>0&&(t._commandDefinition.bindings=o);t.text(t._commandDefinition.text)}))}))},i.prototype._logError=function(t){FxImpl.Rpc.client.log(this._extension.name,{level:2,code:0,area:n.normalize("."),message:MsPortalFx.getLogFriendlyMessage(t)+" \nCommand name: "+this._commandDefinition.name+" \nView model name: "+this._commandDefinition.viewModel})},i.prototype._createExtensionCommandHandler=function(n){var u=this,f=this._ltm,i;if(!f.isDisposed()){var o=n.content,t=f.createChildLifetime(),r={container:this.container,extension:this._extension,viewModelName:this._commandDefinition.viewModel,commandItem:this,propertyBindings:null,diContainer:this.diContainer,selectionInList:this._selectionInList},e=new ht(t,n,r);e.init();r.propertyBindings=e.propertyBindings;i=this._extensionCommand=p.createExtensionCommand(t,o(),n,r);i?(t.registerForDispose([i]),i.init()):this._logError(FxImpl.createError("Error loading command view model. Unknown view model type."));n.container.unauthorizedMessage.subscribeAndRun(t,(function(t){u.unauthorized(!MsPortalFx.isNullOrUndefined(t));u.tooltip(t||n.content().tooltip&&n.content().tooltip())}))}},i.prototype._loadViewModel=function(){var n=this,t;if(!this._viewModelLoadedPromise){if(t=this._ltm,!t)return;this._viewModelLoadedPromise=this._resolveCommandDefinition().then((function(){if(t=n._ltm,t){var u=n._extension,i=n._commandDefinition,r=i.commandKind===4;return(!i.commandKind||r)&&(n._widgetViewModel=st(n._ltm,i,n.diContainer,n.container,r)),n._viewModelManager.getViewModel(u.name,i.viewModelLocator||i.viewModel,7,{createSelectable:!0})}}));this._viewModelLoadedPromise.then((function(i){(t=n._ltm,t)&&(i.content().lc2&&(n._widgetViewModel=st(t,n._commandDefinition,n.diContainer,n.container,!0)),n._createExtensionCommandHandler(i))})).catch((function(t){var i=MsPortalFx.getLogFriendlyMessage(t);n.icon(rt.Blank());n.text(ft.failedToLoad);n._logError(FxImpl.createError("Error loading command view model.\nReason: {0}".format(i)))}))}},i})(g);t.ExtensionCommandMenuItemImpl=nt;ht=(function(){function n(n,t,i){var u=this,r;this._onInputsSetPending=ko.observable(!1);this._hasPermissions=ko.observable(!0);this._extension=i.extension;this._viewModelName=i.viewModelName;this._composedViewModel=t;this._commandViewModel=t.content();this._commandItem=i.commandItem;this._diContainer=i.diContainer;r=this._ltm=n.createChildLifetime();this._initializeInputBindings(i.container,i.commandItem);r.registerForDispose((function(){u._commandViewModel=null}))}return n.prototype.init=function(){var n=this._commandViewModel,t=this._commandItem;ko.isObservable(n.icon)&&n.icon.subscribeAndRun(this._ltm,t.icon);ko.isObservable(n.text)&&n.text.subscribeAndRun(this._ltm,(function(n){return n!==undefined&&t.text(n)}));ko.isObservable(n.ariaLabel)&&n.ariaLabel.subscribeAndRun(this._ltm,t.ariaLabel);ko.isObservable(n.tooltip)&&n.tooltip.subscribeAndRun(this._ltm,t.tooltip);ko.computed(this._ltm,[n.enabled,this._hasPermissions,this._onInputsSetPending,],(function(n,i,r){return t.setEnabled(n&&i&&!r)}))},Object.defineProperty(n.prototype,"propertyBindings",{get:function(){return this._propertyBindings},enumerable:!1,configurable:!0}),n.prototype.dispose=function(){this._ltm.dispose()},n.prototype._initializeInputBindings=function(n,t){var i=this,f=this._ltm,e,r,o,u;f&&(e=t.getInputBindingsFromDefinition(t.commandDefinition),r={bindableTarget:{viewModelName:n.toString()+"-["+this._viewModelName+"]",viewModel:this._composedViewModel},inputs:e,referenceComposition:n,referenceCompositionIsContainer:!0,customBindHandler:function(n){var i=t.sourceBindableContainer;if(i&&i.viewModel&&n.source.modelType!==0)return{sourceModelName:i.viewModelName,sourceModel:i.viewModel}},beforeViewModelPropertyUpdate:function(r){var u=t.commandDefinition,f;return u&&u.permissions?(i._hasPermissions(!1),f=n&&n.locator&&n.locator.toString()+"-",f=(f||"")+u.name,a.checkPermissions(u.permissions,vt.All,r,u.assetType,i._extension.name,i._diContainer,f).then((function(n){return i._updateForHasPermissions(n),n}))):(i._updateForHasPermissions(!0),Q(!0))}},r.inputs&&Array.isArray(r.inputs)&&r.inputs.length>0&&(this._onInputsSetPending(!0),r.inputsSetCalled=function(r,u){i._onInputsSetPending(!0);i._currentOnInputsSetPromise=u;u.then((function(){i._currentOnInputsSetPromise===u&&i._onInputsSetPending(!1)}),(function(u){ut.error("Command '{0}' on composition '{1}' rejected its onInputsSet promise.\nView Model Name: {2}\nInputs Provided: {3}\nReason: {4}".format(t.commandName,n.toString(),i._viewModelName,ko.toJSON(r),u||"N/A"))}))}),o=wt.bindViewModelInputs(this._diContainer,r),u=this._propertyBindings=o.propertyBindings,f.registerForDispose((function(){u&&(u.unbind(),i._propertyBindings=null)})))},n.prototype._updateForHasPermissions=function(n){var t=this._composedViewModel&&this._composedViewModel.container;t&&(n?t.unauthorizedMessage(undefined):t.unauthorized());this._hasPermissions(n)},n})();t.createOpenBladeCommand=ti;t.createOpenLinkCommand=ii}));
define("MsPortalImpl/UI/Commands/UI.CommandManager",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Widgets/Widgets.ContextMenu","MsPortalImpl/Widgets/Widgets.Portal.init","MsPortalImpl/Base/Base.KeyboardHelper"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function l(n){var i,t,r;if(h.isCtrlOrCommandOnly(n)||(i=y.getSelection(),i.rangeCount&&!i.getRangeAt(0).collapsed)||(t=$(n.target),t.filter("input,textarea").length)||t.add($(n.target).parents("a")).filter("a[href]:not([href='#']):not([href=''])").length)return!0;n.preventDefault();n.stopPropagation();r=$.Event("fxcontextmenurequest",{target:n.target,pageX:n.pageX,pageY:n.pageY,clientX:n.clientX,clientY:n.clientY});t.trigger(r)}var a;Object.defineProperty(t,"__esModule",{value:!0});t.PortalCommandManager=t.onContextMenu=t.AsyncPortalFormTarget=void 0;var v=FxImpl.TriggerableLifetimeManager,y=window,c=(function(){function t(){}return t.create=function(n){return n.getAsync(r.get("MsPortalImpl/UI/UI.PortalFormTarget","PortalFormTarget"))},__decorate([__metadata("fx:diagnostics",[n,"AsyncPortalFormTarget"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.Container]),__metadata("design:returntype",Promise)],t,"create",null),t})();t.AsyncPortalFormTarget=c;t.onContextMenu=l;a=(function(){function t(n,t,i){var r=this;this._desktopManagerMode=n;this._previouslyFocusedElement=t;this._diContainer=i;this._ltm=new v;this._ltm.registerForDispose($.querySelectorAll("body").setEvents(["fxcontextmenu",function(n,t){r._showContextMenu(n,t)},],["contextmenu",function(n){l(n)},]))}return t.prototype.dispose=function(){this._ltm.dispose()},t.prototype.getFormTarget=function(){return this._diContainer.getAsync(c)},t.prototype._showContextMenu=function(n,t){var w=this,y,v,i,h;this._contextMenu||(y=s.getPortalViewModel(this._diContainer),this._contextMenu=new o.Widget(y.getRootElement().find(".fxs-commands-contextMenu"),y.contextMenuViewModel,!0));var c=t.contextMenu?t.contextMenu:this._contextMenu,p=c.options.menuItems,r,e,b,l=n.clientX,a=n.clientY;if(t.commands&&t.commands.length!==0){if(t.srcElement){for(v=t.srcElement,i=v,$(v).hasClass("fxs-tile")&&(i=$(v).find(".fxs-part")[0]);i&&typeof i.focus!="function";)i=$(i).closest("[tabindex]")[0];this._previouslyFocusedElement.value(i)}b=t.formTarget&&t.formTarget.length>0?function(){return Q(u.getBladeContentWidget(t.formTarget))}:function(){return w.getFormTarget()};c.hide();p.splice(0,p().length);do e=e?e.parentNode:n.target,r=$(e).data(f.CompositionInstanceDataName);while(!r&&e.parentNode);(f.isContextMenuContainer(r)&&r.beforeActivateCommandMenuItems(t),t.commands.forEach((function(t){w._shouldShowCommand(t)&&(t.activate(),t.bind(new u.CompositionInstanceCommandContext(n.target,b,r)),p.push(t))})),c.options.hasVisibleCommands())&&(l||a||(h=n.target.getClientRects()[0],l=h&&h.left||l,a=h&&h.bottom||a),c.show(l,a,t&&t.forceLeft))}},t.prototype._shouldShowCommand=function(n){return this._desktopManagerMode.value()!==1||!this._isExtensionCommand(n)},t.prototype._isExtensionCommand=function(n){return!!n._extension},__decorate([__metadata("fx:diagnostics",[n,"PortalCommandManager"]),i.Class(),__metadata("design:paramtypes",[e.DesktopManagerMode,e.PreviouslyFocusedElement,i.Container])],t)})();t.PortalCommandManager=a}));
define("MsPortalImpl/UI/Commands/UI.ShellCommands",["require","exports","Fx/DependencyInjection","Fx/ResourceManagement","FxInternal","FxInternal/AsyncLoader","FxInternal/Composition/Part","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Commands/UI.CommandManager","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.TileActionBar","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Widgets/Widgets.Portal.init","MsPortalImpl/UI/Commands/Base.PortalFunctions"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d){"use strict";function it(n){return y.Widget.getWidget(n.closest(".fxs-tile"),p.Widget)}function ii(n,t){return rt||(rt=[{size:0,text:o.ShellCommands.partSizeMini},{size:1,text:o.ShellCommands.partSizeSmall},{size:2,text:o.ShellCommands.partSizeNormal},{size:3,text:o.ShellCommands.partSizeWide},{size:4,text:o.ShellCommands.partSizeTall},{size:10,text:o.ShellCommands.partSizeLarge},{size:5,text:o.ShellCommands.partSizeHeroWide},{size:6,text:o.ShellCommands.partSizeHeroTall},{size:11,text:o.ShellCommands.partSizeHero},],rt.forEach((function(n){n.icon=nt.Mini({customClass:"msportalfx-contextmenu-grid-"+st.InternalPartSize[n.size].toLowerCase()})}))),rt.map((function(i){return new ut(n,t,i.size,i.text,i.icon)}))}var tt,g,ht,ct,lt,at,vt,ut,rt,yt,pt,wt,bt,kt,dt,gt;Object.defineProperty(t,"__esModule",{value:!0});t.ClonePart=t.OpenBrowseDashboardsPane=t.ExitOrganizeMode=t.EnterOrganizeMode=t.ResetStartBoardCommand=t.ReloadPart=t.GoToAssetBlade=t.CreatePartSizeCommandCollection=t.PartSizeCommand=t.PinToStartboard=t.OpenContextMenu=t.CustomizeTileData=t.UnpinFromStartboard=t.ControlCommand=t.ShellCommand=t.CommandNames=t.commandNamePrefix=void 0;var ft=MsPortalFx.Base,et=ft.Diagnostics.Telemetry,ot=FxImpl.TelemetryContext,nt=ft.Images,st=MsPortalFx.Parts,ni=h.CompositionInstanceCommandContext,ti=MsPortalFx.tryImmediateResolve;t.commandNamePrefix="MsPortalImpl.UI.Commands.";tt=1;t.CommandNames={BladeDisplayState:t.commandNamePrefix+"BladeDisplayState",ClonePart:t.commandNamePrefix+"ClonePart",CustomizeTileData:t.commandNamePrefix+"CustomizeTileData",DeleteListItem:t.commandNamePrefix+"DeleteListItem",EnterOrganizeMode:t.commandNamePrefix+"EnterOrganizeMode",ExitOrganizeMode:t.commandNamePrefix+"ExitOrganizeMode",GoToAssetBlade:t.commandNamePrefix+"GoToAssetBlade",OpenBrowseDashboardsPane:t.commandNamePrefix+"OpenBrowseDashboardsPane",OpenContextMenu:t.commandNamePrefix+"OpenContextMenu",PartSize:t.commandNamePrefix+"PartSize",PinBlade:t.commandNamePrefix+"PinBlade",EditBlade:t.commandNamePrefix+"EditBlade",PinListItem:t.commandNamePrefix+"PinListItem",PinToStartboard:t.commandNamePrefix+"PinToStartboard",ReloadPart:t.commandNamePrefix+"ReloadPart",ResetLayout:t.commandNamePrefix+"ResetLayout",ResetStartBoard:t.commandNamePrefix+"ResetStartBoard",UnnamedCommand:t.commandNamePrefix+"UnnamedCommand",UnpinFromStartboard:t.commandNamePrefix+"UnpinFromStartboard"};g=(function(n){function t(t,i,r,u){var f=n.call(this,t,u.text,u.enabled)||this;return f._diContainer=i,f.commandName=r,f.icon(u.icon||nt.Blank()),f.isShellCommand=!0,f}return __extends(t,n),t.prototype.bind=function(t){var i=this;t.getFormTarget||(t.getFormTarget=function(){return i._diContainer.getAsync(c.AsyncPortalFormTarget)});n.prototype.bind.call(this,t)},t.prototype.execute=function(t){n.prototype.execute.call(this,t);var r=this._diContainer.get(v.JourneyManager).activeJourney(),i=h.getCommandSourceTelemetryContext(this._currentContext);ot.setContextValue(ot.ContextType.Blade,i);et.trace({source:i&&i.id,action:"CommandExecuted",name:this.commandName,data:{fromContextMenu:t,desktopMode:this._getDesktopMode()},journeyId:r&&r.id})},t.prototype.createAction=function(n){var i=this,t=new w.TileActionViewModel;return t.command=this,t.bindCommand=function(){var t=n.widget;t?i.bind(new ni(t.element[0],null,n)):i.enabled(!1)},this._setActionClassName(t),t},t.prototype._getComposition=function(){return this._currentContext.compositionInstance},t.prototype._getDesktopMode=function(){return this._diContainer.get(b.DesktopManagerMode).value()},t.prototype._setActionClassName=function(n){var t=this._getActionClassIdentifier();this._actionClassName="fxs-tile-actionbar-command-"+t;n.className=this._actionClassName},t.prototype._getActionClassIdentifier=function(){throw new Error("Not implemented.");},t})(s.CommandImpl);t.ShellCommand=g;ht=(function(n){function i(i,r,u){var f=n.call(this,i,r,t.CommandNames.UnnamedCommand,{text:u.text})||this;return f.command=u,f}return __extends(i,n),i.prototype.execute=function(t){this.command.handler().execute();n.prototype.execute.call(this,t)},i})(g);t.ControlCommand=ht;ct=(function(n){function i(i,r){return n.call(this,i,r,t.CommandNames.UnpinFromStartboard,{text:o.ShellCommands.unpinFromStartboard,icon:nt.Delete()})||this}return __extends(i,n),i.prototype.execute=function(t){var i=it($(this._currentContext.target));i&&i.trigger("fxunpin",{tileId:i.options.id});n.prototype.execute.call(this,t)},i.prototype._getActionClassIdentifier=function(){return"unpinfromstartboard"},i})(g);t.UnpinFromStartboard=ct;lt=(function(n){function i(i,r){var u=this,f=MsPortalFx.isFeatureEnabled(e.partHeaderEnabledFeatureName);return u=n.call(this,i,r,t.CommandNames.CustomizeTileData,{text:f?o.ShellCommands.configureTileSettings:o.ShellCommands.customizeTileData,icon:nt.Gear()})||this,u._partSettingsEnabled=f,u}return __extends(i,n),i.prototype.execute=function(){var n=this._getComposition();n.openPartSettingsBlade()},i.prototype.bind=function(t){n.prototype.bind.call(this,t);this.enabled(this._getDesktopMode()!==tt||this._partSettingsEnabled)},i.prototype._getActionClassIdentifier=function(){return"customizetiledata"},i})(g);t.CustomizeTileData=lt;at=(function(n){function i(i,r,u){return n.call(this,i,r,t.CommandNames.OpenContextMenu,{text:u,icon:nt.Ellipsis()})||this}return __extends(i,n),i.prototype.bind=function(t){var u=this,i,r;n.prototype.bind.call(this,t);i=this._partWidget=it($(t.target));r=i.options.commands.filter((function(n){return n.bind(t),n.visible()&&n.enabled()}));this.enabled(r.length>0);ko.computed(this._ltm,(function(){var n=i.actionBarWidget&&i.actionBarWidget.contextMenuWidget.options.visible(),t=i.element.findByClassName(u._actionClassName);t.toggleClass("fxs-tile-actionbar-action-pressed",n)}))},i.prototype.execute=function(t){var i=this._partWidget,r=i.element,u=$.Event("fxcontextmenu"),f=r.offset();u.clientX=f.left+r.outerWidth(!1);u.clientY=f.top;r.trigger(u,{commands:i.options.commands,contextMenu:i.actionBarWidget.contextMenuWidget});n.prototype.execute.call(this,t)},i.prototype._getActionClassIdentifier=function(){return"opencontextmenu"},i})(g);t.OpenContextMenu=at;vt=(function(n){function i(i,r,u){var f=n.call(this,i,r,t.CommandNames.PinToStartboard,{text:o.ShellCommands.pinToStartboard,icon:nt.Pin(),enabled:!1})||this;return f.partComposition=u,f}return __extends(i,n),i.prototype.bind=function(t){var i,r;if(n.prototype.bind.call(this,t),!this.partComposition.allInputsSet()){this.enabled(!1);return}if(i=this.partComposition.widget,r=!1,i){var f=l.isVariableSize(i.options.size()),e=ko.unwrap(i.options.supportedSizes),u=void 0,o=i.element.parentsUntil(".fxs-blade",".fxs-blade-summary-container").length>0;o?r=!1:f?(u=MsPortalFx.find(e,(function(n){return l.isFixedSize(n)})),u!==null&&u>=0&&(r=!0)):r=!0}this.enabled(r)},i.prototype.execute=function(t){var i=this;MsPortalFx.isFeatureEnabled("dashboardsaveexperience")?f.get("MsPortalImpl/UI/Dashboard/Common/DashboardPinHelper","copyPartWithDashboardSelection").then((function(n){return n(i._diContainer,"ShellCommands",i.partComposition,!1)})).finally((function(){n.prototype.execute.call(i,t)})):this._diContainer.get(d.PinTilePortalFunc).invoke(this.partComposition,"ShellCommands").finally((function(){n.prototype.execute.call(i,t)}))},i.prototype._getActionClassIdentifier=function(){return"pintostartboard"},i})(g);t.PinToStartboard=vt;ut=(function(n){function i(i,r,u,f,e){var o=n.call(this,i,r,t.CommandNames.PartSize+st.InternalPartSize[u],{text:f,icon:e})||this;return o.sizeTarget=u,o}return __extends(i,n),i.prototype.execute=function(t){var i=it($(this._currentContext.target)),r;i&&(r=l.AllSizes[this.sizeTarget],i.element.trigger("fxsizechange",[i.options.id,r.size.width,r.size.height]),u.fcall((function(){i.setFocus()})));n.prototype.execute.call(this,t)},i.prototype.bind=function(t){var i=it($(t.target)),r=i&&i.options;if(!i||this.sizeTarget===r.size()||l.isVariableSize(r.size())||this._getDesktopMode()!==tt){this.enabled(!1);return}this.enabled(r.supportedSizes().indexOf(this.sizeTarget)!==-1);n.prototype.bind.call(this,t)},i})(g);t.PartSizeCommand=ut;t.CreatePartSizeCommandCollection=ii;yt=(function(n){function i(i,r,u){var f=n.call(this,i,r,t.CommandNames.GoToAssetBlade,{text:o.ShellCommands.goToAsset,icon:nt.Go(),enabled:!1})||this;return f.assetWrapper=u,f}return __extends(i,n),i.prototype.bind=function(t){var i=this;n.prototype.bind.call(this,t);this.assetWrapper.getAssetId().then((function(n){i._assetId=n;i.enabled(r.ArmId.parse(n,!0).kind!==0)})).catch($.noop)},i.prototype.execute=function(t){var i=this;n.prototype.execute.call(this,t);f.get("MsPortalImpl/UI/UI.DeepLink","getResourceDeepLink").then((function(n){var t=n(i._diContainer,i._assetId);i._diContainer.get(d.RoutePortalFunc).invoke(t,"ShellCommands")}))},i})(g);t.GoToAssetBlade=yt;pt=(function(n){function i(i,r,u){var f=n.call(this,i,r,t.CommandNames.ReloadPart,{text:o.ShellCommands.reloadPart,icon:nt.Refresh({palette:99})})||this;return f.partComposition=u,f}return __extends(i,n),i.prototype.bind=function(t){n.prototype.bind.call(this,t)},i.prototype.execute=function(t){n.prototype.execute.call(this,t);var i=this.partComposition;return this._diContainer.get(d.ReloadPartPortalFunc).invoke(i,"ShellCommands").then((function(n){var t={source:"Shell",action:"ErrorInteraction",actionModifier:"Refresh",context:{content:i.locator&&i.locator.name,instanceId:i.id}};return n.await(3).then((function(){t.data={successful:!0}}),(function(){t.data={successful:!1}})).finally((function(){et.trace(t)})),n}))},i})(g);t.ReloadPart=pt;wt=(function(n){function i(i,r){return n.call(this,i,r,t.CommandNames.ResetStartBoard,{text:o.ShellCommands.resetLayout})||this}return __extends(i,n),i.prototype.execute=function(t){this._diContainer.get(d.ResetDashboardPortalFunc).invoke({duringPortalStartup:!1,force:!1},"ShellCommands");n.prototype.execute.call(this,t)},i.prototype.bind=function(t){n.prototype.bind.call(this,t);this.enabled(this._getDesktopMode()===tt)},i})(g);t.ResetStartBoardCommand=wt;bt=(function(n){function i(i,r,u){var f=n.call(this,i,r,t.CommandNames.EnterOrganizeMode,{text:o.ShellCommands.enterOrganizeMode,icon:nt.Edit()})||this;return f._expandTileGallery=!!u,r.get(b.DesktopManagerMode).value.subscribeAndRun(f._ltm,(function(n){var t=n!==tt;f.enabled(t)})),f}return __extends(i,n),i.prototype.execute=function(t){var i=this._getComposition();i&&i.widget?i.widget.element.trigger("fxenterorganizemode",{trigger:1,openTileGallery:this._expandTileGallery}):this._diContainer.get(b.DesktopManagerMode).value(tt);n.prototype.execute.call(this,t)},i})(g);t.EnterOrganizeMode=bt;kt=(function(n){function i(i,r){return n.call(this,i,r,t.CommandNames.ExitOrganizeMode,{text:o.ShellCommands.exitOrganizeMode})||this}return __extends(i,n),i.prototype.execute=function(t){k.getPortalViewModel(this._diContainer).topBar.exitOrganizeMode();n.prototype.execute.call(this,t)},i.prototype.bind=function(t){n.prototype.bind.call(this,t);this.enabled(this._getDesktopMode()===tt)},i})(g);t.ExitOrganizeMode=kt;dt=(function(r){function u(n){return r.call(this,new FxImpl.TriggerableLifetimeManager,n,t.CommandNames.OpenBrowseDashboardsPane,{})||this}return __extends(u,r),u.prototype.execute=function(n){var t=this;r.prototype.execute.call(this,n);ti(f.get("MsPortalImpl/Widgets/BrowseDashboardsPane","BrowseDashboardsPane"),(function(n){var i=t._diContainer.get(a.RightContextPane),r=i.getContent(),u;if(r instanceof n){i.tryOpen(r);return}u=t._diContainer.get(n);i.tryOpen(u)}))},__decorate([__metadata("fx:diagnostics",[n,"OpenBrowseDashboardsPane"]),i.Class(),__metadata("design:paramtypes",[i.Container])],u)})(g);t.OpenBrowseDashboardsPane=dt;gt=(function(r){function u(n,i,u){var f=r.call(this,n,i,t.CommandNames.ClonePart,{text:o.ShellCommands.copy,icon:nt.Copy()})||this;return f._partComposition=u,f}return __extends(u,r),u.prototype.execute=function(n){var t=this;r.prototype.execute.call(this,n);f.get("MsPortalImpl/UI/Dashboard/Common/DashboardPinHelper","copyPartWithDashboardSelection").then((function(n){return n(t._diContainer,"Dashboard",t._partComposition)}))},__decorate([__metadata("fx:diagnostics",[n,"ClonePart"]),i.Class(),__metadata("design:paramtypes",[Object,i.Container,Function])],u)})(g);t.ClonePart=gt}));
define("WeaveDOM/SandboxRender/Serialize",["require","exports","WeaveDOM/Core/Sanitization","Weave/Core/InternalUtil","WeaveDOM/Core/InternalUtil","Weave/Core/Computation"],(function(n,t,i,r,u,f){"use strict";function s(n,t,i,r,f,o,s,h){var c={commentContainers:[],dynamicNodes:[],elementNodes:[],htmlFragments:[]},a=h&&h(),l,v;return e(n.children,t,c,i,r,f,o,s,a),l=u.documentFragmentFromHtml(c.htmlFragments.join("")),v=u.collectCommentNodes(c.commentContainers,l),{containerDoc:l,commentLookup:v,dynamicNodes:c.dynamicNodes,elementNodes:c.elementNodes,hooksState:a}}function o(n,t,i){t=(t||"").trim();switch(n){case"aria-describedby":case"aria-controls":case"aria-labelledby":case"aria-owns":case"for":case"form":case"headers":case"id":case"list":var r=t.split(" ").filter(f._identity);return b(r,i).join(" ");default:return t}}function e(n,t,i,r,u,f,e,o,s){for(var v,c=!1,l=0,a=n;l<a.length;l++)v=a[l],c=h(v,t,i,r,u,f,e,o,s)||c;return c}function h(n,t,i,u,f,e,o,s,h){switch(n.type){case"element":return c(n,t,i,u,f,e,o,s,h);case"dynamic":return l(n,t,i,u,f,e,o,s,h);case"text":return y(n,i.htmlFragments);case"html":return p(n,i.htmlFragments,e);default:r.assertSwitchNever(n)}}function c(n,t,u,f,s,h,c,l,a){var k=n.tagName,d,tt,nt,it,ut;w(k);var p="",y="",v=u.htmlFragments;for(v.push("<",k),d=0,tt=n.attributes;d<tt.length;d++){var rt=tt[d],b=rt.name,g=rt.value;if(i.ensureAllowedAttribute(k,b),nt=i.sanitizeAttributeValue(b,g,c),nt.valid)if(b==="id")if(g){if(p)throw new Error("Only one element id can be accepted, "+p+", "+g);p=nt.value;y=r.getUniqueElementId();v.push(' id="',y,'"')}else throw new Error("Empty element node id is not accepted.");else v.push(" ",b,'="',r.encodeHtml(o(b,nt.value,s)),'"');else console.warn("Invalid attribute value will be ignored: "+b+", "+g)}return l&&l.element.postSerialize({addAttribute:function(n,t){return v.push(" ",n,'="',t,'"')},getElementNodeId:function(){return p||(p=y=r.getUniqueElementId(),v.push(' id="',y,'"')),p},node:n,options:t,ltm:f.innerLtmRoot,hooksState:a}),i.isSelfCloseTag(k)?v.push("/>"):(it=-1,y||(it=v.length,v.push("")),v.push(">"),ut=e(n.children,t,u,f,s,h,c,l,a),ut&&(y||(y=r.getUniqueElementId(),v[it]=' id="'+y+'"'),u.commentContainers.push(y)),v.push("<\/",k,">")),p&&u.elementNodes.push({ltm:f,nodeId:p,domId:y}),!1}function l(n,t,i,f,o,s,h,c,l){var y=u.getUniqueCommentIdPair(),p=y.commentStartId,w=y.commentEndId;i.htmlFragments.push("<!--",p,"-->");var b=r.createDynamicNodeLtms(n.dynamicNodeType,f),k=b.selfLtm,d=b.contentLtm,g=d||k;if(e(n.children,t,i,g,o,s,h,c,l),i.htmlFragments.push("<!--",w,"-->"),n.dynamicNodeType==="forEach"&&!n.children.every(a))throw new Error("Only ForEachItem node is allowed as a children to ForEach node.");return i.dynamicNodes.push({nodeId:n.nodeId,nodeType:n.dynamicNodeType,commentStartId:p,commentEndId:w,initContentLtm:d,selfLtm:k,initItemsId:n.dynamicNodeType==="forEach"?n.children.map(v):undefined}),!0}function a(n){return n.type==="dynamic"&&n.dynamicNodeType==="forEachItem"}function v(n){return n.nodeId}function y(n,t){return n.text&&typeof n.text=="string"&&t.push(r.encodeHtml(n.text)),!1}function p(n,t,i){return t.push(i(n.htmlData)),!1}function w(n){if(!i.validateTagNameInSandboxMode(n))throw new Error("TagName: "+n+" is not allowed");}function b(n,t){for(var r=new Array(n.length),i=0;i<n.length;++i)r[i]=t+n[i];return r}Object.defineProperty(t,"__esModule",{value:!0});t.mapAttributeIdPointers=t.serializeRootNode=void 0;t.serializeRootNode=s;t.mapAttributeIdPointers=o}));
define("WeaveDOM/SandboxRender/WeaveSandbox",["require","exports","WeaveDOM/Core/InternalUtil","WeaveDOM/SandboxRender/Serialize","Weave/Core/MemoryManager","WeaveDOM/DirectRender/ForEachNodeOperations","WeaveDOM/Core/Sanitization","Weave/Core/InternalUtil","WeaveDOM/Core/DomOperatorBase","Weave/Core/InternalUtil","Weave/Core/Computation"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function p(n,t){var i=null,r=!1,u=h.makeMap(a.concat(t.customInstructionHandlers||[]),(function(n){return n.name}),(function(n){return n.handler}));return t.registerOnReceive((function(f,e){if(!r&&f)if(f.type==="setRoot"){if(i)throw new Error("Cannot have more than one setRoot instruction.");i=new l({rootElement:n,config:t,rootNode:f.rootNode,setRootInstructionOptions:e,idMapPrefix:k(),cssChanges:f.css})}else{var o=u.get(f.type);if(o)o(f,i,e);else throw new Error("Unknown Weave sandbox mode instruction: "+JSON.stringify(f).slice(0,200));}})),t.registerOnDispose((function(){i&&i.dispose();r=!0})),function(){return i&&i.getMemoryDebugInfo()}}function w(n){return typeof n!="number"}function v(n,t,r,u,f){for(var s,a,h,l,e,o=0,c=n;o<c.length;o++)s=c[o],a=i.getElementByIdInDocumentFragment(f,s.domId),r.setElementNode({nodeId:s.nodeId,element:a,ltm:s.ltm});for(h=0,l=t;h<l.length;h++)e=l[h],r.setDynamicNode({nodeId:e.nodeId,type:e.nodeType,commentStart:u.get(e.commentStartId),commentEnd:u.get(e.commentEndId),contentLtm:e.initContentLtm,selfLtm:e.selfLtm,itemNodesId:e.initItemsId})}function b(n){return n.nodeId}function k(){return"_wv_sandbox_idmap_"+y+++"_"}var a,l,y;Object.defineProperty(t,"__esModule",{value:!0});t.SandboxModeRenderEngine=t.connect_internal=void 0;t.connect_internal=p;a=[{name:"applyCss",handler:function(n,t){return t.applyCssChanges(n.css)}},{name:"clear",handler:function(n,t){return t.clear(n.dynamicNodeId)}},{name:"remove",handler:function(n,t){return t.remove(n.dynamicNodeId)}},{name:"removeAttribute",handler:function(n,t){return t.removeAttribute(n.elementNodeId,n.attributeName)}},{name:"toggleClass",handler:function(n,t){return t.toggleClass(n.elementNodeId,n.value.className,n.value.shouldAdd)}},{name:"setAttribute",handler:function(n,t){return t.setAttribute(n.elementNodeId,n.attributeName,n.attributeValue)}},{name:"setContent",handler:function(n,t,i){return t.setContent(n.dynamicNodeId,n.rootNode,i)}},{name:"setItems",handler:function(n,t,i){return t.setItems(n.dynamicNodeId,n.items,n.css,i)}},{name:"setStyle",handler:function(n,t){return t.setStyle(n.elementNodeId,n.styleName,n.styleValue)}},{name:"toggleDisplay",handler:function(n,t){return t.toggleDisplay(n.dynamicNodeId,n.shouldShow)}},{name:"setEventListener",handler:function(n,t){return t.addEventListener(n.elementNodeId,n.eventName,n.options)}},{name:"focus",handler:function(n,t){return t.focus(n.locatorClass,n.elemIndex)}},{name:"setLocatorClass",handler:function(n,t){return t.toggleClass(n.elementNodeId,t.getDomUniqueLocatorClass(n.locatorClass),!0)}},{name:"initTwoWayInputBinding",handler:function(n,t){t.initTwoWayInputBinding(n.elementNodeId,n.inputBindingName)}},{name:"initValuePushInputBinding",handler:function(n,t){t.initValuePushInputBinding(n.elementNodeId,n.inputBindingName)}},{name:"initValueSubscribeInputBinding",handler:function(n,t){t.initValueSubscribeInputBinding(n.elementNodeId,n.inputBindingName)}},{name:"twoWayInputBindingCommit",handler:function(n,t){t.twoWayInputBindingCommit(n.elementNodeId,n.inputBindingName,n.value)}},{name:"pushInputValue",handler:function(n,t){t.pushInputValue(n.elementNodeId,n.inputBindingName,n.value)}},];l=(function(){function n(n){var e=this,t,f;this._options=n;this._memoryManager=new u.MemoryManager;this._domAgent=new s.DirectDomAgent;this._cssMap=new Map;this._attributeSanitizer=this._options.config.attributeSanitizer;this._getHtmlString=this._options.config.htmlElementDataSerializer;this._idMapPrefix=this._options.idMapPrefix;this._rootElement=this._options.rootElement;this._createHookState=this._options.config.createHookState;this._sendNotification=this._options.config.notificationCallback;this._serializeHooks=this._options.config.serializeHooks;this._postRender=this._options.config.postRender;this._getElement=function(n){return e._memoryManager.getAndEnsureElementNode(n).element};this._customEventHandlerMap=h.makeMap(n.config.customEventHandlers||[],(function(n){return n.eventName}),(function(n){return n.handler}));t=r.serializeRootNode(n.rootNode,n.setRootInstructionOptions,this._memoryManager.outerLtmRoot,this._idMapPrefix,this._getHtmlString,this._attributeSanitizer,this._serializeHooks,this._createHookState);f=t.containerDoc;v(t.elementNodes,t.dynamicNodes,this._memoryManager,t.commentLookup,f);i.removeAllChildren(n.rootElement);this.applyCssChanges(n.cssChanges);n.rootElement.appendChild(f);this._postRender&&this._postRender({hooksState:t.hooksState,getElement:this._getElement})}return n.prototype.dispose=function(){this._memoryManager.dispose();i.removeAllChildren(this._rootElement)},n.prototype.applyCssChanges=function(n){for(var o,t,i,r,s,f,h,u,c=n.newCssDefinition,e=0,l=Object.keys(c);e<l.length;e++)o=l[e],this._cssMap.set(o,c[o]);for(t=[],i=[],r=0,s=n.addedCss;r<s.length;r++)u=s[r],t.push(this._cssMap.get(u));for(f=0,h=n.removedCss;f<h.length;f++)u=h[f],i.push(this._cssMap.get(u));(t.length||i.length)&&this._options.config.cssLoader(t,i)},n.prototype.setAttribute=function(n,t,i){this._domAgent.setAttribute(this._memoryManager,this._attributeSanitizer,n,t,r.mapAttributeIdPointers(t,i,this._idMapPrefix))},n.prototype.removeAttribute=function(n,t){this._domAgent.removeAttribute(this._memoryManager,n,t)},n.prototype.toggleClass=function(n,t,i){this._domAgent.toggleClass(this._memoryManager,n,t,i)},n.prototype.setStyle=function(n,t,i){this._domAgent.setStyle(this._memoryManager,n,t,i)},n.prototype.clear=function(n){var t=this._memoryManager.getAndEnsureDynamicNode(n);this._memoryManager.ensureContentDisposed(t,null);this._domAgent.clear(t)},n.prototype.remove=function(n){this._domAgent.remove(this._memoryManager.releaseDynamicNode(n,null))},n.prototype.toggleDisplay=function(n,t){this._domAgent.toggleDisplay(this._memoryManager,n,t)},n.prototype.addEventListener=function(n,t,r){var s=this,u=this._memoryManager.getAndEnsureElementNode(n),f=u.eventNames,e;f||(f=u.eventNames=[]);f.indexOf(t)<0&&(f.push(t),e=this._customEventHandlerMap.get(t),e?e({element:u.element,elementNodeId:n,ltm:u.ltm.innerLtmRoot,options:r}):i.attachEventListener(u.element,u.ltm.innerLtmRoot,t,(function(i){s._sendNotification({type:"event",elementNodeId:n,eventName:t,eventData:o.getEventData(i,t)})})))},n.prototype.setContent=function(n,t,u){var f=this._memoryManager.getAndEnsureDynamicNode(n);o.ensureDynamicNodeOperation(f.type,4);i.ensureNoContent(this._memoryManager,f,!1,null);var s=f.selfLtm,c=h.getDynamicNodeOperations(f.type)&1?f.contentLtm=s.createChildNode():s,e=r.serializeRootNode(t,u,c,this._idMapPrefix,this._getHtmlString,this._attributeSanitizer,this._serializeHooks,this._createHookState);this._domAgent.setDisplayState(f.commentStart,e.containerDoc);this._renderAfterComment(e,f.commentStart);this._postRender&&this._postRender({hooksState:e.hooksState,getElement:this._getElement})},n.prototype.setItems=function(n,t,i,u){var s=this,h,p,k,a,d,l,v,y;for(this.applyCssChanges(i),h=this._memoryManager.getAndEnsureDynamicNode(n),o.ensureDynamicNodeOperation(h.type,8),p=h.itemNodesId,k=e.arrayToSet(p),a=0,d=t;a<d.length;a++)if(l=d[a],typeof l=="number"){if(!k.delete(l))throw new Error("The ForEachItem node "+l+" doesn't exists, state tracking is lost.");}else if(l.dynamicNodeType!=="forEachItem")throw new Error("Only ForEachItem is allowed as children of ForEach node.");return k.forEach((function(n){s._memoryManager.releaseDynamicNode(n,null)})),v={created:0,deleted:0,skipped:0,moved:0},y=f.processForEachItems((function(n){return s._memoryManager.getAndEnsureDynamicNode(n)}),(function(n,t){var i=r.serializeRootNode({children:n},u,h.selfLtm,s._idMapPrefix,s._getHtmlString,s._attributeSanitizer,s._serializeHooks,s._createHookState);return s._domAgent.setDisplayState(h.commentStart,i.containerDoc),s._renderAfterComment(i,t),s._postRender&&s._postRender({hooksState:i.hooksState,getElement:s._getElement}),n.map(b)}),h,t,w,c._identity,v),v.deleted=p.length-(y.length-v.created),h.itemNodesId=y,y},n.prototype.focus=function(n,t){var i=this._rootElement.getElementsByClassName(this.getDomUniqueLocatorClass(n))[t];i&&document.activeElement!==i&&i.focus()},n.prototype.getElementMetadata=function(n){return this._memoryManager.getAndEnsureElementNode(n)},n.prototype.getMemoryDebugInfo=function(){return this._memoryManager.getDebugInfo()},n.prototype.getDomUniqueLocatorClass=function(n){var t=this;return n.split(" ").filter(c._identity).map((function(n){return t._idMapPrefix+n})).join(" ")},n.prototype.initTwoWayInputBinding=function(n,t){var h=this,r=this._memoryManager.getAndEnsureElementNode(n),e=this._domAgent.prepareInitInputBinding(r,t),o={type:"twoWay",name:t,pendingCount:0},u,f,s;for(this._domAgent.inputBindingsMgr.createInputBinding(r,o),u=0,f=e.eventsToListen;u<f.length;u++)s=f[u],i.attachEventListener(r.element,r.ltm.innerLtmRoot,s,(function(i){h._sendNotification({type:"twoWayInputBinding",elementNodeId:n,inputBindingName:t,eventData:e.collectDataFromEvent(i)});o.pendingCount++}))},n.prototype.initValuePushInputBinding=function(n,t){var r=this._memoryManager.getAndEnsureElementNode(n),o=this._domAgent.prepareInitInputBinding(r,t),s={type:"valuePush",name:t,lastReceivedValue:undefined},f,u,e,h;for(this._domAgent.inputBindingsMgr.createInputBinding(r,s),f=r.element,u=0,e=o.eventsToListen;u<e.length;u++)h=e[u],i.attachEventListener(f,r.ltm.innerLtmRoot,h,(function(){o.writeValueToElement(f,s.lastReceivedValue)}))},n.prototype.initValueSubscribeInputBinding=function(n,t){var h=this,r=this._memoryManager.getAndEnsureElementNode(n),e=this._domAgent.prepareInitInputBinding(r,t),c={type:"valueSubscribe",name:t},o,u,f,s;for(this._domAgent.inputBindingsMgr.createInputBinding(r,c),o=r.element,u=0,f=e.eventsToListen;u<f.length;u++)s=f[u],i.attachEventListener(o,r.ltm.innerLtmRoot,s,(function(i){h._sendNotification({type:"valueSubscribeInputBinding",elementNodeId:n,inputBindingName:t,eventData:e.collectDataFromEvent(i)})}))},n.prototype.twoWayInputBindingCommit=function(n,t,i){var u=this._memoryManager.getAndEnsureElementNode(n),r=this._domAgent.inputBindingsMgr.resolveInputBinding(u,t,["twoWay"]),f=this._domAgent.ensureInputBindingMetadata(t);if(r.pendingCount<=0)throw new Error("Received more twoWayInputBindingCommit message than it should. "+n+', "'+t+'", '+r.pendingCount);r.pendingCount--;r.pendingCount===0&&f.writeValueToElement(u.element,i)},n.prototype.pushInputValue=function(n,t,i){var r=this._memoryManager.getAndEnsureElementNode(n),u=this._domAgent.inputBindingsMgr.resolveInputBinding(r,t,["twoWay","valuePush"]),f=this._domAgent.ensureInputBindingMetadata(t);u.type==="twoWay"?u.pendingCount===0&&f.writeValueToElement(r.element,i):(u.lastReceivedValue=i,f.writeValueToElement(r.element,i))},n.prototype._renderAfterComment=function(n,t){var u=t.nextSibling,r=n.containerDoc;v(n.elementNodes,n.dynamicNodes,this._memoryManager,n.commentLookup,r);i.insertNodeBeforeNode(u,r)},n})();t.SandboxModeRenderEngine=l;y=0}));
define("MsPortalImpl/Weave/SandboxRender",["require","exports","MsPortalImpl/Weave/InternalUtil","WeaveDOM/SandboxRender/WeaveSandbox","MsPortalImpl/Base/Base.KnockoutExtensions.Image","Viva.Controls/Util/Viva.Resize","MsPortalImpl/Weave/SandboxDomAgents/EntryPoint","MsPortalImpl/Base/Base.Timers","WeaveDOM/Core/InternalUtil","Weave/Core/InternalUtil"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function l(t,h,l,a){var v=!1;return r.connect_internal(h,{cssLoader:a,registerOnReceive:function(n){if(v)throw new Error("onReceive can only be registered once.");v=!0;t.onObject((function(t){n(t.body,t.obj)}))},registerOnDispose:function(n){return t.onDispose(n)},notificationCallback:function(n){return t.postMessage(n)},attributeSanitizer:{href:function(t){return i.sanitizeHref(t,{diContainer:l,windowContext:h,localRequire:n})},src:i.sanitizeSrc},htmlElementDataSerializer:i.makeHtmlDataHandler(h,l,!1),customEventHandlers:[{eventName:"fxResize",handler:function(n){var r=n.element,u=n.elementNodeId,i=n.ltm;o.requestAnimationFrame((function(){i.isDisposed()||f.track(i.createChildLifetime(),$(r),(function(n,i){t.postMessage({type:"event",elementNodeId:u,eventName:"fxResize",eventData:{height:i||0,width:n||0}})}),{notifyInitialSize:!0})}))}},{eventName:"fxCustomClick",handler:function(n){var r=n.element,u=n.elementNodeId,f=n.ltm,e=n.options,i=e;s.attachEventListener(r,f,"click",(function(n){(i===null||i===void 0?void 0:i.stopPropagation)===!0&&n.stopPropagation();(i===null||i===void 0?void 0:i.preventDefault)===!0&&n.preventDefault();t.postMessage({type:"event",elementNodeId:u,eventName:"fxCustomClick",eventData:null})}))}},c("fxCustomKeyDown","keydown",t),c("fxCustomKeyUp","keyup",t),c("fxCustomKeyPress","keypress",t),],customInstructionHandlers:[{name:"fxSetImage",handler:function(n,t){return u.renderImage(t.getElementMetadata(n.elementNodeId).element,n.value)}},{name:"fxSetFocus",handler:function(n,t){return t.getElementMetadata(n.elementNodeId).element.focus()}},{name:"fxRequestConfirm",handler:function(n){var i=window.confirm(n.value.content)?"ok":"cancel";t.postMessage({type:"fxAnswerConfirm",value:{reply:i,replyId:n.value.replyId}})}},],createHookState:function(){return[]},serializeHooks:{element:{postSerialize:function(n){var r=n.addAttribute,u=n.getElementNodeId,f=n.node,i=n.options,e=n.ltm,o=n.hooksState,t=f;t.proxiedDataIndexes&&t.proxiedDataIndexes.length>0&&(t.proxiedDataIndexes.some((function(n){return i[n].type==="pcControl"}))&&r("data-bind","pcControl: __control_vm__"),o.push({ltm:e,nodeId:u(),proxiedDataList:t.proxiedDataIndexes.map((function(n){return i[n]}))}))}}},postRender:function(n){for(var u,f=n.hooksState,o=n.getElement,s=function(n){for(var r,y,t,u=o(n.nodeId),f=n.ltm,h=!1,c=!1,a=!1,s=0,v=n.proxiedDataList;s<v.length;s++){r=v[s];switch(r.type){case"pcControl":if(h)throw new Error("Duplicate control vm associated to one element found.");h=!0;t=r.data;y=new ko.bindingContext({__control_vm__:t.vm}).extend({$tabIndex:t.tabIndex,$disabled:t.disabled,$partName:t.partName,$extensionName:t.extensionName,$vm:t.vm,$dicontainer:l});ko.applyBindings(y,u);f.registerForDispose((function(){return ko.cleanNode(u)}));break;case"fxclick":if(c)throw new Error("Duplicate fxclick associated to one element found.");c=!0;t=r.data;i.applyFxClickToElement(u,f,t.data,{diContainer:l,disabled:t.disabled,tabIndex:t.tabIndex});break;case"domAgent":if(a)throw new Error("Duplicate attachWidget associated to one element found.");a=!0;e.attachSandboxDomAgent(u,f,l,r.data);break;default:throw new Error("Unknown proxied data type: "+r.type);}}},t=0,r=f;t<r.length;t++)u=r[t],s(u)}})}function c(n,t,r){return{eventName:n,handler:function(u){var e=u.element,o=u.elementNodeId,c=u.ltm,l=u.options,f=l;s.attachEventListener(e,c,t,(function(u){i.matchKeyCode(f===null||f===void 0?void 0:f.stopPropagation,u.keyCode)&&u.stopPropagation();i.matchKeyCode(f===null||f===void 0?void 0:f.preventDefault,u.keyCode)&&u.preventDefault();r.postMessage({type:"event",elementNodeId:o,eventName:n,eventData:h.getEventData(u,t)})}))}}}Object.defineProperty(t,"__esModule",{value:!0});t.connectWeaveShellPort=void 0;t.connectWeaveShellPort=l}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.PartError.css",["module"],(function(n){"use strict";return{css:".fxs-part-error-content{display:flex;flex-flow:column nowrap;height:100%;box-sizing:border-box;max-width:715px;font-size:13px;margin:0 auto}.fxs-part-error-reason,.fxs-part-error-detailslink{text-align:center;flex:0 0 auto;margin-bottom:4px}.fxs-part-error-healthlinkcontainer{margin:-10px 15px 0}.fxs-part-error-showdetailscontainer{display:flex;flex-flow:row nowrap;align-items:center;justify-content:center}.fxs-part-error-detailslink{display:none}.fxs-part .fxs-part-content.fxs-errorpart~.fxs-part-nodatamessage{display:none !important}.fxs-part-error-iconcontainer{display:flex;flex-flow:column nowrap;align-items:center;justify-content:center;flex:0 1 auto}.fxs-part-error-icon{flex:0 0 auto;display:block;height:50px;width:50px;padding:10px}.fxs-part-error-commandlist{display:flex;justify-content:center;flex:0 0 auto}.fxs-part-error-summary{border-width:1px;border-style:solid;overflow-x:hidden;overflow-y:auto;flex:0 1 auto;margin:10px 0}.fxs-part-error-summaryheadercontainer{margin:15px;display:flex;align-items:center}.fxs-part-error-summaryheader{margin:0}.fxs-part-error-summaryfooter{margin:15px}.fxs-part-error-summarycopybutton{margin-left:15px}.fxs-part-error-summarylist{list-style-type:none;padding:0;margin:15px;display:flex;flex-flow:row wrap;align-content:flex-start}.fxs-part-error-summarylistitem{margin:0 10px 10px 0;width:calc(50% - 10px);min-width:225px}.fxs-part-error-summarylistitem-key,.fxs-part-error-summarylistitem-value{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.fxs-part-error-details{margin:15px}.fxs-tilesize-mini .fxs-part-error .fxs-part-error-icon,.fxs-tilesize-small .fxs-part-error .fxs-part-error-icon{margin-top:-15px}.fxs-tilesize-mini .fxs-part-error .fxs-part-error-detailslink,.fxs-tilesize-small .fxs-part-error .fxs-part-error-detailslink{padding:0;margin-top:-12px}.fxs-part-error-hidereason .fxs-part-error-reason{display:none}.fxs-part-error-hidecommandlist .fxs-part-error-commandlist{display:none}.fxs-part-error-hidecommandlist .fxs-part-error-detailslink{display:inline-block}.fxs-part-error-hidesummary .fxs-part-error-summary{display:none}.fxs-blade-errorcontent .fxs-part-error-icon{height:125px;width:125px}.fxs-blade-errorcontent .fxs-part-error-reason{font-size:18px}",moduleId:n.id}}));
define("MsPortalImpl/Widgets/Widgets.PartError",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Resources/ImplScriptResources","Fx/Controls/CopyableLabel","Fx/Controls/Toolbar","MsPortalImpl/Widgets/Widgets.WidgetBase","Viva.Controls/Util/Viva.Resize","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.PartError.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var w;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.ViewModel=void 0;h.injectCss(c);var a=MsPortalFx.Base,v=a.Diagnostics.Telemetry,y=window,p="fxs-errorpart",l=u.PartError,b=i("div",{"class":"fxs-part-error-content","data-bind":{css:"responsiveClasses"}},i("div",{"class":"fxs-part-error-iconcontainer"},i("div",{"data-bind":{image:"data.icon"},"class":"fxs-part-error-icon"})),i("div",{"data-bind":{untrustedContent:"data.errorOptions.message"},"class":"fxs-part-error-reason"}),i("div",{"class":"fxs-part-error-showdetailscontainer"},i("a",{href:"#",role:"button","data-bind":{click:"$data.showdetails",clickBubble:"false",text:"$data.showdetailstext"},"class":"fxs-part-error-detailslink"})),i("div",{"data-bind":{pcControl:"toolbar"},"class":"fxs-part-error-commandlist"}),i("div",{"class":"fxs-part-error-summary fxs-portal-bg-txt-br"},i("div",{"class":"fxs-part-error-summaryheadercontainer"},i("h4",{"class":"fxs-part-error-summaryheader msportalfx-font-semibold"},l.summary),i("div",{"data-bind":{pcControl:"copyBtn"},"class":"fxs-part-error-summarycopybutton"})),i("ul",{"data-bind":{foreach:"data.summaryItems"},"class":"fxs-part-error-summarylist"},i("li",{"class":"fxs-part-error-summarylistitem"},i("label",{"data-bind":{text:"label"},"class":"fxs-part-error-summarylistitem-key fxs-portal-subtext"}),i("div",{"data-bind":{text:"value"},"class":"fxs-part-error-summarylistitem-value"}))),i("div",{"data-bind":{visible:"data.errorOptions.code >= 500"},"class":"fxs-part-error-healthlinkcontainer"},i("a",{href:"#blade/Microsoft_Azure_Health/AzureHealthBrowseBlade/serviceIssues","data-bind":{text:"$data.azurehealth"}})),i(r.KoIf,{condition:"data.errorOptions.details"},i("div",{"class":"fxs-part-error-details"},i("label",{"class":"fxs-part-error-summarylistitem-key fxs-portal-subtext"},l.details),i("div",{"data-bind":{untrustedContent:"data.errorOptions.details"},"class":"fxs-part-error-summarylistitem-details"}))))),k=(function(n){function t(t,i,r){var f=n.call(this)||this,u,e,o,s;f.commands=ko.observableArray([]);r=r||{};u=MsPortalFx.extend({},t,!0);f.originalShellProps=i=i||{};u.message=u.message||l.title;e=typeof u.code=="number"?u.code:typeof i.code=="number"?i.code:Number.NaN;u.code=e;o={title:l.title};switch(e){case 404:case 410:f.icon=a.Images.Polychromatic.ContentErrorNotFound(o);break;case 401:case 403:f.icon=a.Images.Polychromatic.ContentErrorUnauthorized(o);break;default:f.icon=a.Images.Polychromatic.ContentErrorGeneric(o)}return s=[{label:l.sessionId,value:i.sessionId||l.notAvailable},{label:l.resourceId,value:i.resourceId||l.notAvailable},{label:l.extName,value:i.extName||l.notAvailable},{label:l.contentName,value:i.contentName||l.notAvailable},{label:l.errorCode,value:isNaN(e)?"--":e+""},],u.summaryItems&&(u.summaryItems=u.summaryItems.filter(MsPortalFx.notNullOrUndefined).map((function(n){return{label:n.label||"",value:n.value||""}})),s.push.apply(s,u.summaryItems)),f.summaryItems=s,f.errorOptions=u,f.showDetailsCmd=r.showDetailsCmd||!1,f}return __extends(t,n),t.prototype.cloneForDetailsPane=function(){var n,i=new t(this.errorOptions,this.originalShellProps);return(n=i.commands).push.apply(n,this.commands.peek()||[]),i},t})(o.ViewModel);t.ViewModel=k;w=(function(n){function t(t,i,r){var u=n.call(this,t,i)||this,h,c,o,w,k;return u._diContainer=r,t.html(b).addClass(p),h=ko.observable(""),s.track(u.ltm,u.element,(function(n,t){var r=[];(n<145||t<145)&&r.push("fxs-part-error-hidereason");(n<235||t<145)&&r.push("fxs-part-error-hidecommandlist");(n<255||t<235)&&r.push("fxs-part-error-hidesummary");switch(i.errorOptions.code){case 404:case 410:r.push("fxs-part-notfoundmessage","fxs-part-notfound");break;case 401:case 403:r.push("fxs-part-noaccessmessage")}h(r.join(" "))})),c=function(){return v.trace({source:"Shell",action:"ErrorInteraction",actionModifier:"DetailView",context:{content:i.originalShellProps.contentName}}),MsPortalFx.require("MsPortalImpl/UI/UI.Portal.Actions").then((function(n){n.showErrorContextPane(u._diContainer,u.ltm,i)})),!1},o=[],i.showDetailsCmd&&o.push(e.ToolbarItems.createBasicButton(u.ltm,{label:l.errordetailsbtn,icon:a.Images.Gear(),onClick:c})),i.commands().length&&(o=i.commands().map((function(n){return e.ToolbarItems.createBasicButton(u.ltm,{label:n.text,icon:n.icon,onClick:function(){n.execute(!1)}})}))),MsPortalFx.isFeatureEnabled("parterrorshowprodbutton")&&o.push(e.ToolbarItems.createBasicButton(u.ltm,{label:l.openProductionUri,icon:a.Images.Hyperlink(),onClick:function(){v.trace({source:"Shell",action:"ErrorInteraction",actionModifier:"LeavePreview",context:{content:i.originalShellProps.contentName}});var n=new a.UriBuilder(y.location.toString());n.path=n.path.replace("//rc.","//").replace("//ms.","//").replace("//preview.","//");n.query.setParameter("feature.customportal","false");y.open(n.toString())}})),i.errorOptions.code!==401&&i.errorOptions.code!==403&&(o.push(e.ToolbarItems.createBasicButton(u.ltm,{label:l.getsupportbtn,icon:a.Images.Help(),onClick:function(){v.trace({source:"Shell",action:"ErrorInteraction",actionModifier:"NewSupportRequest",context:{content:i.originalShellProps.contentName}});MsPortalFx.require("MsPortalImpl/UI/UI.Portal.Actions").then((function(n){n.openSubmitSupportCase(u._diContainer,{callerName:i.originalShellProps.extName+" + "+(i.originalShellProps.contentName||"##Content Unknown##"),assetId:i.originalShellProps.resourceId,issueType:"technical",issueContext:{shellProps:JSON.stringify(i.originalShellProps),error:JSON.stringify(i.errorOptions)}})}))}})),o.push(e.ToolbarItems.createBasicButton(u.ltm,{label:l.selfDiagnostics,icon:a.Images.Wrench(),onClick:function(){v.trace({source:"Shell",action:"ErrorInteraction",actionModifier:"SelfDiagnostics",context:{content:i.originalShellProps.contentName}});var n=fx.environment.applicationPath+"/SelfHelp";window.open(n)}}))),w=e.create(u.ltm,{items:o,showLabels:!0}),k=f.create(u.ltm,{ariaLabel:l.copySummary,hideTextbox:!0,value:JSON.stringify({shellProps:i.originalShellProps,error:i.errorOptions},null,2)}),u._bindDescendants({responsiveClasses:h,showdetails:c,showdetailstext:l.errordetailsbtn,azurehealth:l.azurehealthlink,toolbar:w,copyBtn:k}),u}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(p);n.prototype.dispose.call(this)},t})(o.Widget);t.Widget=w}));
define("_generated/Less/MsPortalImpl/CssLibrary/AzureCompatibleOfficeLayoutGrid.css",["module"],(function(n){"use strict";return{css:'.ms-Grid{box-sizing:border-box;zoom:1;padding:0 8px}.ms-Grid::before,.ms-Grid::after{display:table;content:"";line-height:0}.ms-Grid::after{clear:both}.ms-Grid-row{margin:0 -8px;box-sizing:border-box;zoom:1}.ms-Grid-row::before,.ms-Grid-row::after{display:table;content:"";line-height:0}.ms-Grid-row::after{clear:both}.ms-Grid-col{position:relative;min-height:1px;padding-left:8px;padding-right:8px;box-sizing:border-box}.ms-Grid-col{float:left}.ms-Grid-col .ms-Grid{padding:0}.fxs-blade-layout-sm:not(.fxs-blade-layout-md) .ms-hiddenSm,.fxs-blade-layout-sm:not(.fxs-blade-layout-md) .ms-hiddenMdDown,.fxs-blade-layout-sm:not(.fxs-blade-layout-md) .ms-hiddenLgDown,.fxs-blade-layout-sm:not(.fxs-blade-layout-md) .ms-hiddenXlDown,.fxs-blade-layout-sm:not(.fxs-blade-layout-md) .ms-hiddenXxlDown{display:none !important}.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenMd,.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenMdUp,.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenMdDown,.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenLgDown,.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenXlDown,.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenXxlDown{display:none !important}.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenMdUp,.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenLg,.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenLgUp,.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenLgDown,.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenXlDown,.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenXxlDown{display:none !important}.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenMdUp,.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenLgUp,.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenXl,.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenXlUp,.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenXlDown,.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenXxlDown{display:none !important}.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenMdUp,.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenLgUp,.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenXlUp,.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenXxl,.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenXxlUp,.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenXxlDown{display:none !important}.fxs-blade-layout-xxxl .ms-hiddenMdUp,.fxs-blade-layout-xxxl .ms-hiddenLgUp,.fxs-blade-layout-xxxl .ms-hiddenXlUp,.fxs-blade-layout-xxxl .ms-hiddenXxlUp,.fxs-blade-layout-xxxl .ms-hiddenXxxl{display:none !important}.ms-sm12{width:100%}.ms-sm11{width:91.66666667%}.ms-sm10{width:83.33333333%}.ms-sm9{width:75%}.ms-sm8{width:66.66666667%}.ms-sm7{width:58.33333333%}.ms-sm6{width:50%}.ms-sm5{width:41.66666667%}.ms-sm4{width:33.33333333%}.ms-sm3{width:25%}.ms-sm2{width:16.66666667%}.ms-sm1{width:8.33333333%}.fxs-blade-layout-md .ms-md12{width:100%}.fxs-blade-layout-md .ms-md11{width:91.66666667%}.fxs-blade-layout-md .ms-md10{width:83.33333333%}.fxs-blade-layout-md .ms-md9{width:75%}.fxs-blade-layout-md .ms-md8{width:66.66666667%}.fxs-blade-layout-md .ms-md7{width:58.33333333%}.fxs-blade-layout-md .ms-md6{width:50%}.fxs-blade-layout-md .ms-md5{width:41.66666667%}.fxs-blade-layout-md .ms-md4{width:33.33333333%}.fxs-blade-layout-md .ms-md3{width:25%}.fxs-blade-layout-md .ms-md2{width:16.66666667%}.fxs-blade-layout-md .ms-md1{width:8.33333333%}.fxs-blade-layout-lg .ms-lg12{width:100%}.fxs-blade-layout-lg .ms-lg11{width:91.66666667%}.fxs-blade-layout-lg .ms-lg10{width:83.33333333%}.fxs-blade-layout-lg .ms-lg9{width:75%}.fxs-blade-layout-lg .ms-lg8{width:66.66666667%}.fxs-blade-layout-lg .ms-lg7{width:58.33333333%}.fxs-blade-layout-lg .ms-lg6{width:50%}.fxs-blade-layout-lg .ms-lg5{width:41.66666667%}.fxs-blade-layout-lg .ms-lg4{width:33.33333333%}.fxs-blade-layout-lg .ms-lg3{width:25%}.fxs-blade-layout-lg .ms-lg2{width:16.66666667%}.fxs-blade-layout-lg .ms-lg1{width:8.33333333%}.fxs-blade-layout-xl .ms-xl12{width:100%}.fxs-blade-layout-xl .ms-xl11{width:91.66666667%}.fxs-blade-layout-xl .ms-xl10{width:83.33333333%}.fxs-blade-layout-xl .ms-xl9{width:75%}.fxs-blade-layout-xl .ms-xl8{width:66.66666667%}.fxs-blade-layout-xl .ms-xl7{width:58.33333333%}.fxs-blade-layout-xl .ms-xl6{width:50%}.fxs-blade-layout-xl .ms-xl5{width:41.66666667%}.fxs-blade-layout-xl .ms-xl4{width:33.33333333%}.fxs-blade-layout-xl .ms-xl3{width:25%}.fxs-blade-layout-xl .ms-xl2{width:16.66666667%}.fxs-blade-layout-xl .ms-xl1{width:8.33333333%}.fxs-blade-layout-xxl .ms-xxl12{width:100%}.fxs-blade-layout-xxl .ms-xxl11{width:91.66666667%}.fxs-blade-layout-xxl .ms-xxl10{width:83.33333333%}.fxs-blade-layout-xxl .ms-xxl9{width:75%}.fxs-blade-layout-xxl .ms-xxl8{width:66.66666667%}.fxs-blade-layout-xxl .ms-xxl7{width:58.33333333%}.fxs-blade-layout-xxl .ms-xxl6{width:50%}.fxs-blade-layout-xxl .ms-xxl5{width:41.66666667%}.fxs-blade-layout-xxl .ms-xxl4{width:33.33333333%}.fxs-blade-layout-xxl .ms-xxl3{width:25%}.fxs-blade-layout-xxl .ms-xxl2{width:16.66666667%}.fxs-blade-layout-xxl .ms-xxl1{width:8.33333333%}.fxs-blade-layout-xxxl .ms-xxxl12{width:100%}.fxs-blade-layout-xxxl .ms-xxxl11{width:91.66666667%}.fxs-blade-layout-xxxl .ms-xxxl10{width:83.33333333%}.fxs-blade-layout-xxxl .ms-xxxl9{width:75%}.fxs-blade-layout-xxxl .ms-xxxl8{width:66.66666667%}.fxs-blade-layout-xxxl .ms-xxxl7{width:58.33333333%}.fxs-blade-layout-xxxl .ms-xxxl6{width:50%}.fxs-blade-layout-xxxl .ms-xxxl5{width:41.66666667%}.fxs-blade-layout-xxxl .ms-xxxl4{width:33.33333333%}.fxs-blade-layout-xxxl .ms-xxxl3{width:25%}.fxs-blade-layout-xxxl .ms-xxxl2{width:16.66666667%}.fxs-blade-layout-xxxl .ms-xxxl1{width:8.33333333%}',moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/CssLibrary/AzureDeprecatedChartingColor.css",["module"],(function(n){"use strict";return{css:".msportalfx-bgcolor-a1{background-color:#fcd116;color:#000}.msportalfx-bgcolor-b1{background-color:#eb3c00;color:#fff}.msportalfx-bgcolor-c1{background-color:#ba141a;color:#fff}.msportalfx-bgcolor-d1{background-color:#b4009e;color:#fff}.msportalfx-bgcolor-e1{background-color:#442359;color:#fff}.msportalfx-bgcolor-f1{background-color:#002050;color:#fff}.msportalfx-bgcolor-g1{background-color:#0072c6;color:#fff}.msportalfx-bgcolor-h1{background-color:#008272;color:#fff}.msportalfx-bgcolor-i1{background-color:#007233;color:#fff}.msportalfx-bgcolor-j1{background-color:#7fba00;color:#fff}.msportalfx-bgcolor-k1{background-color:#a0a5a8;color:#fff}.msportalfx-bgcolor-a0{background-color:#fff100;color:#000}.msportalfx-bgcolor-b0{background-color:#ff8c00;color:#fff}.msportalfx-bgcolor-c0{background-color:#e81123;color:#fff}.msportalfx-bgcolor-d0{background-color:#ec008c;color:#fff}.msportalfx-bgcolor-e0{background-color:#68217a;color:#fff}.msportalfx-bgcolor-f0{background-color:#00188f;color:#fff}.msportalfx-bgcolor-g0{background-color:#00bcf2;color:#fff}.msportalfx-bgcolor-h0{background-color:#00b294;color:#fff}.msportalfx-bgcolor-i0{background-color:#009e49;color:#fff}.msportalfx-bgcolor-j0{background-color:#bad80a;color:#000}.msportalfx-bgcolor-k0{background-color:#bbc2ca;color:#000}.msportalfx-bgcolor-a2{background-color:#fffc9e;color:#000}.msportalfx-bgcolor-b2{background-color:#ffb900;color:#000}.msportalfx-bgcolor-c2{background-color:#dd5900;color:#fff}.msportalfx-bgcolor-d2{background-color:#f472d0;color:#fff}.msportalfx-bgcolor-e2{background-color:#9b4f96;color:#fff}.msportalfx-bgcolor-f2{background-color:#4668c5;color:#fff}.msportalfx-bgcolor-g2{background-color:#6dc2e9;color:#000}.msportalfx-bgcolor-h2{background-color:#00d8cc;color:#000}.msportalfx-bgcolor-i2{background-color:#55d455;color:#000}.msportalfx-bgcolor-j2{background-color:#e2e584;color:#000}.msportalfx-bgcolor-k2{background-color:#d6d7d8;color:#000}.msportalfx-bgcolor-a0s2{background-color:#807900;color:#fff}.msportalfx-bgcolor-b0s2{background-color:#804600;color:#fff}.msportalfx-bgcolor-c0s2{background-color:#740912;color:#fff}.msportalfx-bgcolor-d0s2{background-color:#760046;color:#fff}.msportalfx-bgcolor-e0s2{background-color:#34113d;color:#fff}.msportalfx-bgcolor-f0s2{background-color:#000c48;color:#fff}.msportalfx-bgcolor-g0s2{background-color:#005e79;color:#fff}.msportalfx-bgcolor-h0s2{background-color:#084c41;color:#fff}.msportalfx-bgcolor-i0s2{background-color:#063d20;color:#fff}.msportalfx-bgcolor-j0s2{background-color:#3d460a;color:#fff}.msportalfx-bgcolor-k0s2{background-color:#32383f;color:#fff}.msportalfx-bgcolor-a0s1{background-color:#bfb500;color:#000}.msportalfx-bgcolor-b0s1{background-color:#bf6900;color:#fff}.msportalfx-bgcolor-c0s1{background-color:#ae0d1a;color:#fff}.msportalfx-bgcolor-d0s1{background-color:#b10069;color:#fff}.msportalfx-bgcolor-e0s1{background-color:#4e195c;color:#fff}.msportalfx-bgcolor-f0s1{background-color:#00126b;color:#fff}.msportalfx-bgcolor-g0s1{background-color:#008db5;color:#fff}.msportalfx-bgcolor-h0s1{background-color:#00856f;color:#fff}.msportalfx-bgcolor-i0s1{background-color:#0f5b2f;color:#fff}.msportalfx-bgcolor-j0s1{background-color:#8ba208;color:#fff}.msportalfx-bgcolor-k0s1{background-color:#464f59;color:#fff}.msportalfx-bgcolor-a0t1{background-color:#fcf37e;color:#000}.msportalfx-bgcolor-b0t1{background-color:#ffba66;color:#000}.msportalfx-bgcolor-c0t1{background-color:#f1707b;color:#fff}.msportalfx-bgcolor-d0t1{background-color:#f466ba;color:#fff}.msportalfx-bgcolor-e0t1{background-color:#a47aaf;color:#fff}.msportalfx-bgcolor-f0t1{background-color:#6674bc;color:#fff}.msportalfx-bgcolor-g0t1{background-color:#66d7f7;color:#000}.msportalfx-bgcolor-h0t1{background-color:#66d1bf;color:#000}.msportalfx-bgcolor-i0t1{background-color:#66c592;color:#000}.msportalfx-bgcolor-j0t1{background-color:#d6e86c;color:#000}.msportalfx-bgcolor-k0t1{background-color:#8f9ca8;color:#fff}.msportalfx-bgcolor-a0t2{background-color:#fffccc;color:#000}.msportalfx-bgcolor-b0t2{background-color:#ffe8cc;color:#000}.msportalfx-bgcolor-c0t2{background-color:#facfd3;color:#000}.msportalfx-bgcolor-d0t2{background-color:#fbcce8;color:#000}.msportalfx-bgcolor-e0t2{background-color:#e1d3e4;color:#000}.msportalfx-bgcolor-f0t2{background-color:#ccd1e9;color:#000}.msportalfx-bgcolor-g0t2{background-color:#ccf2fc;color:#000}.msportalfx-bgcolor-h0t2{background-color:#ccf0ea;color:#000}.msportalfx-bgcolor-i0t2{background-color:#ccecdb;color:#000}.msportalfx-bgcolor-j0t2{background-color:#f0f7b2;color:#000}.msportalfx-bgcolor-k0t2{background-color:#63707e;color:#fff}",moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/CssLibrary/AzureDeprecatedSemanticText.css",["module"],(function(n){"use strict";return{css:'.msportalfx-text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-font-regular{font-family:az_ea_font,\'Segoe UI\',az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,\'Open Sans\',\'Helvetica Neue\',sans-serif;font-weight:400}.msportalfx-font-bold{font-weight:700}.msportalfx-font-semibold{font-weight:600}.msportalfx-font-light,.msportalfx-font-semilight{font-weight:200}.msportalfx-font-monospace{font-family:Consolas,"Courier New",monospace;font-size:13px;line-height:normal}.msportalfx-text-header{font-size:14px;line-height:18px}.msportalfx-text-header-small,.msportalfx-text-label{font-size:13px;line-height:normal;text-transform:uppercase}.msportalfx-text-small{font-size:13px;line-height:normal}.msportalfx-text-subheader{font-size:10px;line-height:10px;padding-bottom:1px}html[lang^="ja"] .msportalfx-text-subheader,html[lang^="ko"] .msportalfx-text-subheader,html[lang^="zh"] .msportalfx-text-subheader{font-size:11px;line-height:11px}.msportalfx-text-header-regular{font-size:14px;line-height:18px}.msportalfx-text-regular{font-size:13px;line-height:normal}.msportalfx-text-preview{font-weight:600;font-size:11px;line-height:11px;text-transform:uppercase;color:#fff}.msportalfx-text-createsectionheader{font-weight:200;font-size:20px;line-height:normal}.msportalfx-number-jumbo{font-weight:600;font-size:60px;line-height:60px;letter-spacing:-.02em}.msportalfx-number-large{font-weight:600;font-size:43px;line-height:43px;letter-spacing:-.02em}.msportalfx-number-medium{font-weight:600;font-size:30px;line-height:30px;letter-spacing:-.025em}.msportalfx-number-small{font-weight:600;font-size:17px;line-height:17px;letter-spacing:-.02em}.msportalfx-number-jumbo-adorn{font-weight:700;font-size:20px;line-height:20px;letter-spacing:-.02em}.msportalfx-number-large-adorn{font-weight:700;font-size:15px;line-height:15px;letter-spacing:-.02em}.msportalfx-number-medium-adorn{font-weight:700;font-size:15px;line-height:15px;letter-spacing:-.02em}.msportalfx-number-small-adorn{font-weight:700;font-size:10px;line-height:10px;letter-spacing:-.05em}.msportalfx-lineheight-reset{line-height:normal}',moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/CssLibrary/AzureSemanticText.css",["module"],(function(n){"use strict";return{css:".az-text-small{font-family:az_ea_font,'Segoe UI',az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif;font-weight:400;font-size:10px;line-height:1.4}.az-text-note{font-family:az_ea_font,'Segoe UI',az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif;font-weight:400;font-size:12px;line-height:1.33333}.az-text-body{font-family:az_ea_font,'Segoe UI',az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif;font-weight:400;font-size:13px;line-height:1.38462}.az-text-label{font-weight:600;font-size:13px;line-height:1.38462}.az-text-header2{font-weight:600;font-size:16px;line-height:1.375}.az-text-header1{font-weight:600;font-size:18px;line-height:1.33333}.az-text-greeting{font-weight:600;font-size:20px;line-height:1.4}@media print{.az-text-header1,.az-text-header2,.az-text-label{break-after:avoid}}",moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/CssLibrary/AzureUtil.css",["module"],(function(n){"use strict";return{css:".az-display-none{display:none !important}@media print{.az-noprint{display:none !important}}",moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/CssLibrary/CustomForm.css",["module"],(function(n){"use strict";return{css:'.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-formElementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-formElementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-formElementSubLabelContainer{display:inline-block;vertical-align:middle;width:68%}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement.msportalfx-form-fileUploadField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement.msportalfx-form-fileUploadField{height:80px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-form-labelcontainer{width:32%;display:inline-block}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular .msportalfx-form-extralabel{display:block;width:68%;margin-left:33%;margin-right:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:nth-child(odd),.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:nth-child(odd){margin-right:1%}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement{min-height:43px;width:48.75% !important;display:inline-block;vertical-align:top;margin-top:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:first-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:first-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:last-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:last-child{margin-top:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.azc-optionsGroupField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.azc-optionsGroupField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.azc-multiLineTextField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.azc-multiLineTextField{height:auto;margin-right:1px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.msportalfx-form-fileUploadField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.msportalfx-form-fileUploadField{height:100px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .azc-form-labelcontainer{display:block;margin-bottom:0;width:auto;min-height:20px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .azc-formElementSubLabelContainer{display:block;width:100%;margin-left:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-extralabel>.msportalfx-form-extralabel{display:inline-block;width:47.75%;margin:43px 1% 0 -49.75% !important}.msportalfx-form.msportalfx-form-custom .msportalfx-form-extralabel{margin-top:0}.fxs-bladestyle-create .msportalfx-form{margin-top:14px}.fxs-bladestyle-create .msportalfx-form .msportalfx-form{margin-top:0}.msportalfx-form:not(.msportalfx-form-custom)>div>.msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom) .fxc-section>.msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>.msportalfx-form-formelement{padding-bottom:15px;width:100%;min-height:23px}.msportalfx-form:not(.msportalfx-form-custom)>div>.msportalfx-form-formelement .msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom) .fxc-section>.msportalfx-form-formelement .msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>.msportalfx-form-formelement .msportalfx-form-formelement{padding-bottom:0}.msportalfx-form.msportalfx-vertical-compact>div>.msportalfx-form-formelement,.msportalfx-form.msportalfx-vertical-compact .fxc-section>.msportalfx-form-formelement,.msportalfx-form.msportalfx-vertical-compact>.msportalfx-form-formelement{padding-bottom:7px}.msportalfx-form .msportalfx-form-labelcontainer,.msportalfx-form .azc-form-labelcontainer,.msportalfx-form .azc-checkBoxField-inlineLabelContainer{box-sizing:border-box;min-height:17px}.msportalfx-form .msportalfx-form-labelcontainer label,.msportalfx-form .azc-form-labelcontainer label,.msportalfx-form .azc-checkBoxField-inlineLabelContainer label{max-width:calc(100% - 25px)}.msportalfx-form .azc-checkBoxField-inlineLabelContainer{width:calc(100% - 25px + 2px)}.msportalfx-form .azc-checkBoxField-inlineLabelContainer label{font-size:13px;line-height:normal}.msportalfx-form .azc-validatableControl-invalid+.azc-checkBoxField-inlineLabelContainer{width:calc(100% - 25px + 2px - 6px)}.msportalfx-form .msportalfx-form-labelcontainer label,.msportalfx-form .azc-form-labelcontainer label{font-size:13px;line-height:normal}.msportalfx-form.msportalfx-form-row{padding:0 20px;width:calc(100% - 40px)}.msportalfx-form .azc-multiLineTextField .azc-multiLineTextBox{height:100%}.azc-text-sublabel{float:right;margin-bottom:-1px}.fxc-has-sublabel-html>.azc-formElementSubLabelContainer>.azc-text-sublabel{float:none}.azc-formElementSubLabelContainer::after{content:"";display:table;clear:both}.msportalfx-form:not(.fxc-left-label-fixed) .fxc-left-label .azc-text-sublabel-neighbor{padding-bottom:16px}.msportalfx-form:not(.fxc-left-label-fixed) .fxc-left-label .azc-text-sublabel-neighbor.azc-form-labelcontainer{padding-bottom:calc(16px + 3px)}.msportalfx-form:not(.fxc-left-label-fixed) .fxc-left-label .azc-text-sublabel-neighbor.azc-checkBoxField-inlineLabelContainer{padding-bottom:0}.azc-required-balloon{display:inline-block}.msportalfx-form-extralabel{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:right;margin-top:-15px;padding-bottom:3px}.msportalfx-customHtml .msportalfx-form-extralabel{margin-top:0}.msportalfx-customHtml>.azc-formElementSubLabelContainer{height:100%}.msportalfx-customHtml>.azc-formElementSubLabelContainer>.azc-formElementContainer{height:100%}.msportalfx-form-formelement .azc-dockedballoon.azc-dockedballoon-info{height:15px;width:15px}.msportalfx-nested-control:not(.fxc-left-label){padding-left:45px;position:relative;box-sizing:border-box}.msportalfx-nested-control:not(.fxc-left-label)::before{display:block;content:"";border-left:1px solid #a9a9a9;border-bottom:1px solid #a9a9a9;position:absolute;top:-9px;left:3px;height:calc(50% + 7px);width:32px}.msportalfx-nested-control.fxc-left-label>.azc-form-labelcontainer{padding-left:45px;position:relative;box-sizing:border-box}.msportalfx-nested-control.fxc-left-label>.azc-form-labelcontainer::before{display:block;content:"";border-left:1px solid #a9a9a9;border-bottom:1px solid #a9a9a9;position:absolute;top:-13px;left:3px;height:22px;width:32px}.msportalfx-form-regular div.msportalfx-nested-control::before,.msportalfx-form-regular .msportalfx-nested-control::before{display:block;content:"";border-left:1px solid #a9a9a9;border-bottom:1px solid #a9a9a9;position:absolute;top:-13px;left:3px;height:22px;width:32px}.msportalfx-nested-control:not(.fxc-left-label)::before{display:block;content:"";border-left:1px solid #a9a9a9;border-bottom:1px solid #a9a9a9;position:absolute;top:-9px;left:3px;height:40px;width:32px}.fxc-left-label-fixed.fxc-smart-labels .msportalfx-nested-control .azc-form-labelcontainer{max-width:205px !important}',moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/CssLibrary/CustomPart.css",["module"],(function(n){"use strict";return{css:'.msportalfx-layoutChildren-horizontal-inlineblock{white-space:nowrap;line-height:0;font-size:0}.msportalfx-layoutChildren-horizontal-inlineblock>.msportalfx-layoutChildren-child{display:inline-block;box-sizing:border-box;white-space:normal;font-size:13px;line-height:normal}.msportalfx-layoutChildren-horizontal-float>.msportalfx-layoutChildren-child{float:left;box-sizing:border-box}.msportalfx-layoutChildren-horizontal-float::after{content:"";clear:both;display:block;visibility:hidden;height:0;font-size:0;line-height:0}.msportalfx-bgcolor-themeMain{background-color:#00bcf2}.msportalfx-bgcolor-themeWarning{background-color:#db7500}.msportalfx-bgcolor-themeError{background-color:#e81123}.msportalfx-bgcolor-themeSuccess{background-color:#7fba00}.msportalfx-bgcolor-paletteDiffAdd{background-color:#c7f1c7}.msportalfx-bgcolor-paletteDiffDel{background-color:#fcd6f1}.msportalfx-bgcolor-white{background-color:#fff}.msportalfx-padding{padding:20px;box-sizing:border-box}.msportalfx-docking{display:flex;flex-direction:column;width:100%;height:100%}.msportalfx-docking-header{flex:0 0 auto}.msportalfx-docking-body{flex:1 1 auto;height:100%;min-height:0;overflow-x:hidden;overflow-y:auto}.msportalfx-docking-footer{flex:0 0 auto;border-top:1px solid}.msportalfx-vertical-center{display:flex;flex-flow:row nowrap;align-items:center}.msportalfx-removeTableBorders{border-spacing:0;border-collapse:collapse}.msportalfx-boxsizing-borderbox{box-sizing:border-box}.msportalfx-removeDefaultListStyle{list-style-type:none;padding:0;margin:0}.msportalfx-removeDefaultListStyle>li{margin:0;padding:0}.msportalfx-fill{height:100%;width:100%}.msportalfx-clearfix::after{content:"";clear:both;display:block;visibility:hidden;height:0;font-size:0;line-height:0}.fxs-tilesize-fittocontainer .msportalfx-overflowY,.azc-graph-node-container .msportalfx-overflowY{overflow-x:hidden;overflow-y:auto}.msportalfx-unselectable{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.msportalfx-removepartpadding{height:calc(100% + 15px + 15px);width:calc(100% + 15px + 15px);margin:-15px -15px -15px -15px}.msportalfx-removepartpaddingside{width:calc(100% + 15px + 15px);margin:0 -15px 0 -15px}.fxs-blade-locked .msportalfx-removepartpadding{height:calc(100% + 15px);width:100%;margin:0 0 15px 0}.fxs-blade-locked .msportalfx-removepartpaddingside{width:100%;margin:0}.fxs-blade-locked .fxs-tilesize-fittocontainer .msportalfx-removepartpadding{height:100%;width:100%;margin:0}.msportalfx-partdivider::after{content:"";display:block;width:calc(100% + 15px + 15px);margin:0 -15px 0 -15px;border-bottom-width:1px;border-bottom-style:solid}.msportalfx-code{font-family:Consolas,"Courier New",monospace;font-size:13px;line-height:normal;background-color:#f1f1f8;color:#32383f;border:1px solid #dcdfe2;border-left:5px solid #dcdfe2;padding:10px 10px 10px 15px;margin:5px 0;overflow-x:auto}.msportalfx-gettingstarted-part{color:#fff}.msportalfx-refresh-icon img,.msportalfx-refresh-icon svg{height:12px;width:12px;vertical-align:baseline}.msportalfx-tile-status-icon img,.msportalfx-tile-status-icon svg{height:16px;width:16px;vertical-align:middle}.msportalfx-gridcolumn-asseticon img,.msportalfx-gridcolumn-asseticon svg{margin-top:4px;height:21px;width:21px}.msportalfx-gridcolumn-assetsvg-icon .fx-grid-formatters-svgicon{width:21px !important;height:21px !important}.msportalfx-gridcolumn-assetsvg-icon img,.msportalfx-gridcolumn-assetsvg-icon svg{height:21px;width:21px;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-badge{margin-left:-21px;height:21px;width:21px;vertical-align:middle;display:inline-block}.msportalfx-gridcolumn-assetsvg-badge img,.msportalfx-gridcolumn-assetsvg-badge svg{height:10px;width:10px;margin-top:11px}.msportalfx-gridcolumn-assetsvg-text{margin-left:10px;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-textbox{vertical-align:middle;display:inline-block;margin-left:20px}.msportalfx-gridcolumn-assetsvg-strongtext{vertical-align:middle;margin-left:0}.msportalfx-gridcolumn-assetsvg-linkicon{margin-left:10px;display:inline-block;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon{display:inline-block}.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon img,.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon svg{opacity:.4;height:10px;width:10px;vertical-align:middle}.msportalfx-iconcontainer{flex:0 0 auto;box-sizing:border-box}.msportalfx-iconcontainer>img,.msportalfx-iconcontainer>svg{height:50px;width:50px}.fxs-tilesize-mini .msportalfx-iconcontainer>img,.fxs-tilesize-small .msportalfx-iconcontainer>img,.fxs-tilesize-mini .msportalfx-iconcontainer>svg,.fxs-tilesize-small .msportalfx-iconcontainer>svg{height:30px;width:30px}.msportalfx-gridcolumn-statusicon{text-align:center}.msportalfx-gridcolumn-statusicon img,.msportalfx-gridcolumn-statusicon svg{text-align:center;height:15px;width:15px}.msportalfx-gridcolumn-statusicon svg{margin-top:4px}.msportalfx-grid-borderless .azc-grid table tbody tr td{border-top-width:0;border-bottom-width:0;border-color:transparent}.msportalfx-grid-borderless .azc-grid table tbody tr.azc-grid-row:first-of-type td{border-top-width:0;border-bottom-width:0;border-color:transparent}.msportalfx-grid-borderless .azc-grid table tbody:last-child tr:last-child td{border-top-width:0;border-bottom-width:0;border-color:transparent}.msportalfx-grid-borderless .azc-br-muted{border-top-width:0;border-bottom-width:0;border-color:transparent !important}.msportalfx-create-tab{max-width:700px}.msportalfx-create-tab .msportalfx-create-description{font-size:13px;line-height:normal}.msportalfx-create-tab .fxc-section{margin-bottom:15px}.msportalfx-create-section-label{font-weight:600;font-size:14px;line-height:normal}.msportalfx-create-footer .fxc-simplebutton{margin-right:12px}.msportalfx-create-footer a{margin-left:12px}.msportalfx-ext-link{padding-right:15px}.msportalfx-ext-link::after{content:" ";background-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%2016%2015%22%3E%3Cpath%20d=%22M14.3%201H10V0h6v6h-1V1.7l-8%208-.7-.7z%22/%3E%3Cpath%20d=%22M11%208v5a.9.9%200%2001-1%201H2a.9.9%200%2001-1-1V6a.9.9%200%20011-1h6l1-1H2a2%202%200%2000-2%202v7a2%202%200%20002%202h8a2%202%200%20002-2V7z%22/%3E%3C/svg%3E");width:11px;height:11px;display:inline-block;margin-left:4px;margin-right:-15px;background-size:11px 11px}.fxs-mode-dark .msportalfx-ext-link::after{background-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%2016%2015%22%3E%3Cpath%20fill=%22%23ffffff%22%20d=%22M14.3%201H10V0h6v6h-1V1.7l-8%208-.7-.7z%22/%3E%3Cpath%20fill=%22%23ffffff%22%20d=%22M11%208v5a.9.9%200%2001-1%201H2a.9.9%200%2001-1-1V6a.9.9%200%20011-1h6l1-1H2a2%202%200%2000-2%202v7a2%202%200%20002%202h8a2%202%200%20002-2V7z%22/%3E%3C/svg%3E")}.msportalfx-inherit-color{color:inherit !important}.msportalfx-statuspart{position:relative;height:100%;width:100%}.msportalfx-statuspart>*{box-sizing:border-box}.msportalfx-statuspart .msportalfx-statuspart-statussection{height:calc(100% - 55px);padding-top:10px}.msportalfx-statuspart .msportalfx-statuspart-statussection>*{vertical-align:middle}.msportalfx-statuspart .msportalfx-statuspart-statussection>img{height:30px;width:30px}.msportalfx-statuspart .msportalfx-statuspart-statussection>span{font-weight:700;font-size:11px;text-transform:uppercase;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-statuspart .msportalfx-statuspart-messagesection{position:absolute;bottom:55px;margin-bottom:25px;height:40px;line-height:0;white-space:normal}.msportalfx-statuspart .msportalfx-statuspart-messagesection>span{font-size:13px;line-height:normal}.msportalfx-statuspart .msportalfx-statuspart-propertysection,.msportalfx-statuspart .msportalfx-statuspart-metricsection{position:absolute;bottom:0;width:100%;height:55px}.msportalfx-statuspart .msportalfx-statuspart-propertysection{padding-top:5px;font-size:13px;line-height:normal}.msportalfx-statuspart .msportalfx-statuspart-propertysection>span,.msportalfx-statuspart .msportalfx-statuspart-propertysection>div{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div{float:left;width:calc(100%/3 - 3px);box-sizing:border-box;border-right:1px solid #8f9ca8;padding-left:7px}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div:first-child{padding-left:0}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div:last-child{border-right:none}.msportalfx-statuspart .msportalfx-statuspart-metricsection .msportalfx-statuspart-metrictitle{white-space:normal;height:30px;font-size:13px;line-height:normal;text-transform:uppercase}.msportalfx-property-text-icon,.msportalfx-property-callback-icon{width:27px}.msportalfx-property-text-icon svg,.msportalfx-property-callback-icon svg{height:25px;width:25px}.msportalfx-property{padding:5px 0;white-space:nowrap;line-height:0;font-size:0}.msportalfx-property>*{display:inline-block;vertical-align:middle;box-sizing:border-box;white-space:normal;font-size:medium;line-height:normal}.msportalfx-property .msportalfx-property-name{font-size:13px;line-height:normal;width:32%;white-space:normal;overflow:hidden;text-overflow:ellipsis}.msportalfx-property .msportalfx-property-label-wrapper{font-size:13px;line-height:normal;width:32%;margin-top:5px}.msportalfx-property .msportalfx-property-label-wrapper .msportalfx-property-name{max-width:100%;width:auto;white-space:normal;overflow:hidden;text-overflow:ellipsis;display:inline-block}.msportalfx-property .msportalfx-property-value{font-size:14px;line-height:normal;width:64%;margin-left:3%;margin-top:4px}.msportalfx-property .msportalfx-property-value.fxs-part-properties-text .msportalfx-tooltip-overflow,.msportalfx-property .msportalfx-property-value.fxs-part-properties-text .msportalfx-property-text-icon{display:inline-block;vertical-align:middle}.msportalfx-property .msportalfx-property-value.fxs-part-properties-text .msportalfx-property-text-icon+.msportalfx-tooltip-overflow{max-width:calc(100% - 27px)}.msportalfx-property .msportalfx-property-value.fxs-part-properties-copyfield{margin-top:4px}.msportalfx-property .msportalfx-property-value.fxs-part-properties-copyfield input{padding-left:9px}.msportalfx-property.msportalfx-property-compact>*{vertical-align:top}.msportalfx-property.msportalfx-property-compact .msportalfx-property-name{margin-top:4px;width:95px}.msportalfx-property.msportalfx-property-compact .msportalfx-property-value{font-size:13px;line-height:normal;max-width:calc(100% - 3% - 95px)}.msportalfx-property-callback-icon{float:left}.msportalfx-preview-text{font-weight:600;font-size:10px;line-height:normal;text-transform:uppercase;margin-top:3px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}',moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/Parts/Parts.Part.css",["module"],(function(n){"use strict";return{css:'.fxs-part{width:100%;height:100%;position:relative;box-sizing:border-box;overflow:hidden;background-color:inherit;padding:15px 15px 15px 15px}.fxs-part-blockui-shield{position:absolute;top:0;left:0;bottom:0;right:0}.fxs-part-title{height:49px;position:relative;top:-4px;box-sizing:border-box}.fxs-part-titleText,.fxs-part-assetname{margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-part-titleText{font-weight:600;font-size:14px;line-height:17px;padding-bottom:1px}.fxs-part-assetname{font-size:10px;line-height:10px;padding-bottom:1px;margin-top:3px}.fxs-part-content{font-size:13px;line-height:normal;position:relative;width:100%;height:100%;box-sizing:border-box}.fxs-part-part-title-visible .fxs-part-content{height:calc(100% - 45px);top:-4px}.fxs-part[tabindex="0"]:focus,.fxs-part-clickable:focus{outline-offset:2px;outline-width:1px;outline-style:solid}.fxs-part[tabindex="0"]:hover,.fxs-part-clickable:hover{cursor:pointer}.fxs-part-unbound{z-index:1}.fxs-part{padding:15px 15px 15px 15px}.fxs-part.fxs-part-no-fx-content-padding{padding:0}.fxs-part.fxs-part-no-fx-content-padding.fxs-part-part-title-visible .fxs-part-title{padding:15px 15px 0 15px}.fxs-part.fxs-part-no-fx-content-padding.fxs-part-part-title-visible .fxs-part-content>.msportalfx-padding:first-child{padding:0 15px 15px 15px}.fxs-part.fxs-part-no-fx-content-padding .fxs-part-content>.msportalfx-padding{padding:15px 15px 15px 15px}.fxs-part.fxs-part-no-fx-content-padding.fxs-part-for-template-blade .fxs-part-content>.msportalfx-padding{padding:10px 20px 20px 20px}.fxs-part-nodata{-webkit-filter:grayscale(100%);filter:grayscale(100%);min-height:85px}.fxs-part-nodatamessage{position:absolute;left:0;top:0;height:100% !important;width:100%;text-align:left;padding:15px;box-sizing:border-box;z-index:1}.fxs-part-nodatamessage-text{position:absolute;top:50%;transform:translateY(-50%);margin-top:20px;padding:15px 10px;width:calc(100% - 30px);box-sizing:border-box;font-size:13px;line-height:normal;text-align:center;border-width:1px;border-style:solid}.fxs-tile.fxs-tilesize-mini .fxs-part{padding-left:3px;padding-right:3px}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-title{display:none !important}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-content{height:100% !important;top:0 !important}.fxs-blade .fxs-blade-locked .fxs-part{padding:0 0 15px 0}.fxs-blade .fxs-blade-locked .fxs-part .fxs-part-title{height:29px;top:0}.fxs-blade .fxs-blade-locked .fxs-tilesize-fittocontainer .fxs-part{padding:0}.fxs-part-filter-button{border:0;padding:0;width:26px;height:26px;cursor:pointer;z-index:2}.fxs-part-filter-button,.fxs-part-filter-button>svg{position:absolute;top:0;left:0}',moduleId:n.id}}));
define("_generated/MsPortalImpl/Svg/Startup/DashboardPartFilter.svg",["require","exports"],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 26 26' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path fill='#8a8886' d='M26 0H0v26L26 0z'/><path d='M2 2v1.547l4 3.787V12h3V7.334l4-3.787V2zm1 1.253V3h9v.253L8 7v4H7V7z' class='msportalfx-svg-c01'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Startup/DashboardPartFilterConflict.svg",["require","exports"],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 26 26' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path fill='#8a8886' d='M26 0H0v26L26 0z'/><path d='M4 2v1.547l4 3.786V12h3V7.333l4-3.787V2z' class='msportalfx-svg-c33'/><path d='M7 8L3 4.035V2H2v2.421l4 3.965V12h1V8z' class='msportalfx-svg-c01'/><path d='M4 2v1.547l4 3.786V12h3V7.333l4-3.787V2zm1 1.253V3h9v.253L10 7v4H9V7z' class='msportalfx-svg-c01'/><\/g><\/svg>"}}));
define("MsPortalImpl/Parts/Parts",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Base/Base.CssSanitizer","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.PartError","MsPortalImpl/Base/Base.Selectable2.ClickContext","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/Commands/UI.ExtensionCommands","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/Base/Base.KeyboardHelper","FxInternal/Composition/ViewModel","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Weave/SandboxRender","FxInternal/Composition/Part","Fx/Composition","_generated/MsPortalImpl/Svg/Startup/DashboardPartFilter.svg","_generated/MsPortalImpl/Svg/Startup/DashboardPartFilterConflict.svg","MsPortalImpl/UI/Commands/Base.PortalFunctions","FxInternal/Css","_generated/Less/MsPortalImpl/Parts/Parts.Part.css","_generated/Less/MsPortalImpl/CssLibrary/AzureCompatibleOfficeLayoutGrid.css","_generated/Less/MsPortalImpl/CssLibrary/AzureSemanticText.css","_generated/Less/MsPortalImpl/CssLibrary/AzureUtil.css","_generated/Less/MsPortalImpl/CssLibrary/AzureDeprecatedSemanticText.css","_generated/Less/MsPortalImpl/CssLibrary/AzureDeprecatedChartingColor.css","_generated/Less/MsPortalImpl/CssLibrary/CustomPart.css","_generated/Less/MsPortalImpl/CssLibrary/CustomForm.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt){"use strict";function ur(n,t){if(ii[n])throw new Error("The part kind '"+n+"' has already been registered and cannot be registered again.");ii[n]=t}function ci(n){return ii[n]}function li(n){var t=n&&n.initialSize;return ti.InternalPartSize[t]!==undefined?t:2}function or(n,t,i,r,u){return new n.Part(t,i,r,u)}function sr(n,t,i){var r=i.partKind,u,f;if(r===pt.Custom||r===pt._Internal_App){var s=i.htmlTemplateInline,e=i.htmlTemplate&&t.getExtensionLocator().withHtmlTemplate(i.htmlTemplate),o=s||e&&n.locate(e);u=vi(o&&o.content,{supportedSizes:i.supportedSizes,partClass:r===pt._Internal_App?yi:null})}else u=r===pt.Frame?ni("MsPortalImpl/Parts/Parts.Frame",or,{supportedSizes:i.supportedSizes}):r===pt._Internal_Az?ni("MsPortalImpl/AzFramework/Parts.Az",(function(n,t,r,u,f){var e=i,o=e.isBlade,s=e.bladeOrPartName;return new n.Part(t,r,u,f,o,s)}),{supportedSizes:i.supportedSizes}):r===pt._Internal_React?ni("MsPortalImpl/Parts/Parts.ReactFrame",(function(n,t,r,u,f){var e=i,o=e.bladeOrPartName,s=e.extensionName;return new n.Part(t,r,u,f,{name:o,extensionName:s})}),{supportedSizes:i.supportedSizes}):ci(pt[r]);return f=u.supportedSizes,f&&f.length||(u.supportedSizes=[li(i)]),u}function ni(n,t,i){return{createPart:function(i,r,u,f,e){return MsPortalFx.tryImmediateResolve(MsPortalFx.require(n),(function(n){var o=t(n,i,r,u,f);return o.partComposition=e,o}))},defaultSize:i.defaultSize,supportedSizes:i.supportedSizes,viewStateProperties:i.viewStateProperties,moduleId:n}}function vi(n,t){return t===void 0&&(t={}),{createPart:function(i,r,u,f,e){var s=t.partClass||gt,o=new s(i,r,u,f);return o.template=n,o.partComposition=e,Q(o)},defaultSize:t.defaultSize,supportedSizes:t.supportedSizes,viewStateProperties:t.viewStateProperties}}var yt,ri,ui,fi,hi,gt,yi;Object.defineProperty(t,"__esModule",{value:!0});t.createPartFactory=t.createAmdPartFactory=t.getPartFactory=t.getPartSizeOrDefault=t.getFactory=t.registerFactory=t.PartImpl=t.PartBase=t.InternalClickableLink=void 0;ft.injectCss(et,ot,st,ht,ct,lt,at,vt);var pi=FxImpl.TriggerableLifetimeManager,ei=MsPortalFx.Base,oi=ei.Diagnostics,wi=ei.Images,bi=oi.Telemetry,ti=MsPortalFx.Parts,pt=ti.PartKind,wt=ti.PartState,bt=window,kt=o.Dashboard.PartFilters,si=FxImpl.features.isNativePerf,ki=0,di=oi.createLog(n),gi=o.Parts.partSettingNotReceivedErrorDescription,ii={},nr="attr: { 'role': context._computedRole, 'data-assetname': container.assetName },css: context._computedClasses,click: function (data, evt) { return context._onClick(data, evt); },event: {'keydown': function (data, evt) { return context._onKeyDown(data, evt); } }",tr="fxs-part-no-fx-content-padding",ir="fxs-part-for-template-blade",rr=i(r.Root,null,i(r.KoIf,{condition:"context.isFilterApplied"},i("div",{role:"button","class":"fxs-part-filter-button",tabindex:"0","data-bind":{image:"context.filterIcon",click:"context.openPartSettingsBlade"}})),i("div",{"class":"fxs-part-title"},i("h3",{"class":"fxs-part-titleText msportalfx-tooltip-overflow","data-bind":{text:"container.partTitle"}}),i("div",{"class":"fxs-part-assetname fxs-portal-subtext msportalfx-tooltip-overflow","data-bind":{visible:"container.assetName() && !context.inContainerOfSameAsset()",text:"container.assetName"}})),i("div",{"class":"fxs-part-content fxs-validationContainer"}),i(r.KoIf,{condition:"context.isUiBlocked"},i("div",{"class":"fxs-part-blockui-shield"}),i(r.KoTemplate,{options:"{ name: context.uiBlockedTemplate }"}))),dt="emptyTemplate";c.registerKoTemplate(dt," ");ri="contentHasNoDataTemplate";c.registerKoTemplate(ri,i("div",{"class":"fxs-part-nodatamessage"},i("div",{"class":"fxs-part-nodatamessage-text msportalfx-tooltip-overflow fxs-bg-overlay-dark fxs-text-white","data-bind":{text:"container.noDataMessage"}})));ui=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(tt.ClickableLink);t.InternalClickableLink=ui;fi=(function(){function n(){this.inContainerOfSameAsset=ko.observable(!0);this.partSettingFailed=ko.observable(!1);this.notFoundMessage=ko.observable();this.handledErrorMessage=ko.observable();this.lockedUiContext=ko.observable(!0)}return n})();t.PartBase=fi;hi=(yt={},yt[1]="fxs-part-success",yt[2]="fxs-part-warning",yt[3]="fxs-part-error",yt[4]="fxs-part-dirty",yt[5]="fxs-part-info",yt);gt=(function(t){function i(n,i,r,u){var f=t.call(this)||this,y,c,g,b,v,p,l,et,d,k,ot,w,st;if(f._diContainer=u,f.isFilterApplied=ko.observable(!1),f.filterIcon=ko.observable(),f.partFilterState=ko.observable(0),f.openPartSettingsBlade=function(){return $.noop},f.assetId=ko.observable(),f.ariaLabel=ko.observable(),f.onSizeChange=function(){},y=f._lifetime=new pi,c=i.container,f._onDashboard=r.partLocation===1,g=MsPortalFx.isFeatureEnabled(nt.partHeaderEnabledFeatureName),g&&f._onDashboard&&c.updatableHeader){c={};MsPortalFx.shallowCopyFromObject(c,i.container);var tt=c.updatableHeader.updatedHeader,ft=c.partTitle,ht=c.assetName;c.partTitle=ko.computed(y,(function(){var t=ft(),n=tt(),i=n===null||n===void 0?void 0:n.title;return t&&i?i:t}));c.assetName=ko.computed(y,(function(){var n=tt(),t=n===null||n===void 0?void 0:n.subtitle;return ft()&&t?t:ht()}))}if(b=FxImpl.tryGetSelectableViewModelContract(c),!c)throw new Error("Cannot create a part without a container viewmodel.");return v=b&&b._msPortalFxSelectable2?h.getOrCreate(f._diContainer,b._msPortalFxSelectable2):undefined,v=v||c.selectable,v||(p=i.content,p&&typeof p().onClick=="function"&&(v=a.getSelectableWithClickHandler(f._diContainer,p,$(n),p().onClick))),r.pinnedBladeDeeplink&&(v=v||{isClickable:function(){return!0},isSelected:ko.observable(!1),value:ko.observable({}),onClick:MsPortalFx.noop},v.onClick=function(){u.get(ut.RoutePortalFunc).invoke(r.pinnedBladeDeeplink,f._onDashboard?"StartBoardPart":"Blade")}),f._selectable=v,f._viewModel=i,ko.cleanNode(n),l=f._partContainer=$(n).attr("data-bind",nr).html(rr),f._accessibility(),r.noFxContentPadding&&l.addClass(tr),r.isVirtualPartForTemplateBlade&&l.addClass(ir),f._partContent=l.findByClassName("fxs-part-content")[0],et=l.findByClassName("fxs-part-title"),f.validateElements=ko.observableArray([]),f._options=r,d=function(n){return!!n.noDataMessage()},f.isUiBlocked=ko.pureComputed((function(){return f._viewModel.internal.allowUiBlocking()&&(c.operations.blockingUi()||d(c))})),f.uiBlockedTemplate=ko.pureComputed((function(){var n=f._viewModel.container,t=!!f.notFoundMessage(),i=!!n.noDataMessage(),r=!!n.unauthorizedMessage();return t?dt:r?dt:i?ri:dt})),k=ko.pureComputed((function(){return f._viewModel.internal.allowUiBlocking()&&d(c)})),f._isPartClickable=ko.computed(y,(function(){return c.operations.blockingUi()||c.partState&&c.partState()===wt.Failed||f.notFoundMessage()||!MsPortalFx.isNullOrUndefined(c.unauthorizedMessage())?!1:!!c.clickableLink||c.isSelectable()&&!!v})),c.partTitle.subscribe(y,(function(){setTimeout((function(){l.trigger("fxsizechanged")}),50)})),ko.computed(y,(function(){f.lockedUiContext()?l.removeAttr("aria-label"):l.attr("aria-label",c.ariaLabel()||f.ariaLabel()||c.partTitle())})),ot=ko.computed(y,(function(){var n=c.partTitle()&&c.partState()!==wt.Failed;return s.toggle(et,n),n})),f._computedClasses=ko.computed(y,(function(){var n=[],t;return ot()&&n.push("fxs-part-part-title-visible"),f._isPartClickable()&&n.push("fxs-part-clickable"),c.noDataMessage()&&n.push("fxs-part-nodata"),v&&c.isSelectable()&&(v.isSelected()&&n.push("fxs-part-selected"),v.isCommandSelected&&v.isCommandSelected()&&n.push("fxs-part-selected-command")),f._viewModel.content()._msPortalFxUnboundPart&&n.push("fxs-part-unbound"),t=hi[c.contentState()],t&&n.push(t),n.join(" ")})),f._computedRole=ko.computed(y,(function(){var n=[],t,i;return(l.find(".fxs-part-clickdesc, .fxs-part-tabback").remove(),f.lockedUiContext())?(l.removeAttr("aria-describedby"),null):(t=MsPortalFx.getUniqueId(),l.append(FxImpl.createElement("div",{"class":"fxs-part-tabback",id:t,style:"display:none;"},MsPortalFx.encodeHtml(o.Parts.tabbackcmds))),n.push(t),f._isPartClickable()&&(i=MsPortalFx.getUniqueId(),l.append(FxImpl.createElement("div",{"class":"fxs-part-clickdesc",id:i,style:"display:none;"},MsPortalFx.encodeHtml(o.Parts.clickableAriaDesc))),n.push(i)),l.attr("aria-describedby",n.join(" ")),"group")})),ko.applyBindings({container:c,context:f},l[0]),k.subscribeAndRun(y,(function(n){if(n){if(!w){w=y.createChildLifetime();var t=f._partContainer;w.registerForDispose([t.setEvents(["focus",f._onFocus=function(){f._toggleDisableTabbableElements(k())}],["focusin",f._onFocusIn=function(){k()&&t[0].focus()}]),function(){f._onFocus=f._onFocusIn=null},])}l.find(document.activeElement).length>0&&l[0].focus()}else w&&w.dispose(),f._toggleDisableTabbableElements(n)})),ko.reactor(y,(function(){!f.lockedUiContext()&&(f._isPartClickable()||f._onDashboard)?l.attr("tabindex",0):l.removeAttr("tabindex")})),st=FxImpl.shellInterface(c),st.triggerValidation((function(n,t){return e.ensureFormFieldValidation(l,!0,t).then((function(t){return n&&e.focusOnFirstInvalidField(f._partContainer),t}))})),c.location===1&&f.partFilterState.subscribeAndRun(y,(function(n){var i=n===4||n===3,u=n===2||n===1,r,t;f.isFilterApplied(i||u);r=i?rt:it;t="";switch(n){case 1:t=kt.Applied.dashboardTimeRange;break;case 0:case 2:t=kt.Applied.dashboardFilters;break;case 3:t=kt.Conflicted.timeRange;break;case 4:t=kt.Conflicted.multiple}f.filterIcon(wi.CustomImageWithOptions(r,{title:t}))})),f}return __extends(i,t),i.prototype.setupContent=function(n){var t=this,i=Q.defer(),f=b.isV2(this._viewModel.content()),u=ko.observable(f),e,r;return f&&(e=this._viewModel.content()._msPortalFx_contentRevealedPromise,e.then((function(){return u(!1)}),(function(){return i.resolve()}))),r=[this.partSettingFailed,this._viewModel.content,u,this._viewModel.container.partState,this.handledErrorMessage,],r.push(this.notFoundMessage),r.push(this._viewModel.container.unauthorizedMessage),ko.explicitComputed(this._lifetime,r,(function(){if(t.partSettingFailed())di.error(gi),ko.ignoreDependencies((function(){t._bindErrorTemplate({message:o.PartError.titleSettings});i.resolve()}));else{var r=t._viewModel.container.partState(),f=r!==wt.Failed,e=MsPortalFx.isNullOrUndefined(t.handledErrorMessage()),s=MsPortalFx.isNullOrUndefined(t.notFoundMessage()),h=MsPortalFx.isNullOrUndefined(t._viewModel.container.unauthorizedMessage()),l=f&&e&&s&&h;if(u()&&l)return;ko.ignoreDependencies((function(){t._bindContentTemplate(r,t.template,n);c.waitForBindings(t._partContent).then((function(){t._setupFormValidationReactor();i.resolve()})).catch((function(n){return i.reject(n)}))}))}})).extend({deferred:!0}),i.promise},i.prototype._setupFormValidationReactor=function(){var t=this,n=this._viewModel.container;n.location!==1&&this._onContentReady(0,(function(){ko.computed(t._lifetime,(function(){var u=t.validateElements(),r=e.gatherFormFieldsFromElements(u,null,!0),i=r.map((function(n){var t=n.viewmodel,i=n.field.validatableViewModel;if((!t||!t.disabled||!ko.unwrap(t.disabled))&&(!t.visible||ko.unwrap(t.visible)))return i&&(i.alwaysHasValidatorEquivalent||i.validators().length)?i.validationState():2})),f=r.some((function(n){return ko.unwrap(n.viewmodel&&n.viewmodel.dirty)}));ko.ignoreDependencies((function(){n.form.dirty(f);var t=n.form.validationState;i.includes(1)?t(1):i.includes(0)?t(0):i.includes(3)?t(3):t(2)}))})).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}})}))},i.prototype.setFocus=function(n){var r=this._partContainer.closest(".fxs-blade"),t=r.length>0?r[0]:this._partContainer[0],i=document.activeElement;return i===document.body||i===t||t.contains(i)?c.waitForBindings(t).then((function(){var r=$(t).find(n),i=r.filter(":focusable").first(),u,f;return i.length<1&&(i=r.findFirstTabbable(),i.length<1&&(u=r.find(":focusable"),f=u.not("div"),i=f.length?f.first():u.first(),i.length<1))?{success:!1,errorMsg:"No focusable element found on or within '{0}'".format(n)}:(i.focus(),{success:!0})})):Q({success:!1,errorMsg:"Requesting container does not own the focus."})},i.prototype._onContentReady=function(n,t){var i=this,r=this.partComposition?MsPortalFx.Base.Promises.cancelOnDispose(this._lifetime,Q(this.partComposition.await(n)).catch(MsPortalFx.noop)):Q();r.then((function(){return t(i._partContainer[0])}))},i.prototype._logClick=function(n){var t=this._diContainer.get(k.JourneyManager).activeJourney();bi.trace({extension:this._options.locator.getExtensionLocator().name,source:this._onDashboard?"StartBoardPart":"Blade",action:"PartClick",name:this._options.locator.toFriendlyString(),data:n,journeyId:t&&t.id})},i.prototype._onClick=function(n,t){return this._activatePart(n,t)},i.prototype._onKeyDown=function(n,t){return t.target===this._partContainer[0]&&t.keyCode===13?this._activatePart(n,t):!0},i.prototype._activatePart=function(t,i){if(this._diContainer.get(v.DesktopManagerMode).value.peek()===1&&!this._viewModel.content()._msPortalFxUnboundPart)return!0;var c=this._viewModel.container,e=$(i.target),l=!0,s=bt.getSelection(),h=s.rangeCount>0&&s.getRangeAt(0),r=c.clickableLink;if(this._isPartClickable()&&!(e.closest("a").length>0)&&(s.isCollapsed||!h||h.commonAncestorContainer.ownerSVGElement||h.commonAncestorContainer.nodeName==="svg"))if(r)if(r instanceof ui&&$.isFunction(r.onClick))r.onClick();else{var u=r.target(),o=f.sanitizeLinkUri(String(r.uri()||""),{diContainer:this._diContainer,windowContext:e,localRequire:n})||"",a=MsPortalFx.startsWith(o,"#"),y=!1;u==="auto"&&(u=a?"_self":"_blank");u==="_self"&&(w.isCtrlOrCommandOnly(i)||i.shiftKey?u="_blank":a&&(this._diContainer.get(ut.RoutePortalFunc).invoke(o,this._onDashboard?"StartBoardPart":"Blade"),y=!0));y||window.open(o,u);this._logClick({effectiveTarget:u,target:r.target(),scrubbedUri:o.split("?")[0]})}else i.shiftKey||w.isCtrlOrCommandOnly(i)||i.which===2?e.trigger("fxopeninnewtab",{selectable:c.selectable}):(this._selectable&&(this._selectable.isSelected()?e.trigger("fxensurebladevisible",{}):(this._selectable.onClick(),this._logClick())),l=!1);return l},i.prototype._accessibility=function(){for(var t,i,r=this._partContainer.findByClassName("fxs-part-title"),n=0;n<r.length;n++)t=MsPortalFx.getUniqueId(),i=$(r[n]),i.findByClassName("fxs-part-titleText").attr("aria-describedby",t),i.findByClassName("fxs-part-assetname").attr("id",t)},i.prototype._bindContent=function(n,t,i){var r=this,o=this._getExtensionName(),a=this._options.locator.name,s=[u.getScopeName(o),],h,f,l;this.scopeClass;h=new Set;f=$(this._partContent);i&&i.styleSheets&&ai.injectStyles(o,i.styleSheets,this._options.locator,h,s);this.scopeClass=s.join(" ");f.addClass(this.scopeClass);this.onSizeChange=function(n){h.forEach((function(t){var i=t.mediaQuery,r=t.mediaClass;i.type==="MINWIDTH"&&(n>=i.pixels?f.addClass(r):f.removeClass(r))}))};var v=this._diContainer.get(d.ViewModelManager),e=v.getWeaveShellPort(this._viewModel),c=ki++;si&&bt.performance.mark("PartStart"+c);e&&e.isChannelEnabled?g.connectWeaveShellPort(e,n,this._diContainer,(function(n){for(var t,u=[],i=0,e=n;i<e.length;i++)t=e[i],MsPortalFx.startsWith(t.moduleId,"FxInternal/_generated/Less/")?ft.injectCss(t):u.push({content:t.css,file:t.moduleId});ai.injectStyles(o,u,r._options.locator,h,s);r.scopeClass=s.join(" ");f.addClass(r.scopeClass);r.onSizeChange(r._viewModel.container.width.peek())})):($(n).html(t),l=new ko.bindingContext(this._getContentForBinding(this._lifetime)).extend({$dicontainer:this._diContainer,$partName:a,$extensionName:o}),ko.applyBindings(l,n),this._nodeToCleanup=n);si&&(bt.performance.mark("PartEnd"+c),bt.performance.measure("PartRender("+(e&&e.isChannelEnabled?"Weave":"KO")+")","PartStart"+c,"PartEnd"+c))},i.prototype.dispose=function(){var n,t;this._lifetime.dispose();n=this._nodeToCleanup;n&&ko.cleanNode(n);t=this._partContainer[0];t&&(ko.cleanNode(t),this._partContainer[0]=this._partContent=null);MsPortalFx.disposeViewModelProperties(this._viewModel)},i.prototype._getContentForBinding=function(){return this._viewModel.content},i.prototype._getExtensionName=function(){return this._options.locator.getExtensionLocator().name},i.prototype._bindContentTemplate=function(n,t,i){var u=this._viewModel.container,r,e;if(this.notFoundMessage())this._bindErrorTemplate(this.notFoundMessage(),404);else if(u.unauthorizedMessage())this._bindErrorTemplate(u.unauthorizedMessage(),401);else if(n===wt.Ready)if(MsPortalFx.isNullOrUndefined(this.handledErrorMessage()))try{u.contentState(0);this._resetContentTemplateContainer();this._bindContent(this._partContent,t,i)}catch(f){this._options.traceErrorTelemetry(f.message||"Failed to bind the knockout template",f);this._bindErrorTemplate({message:o.PartError.titleContent,details:MsPortalFx.getLogFriendlyMessage(f)})}else this._bindErrorTemplate(this.handledErrorMessage());else n===wt.Failed&&(r=typeof u.failureMessage()=="string"?{message:u.failureMessage()}:u.failureMessage(),e=typeof r.message=="string"?r.message:r.message&&r.message.htmlTemplate,this._options.traceErrorTelemetry(e,r.error),this._bindErrorTemplate(r))},i.prototype._bindErrorTemplate=function(n,t){var s,i,r,u,e,o,f;s=typeof n=="string"?{message:n}:n;this._viewModel.container.contentState(3);this._resetContentTemplateContainer();i=new l.ViewModel(s,{sessionId:MsPortalFx.sessionId,extName:this._getExtensionName(),contentName:this._options.locator.name,resourceId:this.assetId(),code:t},{showDetailsCmd:this._onDashboard});r=this.partComposition;r&&(u=new y.CompositionInstanceCommandContext($(this._partContent)[0],null,r),e=new p.ReloadPart(this._lifetime,this._diContainer,r),e.bind(u),i.commands.push(e),this._onDashboard&&(o=new p.UnpinFromStartboard(this._lifetime,this._diContainer),o.bind(u),i.commands.push(o)),f=new p.GoToAssetBlade(this._lifetime,this._diContainer,this.partComposition),f.bind(u),f.enabled()&&i.commands.push(f));new l.Widget($(this._partContent),i,this._diContainer)},i.prototype._resetContentTemplateContainer=function(){ko.cleanNode(this._partContent);$(this._partContent).html("")},i.prototype._toggleDisableTabbableElements=function(n){var r,t,u,i,f="tabindex",e="data-initialtabindex";if(n)for(r=this._partContainer.find(":tabbable"),i=0;i<r.length;++i)t=$(r[i]),u=t.attr(f),t.attr(f,"-1"),t.attr(e,u||"unset");else for(r=this._partContainer.find("["+e+"]"),i=0;i<r.length;++i)t=$(r[i]),u=t.attr(e),u!=="unset"?t.attr(f,u):t.removeAttr(f),t.removeAttr(e)},i})(fi);t.PartImpl=gt;t.registerFactory=ur;t.getFactory=ci;t.getPartSizeOrDefault=li;var fr=(function(){function n(n){this._extensionName=n;this._metadata=new Map}return n.prototype.injectStyles=function(n,t,i,r){for(var v,f,h,c,e=[],l=[],y=function(n){var c,a,h,v,p;if(n.content){var f=n.file,y=u.getScopeName(f),s=o._metadata.get(f);for(s||(c=[],a=[],o._metadata.set(f,s={file:f,mediaQueries:c,sanitizedCss:u.sanitizeStyleSheetText(n.content,"."+u.getScopeName(o._extensionName)+"."+y,a,c)}),a.forEach((function(n){e.push("\n"+t+" - "+f+" - "+u.generateErrorMessage(n))})),l.push(s)),r.push(y),h=0,v=s.mediaQueries;h<v.length;h++)p=v[h],i.add(p)}},o=this,s=0,a=n;s<a.length;s++)v=a[s],y(v);for(e.length&&FxImpl.Rpc.client.log(this._extensionName,{level:this._extensionName?2:1,code:1,area:"Parts",message:"Sanitization error found in following extension("+this._extensionName+") styleSheets:"+e}),f=0,h=l;f<h.length;f++)c=h[f],ft.injectCss({moduleId:this._extensionName+"_"+c.file,css:c.sanitizedCss})},n})(),er=(function(){function n(){this._cache={}}return n.prototype.injectStyles=function(n,t,i,r,u){var f=this._cache[n]||(this._cache[n]=new fr(n));f.injectStyles(t,i,r,u)},n})(),ai=new er;t.getPartFactory=sr;t.createAmdPartFactory=ni;t.createPartFactory=vi;yi=(function(n){function t(t,i,r,u){return n.call(this,t,i,r,u)||this}return __extends(t,n),t.prototype._bindContent=function(t,i,r){var u=this;n.prototype._bindContent.call(this,t,i,r);c.waitForBindings(t).then((function(){var n=fx.getTimestamp();MsPortalFx.require("MsPortalImpl/Parts/Parts.Frame.Common").then((function(t){t.logFrameAddedTelemetry({isPart:u._onDashboard,journeyManager:u._diContainer.get(k.JourneyManager),locator:u._options.locator,telemetryContextState:u._options.getTelemetryContextState&&u._options.getTelemetryContextState(),timestamp:n})}))}))},t})(gt)}));
define("MsPortalImpl/Parts/Parts.Error",["require","exports","MsPortalImpl/Parts/Parts","MsPortalImpl/Widgets/Widgets.PartError","MsPortalImpl/UI/Commands/UI.ExtensionCommands","MsPortalImpl/UI/Commands/UI.ShellCommands"],(function(n,t,i,r,u,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=MsPortalFx.Parts,o=e.PartKind,s=(function(n){function t(t,i,r,u){var f=n.call(this,t,i,r,u)||this;return i.container.contentState(3),i.internal.allowUiBlocking(!1),f}return __extends(t,n),t.prototype._bindContent=function(n){var c=this._viewModel.content.peek(),e=new r.ViewModel(c,{sessionId:MsPortalFx.sessionId,extName:this._getExtensionName(),resourceId:this.assetId(),contentName:this._options.locator.name},{showDetailsCmd:this._onDashboard}),t=this.partComposition,s=new u.CompositionInstanceCommandContext(n,null,t),h=t&&new f.ReloadPart(this._lifetime,this._diContainer,t),o,i;h&&(h.bind(s),e.commands.push(h));this._onDashboard&&(o=t&&new f.UnpinFromStartboard(this._lifetime,this._diContainer),o&&(o.bind(s),e.commands.push(o)));i=t&&new f.GoToAssetBlade(this._lifetime,this._diContainer,this.partComposition);i&&(i.bind(s),i.enabled()&&e.commands.push(i));this._lifetime.registerForDispose(new r.Widget($(n),e,this._diContainer))},t})(i.PartImpl);i.registerFactory(o[e.PartKind._Internal_Error],i.createPartFactory("",{partClass:s}))}));
define("_generated/Less/MsPortalImpl/Parts/Parts.Frame.css",["module"],(function(n){"use strict";return{css:".fxs-part.fxs-part-framepart{padding:0;overflow:hidden !important}.fxs-part.fxs-part-framepart.fxs-part-part-title-visible .fxs-part-title{padding:15px 15px 0 15px}.fxs-part-frame{width:100%;height:100%;border:0;overflow:auto;min-height:calc(100vh - 40px)}@media(min-height:500px){.fxs-part-frame{min-height:initial}}",moduleId:n.id}}));
define("MsPortalImpl/Parts/Parts.Frame.Common",["require","exports","FxInternal/Css","_generated/Less/MsPortalImpl/Parts/Parts.Frame.css"],(function(n,t,i,r){"use strict";function h(n){var l=n.contentElement,a=n.onFatalError,h=n.trustedOrigin,v=n.messageSignature,y=n.onMessage,p=n.lifetime,w=n.uri,c=n.frameReadyDeferred,b=n.isReadyMessage,e=w.toString(),t=FxImpl.createElement("div",{trustedInnerHTML:"<iframe />"}).firstElementChild,r,f,o,i;return t.classList.add("fxs-part-frame"),t.setAttribute("sandbox","allow-same-origin allow-scripts allow-popups allow-modals allow-forms allow-downloads"),t.setAttribute("allow","microphone *; encrypted-media *;clipboard-read;"),t.setAttribute("role","presentation"),t.setAttribute("src",e),t.setAttribute("allowfullscreen","true"),l.appendChild(t),f=p.createChildLifetime(),o=function(n){var e,u;f.isDisposed()||(e=n.source===(r?r:t.contentWindow),e)&&(u=n.data,u.signature==="###BOOT###"&&a(new Error("Boot message received from iframe, disposing to prevent XSS.")),n.origin===h&&u&&u.signature===v)&&(b(u)&&(clearTimeout(i),i=null,c.resolve(),r||(r=t.contentWindow)),y(u))},u.addEventListener("message",o,!1),i=setTimeout((function(){FxImpl.Diagnostics.getStatusCode(e,(function(n,t,i){var r={postIFrameLoadFailurePingResponse:{uri:e,statusCode:n,statusText:i,responseText:t}};c.reject(r)}));i=null}),s),f.registerForDispose({dispose:function(){i&&clearTimeout(i)}}),f.registerForDispose((function(){u.removeEventListener("message",o,!1);t.remove()})),{postMessage:function(n,t){r.postMessage(n,h,t)}}}function c(n){f(__assign(__assign({},n),{action:"IFrameAddedToDom"}))}function f(n){var i=n.isPart,r=n.journeyManager,u=n.locator,f=n.action,t=r.activeJourney();FxImpl.TelemetryContext.usingState((function(){o.trace({extension:u.getExtensionName(),source:i?"StartBoardPart":"Blade",action:f,name:e(n),journeyId:t&&t.id})}),n.telemetryContextState)}function e(n){var r=n.isPart,i=n.locator,t=i?i.toFriendlyString().toLowerCase():"";return r||(t=t.replace(/\/lens\/.*$/g,"")),t}function l(n){$(n).closest(".fxs-part").addClass("fxs-part-framepart")}Object.defineProperty(t,"__esModule",{value:!0});t.removeContentPadding=t.formMarkName=t.logFrameTelemetry=t.logFrameAddedTelemetry=t.createFrame=void 0;i.injectCss(r);var o=MsPortalFx.Base.Diagnostics.Telemetry,u=window,s=3e4;t.createFrame=h;t.logFrameAddedTelemetry=c;t.logFrameTelemetry=f;t.formMarkName=e;t.removeContentPadding=l}));
define("MsPortalImpl/Parts/Parts.ReactFrame",["require","exports","MsPortalImpl/AzFramework/AzHost","MsPortalImpl/Parts/Parts","MsPortalImpl/Parts/Parts.Frame.Common","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/Widgets/ReactFrame.Prewarmer","MsPortalImpl/Base/Themes","MsPortalImpl/Services/Services.ExtensionTokensManager","MsPortalImpl/Services/Services.ExtensionStorageManager","MsPortalImpl/Extension/ExtensionManagerOptions","FxInternal/Utils/LinkSanitizer","MsPortalImpl/UI/Compositions/UI.Composition","FxInternal/Lifetime","Fx"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){"use strict";function p(n,t,i){i===void 0&&(i=!1);n=n.toLowerCase();var u=function(t){var u,r=(u=g.exec(t))===null||u===void 0?void 0:u[0].toLowerCase();return r===n||i&&(r===null||r===void 0?void 0:r.startsWith(n))},r=MsPortalFx.forEachKey(t.dependencyTree||{},(function(n,t,i){i.id||MsPortalFx.find(Object.keys(t),(function(t){if(u(t))return i.id=t,i.url=n,!0}))}),{id:"",url:""});return r.id||MsPortalFx.forEachKey(t.paths,(function(n,i,r){if(!r.id&&u(n))return r.id=n,r.url=t.paths[n][0],!0}),r),r}function k(n,t,i,r){var u=new MessageChannel,f=n.acquireWindow(t,-1,u.port1),e=f.value;return w.getReactModelEndPoint.invoke(n,t,{modelName:i,portId:e,parameters:r}),{unloadModel:function(r){w.disposeReactModelEndPoint.invoke(n,t,{modelName:i,portId:e,unrequire:r});f.dispose()},port:u.port2}}function d(n,t,i,r,u){var h=this,c=""+r.substring(0,r.length-10)+".ReactModel",f=p(c,t),o=k(n,i,f.id,u),s,e;return f.id&&(s=MsPortalFx.getFeatureValue("reactreload"),e=0,s==="true"&&(clearTimeout(e),e=setTimeout((function(){return __awaiter(h,void 0,void 0,(function(){var n,t,i,r,u;return __generator(this,(function(s){switch(s.label){case 0:return n=function(n){return fetch(n).then((function(n){return n.text()}))},t=f.url.endsWith(".js")?f.url:f.url+".js",[4,n(t)];case 1:i=s.sent();s.label=2;case 2:return[4,n(t)];case 3:return(r=s.sent(),r!==i)?(o.unloadModel(!0),clearTimeout(e),u=window.location.hash,window.location.hash="#dashboard",window.location.hash=u,[3,5]):[4,new Promise(function(n){return e=setTimeout(n,3e3)})];case 4:return s.sent(),[3,2];case 5:return[2]}}))}))})))),o}function tt(n){var t=n&&FxImpl.TelemetryContext.usingState((function(){var n;if((n=MsPortalFx.Base.Diagnostics.Telemetry.Context.getBladeContext())!==null&&n!==void 0)return n.instanceId}),n),i=t===null||t===void 0?void 0:t.split("_")[2];return i&&parseInt(i)}Object.defineProperty(t,"__esModule",{value:!0});t.loadModelForView=t.loadModel=t.getModuleIdAndUrl=t.Part=void 0;var w=FxImpl.Extension,b=window,g=new RegExp("[^/]*$"),nt=(function(n){function t(t,i,r,u,f){var o=n.call(this,t,i,r,u)||this,s,a,v,y;return o._contentRevealed=Q.defer(),o._initializationComplete=Q.defer(),o._frameReadyDeferred=Q.defer(),s=f.extensionName,a=f.name,o._name=a,o._inContextPane=!!(i.container.flags&1),o._getFrameVal=e.getFrame(o._inContextPane?1:0),o._linkSanitizer=u.get(l.LinkSanitizer),v=u.get(h.ExtensionStorageManager).getStorageForExtension(s),o._storageReady=v.forceReady(),y=u.get(c.PostBootCache).get(s),o._contentOptions=y.then((function(n){var t=p(a,n.requireConfig).id,i=n.extensionEnvironment,r=n.features,u=n.requireConfig;return{viewModuleId:t,environment:i,features:r,extensionStorage:v,mergedConfig:u}})),o}return __extends(t,n),t.prototype.awaitReady=function(){return this._frameReadyDeferred.promise},t.prototype.awaitContentRevealed=function(){return this._contentRevealed.promise},t.prototype.awaitInitializationComplete=function(){return this._initializationComplete.promise},t.prototype.toggleDevTools=function(){var n;(n=this._host)===null||n===void 0?void 0:n.toggleDevTools()},t.prototype.togglePerfTools=function(){var n;(n=this._host)===null||n===void 0?void 0:n.togglePerfTools()},t.prototype._bindContent=function(n){var t=this,r;MsPortalFx.disposeDisposable(this._childLifetime);r=Promise.all([this._contentOptions,this._storageReady]);Promise.all([r,this._getFrameVal.frame]).then((function(){return t._frameReadyDeferred.resolve()}),(function(n){return t._frameReadyDeferred.reject(n)}));r.then((function(r){var nt,k,c=r[0],st=c.viewModuleId,ht=c.environment,ct=c.features,it=c.extensionStorage,lt=c.mergedConfig;if(!st){t._viewModel.container.notFound();return}n.classList.add("fxs-part-reactframe");var p=t._childLifetime=t._lifetime.createChildLifetime(),h=new v.TriggerableLifetimeManager,g=t._diContainer.get(o.ThemeManager),rt="Az",at=tt((k=(nt=t._options).getTelemetryContextState)===null||k===void 0?void 0:k.call(nt)),ut=y.defer(),vt=t._getFrameVal.frame.then((function(i){var s,f,o,a,v;if(h.registerForDispose((function(){return t._getFrameVal.dispose()})),p.isDisposed())return t._getFrameVal.completed(),h.dispose(),null;n.setAttribute("data-react-id",i.id);var r=i.element,y=r.contentWindow,w=(s=n.closest(".fxs-blade-content-container"))===null||s===void 0?void 0:s.querySelector(".fxs-bladesize-menu"),c=!!w;!t._inContextPane&&c&&r.classList.add("fxs-blade-floated-menuframe");r.classList.add("fxs-blade-floated-frame");r.classList.remove("fxs-extension-frame");var k=document.getElementsByClassName("fxs-journey-layout")[0],nt=n.closest(".fxs-blade-content-wrapper"),u=function(){if(!t._inContextPane){var u=r.parentElement&&r.parentElement.getBoundingClientRect().left||0,f=n.getBoundingClientRect(),i=nt.getBoundingClientRect();r.setAttribute("style","left: "+(k.scrollLeft+f.left-u)+"px; height: "+i.height+"px; width: "+i.width+"px;")}};return n.onresize=u,u(),ut.promise.then((function(n){e.setLatest({extensionName:l,frame:i,isMenuBladeContent:c,inContextPane:t._inContextPane,viewName:t._name,diContainer:t._diContainer,parameters:n,bladeSequenceNumber:at});var r=i.model||d(t._diContainer.get(FxImpl.Rpc.Client),lt,l,t._name,n);h.registerForDispose((function(){r.unloadModel()}));i.port.postMessage({signature:rt,kind:3,data:{theme:{mode:g.currentTheme().mode,highContrastMode:g.highContrastMode()},isMenuBlade:c,environment:ht,features:ct,serializedStorage:it.serialize(),name:t._name,type:"init"}},[r.port])})),t._inContextPane||(b.addEventListener("resize",u),h.registerForDispose((function(){b.removeEventListener("resize",u)}))),f=n.closest(".fxs-blade"),o=new MutationObserver(function(){u();r.style.display=getComputedStyle(f).display==="none"?"none":""}),h.registerForDispose((function(){o.disconnect()})),o.observe(f.parentElement,{childList:!0}),o.observe(f,{attributes:!0,attributeFilter:["style","class"]}),a=function(){return r.classList.add("fxs-display-none")},v=function(){r.classList.remove("fxs-display-none");u()},p.registerForDispose({dispose:a}),{postMessage:function(n,t){y.postMessage({signature:rt,kind:n,data:t},e.reactOrigin)},setOnMessage:i.setMessageListener,reactViewOptions:{hide:a,show:v,dispose:function(){h.dispose()},onUnloaded:function(){i.clearMessageListener()}}}})),ft=Q.defer(),et=ft.promise.then((function(n){var i=n.timestamp;t._viewModel.internal.reactViewInitializeEnd(i)})),ot=t._viewModel.content(),yt=ot.configure(et);et.finally((function(){t._initializationComplete.resolve();t._getFrameVal.completed()}));u.logFrameAddedTelemetry({isPart:t._onDashboard,journeyManager:t._diContainer.get(f.JourneyManager),locator:t._options.locator,telemetryContextState:t._options.getTelemetryContextState&&t._options.getTelemetryContextState()});var w=t._diContainer,l=t._getExtensionName(),pt=t._viewModel.container,wt=w.get(s.ExtensionTokensManager).createAuthTokenCache(l).getToken,bt=function(i){if(t._inContextPane&&!p.isDisposed()){var r=n.closest(".fxs-blade"),u=$.data(r,a.CompositionInstanceDataName);u.containerWidget.setContextPaneWidth(i)}};yt.then((function(n){var f,u,r=n&&n.parameters||{},e=r._provisioningContext;delete r._provisioningContext;ut.resolve(r);t._host=i.create({lifetime:p,parameters:JSON.stringify(r),telemetryContextState:(u=(f=t._options).getTelemetryContextState)===null||u===void 0?void 0:u.call(f),initializedDeferred:ft,viewModel:ot,container:pt,extensionName:l,getToken:wt,diContainer:w,contentRevealedDeferred:t._contentRevealed,features:w.get(FxImpl.Features).value,theme:g,provisioningContext:e,isReactView:!0,defaultTokenPromise:w.get(s.ExtensionTokensManager).createAuthTokenCache(l).getToken(),extensionStorage:it,getSafeLink:function(n,i){return t._linkSanitizer.getSafeLink(n,i)},setContextPaneWidth:bt,inContextPane:t._inContextPane});vt.then((function(n){return n&&t._host.initialize(n)}))}))}))},t})(r.PartImpl);t.Part=nt;t.getModuleIdAndUrl=p;t.loadModel=k;t.loadModelForView=d}));
define("MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer",["require","exports","FxInternal/Composition/ViewModel","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/Extension/DefinitionCache","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u,f,e,o){"use strict";function a(n,t,i,r,u){if(v(i,t,r),r){var f=y(n,t,u);i.push.apply(i,f)}}function v(n,t,i){n.filter((function(n){return t.getCompositionType()===s.StartboardPart&&i?n instanceof f.ShellCommand&&!(n instanceof f.CustomizeTileData):n instanceof f.ShellCommand})).forEach((function(t){MsPortalFx.remove(n,t);t.dispose()}))}function y(n,t,i){var r=[],e,u;return t.getCompositionType()===s.StartboardPart?(r.push(new f.GoToAssetBlade(n,i,t)),r.push(new f.EnterOrganizeMode(n,i)),r.push.apply(r,f.CreatePartSizeCommandCollection(n,i)),r.push(new f.ReloadPart(n,i,t)),r.push(new f.ClonePart(n,i,t)),r.push(new f.UnpinFromStartboard(n,i),new f.ExitOrganizeMode(n,i))):(e=t.instanceDefinition,u=e&&e.reference,u&&u.extension==="HubsExtension"&&u.partTypeName==="MonitorChartPart"||r.push(new f.PinToStartboard(n,i,t))),r}function p(t,r,u){var f=u.getViewModel(),e;return i.isV2(f.content())?(e=f.content().supplyCommands?f.content().supplyCommands(r):Promise.resolve([]),e.then((function(n){if(n===null||n===void 0?void 0:n.length){var i=FxImpl.shellInterface(f.container);return i.partCommands(n),MsPortalFx.require("MsPortalImpl/Widgets/Widgets.CommandBar").then((function(i){var f=u.diContainer,e=n.map((function(n){return i.createItem(r,n,u.locator,f,{executeLifetime:u})}));t.unshift.apply(t,e)}))}})).catch((function(t){var i="supplyCommands failed.\r\n "+MsPortalFx.getLogFriendlyMessage(t);o.logToExtension(n,u.extension.name,2,i)}))):Promise.resolve()}function w(n,t){var i=t.diContainer,f=u.getCommandGroupForDefinitionItem(i.get(e.DefinitionCache),t.extension.name,t.partDefinition),r=[],o={viewModelName:t+"-[ContainerModel]",viewModel:t.containerModel};return f.then((function(f){f&&(f.commands.forEach((function(n){b(n,t)&&r.push(new u.ExtensionCommandMenuItemImpl(t,t.extension,t,n,t.partDefinition,i,o))})),n.unshift.apply(n,r))}))}function b(n,t){var i=t.parent&&t.getPartsContainer();return i?n.details&&i.flags&1?(l.error("Part '"+t+"' cannot have the open blade command '"+(n.name||n.text)+"', because it is inside the context blade."),!1):!0:!0}function k(n,t){var i;return i=n._msPortalFxCreateSelectionAsync?n._msPortalFxCreateSelectionAsync(t):n.createSelection(t),Q(i)}Object.defineProperty(t,"__esModule",{value:!0});t.createSelection=t.composeCommands=t.composePartCommands=t.composeShellCommands=void 0;var h=MsPortalFx.Base,c=h.Diagnostics,s=r.CompositionType,l=c.createLog(n);t.composeShellCommands=a;t.composePartCommands=p;t.composeCommands=w;t.createSelection=k}));
define("MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Services/Services.Settings"],(function(n,t,i,r,u,f,e){"use strict";function o(n,i,u){var f=""+t.partIdentityStatePrefix+n.toString(),e;return u&&(f+="-"+u),i&&(e=i.hasOwnProperty(r.PartContainerModelIdProperty)&&[r.PartContainerModelIdProperty],f+="-"+MsPortalFx.toSortedString(ko.toJS(i),e)),f}function a(n){var t;try{t=JSON.parse(JSON.stringify(n))}catch(i){t=n}return t}function b(n){return n.some((function(n){var t=a(n.propertyValue),i=a(n.propertyOldValue);return!MsPortalFx.deepEquals(t,i)}))}var v;Object.defineProperty(t,"__esModule",{value:!0});t.PartSettingsManager=t.buildIdentitySettingKey=t.partIdentityStatePrefix=void 0;var y=MsPortalFx.Base,p=y.Diagnostics,s=r.CompositionType,h=u.PropertyBindings,c=p.createLog(n),l=Object.keys(MsPortalFx.trace.partsettings||{}),w=l.length>0;t.partIdentityStatePrefix="[PartIdentityState]-";t.buildIdentitySettingKey=o;v=(function(){function t(n){this._sharedSettings=n;this._trace=!1}return t.prototype.configure=function(n){this._options=n;this._settingsStore=n.part.getCompositionType()===s.StartboardPart?11:2},t.prototype.configureInstanceProperties=function(n){this._options.instanceProperties=n},t.prototype.initialize=function(){var n=this;this.dispose();this._registerPartIdentityStateChangeHandler();this._registerPartSharedKeyChangeHandler();this._registerPartInstanceChangedHandler();w&&(this._trace=l.some((function(t){return n._options.partViewModelId.toLowerCase().indexOf(t)>=0})))},t.prototype.saveIdentityPartSettings=function(n,t){var f=this._options,u=f.part,i=this.getKeyForIdentitySettings(n),r;u.getCompositionType()===s.StartboardPart&&(i=o(u.locator,n));i&&(this._identityState&&(r=FxImpl.toSerializableObject(this._identityState.targetModel),this._traceOperationWithSettings("Save identity part settings.",r,i),this._sharedSettings.setSetting(t&&11||this._settingsStore,i,r)),this._options.part.notifySettingChanged())},t.prototype.clearIdentityPartSettings=function(){var i=this._options;if(i){var t=i.part,r=t.containerModel,n=[this.getKeyForIdentitySettings(r)];t.getCompositionType()===s.StartboardPart&&n.push(o(t.locator,r));n=n.filter((function(n){return!!n}));n.length>0&&this._sharedSettings.deleteSettings({store:this._settingsStore,keys:n})}},t.prototype.getPartSettingsAsync=function(){if(this._options.part.getCompositionType()===s.StartboardPart)return this.getStartboardPartIdentitySettings();var n=this.getIdentityPartSettingsAsync(),t=this.getSharedPartSettingsAsync();return Q.all([n,t]).spread((function(n,t){return $.extend(!0,{},n,t)}))},t.prototype.registerInstanceStateProperty=function(n,t,i){i===void 0&&(i=!0);var r=this._options.part,u=this._getOrCreateInstanceStatePropertyBindings(),f=u.targetModel,e=r.getSettingsModel();this._registerViewModelPropertyChangeHandler(t,e,f,u,(function(){r.save()}),n);i&&r.save()},t.prototype.savePart=function(){var n=this._options;n&&n.part.save()},t.prototype.dispose=function(){var i=this._partInstanceState,n,t;i&&(i.unbind(),this._partInstanceState=null);n=this._identityState;n&&(n.unbind(),this._identityState=null);t=this._sharedKey;t&&(t.unbind(),this._sharedKey=null)},t.prototype.getKeyForIdentitySettings=function(n){var f=null,t=this._options,i=t.part,e=t.partStateDefinition,r=t.identityInputs,h=i.getInputPropertyBindings(),s=e&&e.inputIdentityProperties,u;return i.allInputsSet()&&s&&s.length>0&&(u="",r&&r.length>0&&(u=MsPortalFx.toSortedString(ko.toJS(h.targetModel),r)),f=o(i.locator,n,u)),f},t.prototype._registerPartIdentityStateChangeHandler=function(){var u=this,t=this._options,i=t.part,r=t.partStateDefinition,n=r&&r.inputIdentityProperties;n&&n.length>0&&(this._identityState=new h(i.toString()+"-[PartIdentitySettings]",{}),this._registerViewModelChangeHandler(n,this._identityState,(function(n){var t=b(n);t&&u.saveIdentityPartSettings(i.containerModel)})))},t.prototype._registerPartSharedKeyChangeHandler=function(){var i=this,r=this._options,o=r.part,f=r.partStateDefinition,n=f&&f.sharedProperties,e,t;n&&n.length>0&&(e=n.map((function(n){return n.property})),t={},this._sharedKey=new h(o.toString()+"-[PartSharedSettings]",t),this._registerViewModelChangeHandler(e,this._sharedKey,(function(){var r={},f;n.forEach((function(n){var i=u.getModelValue(t,n.property).value;r[n.key]=FxImpl.toSerializableObject(i)}));f={store:5,settings:r};i._traceOperationWithSettings("Save shared part settings.",r);i._sharedSettings.setSettings(f)})))},t.prototype._registerPartInstanceChangedHandler=function(){var n=this._options,t=n.instanceProperties,r=function(n){return n.some((function(n){return n.propertyName==="content.pollingOptions"}))},i;t&&t.length>0&&(i=this._getOrCreateInstanceStatePropertyBindings(),this._registerViewModelChangeHandler(t,i,(function(t){n.part.save();r(t)&&n.part.notifySettingChanged()})))},t.prototype._registerViewModelChangeHandler=function(n,t,i){var r=this,u=t.targetModel,f=this._options.part.getSettingsModel();n.forEach((function(n){r._registerViewModelPropertyChangeHandler(n,f,u,t,i)}))},t.prototype._registerViewModelPropertyChangeHandler=function(t,i,r,e,o,s){var c=this,h;u.getModelValue(r,t).exists||u.setModelValue(r,t,ko.toJS(u.getModelValue(i,t).value));h=e.addProperty(t).bind(this._options.partViewModelId,i,!1,o,(function(t){f.logToExtension(n,c._options.part.locator.getExtensionName(),2,"[PartState] Failed to bind changes from viewmodel to part state. Error: "+t)}));s&&s.registerForDispose((function(){e.removeProperty(h)}))},t.prototype.getIdentityPartSettingsAsync=function(){var t=this,i=this._options,r=i.partStateDefinition,u=i.part.containerModel,f=r&&r.inputIdentityProperties,n,e;return(f&&f.length>0)?(n=this.getKeyForIdentitySettings(u),e={store:this._settingsStore,keys:[n]},this._getPartSettingsAsync("Get identity part settings.",e,undefined).then((function(i){if(n===t.getKeyForIdentitySettings(u)){var r=t._identityState;return r&&$.extend(!0,r.targetModel,i),i}}))):Q.resolve(null)},t.prototype.getStartboardPartIdentitySettings=function(){var i=this._options,n=i.part,r=i.partStateDefinition,u=r&&r.inputIdentityProperties,t;return(u&&u.length>0)?(t=n.flags&2?[o(n.previousLocator,n.containerModel)]:[],t=t.concat([this.getKeyForIdentitySettings(n.containerModel),o(n.locator,n.containerModel),]),this._getPartSettingsAsync("Get identity part settings.",{store:this._settingsStore,keys:t},undefined)):Q.resolve(null)},t.prototype.getSharedPartSettingsAsync=function(){var f=this._options,r=f.partStateDefinition,n=r&&r.sharedProperties,t,i,u;return(n&&n.length>0)?(t=[],i={},n.forEach((function(n){t.push(n.key);i[n.key]=n.property})),u={store:5,keys:t},this._getPartSettingsAsync("Get shared part settings.",u,i)):Q.resolve(null)},t.prototype._traceOperationWithSettings=function(n,t,i){if(this._trace){if(i){var r={};r[i]=t;t=r}c.verbose("[PartSettingsManager] {0} Part: {1}.\nSettings: {2}".format(n,this._options.part.toString(),ko.toJSON(t,null,2)))}},t.prototype._traceOperationWithKeys=function(n,t){this._trace&&c.verbose("[PartSettingsManager] {0} Part: {1}.\nKeys: {2}".format(n,this._options.part.toString(),ko.toJSON(t,null,2)))},t.prototype._getPartSettingsAsync=function(n,t,i){var f=this,r;return this._traceOperationWithKeys("BEGIN - "+n,t.keys),r=[this._sharedSettings.querySettings(t)],Q.all(r).then((function(r){var e={},o=r[0]||{};return t.keys.forEach((function(n){var t=o[n],f=FxImpl.isSerializedObject(t),r=f?FxImpl.fromSerializableObject(t):t;i?o[n]!==undefined&&i[n]&&u.setModelValue(e,i[n],r):$.extend(!0,e,r)})),f._traceOperationWithSettings("END - "+n,e),e}))},t.prototype._getOrCreateInstanceStatePropertyBindings=function(){if(!this._partInstanceState){var n=this._options.part;this._partInstanceState=new h(n.toString()+"-[PartInstanceState]",n.partState)}return this._partInstanceState},__decorate([__metadata("fx:diagnostics",[n,"PartSettingsManager"]),i.Class("composition"),__metadata("design:paramtypes",[e.SettingsManager])],t)})();t.PartSettingsManager=v}));
define("MsPortalImpl/UI/Compositions/UI.Composition.Part",["require","exports","Fx","FxInternal/Composition/ViewModel","FxInternal/Utils/Promise","FxInternal/AsyncLoader","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.Events","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Interactions/Interactions.PrintHandler","MsPortalImpl/Interactions/Interactions.FullScreenMode","MsPortalImpl/Parts/Parts","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/Base/Base.FeatureDetection","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.Graph","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.Security","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/Base/Base.ElementWidgetMap","MsPortalImpl/Extension/ShellPart","MsPortalImpl/Widgets/Widgets.Portal.init","FxInternal/Composition/Part","FxInternal/Composition/ViewModelComposer","MsPortalImpl/Parts/Parts.Error","MsPortalImpl/Parts/Parts.ReactFrame"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii){"use strict";function bi(n){return n&&n.toFriendlyString()}function pu(n,t,i,r){var o;try{return i()}catch(u){var s="Error deserializing composition.",f=void 0,e=void 0;try{f=JSON.stringify(t)}catch(h){f="<Invalid> {0}".format(h.toString())}try{e=tr.fromJSON(n,t.locator)}catch(c){e=tr.forExtension(s+"-"+c)}return o="{0}\nJSON: {1}\nException Message: {2}\nException StackTrace: {3}".format(s,f,u.message||"<N/A>",u.stack||u.toString()),ri.error(o),r(e,o)}}function wf(n,t,i,r,u,f){var o=fx.getTimestamp()-t,e=function(){return u&&(r=MsPortalFx.extend2(r,u.getTelemetryInfo())),br.trace({name:i.name,extension:i.extension,source:i.source,action:n,actionModifier:su.Complete,data:r,duration:o,journeyId:i.journeyId})};return f?hi.usingState(e,f):e()}function ci(n){return n.partDefinition&&n.partDefinition.shareVmWithParentBlade}function si(n){var t=n.getPartsContainer();return t&&t.getCompositionType()===ot.CompositionType.Blade&&t}function wu(n){var t=si(n);return!!(t&&t.bladeDefinition&&t.bladeDefinition.locked)}function bu(n,t){return t.masterPartId===n.id&&or(t.masterCommandName)}function bf(n){var i=n.diContainer.get(ft.JourneyManager),r=i.tryCloseBlade.bind(i),t=n.getPartsContainer();return function(i,u){var s,f;switch(i){case 1:case 2:return s=n.diContainer.get(at.Finder),f=s.findBlades(t).filter((function(t){var r=!!(t.flags&1);return bu(n,t)&&i===1?!r:r})),f.length===0?!1:!f.some((function(n){return!r(n)}));default:var e=t,o=t.masterContainer,h=o&&o.bladeDefinition;return h&&h.menuBlade&&(e=o),e.returnValue=u,r(e,2)}}}function kf(t,i,r){var u=ku(i,r);return u&&{switchItem:function(i){cf(t,MsPortalFx.require("../../../MsPortalImpl.Controls/Controls/Lists/Menu",n)).then((function(n){var t=u.widget.element.findByClassName("fxc-menu"),r=t.length?(dt.getAllMatch(t[0],n.Widget)||[])[0]:u.getMenuWidget();r&&r.switchItem(i)}))}}}function ku(n,t){var r=t&&t.children||[],u=r.indexOf(n,1),i;if(u>0&&(i=r[u-1],i.bladeDefinition&&i.bladeDefinition.menuBlade))return i}function ru(n){var t=n.parent&&n.getPartsContainer(),i=t?t.getCompositionType():vi.Unknown;return t?i===vi.Startboard?1:2:0}function ar(n,t){t===void 0&&(t=!0);var i;return n&&(t&&!n.hasOwnProperty(ot.PartContainerModelIdProperty)&&(n=ko.toJS(n),n[ot.PartContainerModelIdProperty]=MsPortalFx.getUniqueId()),i=fi.createObservableModel(n)),i}function uu(n,t){var i;return n&&t?(i={},tu(n,(function(n){i[n]=null}))):i=n,FxImpl.toSerializableObject(i)}function du(n,t,i,r,u,f){var o=n.createChildContainer("composition"),e=new iu(o,t,null,i,null,null,null,f);return e.registerForDispose((function(){return o.disposeAsync()})),e.calculateInitialSize(),e.containerModel=ar(r),e.overridesModel=ar(u||{},!1),e}function gu(n){var t=pt.getGridPixelSize(n.gridWidth(),n.gridHeight()),i=t.height,r=t.width;return n.locked()||(i-=30,r-=30),{height:i,width:r}}function df(n,t){var e,o;if(pt.isFixedSize(n.size()))return gu(n);var u=0,f=0,i=t.journeyWidget,r=t.blade;return t.partLocation===2&&r&&i&&(e=i.getBlades().length>1,u=lu.innerHeight-113-(e?tt.getScrollbarWidth():0),o=t.inMenuBlade?r.masterContainer.id:r.id,f=i.getBladeDisplayWidth(o)-(t.inMenuBlade?265:0)-1),{height:u,width:f}}function gf(n,t){return pt.isFixedSize(t.size())?gu(t):{height:n.height(),width:n.width()}}function fu(n,t,i,r,u,f){if(!yr(f)){if(u){var e="content.size",o=ei(n,e);o.exists&&ko.isObservable(o.value)&&wt.setModelValue(n,e,r)}y.requestAnimationFrame((function(){var u=gf(t,i),f=n.container,e;f.width(u.width);f.height(u.height);e=f.size();(or(e)||e.partSize!==r||!MsPortalFx.deepEquals(e.dimensions,u))&&f.size({partSize:r,dimensions:u})}))}}function fr(n){var t=n.partDefinition,i=n.adapter,r=t&&t.viewModel?t.viewModel:"N/A",u=i?"AdapterPart. Extension: "+i.extension.name+", ViewModel: "+i.viewModelName+", Wrapped ViewModel: "+r:"ViewModel: "+r;return n+" ("+u+")"}function ne(n,t,i){var r=n.getInputPropertyBindings();(i||[]).forEach((function(i){var u=MsPortalFx.find(r.properties,(function(n){var r=n.compositionBindingDefinition;return n.sourceProperty===i.source.property&&r&&r.source&&r.source.id===t.id}));u||(hr(n.diContainer,n,r,[i]),i.source.id=t.id,n.bindings.push(i),n.save())}))}function te(n,t){var i=n.getInputPropertyBindings(),r=n.bindings||[],u=r.filter((function(n){return n.source.scope!==ai.DetailsContainer}));u.length!==r.length&&(i.properties.filter((function(n){var i=n.compositionBindingDefinition;return i&&i.source&&i.source.id===t.id})).forEach((function(n){i.removeProperty(n)})),n.bindings=u,n.save())}function nf(n){var t=n.adapter,i=t.inputPropertyBindings,r=i.targetModel;hr(n.diContainer,n,t.inputPropertyBindings,t.bindings,(function(t){return r[t.targetProperty]=ko.observable(),n.bindAgainstOverridesOrContainerModel(t)}))}function ie(n,t,i){var r=!!t;return t&&(t.assetType&&!t.assetIdInputProperty?(ri.error("'assetIdProperty' is required if 'assetType' is defined on part definition. Locator:'"+n.locator+"'."),r=!1):!i&&!!t.editScopeType&&n.bindings&&n.bindings.some((function(n){return n.targetProperty===ki}))&&(r=!1,ri.error("Declaring an 'editScopeType' and an input binding with '"+ki+"' as a target property is not supported. "+("A part cannot be the owner of an edit scope and also receive an edit scope id from an external source. Part: '"+n+"'. Bindings: "+JSON.stringify(n.bindings)+".")))),r}function re(n,t){var i=[],r=!0;return t&&t.invocationInputArguments&&t.invocationInputArguments.length&&(r=ht.validateDetailsDefinition(t,i)),i.length&&vf.logDetailDefinitionError(i[0],n.toString(),t),r}function ue(n,t){var i=[],r=fi.validateInputBindings(n,t,i);return i.length&&ri.error(i[0]+" Part:'"+n+"'."),r}function fe(n){var t=n.adapter,i=t?t.allInputsSet:n.allInputsSet;ko.computed(n,(function(){if(i()){var t=tf(n);t&&t.exists&&n.assetId(ko.unwrap(t.value))}}))}function tf(n){var i=n.adapter,r=i?i.inputPropertyBindings:n.getInputPropertyBindings(),t=MsPortalFx.find(r.properties,(function(t){return t.targetProperty===n.assetInstanceDefinition.assetIdInputProperty}));return t?ei(t.sourceModel,t.sourceProperty):null}function ee(n){var f,i,t,r,u;return n.isComposed&&(i=n.getViewModel(),i&&(t=i.container,t&&(r=t.partTitle&&t.partTitle(),u=t.assetName&&t.assetName(),(r||u)&&(f={partTitle:r,assetName:u})))),f}function rf(n){typeof n=="object"&&tu(n,(function(t,i){pf[t]?delete n[t]:typeof i=="object"&&rf(i)}))}function uf(t){return ir(undefined,t,(function(n){return ur[t]=n}),n)}function oe(n){var t=uf(nu);return MsPortalFx.tryImmediateResolve(t,(function(){return n}))}function vr(){return uf(gr)}function eu(){return ur[gr]}function se(){return ur[nu]}function he(n){ur[nu]=n}function ce(n){ur[gr]=n}function le(n){return{property:n,modelType:t.inferredReferenceType,scope:ai.CurrentContainer,cardinality:wt.ReferenceCardinality.OneToOne}}function ae(t,i){return ir(t,"./UI.Composition.Selectable2Registrar",i,n)}function ff(n){return n&&(n.partKind===oi.Frame||n.partKind===oi._Internal_Az||n.partKind===oi._Internal_React)}function yr(n){return n&&(n.partKind===oi._Internal_Az||n.partKind===oi._Internal_React)}function gi(n){var t=n.getPartsContainer(),r,i;return t&&(r=t.getCompositionType(),r===vi.Blade)?t.locator.getExtensionName():(i=n.locator,i&&i.getExtensionName())}function ve(n,t){var i=n.locator,r=n.extension,u=i&&i.getExtensionName(),f=r&&r.name;return u!==t?u:f!==t?f:undefined}function ye(n,t){var r={},i;return(n&&t&&(t.forEach((function(n){n.isIdentityInput&&!!n.property&&(r[n.property]=!0)})),n.forEach((function(n){n.isIdentityInput=!!r[n.property]}))),n&&t)?(i=n.slice(0),t.forEach((function(t){var r=t.valuesFrom;r&&r.length&&r[0].referenceType===5&&(n.some((function(n){return n.property===t.property}))||i.push(t))})),i):n||t||[]}function pe(n,t){var i=n.partDefinition;return i&&i.partKind===oi.Custom&&i.htmlTemplate&&!t.tryLocate(n.locator.getExtensionLocator().withHtmlTemplate(i.htmlTemplate),{})}function we(n){var t=n.name,i=n.getExtensionName();return i==="HubsExtension"&&!!gt.shellParts[t]}var nr,yu,tu,ui,iu;Object.defineProperty(t,"__esModule",{value:!0});t.createOverridesOrContainerModelSourceReference=t.inferredReferenceType=t.setDynamicPartBinderModule=t.setBladeOpenerModule=t.create=t.getSerializableContainerModel=t.prepareContainerModel=t.tryGetParentMenuBlade=t.Instance=t.createCompositionFromJSON=t.OnInputsSetPromiseType=t.fxpartinputchanged=t.EmptyViewModel=t.fxpartsettingchanged=void 0;var tr=p.Locator,hi=FxImpl.TelemetryContext,ou=hi.ContextType,pr=FxImpl.shellInterface,ef=MsPortalFx.Base,wr=ef.Diagnostics,su=wr.Telemetry.ActionModifier,br=wr.Telemetry,sf=MsPortalFx.Extension,hf=sf.SetRequirement,er=MsPortalFx.Parts,oi=er.PartKind,vi=ot.CompositionType,fi=ct.CompositionBinder,ai=wt.ReferenceScope,hu=wt.PropertyBindings,ir=st.compositionRequire,cf=MsPortalFx.Base.Promises.cancelOnDispose,kr=MsPortalFx.Errors,cu=kr.CanceledError,yi=kr.DisposedCanceledError,lf=kr.Error,lu=window,af=s.Asset,or=MsPortalFx.isNullOrUndefined,li=MsPortalFx.startTimer,ri=wr.createLog(n),au="fxs-part",vf={logDetailDefinitionError:function(n,t,i){ri.error(n+" "+"Part: '{0}'. Details: '{1}'.".format(t,JSON.stringify(i)))}},vu=ht.PartContainerSelectable_ViewModelPath,yf=[vu+".isSelected",vu+".isCommandSelected",],sr=br,pi="Shell",wi=7,rr=9,ki=ot.EditScopeIdPropertyName,hr=fi.setupPropertyBindings,di=tr.forExtension,ei=wt.getModelValue,cr=fi.mapInputBindingDefinitions,lr=fi.createAllInputsSetWatcherConfigExtended,dr=wt.mapSourceModelToTargetModel,pf={isActivated:!0,isSelected:!0,itemsWithChildEdits:!0,selectedValue:!0,activatedItems:!0,selectedItems:!0},gr="./UI.Composition.DynamicPartBinder",nu="./UI.Composition.BladeOpener",ur={};yu=0;tu=MsPortalFx.forEachKey;t.fxpartsettingchanged="fxpartsettingchanged";t.EmptyViewModel=ti.composePartViewModel(MsPortalFx.noop);t.fxpartinputchanged="fxpartinputchanged";t.OnInputsSetPromiseType=(nr={},nr[0]="unknown",nr[1]="Q",nr[2]="jQuery",nr),(function(n){n[n.OldInputsNotHandled=1]="OldInputsNotHandled";n[n.UnrecoverableError=2]="UnrecoverableError";n[n.CustomPartWithMissingTemplate=3]="CustomPartWithMissingTemplate";n[n.PartDefinitionNotFound=4]="PartDefinitionNotFound";n[n.IncorrectPartType=5]="IncorrectPartType";n[n.ErrorLocatingPartDefinition=6]="ErrorLocatingPartDefinition";n[n.ErrorAcquiringViewModel=7]="ErrorAcquiringViewModel";n[n.ViewModelMissing=8]="ViewModelMissing";n[n.ErrorLoadingControl=9]="ErrorLoadingControl";n[n.ErrorCreatingWidget=10]="ErrorCreatingWidget";n[n.TransitionedToErrorState=11]="TransitionedToErrorState"})(ui||(ui={}));t.createCompositionFromJSON=pu;iu=(function(y){function tt(n,r,u,f,e,s,h,l){var a=y.call(this,s||"Part",n,r,[],u,f,l)||this;a._pinnedBladeDeeplink=h;a.bindings=[];a.editScopeId=ko.observable();a.invocationThrottleDuration=25;a.allInputsSet=ko.observable(!1);a.calledOnInputsSet=ko.observable(!1);a.failedOnInputsSet=ko.observable(!1);a.assetId=ko.observable();a.triggeringLockedBladeSpinner=ko.observable(!1);a.contentRevealed=!1;a._earlyVmDeferred=i.defer();a._viewStateProperties=[];a._partDefinitionDeferred=i.defer();a._registrationDeferred=i.defer();a._disabled=!1;a._restoredFromJson=!1;a._perfData={instanceExtensionLoad:0,referenceExtensionLoad:0,adapterViewModelLoad:0,partViewModelLoad:0,extenderViewModelLoad:0,checkPermissions:0,prepareViewModel:0,finalizePartCompose:0,allInputBindingsBoundPreprocess:0,allInputBindingsBound:0,srcExtension:"",contentRevealedCalled:!1,onInputsSetPromiseState:"",onInputsSetPromiseType:"",resourceId:undefined};a._showShellCommands=!0;a._allInputPropertyBindingsBound=i.defer();a._frameInitialized=i.defer();a._frameRevealed=i.defer();a._frameBlockingUi=ko.observable(!1);a._contentInitializing=ko.observable(!0);a._getPartViewModelCalledDeferred=i.defer();n.get(vt.CompositionGraph).addPart(a);n.set(o.CompositionProvenance,new o.CompositionProvenance(r,a.id));a._viewModelManager=n.get(c.ViewModelManager);a._finder=n.get(p.DefinitionFinder);a._setupPromises();var v=l||yu++,w=0,b=a._updateRebindSequenceNumber=function(){a.instanceId="Part_"+MsPortalFx.sessionId+"_"+v+"_"+w++};return b(),a._vm=e||t.EmptyViewModel,a.partState={},a.containerModel=null,a.overridesModel=ar({},!1),a._registrationDeferred.promise.catch((function(n){a._allInputPropertyBindingsBound.reject(n)})),a._partSettingsManager=a.diContainer.get(yt.PartSettingsManager),a}return __extends(tt,y),tt.prototype.getPartsContainer=function(){return this._partContainer||(this._partsContainer=this.diContainer.get(at.Finder).findPartsContainer(this)),this._partsContainer},tt.prototype.shouldAlertOnClose=function(n){var t=this._getContainer(),r,i;return t?(r=ko.utils.peekObservable(t.suppressAlert),i=ko.utils.peekObservable(t.configureAlert),r)?!1:i?i.showAlert:!!this.widget&&e.gatherFormFields(this.widget.element).some((function(t){var i=t.viewmodel;return(i._msPortalFxViewModelValueChangesAreClean||i._msPortalFxOldControl&&!n)&&i.dirty&&i.dirty()})):!1},tt.prototype.getAlertMessage=function(){var t=this._getContainer(),n=ko.utils.peekObservable(t.configureAlert);return n&&n.showAlert?n.message:""},tt.prototype.suppressAlert=function(){var n=this._getContainer();return n?ko.utils.peekObservable(n.suppressAlert):!0},tt.prototype.notifySettingChanged=function(){var n=this.widget;n&&n.element.trigger(t.fxpartsettingchanged,{part:this,isUserInteraction:this.hasUserInteractedRecently()})},tt.prototype.getViewModel=function(n,i){var r=t.EmptyViewModel,u=this.adapter,f,e;if(n=n||0,n===0)r=this._vm;else if(n===4)if(f=this._contextMenuViewModels,f)r=f.getViewModel(n,i);else{var s=this._getCommands(),o=ot.findCommand(s,i,""+this),h=o&&o.getViewModel();r=h||t.EmptyViewModel}else n===wi?r=u&&u.viewModel:n===rr?(e=u&&u.inputPropertyBindings,r=e&&e.targetModel):ri.error("Invalid model type '"+n+"' for part '"+this.locator.toString()+"'.");return r},tt.prototype.getViewModelAsync=function(n,t){var i=this;return this._registrationDeferred.promise.then((function(){var r,f,u;return n===4?(r=i._contextMenuViewModels,r?r.getViewModelAsync(n,t):(f=i._getCommands(),u=ot.findCommand(f,t,""+i),u&&u.getViewModelAsync())):i.getViewModel(n)}))},tt.prototype.setViewModel=function(n){this._vm=n||t.EmptyViewModel},tt.prototype.setBladeOpener=function(n){this.registerForDispose(this._bladeOpener=n)},tt.prototype.getBladeOpener=function(){return this._bladeOpener},Object.defineProperty(tt.prototype,"isDisabled",{get:function(){return this._disabled},enumerable:!1,configurable:!0}),Object.defineProperty(tt.prototype,"canClone",{get:function(){var n=this.isComposed,t=this.getInputPropertyBindings().allBound,i=this.partDefinition.partKind===oi.ResourceSummary;return n&&t&&!i},enumerable:!1,configurable:!0}),Object.defineProperty(tt.prototype,"eligibleForBinding",{get:function(){return!this.containerModel},enumerable:!1,configurable:!0}),Object.defineProperty(tt.prototype,"templateKey",{get:function(){var n=this.locator.toString(),t=this.containerModel;return t&&(n+="-"+MsPortalFx.toSortedString(ko.toJS(t))),n},enumerable:!1,configurable:!0}),Object.defineProperty(tt.prototype,"journeyPath",{get:function(){return this.getPartsContainer().journeyPath.concat(this.templateKey)},enumerable:!1,configurable:!0}),Object.defineProperty(tt.prototype,"dirtyAndNotSaving",{get:function(){return this.diContainer.get(nt.EditScopeManager).getStateObservable(this.editScopeId())()===1},enumerable:!1,configurable:!0}),Object.defineProperty(tt.prototype,"instanceDefinition",{get:function(){return this._partInstanceDefinition},enumerable:!1,configurable:!0}),tt.prototype.getCompositionType=function(){return vi.Part},tt.prototype.getPartSettingsManager=function(){return this._partSettingsManager},tt.prototype.getPerfData=function(){return this._perfData},tt.prototype.getSettingsModel=function(){var n=this._settingsModel,t;if(!n&&(t=this.getViewModel())){var u=r.isV2(t.content()),f=this.partDefinition,i=f&&f.partState,e=MsPortalFx.unique((i?(i.inputIdentityProperties||[]).concat((i.sharedProperties||[]).map((function(n){return n.property}))):[]).concat(!u&&this._viewStateProperties||[]));this._settingsModel=n=MsPortalFx.clone(t);n.content=ko.observable({});e.forEach((function(i){if(i.startsWith("content.")){var r=u?ko.observable():ei(t,i).value;wt.setModelValue(n,i,r)}}))}return n},tt.prototype.hasUserInteractedRecently=function(){return!1},tt.prototype.dispose=function(n){var t=this;y.prototype.dispose.call(this,n);this._releaseResources(n);this._readyMarker&&hi.usingState((function(){sr.trace({extension:gi(t),source:pi,action:"PartReady",actionModifier:su.Cancel,name:bi(t.locator),data:t._perfData,journeyId:t._getTelemetryJourneyId()})}),this._creationState)},tt.prototype.onBladeFullReady=function(n,t,i){if(i===5)this._part.onReadyComplete(n,t)},tt.prototype._setExtension=function(n){this.extension=n;this._partContainer&&this._partContainer.attr("data-extensionname",this.extension?this.extension.name:null)},tt.prototype.resourceLTM=function(){return this._ltm||(this._ltm=this.widget.ltm.createChildLifetime())},tt.prototype._releaseResources=function(n){var r,u,i,e,f,o;this._ltm&&this._ltm.dispose();this._clearLoadingReactor();r=this._inputBindings;r&&(r.unbind(),this._inputBindings=null);u=this._part;u&&(u.dispose(),this._part=null);i=this._vm;e=this.extension;e&&i&&i!==t.EmptyViewModel&&this._viewModelManager.releaseViewModel(i,!0);this._releaseAdapter();f=this._extenderVM;o=this._extenderVMExtn;f&&o&&this._viewModelManager.releaseViewModel(f);n||this._disposeEditScope();this._journey=null;this._vm=t.EmptyViewModel},tt.prototype._clearLoadingReactor=function(){var n=this._loadingReactorLifetime;n&&n.dispose()},tt.prototype._releaseAdapter=function(){var n=this.adapter,t;n&&(n.inputPropertyBindings.unbind(),t=n.viewModel,t&&this._viewModelManager.releaseViewModel(t),this.adapter=null)},tt.prototype._getContainer=function(){return pr(this.isDisposed()||!this._vm?{}:this._vm.container)},tt.prototype.getInputPropertyBindings=function(){if(!this._inputBindings)this._inputBindings=new hu(fr(this),{},!1);return this._inputBindings},tt.prototype.getAssetId=function(){var f=this,t=this.assetInstanceDefinition,e=t&&t.assetIdInputProperty;if(!e)return Q.reject(0);var i=function(n){var t=tf(f);t&&t.exists?n.resolve(ko.unwrap(t.value)):n.reject()},n=Q.defer(),r=this.adapter,u=r?r.allInputsSet:this.allInputsSet;return u()?i(n):u.subscribe(this,(function(t){t&&!n.promise.isFulfilled()&&i(n)})),n.promise},tt.prototype.toJSON=function(){var n=y.prototype.toJSON.call(this),t,i;return n.assetInstanceDefinition=this.assetInstanceDefinition,n.partState=FxImpl.toSerializableObject(this.partState||{}),n.initialSize=this.initialSize,n.bindingsInitialized=this._bindingsInitialized,n.savedContainerState=ee(this),n.containerModel=uu(this.containerModel,this.modelContainsSensitiveData),n.overridesModel=uu(this.overridesModel,!1),n.originalPartLocator=this.previousLocator,n.flags=this.flags,t=this.adapter,i=this.bindings,n.adapterBindings=t&&t.bindings,n.bindings=t?i.filter((function(n){return n.source.scope===ai.DetailsContainer})):i,n},tt.prototype.cloneAs=function(n,t){var u=this,i,r=this.widget?this.widget.options:null,f=[this.await(7),this.getInputPropertyBindings().awaitAllBound],e=this.adapter;return e&&f.push(e.inputPropertyBindings.awaitAllBound),Q.all(f).then((function(){var s=u.getNonDetailsContainerPropertyBindings(),e={},o,f;return s.forEach((function(n){var t=ei(n.targetModel,n.targetProperty).value;wt.setModelValue(e,n.sourceProperty,ko.toJS(t))})),o=ko.toJS(u.overridesModel),i=n(e,o),i.widgetState($.extend(!0,{},u.widgetState())),r&&r.size&&(i.initialSize=r.size(),i.initialSize===99&&(i.initialWidth=r.gridWidth(),i.initialHeight=r.gridHeight())),f=u._partSettingsManager,f&&f.saveIdentityPartSettings(i.containerModel,t),i}))},tt.prototype.clone=function(){var n=this;return this.cloneAs((function(t,i){return du(n.diContainer,n.locator,null,t,i)}))},tt.fromJSON=function(n,t){var i=n.get(l.ExtensionManagerOptions);return pu(i,t,(function(){var u=n.createChildContainer("composition"),r=new tt(u,tr.fromJSON(i,t.locator),t.widgetState,t.id);return r.registerForDispose((function(){return u.disposeAsync()})),r.loadPropertiesFromJson(i,t),r}),(function(i,r){var f=n.createChildContainer("composition"),u=new tt(f,i,null,t.id);return u.registerForDispose((function(){return f.disposeAsync()})),u.unrecoverableErrorMessage=r,u}))},tt.prototype.getAssetInstanceMetadataAsync=function(){var n=this;return Q(this._registrationDeferred.promise.then((function(){if(!n.isDisabled&&!n.isDisposed())return n.getAssetId().then((function(t){return{id:t,type:n.assetType}})).catch($.noop)})))},Object.defineProperty(tt.prototype,"assetType",{get:function(){var n=this.assetInstanceDefinition;return n&&n.assetType},enumerable:!1,configurable:!0}),tt.prototype.addWidgetToUI=function(n){var t=this.widget;n.skipDOMAttach||n.parentElement.addChild(t);t.addChild(this._partContainer)},tt.prototype.recompose=function(n){this._compose(n,i.defer(),!0)},tt.prototype._compose=function(n,t,i,r){var u=this,e,o,a,s,h,c;i===void 0&&(i=!1);var f,l=gi(this),v=bi(this.locator),y=function(n,t,i,r){return wf(n,t,i,r,u._menu,u._creationState)},p={extension:l,source:pi,name:v,journeyId:this._getTelemetryJourneyId()};this.calledOnInputsSet.subscribe(this,(function(n){n&&(u._onInputsSetResolvedMarker=fx.getTimestamp())}));this._allOnInputsSet.then((function(){var t=u._readyMarker,n;t&&(y("PartReady",t,p,u._perfData),u._readyMarker=null);n=u._onInputsSetResolvedMarker;n&&(u.fullReadyTime=fx.getTimestamp()-n,u._onInputsSetResolvedMarker=null)}));this.await(0).then((function(n){var t=u._revealedMarker;t&&(u._perfData.contentRevealedCalled=n,u._revealedMarker=null)}));this._registrationDeferred.promise.then((function(){t.resolve()}),(function(){t.reject();u._getPartViewModelCalledDeferred.reject()}));this._clearLoadingReactor();this._ltm&&this._ltm.dispose();e=this.widget;e&&i?(this._partContainer=e.element.find("."+au),f=e.options,o=f.commands.splice(0,f.commands.length),a=!!MsPortalFx.find(o,(function(n){return n instanceof ut.CustomizeTileData})),o.forEach(MsPortalFx.disposeDisposable),a&&f.commands.push(new ut.CustomizeTileData(this,this.diContainer)),f.actionBarViewModel.update(),this._ltm=e.ltm.createChildLifetime()):(this._partContainer=$(FxImpl.createElement("div",{"class":au})),r?(f=r.options,e=this.widget=r):(f=this.createTileViewModel(n.options.locked()),e=this.widget=it.createTileWidget($(FxImpl.createElement("div")),f,this.diContainer,!1,(function(){return u._getActions()}))),f.actionBarViewModel.partTitle(this.getTitle()||"Untitled"),this.widgetState(e.saveViewSettings()),this._ltm=e.ltm.createChildLifetime(),this.addWidgetToUI({parentElement:n,doNotSaveSettings:!0,skipDOMAttach:!!r}));s=e.element;h=this._ltm;n.options.locked()||f.isInBlockingLoadingState(!0);s.data(ot.CompositionInstanceDataName,this);h.registerForDispose(s.setEvents(["fxregistermenu",function(n,t){u._menu=t},]));this._loadedMarker=fx.getTimestamp();this._readyMarker=fx.getTimestamp();this._revealedMarker=fx.getTimestamp();this.unrecoverableErrorMessage&&this.unrecoverableErrorMessage.length>0?(this._partDefinitionDeferred.reject(this.unrecoverableErrorMessage),this._createErrorPart(ui.UnrecoverableError,this.unrecoverableErrorMessage)):(this._locateDefinitionAndStartCompose(h,f),this._perfData.srcExtension=ve(this,l),this._perfData.resourceId=this.assetId(),c=this.createChildLifetime(),n.options.locked.subscribeAndRun(c,(function(n){lt.composeShellCommands(c,u,f.commands,u._showShellCommands=!n,u.diContainer)})))},tt.prototype.createTileViewModel=function(n){var t=new it.ViewModel(this.id,this.widgetState());return t.inLockedContext=n,t.size()===undefined&&t.size(this.initialSize),this.initialSize===99&&(t.gridWidth(Math.max(1,this.initialWidth)),t.gridHeight(Math.max(1,this.initialHeight))),t},tt.prototype.generateBindings=function(n){var t=this;return Q.all([this._finder.locateAsync(this.locator).then((function(n){return t._processLocatedDefinitionAsync(n)})),vr(),]).then((function(i){var r=i[0],u=i[1];if(!n.isDisposed()&&r)return t._generateAndSaveBindings(r)}))},tt.prototype._locateDefinitionAndStartCompose=function(n,t){var i=this,u=li(),r,f=vr();return this._finder.locateAsync(this.locator).then((function(n){return i._perfData.instanceExtensionLoad=u(),r=li(),i._processLocatedDefinitionAsync(n)})).then((function(n){return f.then((function(){return n}))})).then((function(u){if(!n.isDisposed())if(i._perfData.referenceExtensionLoad=r(),u)if(i._generateAndSaveBindings(u),i.partDefinition=u,i._partDefinitionDeferred.resolve(u),pe(i,i._finder))i._createErrorPart(ui.CustomPartWithMissingTemplate,s.UiCompositionPart.missingTemplateMessage);else return i._composeCommandsAndPart(t,i._partContainer);else i._createErrorPart(ui.PartDefinitionNotFound,"Unable to find the definition for the part. Locator: "+i.locator+".")})).then((function(){n.isDisposed()||i._contentInitializing.fxAwaitAndRun(n,(function(n){return!n})).then((function(){i._part&&i._vm.container.width.subscribeAndRun(n,i._part.onSizeChange)}))})).catch((function(t){i._partDefinitionDeferred.reject(t);n.isDisposed()||i._createErrorPart(ui.ErrorLocatingPartDefinition,t)}))},tt.prototype.getInstanceBindings=function(){var n=this._partInstanceDefinition;if(n)return n.inline?n.inline.bindings:n.reference.bindings},tt.prototype._generateAndSaveBindings=function(n){var t,r,i;if(this._isRestoredPartLackingBinding(n))if(this.eligibleForBinding)this._bindingsInitialized=!1,this.bindings=[];else if(!n.canUseOldInputVersions){ri.warning("[Definition Change] Bindings for part '"+this+"' have been changed in the definition in an incompatible way.");this._createErrorPart(ui.OldInputsNotHandled,"Bindings for part have been changed in the definition in an incompatible way. Locator: "+this.locator+".");return}if(t=this.adapter,this._restoredFromJson&&this._bindingsInitialized!==!1){var u=t?t.bindings:this.bindings,f=t?t.inputDefinitions:n.inputDefinitions,e=eu(),o=e.inferInitialBindingsForInputDefinitions(this,f),s=o.filter((function(n){return u.every((function(t){return t.targetProperty!==n.targetProperty}))}));return[].push.apply(u,s),u}return t?t.bindings=this._constructAdaptedBindings():this._setBindings(n),this.assetInstanceDefinition={assetType:n.assetType,assetIdInputProperty:n.assetIdInputProperty},t&&((t.assetType||t.adaptedPart.assetType)&&(this.assetInstanceDefinition.assetType=t.assetType||t.adaptedPart.assetType),t.assetIdInputProperty&&(this.assetInstanceDefinition.assetIdInputProperty=t.assetIdInputProperty)),r=this._partInstanceDefinition,i=r&&r.reference,i&&i.assetType&&(this.assetInstanceDefinition.assetType=i.assetType),this._bindingsInitialized=!0,this.save(),t?t.bindings:this.bindings},tt.prototype._setBindings=function(n){var r=this.getInstanceBindings(),t=ye(r,n.bindings),i;ue(this,t)&&(this.bindings=this.bindings.concat(cr(t,this)));this.bindings.length<=0&&this.locator.type===6&&(i=eu(),this.bindings=this.bindings.concat(i.inferInitialBindingsForInputDefinitions(this,n.inputDefinitions)))},tt.prototype._constructAdaptedBindings=function(){var n=this.adapter,t;return n.bindings.length<=0&&this.locator.type===6?(t=eu(),t.inferInitialBindingsForInputDefinitions(this,n.inputDefinitions)):cr(n.adaptedPart.bindings,this)},tt.prototype._isRestoredPartLackingBinding=function(n){if(this._restoredFromJson){var t=this.adapter,i=t?this._constructAdaptedBindings():cr(n.bindings||[],this),r=t?t.bindings:this.bindings,u=function(n){return!n.optional&&MsPortalFx.findIndex(r,(function(t){return t.targetProperty===n.targetProperty}))<0};return!!i.some(u)}return!1},tt.prototype._getActions=function(){var t=this.diContainer,n=[];return this.getCompositionType()===vi.StartboardPart&&n.push(new ut.UnpinFromStartboard(this,t).createAction(this)),n.push(new ut.OpenContextMenu(this,t,s.ContextMenu.ariaLabel).createAction(this)),n},tt.prototype.resetLayout=function(){var n=this.initialSize,r=pt.AllSizes[n>=0?n:pt.getDefaultSize().name],t=r.size,i=this.widget;i.element.trigger("fxsizechange",[i.options.id,t.width,t.height])},tt.prototype.clearIdentitySettings=function(){var n=this._partSettingsManager;n&&n.clearIdentityPartSettings()},tt.prototype._processLocatedDefinitionAsync=function(n){var f=this,u=this._finder,r=n,t,i;switch(this.locator.type){case 5:case 7:this._partInstanceDefinition=n;break;case 6:t=n;t&&t.reference&&(this._partInstanceDefinition={reference:{partTypeName:t.name,bindings:t.bindings,assetType:t.assetType,initialSize:t.initialSize}})}if(i=this._partInstanceDefinition,i){if(i.reference){var e=i.reference.extension||this.locator.getExtensionName(),o=di(e),s=o.withPartType(i.reference.partTypeName);return u.locateAsync(o).then((function(n){return f._setExtension(n),u.locateAsync(s)})).then((function(n){return n&&n.reference?f._processAdapterAsync(n,e):n}))}r=i.inline}return this.initialSize===99&&(this.initialWidth=r.initialWidth,this.initialHeight=r.initialHeight),this._setExtension(u.locate(this.locator.getExtensionLocator())),Promise.resolve(r)},tt.prototype._processAdapterAsync=function(n,t){var i=this,r=di(n.reference.extension||t),f=r.withPartType(n.reference.partTypeName),u=this._finder;return u.locateAsync(r).then((function(t){var e=i+" (AdapterPart. Extension: "+i.extension.name+", ViewModel: "+n.viewModel+")",r;return i.adapter={extension:i.extension,viewModel:null,viewModelLocator:n.viewModelLocator,viewModelName:n.viewModel,viewModelId:e,bindings:i._adapterBindings||[],inputDefinitions:n.inputDefinitions,adaptedPart:i._partInstanceDefinition.reference,allInputsSet:ko.observable(!1),calledOnInputsSet:ko.observable(!1),failedOnInputsSet:ko.observable(!1),inputPropertyBindings:new hu(e,{},!1),assetType:n.assetType,assetIdInputProperty:n.assetIdInputProperty},i._partInstanceDefinition={name:i._partInstanceDefinition.name,reference:n.reference},r=i.adapter.adaptedPart.assetType,r&&(i._partInstanceDefinition.reference.assetType=r),i._setExtension(t),u.locateAsync(f)})).then((function(r){if(r&&r.reference){var u="Error processing the part defintion for part '{0}'. Adapted part definition '{0}:{1}' cannot reference another adapted part definition '{2}:{3}'.".format(i,i.adapter.extension.name,n.reference.partTypeName,r.reference.extension||t,r.reference.partTypeName);ri.error(u);throw FxImpl.createError(u);}else return i._setBindings(r),i.extension.name==="HubsExtension"&&r.name==="MonitorChartPart"&&i.bindings.forEach((function(n){n.optional=!0})),r}))},tt.prototype.getTitle=function(){var t=this.getViewModel(),n;return t&&(n=t.container,n)?n.partTitle&&n.partTitle()||"":""},tt.prototype.disableForAssetDeleted=function(n,t){var r,i,u,f;this._disabled=!0;r=this._vm;r&&r.container&&this._vm.container.notFoundMessage({message:af.deletedTitle});i=this.widget;i&&i.options&&(u=i.options.commands,f=u.splice(0,u.length,new ut.UnpinFromStartboard(this,this.diContainer)),f.forEach(MsPortalFx.disposeDisposable));this.save();ri.warning("Part '{0}' disabled because asset was deleted. {1}".format(this,t))},tt.prototype._composeCommandsAndPart=function(n,t){var i=this;return lt.composeCommands(n.commands,this).then((function(){i._composePart(t,n);i._attachEventHandlers(t)}))},tt.prototype._attachEventHandlers=function(n){var t=this,i=function(n,i){t.widgetState(i);t.save();n.stopPropagation()},r=function(i,r){var u=t.widget.options,f=!!er.InternalPartSize[r];r=f?r:u.size();fu(t._vm,n,u,r,f,t.partDefinition);t.widgetState(t.widget.saveViewSettings())},u=function(n,i){t._handleRightClick(n,i)},f=function(n,i){i.masterPartId=t.id},e=function(n,i){n.stopPropagation();var r=t.locator.getExtensionLocator();t.diContainer.get(kt.PinTilesPortalFunc).invoke({partReferences:i.partReferences,originExtension:r.name,notify:!0},pi)};this.resourceLTM().registerForDispose(this.widget.element.setEvents([rt.Widget.viewSettingsChanged,i],["fxsizechanged",r],["rightclick",u],["fxensurebladevisible",f],[h.fxpinmultipleparts,e]))},tt.prototype._getPartContext=function(){var n=si(this)||{},t=this.getPartsContainer(),i=!MsPortalFx.isEmpty(n),r=t&&t.getCompositionType()===vi.Startboard;return{id:bi(this.locator),instanceId:this.instanceId,bladeId:bi(n.locator),bladeInstanceId:n.instanceId,onBlade:i,onStartBoard:r,bladeCustomized:!1}},tt.prototype._getPartViewModelAsync=function(n,t,i,u,e,o,s){var h=this,c=this.parent&&this.getPartsContainer(),a=kf(this,c,this._journey||this.diContainer.get(ft.JourneyManager).activeJourney()),y=ht.needContainerSelectable(this.partDefinition.details),p=li(),l,v;return hi.provideContext((function(){h._creationState=hi.getState()}),ou.Part,this._getPartContext()),l=o&&function(n){n&&!n.chrome&&n.content()&&o(n)},v=MsPortalFx.tryImmediateResolve(ci(this)?MsPortalFx.tryImmediateResolve(si(this).tryGetVirtualPartViewModel(),(function(n){return n&&l&&l(n),n})):Q(null),(function(r){var v,p;if(h._getPartViewModelCalledDeferred.resolve(),r)return r;var o=ru(h),u=c&&c.bladeDefinition,w=ii.getViewModelType(ci(h)&&u),f;return f=c&&c.flags&1?1:0,f|=wu(h)?2:0,f|=a?4:0,v=si(h),p=!yr(h.partDefinition)&&df(s,{partLocation:o,blade:v,journeyWidget:ni.getPortalViewModel(h.diContainer).panorama.getJourneyWidget(),inMenuBlade:!!a}),hi.usingState((function(){return h._viewModelManager.getPartViewModel((u===null||u===void 0?void 0:u.attributes)&4?"Microsoft_Azure_CreateUIDef":h.extension.name,n,w,{createSelectable:y,partSize:t,contentSize:p,partLocation:o,collapsed:i,onInputsSetParameters:e,onViewModelAcquired:l,locator:h.locator,flags:f,menuId:c&&c.defaultMenuItemId})}),h._creationState)})),v.then(this._earlyVmDeferred.resolve,this._earlyVmDeferred.reject),v.then((function(n){var u,i,e,t,c;return n&&n.chrome?(i=MsPortalFx.cloneAndRebindFunctions(n),i.content=ko.observable(r.markAsV2(n.chrome)),u=n.content.fxAwaitAndRun(h).then((function(){return o&&o(n),n})),h._setupLoadingReactor(s,n.container.operations)):u=Q.resolve(i=n),ci(h)&&(e=si(h),e.setViewModelForTemplateOrMenuBlade(i),e.setInputsSetPromise(Q(h._allOnInputsSet))),t=n&&pr(n.container),t&&(t.requestOpenBlade((function(n,t){return __awaiter(h,void 0,void 0,(function(){var i;return __generator(this,(function(r){switch(r.label){case 0:return[4,this.diContainer.getAsync(f.get("MsPortalImpl/UI/UI.BladeOpenerImpl","BladeOpener"))];case 1:return i=r.sent(),[2,i.requestOpenBlade(n,undefined,t)]}}))}))})),t.closeBlade(bf(h)),t.menu(a),t.openDialog((function(t,i){return f.get("MsPortalImpl/UI/Compositions/UI.Composition.Part.Dialog","openDialog").then((function(r){return r(h,n,t,i,h._contentInitializing,si(h),wu(h))}))})),t.setFocus((function(n){return h._contentInitializing.fxAwaitAndRun(h,(function(n){return n===!1})).then((function(){return h._part.setFocus(n)}))})),t.print((function(){var n=si(h).containerWidget;h.diContainer.get(b.PrintHandler).printBlade(n.element[0],{name:n.getContentWidget().options.getTelemetryName(),source:"ExtensionCall",menuBladeCtx:n.options.isMenuBlade.peek()?n.options.getTelemetryName():null})})),t.executeInCloudShell((function(n){return __awaiter(h,void 0,void 0,(function(){var r,t,i,u,e,o;return __generator(this,(function(s){switch(s.label){case 0:if(r=si(this).containerWidget,t=r.getContentWidget().options.getTelemetryName(),i=function(i){var u=n.command,r;r=Array.isArray(u)?u:[u];r=r.map((function(n){return n.name}));br.trace({source:t,action:"ProgrammaticOpenCloudShell",actionModifier:"Failed",name:JSON.stringify(r),data:{type:n.cliType,numberOfCommands:r.length,commandNames:JSON.stringify(r),error:i}})},u=MsPortalFx.isFeatureEnabled("azureconsole"),!u)return i(),[2,!1];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.diContainer.getAsync(f.get("MsPortalImpl/UI/UI.AzureConsole","AzureConsole"))];case 2:return e=s.sent(),[2,e.executeInCloudShell(n,t)];case 3:return o=s.sent(),i(o),[2,!1];case 4:return[2]}}))}))})),t.toggleFullScreen((function(){h.diContainer.get(k.FullScreenMode).toggle()})),t.openHelpPane((function(){return __awaiter(h,void 0,void 0,(function(){var n;return __generator(this,(function(t){switch(t.label){case 0:return[4,this.diContainer.getAsync(f.get("MsPortalImpl/UI/UI.HelpPane","HelpPane"))];case 1:return n=t.sent(),n.open(),[2]}}))}))}))),n&&n.container&&n.container._msPortalFxAnnounce((function(n){c||(c=new w.PortalReader(h._ltm,{idPrefix:h.locator.name}));c.read(n)})),u})).then((function(n){var r=h._finder,t=r.locate(h.locator),f=li(),i=n&&n.content();return e&&fi.notifyOnInputsSetCalled(u,e,n&&n.onInputsSetPromise&&Q(n.onInputsSetPromise)),t&&t.reference&&(t.reference.extenderViewModelLocator||t.reference.extenderViewModel)?(h._extenderVMExtn=r.locate(h.locator.getExtensionLocator(),h.extension.name),h._viewModelManager.getViewModel(h._extenderVMExtn.name,t.reference.extenderViewModelLocator||t.reference.extenderViewModel,9).then((function(r){var u=t.reference.extenderViewModelLocator?t.reference.extenderViewModelLocator.name:t.reference.extenderViewModel;return r&&r.content()?i&&ko.isObservable(i.extenderViewModel)?(h._extenderVM=r,i.extenderViewModel(r.content())):ri.error("Part '"+h+"' defines extender view model '"+u+"' but the referenced part is not marked as extensible."):ri.error("Extender view model '"+u+"' for part '"+h+"' must be an object."),n})).finally((function(){h._perfData.extenderViewModelLoad=f()}))):n})).finally((function(){h._perfData.partViewModelLoad=p()}))},tt.prototype._getAdapterViewModelAsync=function(){var n=this;if(!this.adapter)return Q(null);nf(this);var i=lr(this._getAdapterAllInputsSetWatcherConfig()),r=fi.loadOnInputsSetParameters(i),t=this.adapter;return r.then((function(r){n._earlyAdapterOnInputsSet=!!r;n._perfData.earlyOnInputsSetAdapter=n._earlyAdapterOnInputsSet;var u=li();return n._viewModelManager.getViewModel(t.extension.name,t.viewModelLocator||t.viewModelName,10,{onInputsSetParameters:r}).then((function(n){return t.viewModel=n,r&&fi.notifyOnInputsSetCalled(i,r,n&&n.onInputsSetPromise),i})).finally((function(){n._perfData.adapterViewModelLoad=u()}))}))},tt.prototype._bindAssetNameFromAdapter=function(){var r=this,t=this.adapter,n,i;t&&(n=ei(t.viewModel,"content.assetName"),n.exists)&&(ko.isObservable(n.value)?(i=n.value,ko.computed(this,(function(){var t=i(),n=r._vm;!or(t)&&n&&n.container&&wt.setModelValue(n,"container.assetName",t)}))):ri.error("Failed to bind the asset name from the adapter view model for Part '{0}', because the asset name needs to be an observable.".format(t.viewModelId)))},tt.prototype._composePart=function(n,i){var u=this,l,a;if(!this.isDisposed()){var v=this.locator,f=this.partDefinition,b=f.partKind,o=d.getPartFactory(this._finder,v,f),e,h,y;if(o){f.resizeMode!==1?i.supportedSizes(o.supportedSizes):i.supportedSizes([]);this._inputBindings=null;this.getInputPropertyBindings();var p=this._getAdapterViewModelAsync(),c=this._finder.locate(v),k=c&&c.reference&&c.reference.extenderViewModel,w=this.bindings||[],g=w.some((function(n){return n.source&&n.source.scope===ai.DetailsContainer})),nt=this.adapter&&w.some((function(n){return n.source&&n.source.modelType===wi}));k||g?h=Q(null):(l=function(){return u.isDisposed()?Q(null):(u._registerInputPropertyBindings(),e=lr(u._getAllInputsSetWatcherConfig()),fi.loadOnInputsSetParameters(e))},h=nt?p.then(l):l());h=oe(h);this._vmPromise=MsPortalFx.tryImmediateResolve(h,(function(n){var t,r,f;return u.isDisposed()?(u._releaseResources(),Q.reject(new yi)):(u._earlyOnInputsSet=!!n,u._perfData.earlyOnInputsSetPart=u._earlyOnInputsSet,t=u.partDefinition,r=t.partKind===oi.ResourceSummary?u._getSummaryPartViewModelState():null,a=i?i.size():u.initialSize,f=u._getPartViewModelAsync(t.viewModelLocator||t.viewModel,a,r,e,n,e&&function(n){return u._setupInvocationProperties(o.viewStateProperties,n)},i).then((function(n){return lt.composePartCommands(i.commands,u.resourceLTM(),u).then((function(){return n}))})),Q.all([f,p]))})).spread((function(h,c){var l=li();if(u.setViewModel(h),ko.reactor(u,(function(){var n=u._vm.content()&&u._vm.onInputsSetPromiseState();n&&(u._perfData.onInputsSetPromiseState=n.state,u._perfData.onInputsSetPromiseType=t.OnInputsSetPromiseType[n.type])})),u.isDisposed())return u._releaseResources(),Q.reject(new yi);if(h){if(!u.isDisabled){u._bindAssetNameFromAdapter();u.resourceLTM().registerForDispose(u.widget.element.setEvents(["fxportalcontrolloadfailed",function(n,t){u._createErrorPart(ui.ErrorLoadingControl,t)},]));f.partKind===oi.ResourceSummary&&u._autoOpenSettingsFromSummary();var v=i?i.size():u.initialSize,y=v!==a,p=f.partKind===oi.Provisioning;fu(u._vm,n,i,v,y,u.partDefinition);r.isV2(h.content())||u._setupLoadingReactor(i,h.container.operations);i.userResizable(u.getCompositionType()===vi.StartboardPart&&f.resizeMode===2);y?u.extension.processMessages().finally((function(){u.isDisposed()||u._setupPartWidget(n,o,e,c,p,l)})):u._setupPartWidget(n,o,e,c,p,l)}}else u._createErrorPart(ui.ViewModelMissing,s.UiCompositionPart.viewModelRequired)})).catch((function(n){if(u.isDisposed()||MsPortalFx.Errors.isInstanceOfErrorType(n,MsPortalFx.Errors.CanceledError))return Q.reject(new yi);u._createErrorPart(ui.ErrorAcquiringViewModel,n)}))}else y="Incorrect part type '{0}'.".format(b),this._createErrorPart(ui.IncorrectPartType,y)}},tt.prototype._setupPartWidget=function(n,t,i,r,u,f){var e=this,o=this.widget,s=this.getViewModel(),h;this._perfData.prepareViewModel=f();h=li();v.setSelectableContext(this,s,n);MsPortalFx.tryImmediateResolve(this._createPartWidget(t,s,u),(function(){var f,u,c;if(e.isDisposed())return Q.reject(new yi);if(fu(s,n,o.options,o.options.size(),!1,e.partDefinition),e.register(t.viewStateProperties,i,r),fe(e),e._ensureAssetAffinity(),e._perfData.finalizePartCompose=h(),f=e.partDefinition,f.resizeMode===1){if(u=e.extension&&e.extension.name,u!=="AppInsightsExtension"&&u!=="SamplesExtension")return;c=pr(e._vm.container);c.resize.subscribe(e,(function(n){if(n&&n.width&&n.height){var t=pt.getGridPixelSize(n.width,n.height);e.widget.element.trigger("fxsizechange",[o.options.id,t.width,t.height])}}))}}),(function(n){e._createErrorPart(ui.ErrorCreatingWidget,n)}))},tt.prototype.register=function(t,i,r){var u=this,e=this.parent&&this.getPartsContainer(),o,s,f;this._removeOutputArgumentValuesFromContainerModel();(this.bindings||[]).forEach((function(n){var t=n.source.modelType;u._hasRebindableInputs||n.source.scope!==ai.CurrentContainer||t!==1&&t!==wi&&t!==rr||(u._hasRebindableInputs=!0)}));this._listenForPartMutation();this.adapter&&!r&&nf(this);i||(this._registerInputPropertyBindings(),this._setupInvocationProperties(t,this._vm));this._partSettingsManager.configureInstanceProperties(this._viewStateProperties);this._partSettingsManager.initialize();yr(this.partDefinition)||ir(this,"./UI.Composition.SelectableRegistration",(function(n){n.listenForRegistrationChanges(u,u._vm,u)}),n);ae(this,(function(n){n.registerSelectables(u,u._vm,u,!yr(u.partDefinition))}));o=this.getInputPropertyBindings();this._setupBladeRebindingHandlers(e);s=li();this.save();i||(i=lr(this._getAllInputsSetWatcherConfig()));i.bindableTarget.viewModel=this._vm;this._setContainerInputsChanging=function(n,t){if(n)fi.turnOnInputsSetSuppressionOn(i);else return t?fi.turnOnInputsSetSuppressionOff(i,t):fi.turnOnInputsSetSuppressionOff(i)};fi.setupAllInputsSetWatcherFromExtendedConfig(i);this.adapter&&(r||(r=lr(this._getAdapterAllInputsSetWatcherConfig())),r.bindableTarget.viewModel=this.adapter.viewModel,fi.setupAllInputsSetWatcherFromExtendedConfig(r));vr().then((function(n){n.listenForConfigurationChanges(u,r,i)}));f=function(){u._finishCompose(e,o,s)};ci(this)||we(this.locator)?f():this.extension.processMessages().finally(f)},tt.prototype._finishCompose=function(n,t,i){var r=this,u,e,f;this.isDisabled||this.isDisposed()||(n&&n.notifyPartComposed(this),this._registrationDeferred.resolve(),u=[t.awaitAllBound],this.adapter&&u.push(this.adapter.inputPropertyBindings.awaitAllBound),e=i(),f=this._allInputPropertyBindingsBound,Q.all(u).then((function(){var n=r._perfData;f.resolve();n.allInputBindingsBoundPreprocess=e;n.allInputBindingsBound=i();r._loadedMarker&&(r.adapter&&$.extend(n,{innerPart:{extension:r.extension.name,name:r.partDefinition.name}}),r.compositionTime=fx.getTimestamp()-r._loadedMarker,r._loadedMarker=null)})).catch((function(){f.reject()})),this.save())},tt.prototype._registerInputPropertyBindings=function(){var n=this,i=[],r=[],u=[],t;this._journey=this.diContainer.get(ft.JourneyManager).activeJourney();(this.bindings||[]).forEach((function(n){n.source.scope===ai.DetailsContainer?u.push(n):r.push(n);n.isIdentityInput&&i.push(n.targetProperty)}));this._partSettingsManager.configure(this._getPartSettingsManagerConfig(i,this._viewStateProperties));t=this.getInputPropertyBindings();hr(this.diContainer,this,t,u);hr(this.diContainer,this,t,r,(function(t){return n.adapter?n.adapter?n.bindAdaptedInput(t):void 0:n.bindAgainstOverridesOrContainerModel(t)}));this._setEditScope();this._setupJourneyEditScopeReactor()},tt.prototype.bindAdaptedInput=function(n){var t=n.source,i=t&&t.modelType;switch(i){case wi:return{sourceModel:this.adapter.viewModel,sourceModelName:this+"-[Adapter]"};case rr:return{sourceModel:this.adapter.inputPropertyBindings.targetModel,sourceModelName:this+"-[AdapterInputs]"}}},tt.prototype.getNonDetailsContainerPropertyBindings=function(n){n===void 0&&(n=!0);var t=this.adapter,i=n&&t?t.inputPropertyBindings:this.getInputPropertyBindings();return i.properties.filter((function(n){var t=n.compositionBindingDefinition,i=t&&t.source&&t.source.scope;return i!==ai.DetailsContainer}))},tt.prototype.bindAgainstOverridesOrContainerModel=function(n){var t,r,i,u;if(n.source.id!==this.id){if(wt.isDynamicBindingWithNonLocalSource(n))return null;if(t=n.source.property,r=this.overridesModel,ei(r,t).exists)return{overridesConstantBindings:!0,sourceModelName:this+"-[OverridesModel]",sourceModel:r};if(i=this.containerModel,i&&ei(i,t).exists)return{sourceModelName:this+"-[ContainerModel]",sourceModel:i};if(wt.isOverridesOrContainerModelSourceReference(n.source))return u={},wt.setModelValue(u,t,undefined),{sourceModelName:this+"-[Inferred]",sourceModel:u}}},tt.prototype._setupInvocationProperties=function(n,t){var i=this,r=this.partDefinition,f,u;(this._vm=t,!this._vm||this.isDisposed()||this.isDisabled)||(this._setViewStateProperties(r.viewStateProperties,n),f=se(),u=this.diContainer.createChildContainer("composition"),u.set(ht.OpenerConfiguration,this._getBladeOpenerConfig()),this.setBladeOpener(u.get(f.BladeOpener)),this.registerForDispose((function(){return u.disposeAsync()})),ie(this,this.partDefinition,this._restoredFromJson)&&r.details&&r.details.length&&(r.details.forEach((function(n){re(i,n)&&i._registerInvocationProperty(n)})),this.resourceLTM().registerForDispose(this.widget.element.setEvents(["fxopeninnewtab",function(n,t){var r=t.selectable,u=ht.getAssociatedDetailDefinition(r||t.selectableSet,i.getViewModel(),i.partDefinition),f,e;u&&(f=r?r.selectedValue():lt.createSelection(t.selectableSet,t.item),e=Q(f).then((function(n){var t=i._bladeOpener.createBladeModelForSelectedItem(u,n),r=t&&t.locator;return r?a.getBladeDeepLink(r.getExtensionName(),r.name,t.model,{baseUri:lu.location.href}):null})),i.diContainer.get(et.WindowManager).openWindow(e))}]))))},tt.prototype.getSelectableAsync=function(n){return Q(this.getViewModelAsync().then((function(t){var r=typeof n=="string"?n:ht.getSelectablePath(n),i=ei(t,r);if(i.exists)return ko.unwrap(i.value)})))},tt.prototype._getBladeOpenerConfig=function(){var n=this;return{diContainer:this.diContainer,masterModelId:fr(this),masterModel:this.getViewModel(),referenceComposition:this,referenceExtension:this.extension,invocationThrottleDuration:this.invocationThrottleDuration,isBladeOpenedByMaster:function(t){return bu(n,t)},onBladeOpened:MsPortalFx.noop,addOutputBindings:function(t,i){ne(n,t,i)},removeOutputBindings:function(t){te(n,t)},configureBladeDescriptor:function(t){t.masterPartId=n.id;t.bindings&&t.bindings.forEach((function(i){i.source&&i.source.id===n.id&&(t.model[i.targetProperty]=ko.toJS(ei(n._vm,i.source.property).value))}))}}},tt.prototype.loadState=function(n){var i=this;this.partDefinition&&n&&this._vm&&this._vm!==t.EmptyViewModel&&this._viewStateProperties.forEach((function(t){var r=ei(n,t);r.exists&&!t.startsWith("internal.")&&wt.setModelValue(i._vm,t,r.value)}))},tt.prototype._setupLoadingReactor=function(n,t){var r=this,u,i,f;this.partDefinition.partKind!==oi.Provisioning&&(this._frameBlockingUi(ff(this.partDefinition)),this._loadingReactorLifetime=this.createChildLifetime(),ko.reactor(this._loadingReactorLifetime,(function(){var i=t.inProgress();n.hasOngoingOperation(i&&!n.locked());r.triggeringLockedBladeSpinner(i&&n.locked())})),u=ko.computed(this._loadingReactorLifetime,(function(){return t.blockingUi()||r._frameBlockingUi()||r._contentInitializing()})),ci(this)&&(i=si(this),f=ot.getBladeType(i.bladeDefinition),f!==2&&(ko.reactor(this._loadingReactorLifetime,(function(){i.shieldType&&i.shieldType(t.shieldType())})),i.uiBlockers.push(u))),u.subscribe(this._loadingReactorLifetime,(function(i){var f=t.shieldType()===1||n.locked(),u;n.isInBlockingLoadingState(i&&!f);i||(u=n.hasOngoingOperation.value,r._contentRevealed.resolve(u))})),u()||(this._contentRevealed.resolve(t.inProgress()),n.isInBlockingLoadingState(!1)))},tt.prototype._removeOutputArgumentValuesFromContainerModel=function(){var n=this.partDefinition,t=this.containerModel;t&&n&&n.details&&n.details.forEach((function(n){var i=n.outputArguments;i&&i.forEach((function(n){var i=n.valuesFrom;i&&i.forEach((function(n){var i=n.property;ei(t,i).exists&&wt.setModelValue(t,i,undefined)}))}))}))},tt.prototype._getPartSettingsManagerConfig=function(n,t){return{part:this,instanceProperties:t,partViewModelId:fr(this),partStateDefinition:this.partDefinition&&this.partDefinition.partState,identityInputs:n}},tt.prototype._listenForPartMutation=function(){var n=this,u=this.partDefinition,t,r=this._vm.container,i;r.mutate&&!ci(this)&&(i=this.createChildLifetime(),r.mutate.subscribe(i,(function(r){var e=n.locator.getExtensionLocator(),f,o;if(r.partName)t=r.extensionName?di(r.extensionName).withPartType(r.partName):e.withPartType(r.partName);else{if(f=u.assetTypeDefinition,!f){ri.error("Mutate function on part {0} was called with an object but the mutating part doesn't have an asset type definition.".format(n.locator.toString()));return}t=di(e.name).withPartType(f.partName)}o={newPartContainerModel:r.containerModel,invoker:"mutation"};n.diContainer.get(kt.ReplacePartPortalFunc).invoke({part:n,newLocator:t,options:o},pi).catch((function(i){var r="Unable to replace provisioning part '"+n.locator.toString()+"' with the part for the created asset defined by the locator '"+t.toString()+"'\r\n"+i+".";ri.error(r)})).finally((function(){n._disposeEditScope();i.dispose()}))})))},tt.prototype._updateForHasPermissions=function(n){var i=this;return Q(this._vmPromise.then((function(){var u=i._vm,r,f;u===t.EmptyViewModel||i.isDisposed()?ri.warning("Part '{0}' has not retrieved view model when checking permissions.".format(i.locator.toString())):(r=u.container,f=i.widget,n?MsPortalFx.isNullOrUndefined(r.unauthorizedMessage.peek())||r.unauthorizedMessage(null):(f&&f.options.isInBlockingLoadingState(!1),r.unauthorized(),u.updatePartForUnauthorized()))})))},tt.prototype._getAllInputsSetWatcherConfig=function(){var t=this,i=this.widget,r={bindableTarget:{viewModelName:fr(this)},propertyBindings:this.getInputPropertyBindings(),allInputsSet:this.allInputsSet,calledOnInputsSet:this.calledOnInputsSet,failedOnInputsSet:this.failedOnInputsSet,referenceComposition:this,notifyWhenInputsChangeWithSameValues:!0,inputsSetCalled:function(n,r){r.finally((function(){t._onInputsSet.resolve(r.inspect&&r.inspect().value);t._contentRevealed.resolve(!1);t._lastRebindOnInputsSetProperties&&($.isEmptyObject(t._lastRebindOnInputsSetProperties)||ot.deepSubset(n,t._lastRebindOnInputsSetProperties))&&i&&i.options.isInBlockingLoadingState(!1)}))},beforeViewModelPropertyUpdate:function(i){if(t.partDefinition.permissions){var r=li(),u=t.locator.toString();return bt.checkPermissions(t.partDefinition.permissions,hf.All,i,t.partDefinition.assetType,t.extension.name,t.diContainer,u).then((function(i){return t._updateForHasPermissions(i).catch((function(i){t.isDisposed()||MsPortalFx.Errors.isInstanceOfErrorType(i,MsPortalFx.Errors.CanceledError)||o.logToExtension(n,t.widget.element,2,"Part permission check failed. Error: "+MsPortalFx.getLogFriendlyMessage(i))})),i})).finally((function(){t._perfData.checkPermissions=r()}))}return Q(!0)},getInputsMetadata:ru(this)===1&&function(){return MsPortalFx.tryImmediateResolve(vr(),(function(n){var i=n.getConfigurableInputsMetadata(t);return Object.keys(i).forEach((function(n){var t=i[n];(t&&t.bindingSources||[]).forEach((function(n){delete n.sourceReference}))})),i}))},getDashboardFilters:function(){var n=t.parent&&t.getPartsContainer();return n&&n.getFilters?n.getFilters():{}},getPartFilters:function(){return t.filters||{}}};return this.partDefinition&&this.partDefinition.partState&&this._partSettingsManager&&(r.getStateAsync=function(){return Q(t._partSettingsManager.getPartSettingsAsync()).then((function(n){return t._part&&t._part.partSettingFailed(!1),n}),(function(n){return t._part&&t._part.partSettingFailed(!0),FxImpl.QReject("Failed to retrieve part settings for part '"+t+"'.",{innerErrors:n})}))}),r},tt.prototype._getAdapterAllInputsSetWatcherConfig=function(){var n=this.adapter;return{bindableTarget:{viewModelName:n.viewModelId},propertyBindings:n.inputPropertyBindings,allInputsSet:n.allInputsSet,calledOnInputsSet:n.calledOnInputsSet,failedOnInputsSet:n.failedOnInputsSet,referenceComposition:this,notifyWhenInputsChangeWithSameValues:!0}},tt.prototype.notifyDetailBladeClosed=function(n){var i=this,t=function(){var u=n.masterCommandName,t=i._vm.container,r=t&&t.selectable;r&&!or(u)&&r.isCommandSelected(!1)};this.isComposed?t():this.await(7).then(t)},tt.prototype.beforeActivateCommandMenuItems=function(n){n.isControlContextMenu||this._contextMenuViewModels&&(this._contextMenuViewModels.dispose(),this._contextMenuViewModels=null)},tt.prototype._handleRightClick=function(t,i){var r=this,f=i&&i.listData&&i.listData.selectableSet,u;this.isDisabled||this.isDisposed()||(u=f,i.supplyCommands||u&&u._msPortalFxSupplyCommands?ir(this,"./UI.Composition.ContextMenuV2",(function(n){var u={partComposition:r,diContainer:r.diContainer},f=n.OpenContextMenuPipeline.createPipeline(r.diContainer,r,u,r);f.startTask({dataItem:i.viewModel,extension:r.extension,contextMenuArgs:i,evt:t})}),n):this._determineExtensionAndTriggerContextMenu(t,i))},tt.prototype._determineExtensionAndTriggerContextMenu=function(t,i){var r=this,e=this.diContainer,u=this.extension,o=function(n){var t=r._finder.locateAsync(di(n.commandGroupOwner));return t.catch((function(){ri.error("Could not find extension '{0}' for commandGroup {1} from part in extension {2}.".format(n.commandGroupOwner,n.commandGroup,u.name))})),t},f=function(n,u){n.fireContextMenuEvent(r,e,r,u,t,i,r._showShellCommands,r._bladeOpener).then((function(n){r._contextMenuViewModels=n}))};ir(this,"./UI.Composition.ContextMenuContainer.DemandLoad",(function(n){i.commandGroupOwner&&i.commandGroupOwner!==u.name?o(i).then((function(t){f(n,t)})):f(n,u)}),n)},tt.prototype.isSelected=function(){var t=ko.unwrap(this._vm.container).selectable,n=ko.unwrap(t);return n&&ko.unwrap(n.isSelected)},tt.prototype.await=function(n){var t=this;switch(n){case 0:return u.toPromise(this._allContentRevealed);case 1:return u.toPromise(this._partDefinitionDeferred.promise);case 2:return u.toPromise(this._earlyVmDeferred.promise);case 3:return u.toPromise(this._allOnInputsSet);case 5:return u.toPromise(this._getPartViewModelCalledDeferred.promise);case 6:return this.await(1).then((function(){var n=si(t),i=(n===null||n===void 0?void 0:n.bladeDefinition)?ot.getBladeType(n.bladeDefinition):0,r=i===5||i===6;return r?t.await(0):t.await(7)}));case 7:return u.toPromise(this._registrationDeferred.promise)}return y.prototype.await.call(this,n)},tt.prototype._createErrorPart=function(t,i){var u,r,f;if(this.isDisposed())return Q.reject(new yi);u=MsPortalFx.getLogFriendlyMessage(i);this._traceErrorTelemetry(t,typeof i=="string"?i:i&&i.message,i);r=ci(this)&&si(this);f="Error composing "+(r?"blade":"part")+" '"+(r||this)+"'. Details: "+u;t===ui.ErrorAcquiringViewModel||t===ui.ViewModelMissing?o.logToExtension(n,gi(this),2,f):ri.error(f);var l=d.getPartFactory(this._finder,this.locator,{partKind:oi._Internal_Error}),h=ti.composePartViewModel((function(){return{message:s.PartError.titleContent,summaryItems:[{label:s.PartError.errorReason,value:ui[t]}],details:u}})),e=this._savedContainerState,c=h.container;return e&&(c.partTitle(e.partTitle),c.assetName(e.assetName)),this._registrationDeferred.reject(i),r&&r.widget.options.loaded(!0),this._createPartWidget(l,h,!0)},tt.prototype._createPartWidget=function(t,i,r){var u=this,s,h,c;if(this.isDisposed())return Q.reject(new yi);var f=si(this),e=f&&f.bladeDefinition,l={size:this.widget.options.size,locator:this.locator,getDebugId:function(){return fr(u)},traceErrorTelemetry:function(n,t){u._traceErrorTelemetry(ui.TransitionedToErrorState,n,t)},noFxContentPadding:this.partDefinition&&(this.partDefinition.noFxContentPadding||this.partDefinition.isV2),isVirtualPartForTemplateBlade:e&&ot.getBladeType(f.bladeDefinition)===1,getTelemetryContextState:e&&ot.bladeImplementedWithVirtualPart(e)?function(){return f.getTelemetryContextState()}:function(){return u._creationState},partLocation:ru(this),pinnedBladeDeeplink:this.partDefinition&&this.partDefinition.ignorePinnedDeepLink?undefined:this._pinnedBladeDeeplink};return r&&this.widget.options.isInBlockingLoadingState(!1),e&&e.menuBlade&&(s=void 0,e.menuBlade.isV2?(h=i.content().viewModel,s=h&&h._msPortalFxMenu):(h=i.content(),s=h.menu),c=s&&s._msPortalFxData,MsPortalFx.extend(c,{menuDeepLink:f.menuDeepLink})),MsPortalFx.tryImmediateResolve(t.createPart(this._partContainer[0],i,l,this.diContainer,this),(function(t){var s,r,e;if(u.isDisposed())return Q.reject(new yi);u._part=t;r=function(n){n===void 0&&(n=!1);u._frameRevealed.resolve(n);u._frameBlockingUi(!1);n||u._frameInitialized.resolve()};ff(u.partDefinition)&&t.awaitReady?(e=t,e.awaitReady().catch((function(t){var i=f.bladeDefinition?ot.getBladeType(f.bladeDefinition):0;i===2||i===5||i===6?f.logFrameBladeLoadError(t):hi.usingState((function(){sr.trace({extension:gi(u),source:pi,action:"IFramePartReadyTimeout",name:bi(u.locator),data:{details:t},journeyId:u._getTelemetryJourneyId()})}),u._creationState);o.logToExtension(n,u.widget.element,2,"A 'ready' message is expected but not received by '"+u+"'. IFrame should post the 'ready' message to indicate that the IFrame HTML page has loaded and an 'onMessage' handler has been installed to receive subsequent messages. Details: "+MsPortalFx.getLogFriendlyMessage(t))})),e.awaitContentRevealed().then((function(){r(!0)})),e.awaitInitializationComplete().then((function(){r()}))):r();ci(u)||(ko.reactor(u,(function(){var n=i.container.notFoundMessage();u._part.notFoundMessage(n)})),ko.reactor(u,(function(){var n=i.container._msPortalFxHandledError();u._part.handledErrorMessage(n)})));t.setupContent({extensionWindowId:u.extension&&u.extension.name,styleSheets:(s=u.partDefinition)===null||s===void 0?void 0:s.styleSheets}).finally((function(){u._contentInitializing(!1)}));ko.computed(u,(function(){var n=u.parent,t=n&&n.widget,i=t&&t.options.locked();u.widget&&u.widget.options.locked(i);u._part&&u._part.lockedUiContext(i)}))}))},tt.prototype.loadPropertiesFromJson=function(n,t,i,r){i===void 0&&(i=!1);var f=fi.bindingsFromJSON,u=t.partState;this.assetInstanceDefinition=t.assetInstanceDefinition;this.bindings=r?cr(r,this):f(n,t.bindings)||[];this.initialSize=t.initialSize;this._bindingsInitialized=t.bindingsInitialized;this._restoredFromJson=!0;this.loadFromJson(t);this._savedContainerState=t.savedContainerState;this.containerModel=st.createContainerModel(t.containerModel);this.overridesModel=st.createContainerModel(t.overridesModel)||{};this.partState=FxImpl.isSerializedObject(u)?FxImpl.fromSerializableObject(u):u;i&&rf(this.partState);t.originalPartLocator&&(this.previousLocator=tr.fromJSON(n,t.originalPartLocator));this.flags=t.flags||0;this._adapterBindings=f(n,t.adapterBindings)},tt.prototype.calculateInitialSize=function(){var n,h,a,v,i={},c=this._finder,f=this.locator,e=f.type,o,t,r,y,p,l,u,s;e===5||e===7?c.tryLocate(f,i)&&(o=i.value,o&&(t=o.inline,r=o.reference,h=t?t.initialSize:r.initialSize,a=t?t.initialWidth:r.initialWidth,v=t?t.initialHeight:r.initialHeight,t?n=t:(y=di(r.extension||f.getExtensionName()),p=y.withPartType(r.partTypeName),i={},c.tryLocate(p,i)&&(n=i.value)))):e===6?(i={},c.tryLocate(f,i)&&(n=i.value)):ri.error("Unable to create Part composition. Invalid locator type: '{0}'".format(e));this._bindingsInitialized=!1;l=d.getPartSizeOrDefault(n);u=l;er.InternalPartSize[h]?u=h:n&&er.InternalPartSize[n.initialSize]?u=n.initialSize:n&&(s=d.getPartFactory(this._finder,this.locator,n),u=s&&s.defaultSize!==undefined?s.defaultSize:l);this.initialSize=u;this.initialSize===99&&(this.initialWidth=a||n&&n.initialWidth,this.initialHeight=v||n&&n.initialHeight)},tt.prototype.getDiagnosticsData=function(){return $.extend(y.prototype.getDiagnosticsData.call(this),{bindings:fi.mapBindingsToFriendlyObjects(this.bindings)})},tt.prototype._getSummaryPartViewModelState=function(){var n={collapsed:!1};return this.widget.trigger("fxsummarycollapsed",n),n.collapsed},tt.prototype._autoOpenSettingsFromSummary=function(){var n=this,t;this._restoredFromJson||(t=this.getPartsContainer(),Q.all([t.getPermissionPromise(),this.await(7)]).then((function(){var u=ei(n._vm,"content.hasSettings"),i,r,f;u.exists&&ko.unwrap(u.value)&&(i=ei(n._vm,"content.settingsSelectable"),i.exists&&(r=ko.unwrap(i.value),f=n.diContainer.get(at.Finder).findBlades(t),r&&(f||[]).length<=0&&t.canAutoOpenSettings()&&(n.widget.element.trigger("fxautosettings",{masterBladeId:t.instanceId,masterPartId:n.instanceId}),r.isSelected(!0))))})))},tt.prototype._getEditScopeIdFromSettings=function(){var n=this._journey,t=n&&n.ambientSettings.getItem(this.journeyPath),i=t&&t.value,r=i&&i.editScope;return r&&r.editScopeId},tt.prototype._setupJourneyEditScopeReactor=function(){var n=this.partDefinition,t=this._journey;n&&n.editScopeType&&t&&t.observeEditScopeChanges(this,{editScopeId:this.editScopeId,ownerType:this.locator.type,ownerLocatable:this})},tt.prototype._setEditScope=function(){var u=this.partDefinition,t,n,i,f,r;if(u&&u.editScopeType){if(t=this._getEditScopeIdFromSettings(),n=this.editScopeId,t)n(t);else{n(MsPortalFx.getUniqueId());this.diContainer.get(nt.EditScopeManager).onEditScopeCreated(n())}i=this.getInputPropertyBindings();f=i.properties.some((function(n){return n.targetProperty===ki}));f||(r={},r[ki]=n,i.mapProperty(ki,ki).bind(this+"-[EditScopeId]",r,!0))}},tt.prototype._getCommands=function(){if(!this.isComposed||!this.widget)throw new lf("Part '"+this+"' needs to be composed before retrieving its commands.");var n=this.widget;return n.options.commands},tt.prototype._setupPromises=function(){var n=this;this._onInputsSet=Q.defer();this._contentRevealed=Q.defer();this._allOnInputsSet=Q.all([this._onInputsSet.promise,this._frameInitialized.promise]);this._allContentRevealed=Q.all([this._contentRevealed.promise,this._frameRevealed.promise]).spread((function(n){return n}));this._allContentRevealed.then((function(t){return n.contentRevealed=t}))},tt.prototype._setupBladeRebindingHandlers=function(n){var t=this;if(n&&n.onRebind){var i=function(n){var i,r,u,f;if(t._setContainerInputsChanging(!0),t._updateRebindSequenceNumber(),hi.provideContext((function(){t._creationState=hi.getState()}),ou.Part,t._getPartContext()),i=t.editScopeId()&&t.diContainer.get(nt.EditScopeManager).getStateObservable(t.editScopeId()),r=t.widget,t._onInputsSet.reject(new cu("Part binding canceled due to rebinding for part '"+t+"'")),t._contentRevealed.reject(new cu("Part reveal canceled due to rebinding for part '"+t+"'")),t._setupPromises(),t._hasRebindableInputs&&(u=(t.parent.parent||t.parent).widget,!r||u&&u.options.locked()||r.options.isInBlockingLoadingState(!0),t._lastRebindOnInputsSetProperties=dr(n,t.bindings,1,""+t),t._setupAdaptedInputsReboundReactor()),i&&i()===0)t.diContainer.get(nt.EditScopeManager).onEditScopeDisposed(t.editScopeId());t.editScopeId(undefined);t._ensureAdapterAtomicityForBindings();t.bindings.forEach((function(n){if(n.source.scope===ai.DetailsContainer){var i=ei(t._vm,n.targetProperty);i.exists&&wt.setModelValue(t._vm,n.targetProperty,undefined)}}));t._vm.container.unauthorizedMessage.peek()&&t._vm.container.unauthorizedMessage(null);ci(t)?(f=si(t),f.setInputsSetPromise(Q(t._onInputsSet.promise))):t._vm.container.notFoundMessage.peek()&&t._vm.container.notFoundMessage(null)},r=function(){t.isComposed&&(t._setEditScope(),t.partDefinition.partKind===oi.ResourceSummary&&t._autoOpenSettingsFromSummary())},u=function(){t._setContainerInputsChanging(!1)};n.onRebind(i,r,u);this.registerForDispose((function(){n.offRebind(i,r,u)}))}},tt.prototype._ensureAssetAffinity=function(){var t=this,n=this.parent&&this.getPartsContainer(),i=this.assetType,r=n&&n.assetType,u=this._part.inContainerOfSameAsset;if(!n||!r||!i||r!==i||!ko.isObservable(n.assetId))return u(!1);ko.computed(this,(function(){var r=n.assetId(),i=t.assetId(),f=r&&i&&g.compareAssetId(r,i);u(f);t._part.assetId(i)}))},tt.prototype._ensureAdapterAtomicityForBindings=function(){var t=this.adapter,n;t&&(n=[],this.bindings.forEach((function(t){var i=t.source;i.modelType===wi&&n.push(i.property)})),n.forEach((function(n){wt.setModelValue(t.viewModel,n,undefined)})))},tt.prototype._setupAdaptedInputsReboundReactor=function(){var n=this,t=this.adapter;t&&!t.allOutputsReboundComputed&&(t.allOutputsReboundComputed=ko.computed(this,(function(){var r=n.bindings.filter((function(n){var t=n.source.modelType;return t===wi||t===rr})).every((function(t){var i=n.bindAdaptedInput(t).sourceModel,r=ei(i,t.source.property).value;return ko.unwrap(r)!==undefined}));if(r){var i=""+n,u=dr(t.viewModel,n.bindings,wi,i),f=dr(t.inputPropertyBindings.targetModel,n.bindings,rr,i);n._lastRebindOnInputsSetProperties=$.extend(u,f)}})))},tt.prototype._disposeEditScope=function(){var t=this.editScopeId(),n;if(t){this.diContainer.get(nt.EditScopeManager).onEditScopeDisposed(t);n=this._journey;n&&n.ambientSettings.removeItem(this.journeyPath)}},tt.prototype._setViewStateProperties=function(n,t){var f=this,e=n||[],i=t||[],r,u;i=i.filter((function(n){var t=n.split(".");return t.length>1?(t.pop(),typeof ei(f._vm,t.join(".")).value=="object"):!0}));this._viewStateProperties=MsPortalFx.union(e,i);r=this._vm;u=r&&r.container;u&&u.selectable&&(this._viewStateProperties=MsPortalFx.union(this._viewStateProperties,yf))},tt.prototype._registerInvocationProperty=function(n){var i=this,r=this._bladeOpener,t,u=ht.detailsIsPartContainer(n);u&&(t=ko.pureComputed((function(){return!i._vm.container.isSelectable()})));r.registerInvocationProperty(n,t)},tt.prototype._traceErrorTelemetry=function(n,t,i){var r=this,u=__assign(__assign({details:t,resourceId:this.assetId()},i&&i.data||{}),{stack:i&&i.stack});ci(this)?MsPortalFx.tryImmediateResolve(this.diContainer.getAsync(f.get("MsPortalImpl/UI/Compositions/UI.Composition.BladeTelemetry","BladeTelemetry")),(function(t){t.traceBladeLoadErrored(ui[n],u)})):hi.usingState((function(){sr.trace({extension:gi(r),source:pi,action:"PartErrored",actionModifier:ui[n],name:bi(r.locator),data:u,journeyId:r._getTelemetryJourneyId()})}),this._creationState)},tt.prototype._getTelemetryJourneyId=function(){var n=this._journey;return n&&n.id},tt.prototype.recordUserInteraction=function(){},tt.prototype._tracePartTelemetry=function(n,t){var i=gi(this),r=bi(this.locator);sr.trace({source:pi,action:n,extension:i,name:r,journeyId:this._getTelemetryJourneyId(),data:t})},tt})(st.Instance);t.Instance=iu;t.tryGetParentMenuBlade=ku;t.prepareContainerModel=ar;t.getSerializableContainerModel=uu;t.create=du;t.setBladeOpenerModule=he;t.setDynamicPartBinderModule=ce;t.inferredReferenceType=-999;t.createOverridesOrContainerModelSourceReference=le}));
define("MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter",["require","exports"],(function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CompositionAwaiter=void 0;var i=(function(){function n(n,t){this.deferred=Q.defer();this.targetId=n;this.isSource=t}return n})(),r=(function(){function n(n){this._awaitableCompositions=[];this.resolvedCompositions=[];this._trackResolvedCompositions=n}return n.prototype.await=function(n,t){var u=this,r=new i(n&&n.toString(),t),f=MsPortalFx.findIndex(this.resolvedCompositions,(function(n){return t(n)}));if(f>=0)r.deferred.resolve(this.resolvedCompositions[f]);else if(this._awaitableCompositions.push(r),n)n.onDispose((function(){if(Q.isPending(r.deferred.promise)){r.deferred.reject(new MsPortalFx.Errors.DisposedCanceledError);var n=u._awaitableCompositions.indexOf(r);n>=0&&u._awaitableCompositions.splice(n,1)}}));return r.deferred.promise},n.prototype.resolve=function(n){var r=this,t,i;if(this._trackResolvedCompositions){this.resolvedCompositions.push(n);n.onDispose((function(){var t=r.resolvedCompositions.indexOf(n);t>=0&&r.resolvedCompositions.splice(t,1)}))}for(t=this._awaitableCompositions.length-1;t>=0;t--)i=this._awaitableCompositions[t],i.isSource(n)&&(i.deferred.resolve(n),this._awaitableCompositions.splice(t,1))},Object.defineProperty(n.prototype,"waitingCompositions",{get:function(){return this._awaitableCompositions.map((function(n){return n.targetId}))},enumerable:!1,configurable:!0}),n})();t.CompositionAwaiter=r}));
define("MsPortalImpl/UI/Dashboard/FiltersSerialization",["require","exports","Fx/Composition/DashboardFilters","FxInternal/Composition/DashboardFilters"],(function(n,t,i,r){"use strict";function l(n){return ut[typeof n=="number"?n:r.getFilterKindFromId(n)]}function w(n){var t=n&&Object.keys(n);return!t||t.length===0?undefined:t.reduce((function(t,i){var r=l(i);return t[i]={model:r.toJSON(r.fromExtensionModel(n[i]))},t}),{})}function b(n){var t=n&&Object.keys(n);return!t||t.length===0?undefined:t.reduce((function(t,i){var r=l(i),u=r.fromJSON(n[i].model);return t[i]=r.toExtensionModel(MsPortalFx.extend2(u,{selectAllState:undefined})),t}),{})}function k(n){var t={format:n.format?"local":"utc",granularity:a[n.granularity]};return n.relative?t.relative=""+n.relative.duration+v[n.relative.timeUnit]:t.absolute=n.absolute,t}function d(n){function u(n){var r,t,i;return n=n&&n.trim(),n&&n.length>1?(r=n.slice(-1),t=MsPortalFx.findIndex(v,(function(n){return n===r})),t!==-1&&(i=parseInt(n.slice(0,n.length-1)),MsPortalFx.isNumeric(i)))?{duration:i,timeUnit:t}:undefined:void 0}function f(n){var t=MsPortalFx.findIndex(a,(function(t){return t===n}));return t!==-1?t:0}var i={format:n.format==="local"?1:0,granularity:f(n.granularity)},r=n.relative,t;return r?i.relative=u(r):(t=n.absolute,t&&(i.absolute={fromDate:new Date(t.fromDate),toDate:new Date(t.toDate)})),i}function e(n){var t=c[n.operator],i,r;if(y(n))return{operator:t,substring:n.substring};i=n.values;r=n.selectAllState;MsPortalFx.isNumeric(r)||(r=0);switch(r){case 1:return{operator:t,selectAllState:"intermediate",excludedValues:i};case 0:return{operator:t,values:i};case 2:return{operator:t,selectAllState:"all",values:i}}}function o(n){var t=+MsPortalFx.find(Object.keys(c),(function(t){return c[+t]===n.operator})),r,u,i;if(t!==0&&t!==1)return{operator:t,substring:n.substring,selectAllState:0};r=n.values||n.excludedValues;u=n.selectAllState;switch(u){case"all":i=2;break;case"intermediate":i=1;break;default:i=0}return{operator:t,values:r,selectAllState:i}}function p(n){var t=n.operator;return typeof t=="number"&&(t===0||t===1)}function y(n){return!p(n)}function s(n){if(n&&y(n)){var t=n.operator,i=n.substring;return{operator:t,substring:i}}return null}function h(n){if(n&&i.EqualityFilter.isSubstringFilterModel(n)){var t=n.operator,r=n.substring;return{operator:t,substring:r,selectAllState:0}}return null}var u,f,c,a,v;Object.defineProperty(t,"__esModule",{value:!0});t.isSubstringFilterModel=t.isEqualityFilterModel=t.deserializeFilters=t.serializeFilters=t.getFilterProcessor=void 0;c=(u={},u[0]="equals",u[1]="notEquals",u[2]="contains",u[3]="notContains",u[4]="startsWith",u[5]="notStartsWith",u[6]="endsWith",u[7]="notEndsWith",u);t.getFilterProcessor=l;t.serializeFilters=w;t.deserializeFilters=b;a=(function(){var n=[];return n[0]="auto",n[1]="1m",n[2]="5m",n[3]="15m",n[4]="30m",n[5]="1h",n[6]="6h",n[7]="12h",n[8]="1d",n[9]="7d",n[10]="1mo",n})();v=(function(){var n=[];return n[0]="m",n[1]="h",n[2]="d",n[3]="w",n})();t.isEqualityFilterModel=p;t.isSubstringFilterModel=y;var g={fromExtensionModel:function(n){return h(n)||__assign(__assign({},n),{selectAllState:0})},toExtensionModel:function(n){return s(n)||{operator:n.operator,values:n.values}},toJSON:e,fromJSON:o},nt={fromExtensionModel:function(n){return h(n)||{operator:n.operator,values:n.subscriptionIds,selectAllState:0}},toExtensionModel:function(n){return s(n)||{operator:n.operator,subscriptionIds:n.values}},toJSON:e,fromJSON:o},tt={fromExtensionModel:function(n){return h(n)||{operator:n.operator,values:n.locations,selectAllState:0}},toExtensionModel:function(n){return s(n)||{operator:n.operator,locations:n.values}},toJSON:e,fromJSON:o},it={fromExtensionModel:function(n){return h(n)||{operator:n.operator,values:n.resourceGroupIds,selectAllState:0}},toExtensionModel:function(n){return s(n)||{operator:n.operator,resourceGroupIds:n.values}},toJSON:e,fromJSON:o},rt={fromExtensionModel:function(n){return h(n)||{operator:n.operator,values:n.resourceTypes,selectAllState:0}},toExtensionModel:function(n){return s(n)||{operator:n.operator,resourceTypes:n.values}},toJSON:e,fromJSON:o},ut=(f={},f[0]={fromExtensionModel:function(n){return n},toExtensionModel:function(n){return n},toJSON:k,fromJSON:d},f[1]=g,f[2]=nt,f[3]=tt,f[5]=it,f[4]=rt,f)}));
define("MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart",["require","exports","Fx/Composition/DashboardFilters","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/UI/Dashboard/FiltersSerialization","MsPortalImpl/Services/Services.EditScopeManagement","Fx/Composition/Selectable","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/Widgets/Widgets.Portal.init","FxInternal/Composition/Part"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";function g(n){return n.chrome&&n.chrome._msPortalFxV2ShellApi()}function it(n,t,i,r){r=r||{};var f=n.createChildContainer("composition"),u=new d(f,t,null,r);return u.registerForDispose((function(){return f.disposeAsync()})),u.calculateInitialSize(),u.modelContainsSensitiveData=r.modelContainsSensitiveData,u.containerModel=c.prepareContainerModel(i||{}),u.filters=r.filters,u.overridesModel=c.prepareContainerModel(r.overridesModel||{}),u.validateBindings(i)||(k.error("Unable to create instance of startboard part '{0}', check log for errors.".format(t.toString())),u.locator.name="##INVALID##"),r.doNotSaveSettings||u.save(),u}var k,d;Object.defineProperty(t,"__esModule",{value:!0});t.create=t.Instance=t.fxpartfilterschanged=void 0;var rt=MsPortalFx.Base,ut=rt.Diagnostics,nt=MsPortalFx.Parts.PartKind,ft=s.CompositionBinder,tt=window.fx.getTimestamp;t.fxpartfilterschanged="fxpartfilterschanged";k=ut.createLog(n);d=(function(n){function s(t,i,r,u){var f=n.call(this,t,i,r,u&&u.id,null,"StartboardPart",u&&u.pinnedBladeDeeplink)||this;return f.partFilterState=ko.observable(0),f._lastUserInteraction=-2e3,f.containerModel={},f._store=4,f._deepLink=u&&u.pinnedBladeDeeplink,u&&u.duringPortalStartup&&(f._dontLoadFilterUpdatingModule=!0),u&&u.savedContainerState&&(f._savedContainerState=u.savedContainerState),u&&u.partHeader&&(f._partHeader=u.partHeader),f.await(7).then((function(){f._updatePartFilterState(!f._dontLoadFilterUpdatingModule);f._dontLoadFilterUpdatingModule=!1})),f.await(2).then((function(n){g(n)&&n.content.subscribeAndRun(f,(function(){var t=g(n).updateFilters;t&&t((function(n){return f.updateFilters(n)}))}))})),f.await(3).then((function(){var n,t,i;MsPortalFx.isFeatureEnabled(b.partHeaderEnabledFeatureName)&&(n=f.getViewModel().container,n&&(t=n.updatableHeader,i=!!t.options(),(i||n.partTitle())&&(f._updatableHeader=t,f.getPerfData().updatableHeaderEnabledBy=i?"API":"title",i||t.options({disableSubtitleUpdate:!n.assetName()}),f._partHeader&&f._updateHeader(f._partHeader))))})),f}return __extends(s,n),s.prototype.clone=function(){var n=this;return this.cloneAs((function(t,i){var u={overridesModel:i,filters:n.filters,pinnedBladeDeeplink:n._deepLink,savedContainerState:n._savedContainerState},r=it(n.diContainer,n.locator,t,u);return r.defaultMenuItemId=n.defaultMenuItemId,r}))},s.fromJSON=function(n,t,i,f){var e=n.get(r.ExtensionManagerOptions);return c.createCompositionFromJSON(e,t,(function(){var o=n.createChildContainer("composition"),r=new s(o,u.Locator.fromJSON(e,t.locator),t.widgetState,{id:t.id,duringPortalStartup:f,pinnedBladeDeeplink:t.deepLink});return r.registerForDispose((function(){return o.disposeAsync()})),r.loadPropertiesFromJson(e,t,!0,i),r._storedEditScopeId=t.editScopeId,r.defaultMenuItemId=t.defaultMenuItemId,r.containerModel=r.containerModel||{},r.filters=a.deserializeFilters(t.filters),r._partHeader=t.partHeader,r}),(function(i,r){var f=n.createChildContainer("composition"),u=new s(f,i,null,{id:t.id});return u.registerForDispose((function(){return f.disposeAsync()})),u.unrecoverableErrorMessage=r,u}))},s.prototype.getCompositionType=function(){return f.CompositionType.StartboardPart},s.prototype.register=function(t,i,r){var u=this,f,e;n.prototype.register.call(this,t,i,r);f=this._part;e=this.editScopeId();e&&this.partDefinition.partKind===nt.Provisioning&&this.diContainer.get(v.EditScopeManager).getStateObservable(e).subscribe(this,(function(n){var t=n===1||n===2;t&&u.addWidgetToUI({parentElement:u.getPartsContainer().widget})}));f.openPartSettingsBlade=function(n,t){t&&t.stopPropagation();u.openPartSettingsBlade()};this.partFilterState.subscribe(this,(function(n){f.partFilterState(n)}))},s.prototype.toJSON=function(){var t=n.prototype.toJSON.call(this);return t.editScopeId=this.editScopeId(),t.defaultMenuItemId=this.defaultMenuItemId,t.deepLink=this._deepLink,t.filters=a.serializeFilters(this.filters),this._partHeader&&(this._partHeader.title||this._partHeader.subtitle)&&(t.partHeader=this._partHeader),t},s.prototype.validateBindings=function(n){var r=this,t,i;return this.bindings&&this.bindings.length>0?(t=this.bindings.filter((function(n){return n.source.id!==r.id})),i=t.map((function(n){return n.source.property})),ft.modelHasProperties(""+this,i,n)):!0},s.prototype.matchesLocatorAndModel=function(n,t,i,r,u){return!this.locator.equals(t)&&!this._matchesPartReferenceLocator(n,t)?!1:this.defaultMenuItemId!==r||!MsPortalFx.deepEquals(this.filters||{},u||{})?!1:f.deepSubset(this.containerModel,i||{})},s.prototype.addWidgetToUI=function(t){var i=this,u=this.widget,f,r;Promise.all([this.getDashboardFiltering(),this.await(7),]).then((function(n){var t=n[0];i._supportsFiltering=t.supportsFiltering;(i._supportsFiltering||!!i._updatableHeader)&&u.options.commands.push(new l.CustomizeTileData(i,i.diContainer));h.composeShellCommands(i,i,u.options.commands,!0,i.diContainer)}));n.prototype.addWidgetToUI.call(this,t);t.doNotSaveSettings||this.save();f=u.element;r=this._ltm;f&&r&&this.await(1).then((function(n){var e=i._isFramePart=n&&n.partKind===nt.Frame,t,u;e||(t=function(n,t,i){return n.addEventListener(t,i,!0),{dispose:function(){n&&(n.removeEventListener(t,i,!0),n=null)}}},u=function(){var n=w.getPortalViewModel(i.diContainer),t=function(n,t){t.masterPartId===i.id&&i.recordUserInteraction()};return n.customEvents.addHandler(r,"fxbladeclosed",t),{dispose:function(){n.customEvents.removeHandler("fxbladeclosed",t)}}},r.registerForDispose(u()),r.registerForDispose(__spreadArray([],["click","mousedown","keydown"].map((function(n){return t(f[0],n,(function(){return i.recordUserInteraction()}))})))))}))},s.prototype.hasUserInteractedRecently=function(){if(this._isFramePart||this._lastUserInteraction+2e3>tt())return!0;var n=this.diContainer.get(p.JourneyManager).activeJourney(),t=n&&n.children&&n.children[0];return(t&&t.masterPartId)===this.id},s.prototype.save=function(){},s.prototype._forceSave=function(t){n.prototype.save.call(this,t)},s.prototype._getEditScopeIdFromSettings=function(){return this._storedEditScopeId},s.prototype._setupJourneyEditScopeReactor=function(){},s.prototype.getDashboardFiltering=function(){var n=this;return Q(this.await(1)).then((function(t){return{supportsFiltering:t.supportsFiltering,staticFilters:t.filters||[],partApi:Q(n.await(2)).then((function(n){return g(n)}))}}))},s.prototype.overridesFilter=function(n){return Object.keys(this.filters||{}).includes(n)},s.prototype.notifyFiltersChanged=function(n){var t=this;return Q(this.await(7).then((function(){t._setContainerInputsChanging(!0);var i=2|(n?4:0),r=t._setContainerInputsChanging(!1,i),u=t._updatePartFilterState(!t._dontLoadFilterUpdatingModule);return Q.all([r,u])})))},s.prototype._disposeEditScope=function(){var n=this.editScopeId();if(n)this.diContainer.get(v.EditScopeManager).onEditScopeDisposed(n)},s.prototype._getBladeOpenerConfig=function(){var t=this,i=n.prototype._getBladeOpenerConfig.call(this),u=function(){var n=t.diContainer.get(e.Finder).findBlades(t.getPartsContainer());return n&&n.length>0&&n[0]},r=this.diContainer.get(p.JourneyManager),f=i.configureBladeDescriptor;return i.configureBladeDescriptor=function(n){f(n);MsPortalFx.startsWith(n.masterInvocationProperty,"container.")&&(n.defaultMenuItemId=t.defaultMenuItemId)},i.onBladesOpening=function(){t.isDisposed()&&k.error("Cannot open new blades for part '"+t+"', it has already been disposed and removed from the starboard. If this part was created from a Hub action, make sure it doesn't change the target blade after it has been opened.")},i.getCloseOwnedDetailBladesHandler=function(n){var f,e=n&&n.source&&n.source.property,i=u();return i&&i.masterPartId===t.id&&i.masterInvocationProperty===e&&!i.masterCommandName&&(f=function(){var n=r.activeJourney();return n?r.tryDiscardJourney(n.id):r.tryDeactivateJourney()}),f},i.getCloseOtherDetailBladesHandler=function(n){var f,e=n&&n.source&&n.source.property,i=u();return i&&(i.masterPartId!==t.id||i.masterInvocationProperty!==e)&&(f=function(){var n=r.activeJourney();if(n)return n.isStartedWithContextBlade()?r.tryDiscardJourney(n.id):r.tryDeactivateJourney()}),f},i},s.prototype._updatePartFilterState=function(n){var t=this,r=this.parent&&this.getPartsContainer();return r&&r.getDashboardFiltersForPart(this.id,n).then((function(n){var e=t.filters||{},u,f;n=n||{};var o=0,s=Object.keys(e),r=Object.keys(n);if(s.length>0||r.length>0)if(s.length===0)o=r.length===1&&r.includes(i.TimeRangeFilter.filterId)?1:2;else{u=[];for(f in e)n[f]&&!t._deepEquals(e[f],n[f])&&u.push(f);o=u.length===0?r.length>1||!r.includes(i.TimeRangeFilter.filterId)?2:1:u.includes(i.TimeRangeFilter.filterId)&&u.length===1?3:4}t.partFilterState(o)}))},s.prototype._matchesPartReferenceLocator=function(n,t){var f=!1,e={},r,i,o,s;return this.locator.type===7&&n.tryLocate(this.locator,e)&&(r=e.value,i=r&&r.reference,i&&(o=i.extension?u.Locator.forExtension(i.extension):this.locator.getExtensionLocator(),s=o.withPartType(i.partTypeName),f=t.equals(s))),f},s.prototype.updateFilters=function(n){var u=this.parent&&this.getPartsContainer(),t,i,r;return u?(Array.isArray(n)?t=n.reduce((function(n,t){return n[t.filterId]=t.filterModel,n}),{}):n.dashboard||n.part?(t=n.dashboard,i=n.part):t=n,r=!1,i&&(r=this._updatePartFilters(i)),t)?u.updateFilters(this,t):(r&&this.notifyFiltersChanged(!0),Q()):Q.reject(new Error("Only Parts located on Dashboards can call 'updateFilters'"))},s.prototype._updatePartFilters=function(n){for(var r,f,i=MsPortalFx.clone(this.filters||{},!0,!0),e=Object.keys(n),u=0;u<e.length;u++)r=e[u],f=n[r],f?i[r]=f:delete i[r];return MsPortalFx.deepEquals(this.filters,i)?!1:(this.filters=i,this.widget.element.trigger(t.fxpartfilterschanged,{part:this,isUserInteraction:this.hasUserInteractedRecently()}),!0)},s.prototype._getTelemetryJourneyId=function(){return undefined},s.prototype.recordUserInteraction=function(){this._lastUserInteraction=tt()},s.prototype.openPartSettingsBlade=function(){var n=this,i=!!this._updatableHeader,t=i?this._getPartHeader():undefined;this.getViewModel().container.openContextPane(new y.PdlBladeReference("PartSettingsBlade","HubsExtension",{onClosed:function(r,u){var e,f;u&&(n._supportsFiltering&&(e={},Object.keys(u.filters).forEach((function(n){e[n]=u.filters[n]&&a.getFilterProcessor(n).toExtensionModel(u.filters[n])})),n._updatePartFilters(e),n.notifyFiltersChanged(!1)),i&&u.partHeader&&(f=u.partHeader,(f.title!==t.title||f.subtitle!==t.subtitle)&&(n._tracePartTelemetry("PartUpdatableHeaderChanged"),n._updateHeader(f,!0),n.widget.element.trigger("fxpartsettingchanged",{part:n,isUserInteraction:!0}))))},parameters:{partId:this.id,partHeader:t}}))},s.prototype._getPartHeader=function(){var n,t,i=this._partHeader||{},f=i.title,e=i.subtitle,r={title:f},u=(n=this._updatableHeader)===null||n===void 0?void 0:n.options;return u&&((t=u())===null||t===void 0?void 0:t.disableSubtitleUpdate)||(r.subtitle=e||""),r},s.prototype._updateHeader=function(n,t){var r,f=n.title,e=n.subtitle,i=this._getPartHeader(),u;i.title=f;u=this._updatableHeader.options;((r=u())===null||r===void 0?void 0:r.disableSubtitleUpdate)||(i.subtitle=e);this._partHeader=i;this._updatableHeader.updatedHeader(i);t&&this.widget.element.trigger(c.fxpartsettingchanged,{part:this,isUserInteraction:!0})},s.prototype.getConfigureOnAddToDashboardSelectorAsync=function(){return this.getViewModelAsync().then((function(n){var t=o.getModelValue(n,"content.configureOnAddToDashboardSelector");if(t.exists)return ko.unwrap(t.value)}))},s.prototype._deepEquals=function(n,t){var u=this,i,f,r;if(n=ko.unwrap(n),t=ko.unwrap(t),n===t)return!0;if(!n||!t||(i=MsPortalFx.getTypeOf(n),i!==MsPortalFx.getTypeOf(t)))return!1;switch(i){case"array":return f=n,n.length!==t.length?!1:f.every((function(n){for(var r=!1,i=0;i<t.length;){if(u._deepEquals(t[i],n)){r=!0;break}i++}return r}));case"date":return n.getTime()===t.getTime();case"object":return r=Object.keys(n),r.length===MsPortalFx.keysLength(t)&&r.every((function(i){return u._deepEquals(n[i],t[i])}));default:return!1}},s})(c.Instance);t.Instance=d;t.create=it}));
define("MsPortalImpl/Base/Languages",["require","exports","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Services/Services.GeneralSettings"],(function(n,t,i,r){"use strict";function h(n){var t=FxImpl.knownCulturesMap[n];return t?t.localizedName:null}function c(){var n=MsPortalFx.find(t.currentLocaleContext.selectableDisplayLanguages,(function(n){return!MsPortalFx.localeCompareIgnoreCase(n.locale,t.currentLocaleContext.selectedDisplayLanguage)}));return n&&(n.specificCulture||n.locale)||"en-us"}function l(n,t){return n.map((function(n){return t[n]})).filter(MsPortalFx.identity)}function a(n){var t=MsPortalFx.convertArrayToMap(n,(function(n){return n.locale.split("-")[0]}));return o(FxImpl.knownCulturesMap,(function(n,i,r){var u=n.split("-");u.length>1&&!i.neutralCulture&&t[u[0]]&&r.push(i)}),[])}function v(n,t,i){return n?n.split(".")[1]:i}function s(n){var t=n.displayLanguage,i=l(n.selectableLanguages,FxImpl.knownCulturesMap);return{selectableDisplayLanguages:i,selectedDisplayLanguage:t,selectedFormatCulture:v(n.rawLocaleSetting,t,n.formatCulture),selectableFormatCultures:a(i)}}function y(n,o,h,c){var l={requireRedirect:!1,userSettingLocale:undefined,portalQueryLocale:undefined,desiredLocale:undefined,localeFromQuery:undefined},a=o.get(i.StorageService),v=o.get(r.GeneralSettings).rawLocale;return v.subscribeAndRun(n,(function(n){var r=(u.fx.bootParameters.portalQuery||{}).l,i=e(n||r),o=JSON.parse(a.getValue(f,t.redirectQueryKey,0)||"{}");o.l=i;a.setValue(f,"LastUsedLocale",i,0);c||i===e(h)||(l.requireRedirect=!0,l.userSettingLocale=n,l.portalQueryLocale=r,l.desiredLocale=i,l.localeFromQuery=e(h));a.setValue(f,t.redirectQueryKey,JSON.stringify(o),0)})),t.currentLocaleContext=s({selectableLanguages:MsPortalFx.isFeatureEnabled("settingsnolangfilter")?u.fx.environment.supportedLanguages:u.fx.environment.supportedLanguages.filter((function(n){return n!=="qps-ploc"&&n!=="id"})),displayLanguage:FxImpl.Intl.displayLanguage,formatCulture:FxImpl.Intl.formatCulture,rawLocaleSetting:v()}),l}function e(n){var r=MsPortalImpl.sanitizeLanguage(n,u.fx.environment.supportedLanguages),t=r.split("."),i=t[0],f=FxImpl.sanitizeFormatCulture(t[1],i);return i+"."+f}var u,o,f;Object.defineProperty(t,"__esModule",{value:!0});t.initialize=t.currentLocaleContext=t.createLocaleContext=t.getCultureSpecificLanguage=t.getLocalizedName=t.localeDelimiter=t.redirectQueryKey=void 0;u=window;o=MsPortalFx.forEachKey;t.redirectQueryKey="LocaleQuery";t.localeDelimiter=".";f=i.ComponentName.Redirect;t.getLocalizedName=h;t.getCultureSpecificLanguage=c;t.createLocaleContext=s;t.initialize=y}));
define("MsPortalImpl/UI/UI.DashboardFiltersManager",["require","exports","Fx/Composition/DashboardFilters","Fx/ResourceManagement","FxInternal/Composition/DashboardFilters","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Languages","MsPortalImpl/UI/Dashboard/FiltersSerialization","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Services/Services.Subscriptions"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function ft(n){return n.get(h.SubscriptionsUserContext).inSessionSelectedSubscriptions}function a(n,t){var r,i,u;if(!t)return!1;r=!1;switch(n){case 0:i=t;r=i.absolute&&!!i.absolute.fromDate&&!!i.absolute.toDate||i.relative&&MsPortalFx.isNumeric(i.relative.duration)&&MsPortalFx.isNumeric(i.relative.timeUnit);i.absolute&&(r=i.absolute.toDate&&i.absolute.fromDate<i.absolute.toDate);break;case 1:case 2:case 3:case 5:case 4:u=t;r=MsPortalFx.isNumeric(u.operator)}return r}function g(n){var i=n&&n.selectedDisplayLanguage||"",r=n&&n.selectableDisplayLanguages||[],t=MsPortalFx.find(r,(function(n){return!MsPortalFx.localeCompareIgnoreCase(n.locale,i)}));return t&&t.specificCulture||"en-us"}function nt(n){var i=n.filterKind;return t.intrinsicFilterDescriptors[i]?t.intrinsicFilterDescriptors[i].filterId:n.filterId}function it(n,t){var i=k(n,t);return i&&r.ArmId.stringify(i,4)}function k(t,i,u){var e=r.ArmId.parse(t,!0),f;if(e.kind!==4){u||(f=new Error("Invalid resource group id '"+JSON.stringify(t)+"'"),i?s.logToExtension(n,i.widget.element,2,f):d.error(f));return}return e}var tt,c,v,y,p,w,b;Object.defineProperty(t,"__esModule",{value:!0});t.parseResourceGroupId=t.normalizeResourceGroupId=t.ResourceTypeFilterRuntime=t.ResourceGroupFilterRuntime=t.LocationFilterRuntime=t.SubscriptionFilterRuntime=t.EqualityFilterRuntime=t.EqualityFilterRuntimeBase=t.DashboardFiltersManager=t.getStaticFilterId=t.getCultureSpecificLanguage=t.isCompleteFilterModel=t.intrinsicFilterDescriptors=void 0;var l=MsPortalFx.Base,rt=l.Diagnostics,ut=l.Diagnostics.Telemetry,d=rt.createLog(n);t.intrinsicFilterDescriptors=(function(){var n=[{kind:0,filterId:i.TimeRangeFilter.filterId,displayText:f.Filtering.Intrinsics.timeRange},{kind:2,filterId:i.SubscriptionFilter.filterId,displayText:f.Filtering.Intrinsics.subscription},{kind:3,filterId:i.LocationFilter.filterId,displayText:f.Filtering.Intrinsics.location},{kind:5,filterId:i.ResourceGroupFilter.filterId,displayText:f.Filtering.Intrinsics.resourceGroup},{kind:4,filterId:i.ResourceTypeFilter.filterId,displayText:f.Filtering.Intrinsics.resourceType},];return n.reduce((function(n,t){return n[t.kind]=t,n}),[])})();t.isCompleteFilterModel=a;t.getCultureSpecificLanguage=g;t.getStaticFilterId=nt;tt=(function(){function n(n,t){var i=this,u,f,r,o,s,c;this._diContainer=n;this._filtersLocale=ko.observable();this._appliedFilters=ko.observableArray();this._currentSessionLocale=g(e.currentLocaleContext);this._equalityFilterRuntimes=[];this._parent=t;this._filtersLifetime=t.createChildLifetime();u=this._diContainer;f=this._subscriptions={getSelectedSubscriptions:function(){return u.get(h.SubscriptionsUserContext).getInSessionSelectedSubscriptions().then((function(n){return n()}))},selectedSubsUpdateTriggered:ft(u)};this._equalityFilterRuntimes[1]=new v;this._equalityFilterRuntimes[2]=new y(f);this._equalityFilterRuntimes[3]=new p;this._equalityFilterRuntimes[5]=new w(f);this._equalityFilterRuntimes[4]=new b;r=ko.observableArray([]);o=r.mapInto(t,(function(n,t){var r=ko.observable();return l.Promises.cancelOnDispose(i._filtersLifetime,t.getDashboardFiltering&&t.getDashboardFiltering()).then((function(n){n.partApi.then((function(t){r({supportsFiltering:n.supportsFiltering,supportsAddFilter:n.staticFilters.some((function(n){return n.filterKind!==0}))||t&&!!t.getDynamicFilterDefinitions})}))})),r}));t.subscribeChildren((function(n){r(n.map((function(n){return n})))}));this.filtersWidgetViewModel={showDashboardFilteringUi:MsPortalFx.isFeatureEnabled("dashboardautorefresh")?ko.observable(!0):ko.pureComputed((function(){return!!i._appliedFilters().length||o().some((function(n){return n()&&n().supportsFiltering}))})),showAddFilterUi:ko.pureComputed((function(){return o().some((function(n){return n()&&n().supportsAddFilter}))})),appliedFilters:this._appliedFilters,createDashboardFilterViewmodel:function(){return i._createDashboardFilterViewModel({})},getFilterUpdatingApi:function(){return i._getFilterUpdatingApi().then((function(n){return n.filtersWidgetViewModel}))}};r.subscribeArrayBulkChanges(this._parent,(function(n,t){t&&t.length&&t.forEach((function(n){var t=i._appliedFilters.peek();t.forEach((function(t){return MsPortalFx.remove(t.filteredPartIds,n.id)}))}))}));s=ko.pureComputed(r).extend({throttle:100});c=ko.pureComputed(this._appliedFilters).extend({throttle:100});ko.reactor(this._parent,[s,c],(function(n,t){var r=i._isFilterUpdatingModuleLoadingOrLoaded()?i._getFilterUpdatingApi().then((function(n){return n.getAllFilterDescriptors(!0).then((function(n){return n.map((function(n){return n.filterId}))}))})):(function(){var t=[];return Q.allSettled(n.map((function(n){return i._getPartStaticFilters(n).then((function(n){MsPortalFx.pushUnique(t,n)}))}))).then((function(){return t}))})();return r.then((function(n){i._ensureTimeRangeFilter(n);t.forEach((function(t){var i=n.includes(t.id())||t.filteredPartIds&&t.filteredPartIds.length>0;t.isApplicable(i)}))}))}))}return n.prototype.updateFilters=function(n,t){return this._getFilterUpdatingApi().then((function(i){return i.updateFilters(n,t)}))},n.prototype.getFilters=function(){var n=this;return this._appliedFilters.peek().filter((function(n){var t=n.model();return t.selectAllState!==2||t.values&&t.values.length===0})).reduce((function(t,i){var r=i.id(),u=i.model(),f=i.kind();return typeof r=="string"&&a(f,u)&&(t[r]=n.toExtensionModel(f,u)),t}),{})},n.prototype.loadDashboard=function(n){var t,i=this;this.resetFilters();this._filtersLocale(n&&n.filterLocale||this._currentSessionLocale);var r=n&&n.filters||{},f=Object.keys(r),e=function(n,t){return{kind:u.getFilterKindFromId(n),model:o.getFilterProcessor(n).fromJSON(t.model),displayCache:t.displayCache,filteredPartIds:t.filteredPartIds}},s=f.map((function(n){var t=e(n,r[n]),f=t.kind,u;if(a(f,t.model))return u=i._createDashboardFilterViewModel({id:n,model:t.model,kind:f,filterIdDisplayText:t.displayCache.name,filterValueDisplayText:t.displayCache.value,filteredPartIds:t.filteredPartIds}),i._activateFilter(u),u})).filter((function(n){return!!n}));(t=this._appliedFilters).push.apply(t,s);ut.trace({source:"DashboardFilters",action:"DashboardFiltersLoaded",data:{filterIds:f.toString()}})},n.prototype.setFilters=function(n){var t=this,i;this._filtersLifetime||(this._filtersLifetime=this._parent.createChildLifetime());i=Object.keys(n).map((function(i){var r=n[i];return t._createDashboardFilterViewModel({id:i,model:t.fromExtensionModel(r.filterKind,r.filterModel),kind:r.filterKind})}));this._appliedFilters(i)},n.prototype.toJSON=function(){return this._appliedFilters().length?this._getFilterUpdatingApi().then((function(n){return n.toJSON()})):Q({})},n.prototype.getDashboardFiltersForPart=function(n,t){var r=this,i,u;return t||this._isFilterUpdatingModuleLoadingOrLoaded()?this._getFilterUpdatingApi().then((function(t){return t.getDashboardFiltersForPart(n)})):(i=MsPortalFx.find(this._parent.children,(function(t){return t.id===n})),!i)?(u=new Error("Error retrieving dashboard filters for part '{0}'. Part could not be found.".format(n)),d.error(u),Q({})):this._getPartStaticFilters(i).then((function(t){var i=r._appliedFilters.peek().filter((function(i){var r=i.filteredPartIds.includes(n);return r||t.includes(i.id())}));return i.reduce((function(n,t){return n[t.id()]=r.toExtensionModel(t.kind(),t.model()),n}),{})}))},n.prototype.getFilterValues=function(n,t,i){return this._getFilterUpdatingApi().then((function(r){return r.getFilterValues(n,t,i)}))},n.prototype.getFilterIdTextAndOperators=function(n,t){return this._getFilterUpdatingApi().then((function(i){return i.getFilterIdTextAndOperators(n,t)}))},n.prototype.getFilterValueDisplayText=function(n,t,i){return this._getFilterUpdatingApi().then((function(r){return r.getFilterValueDisplayText(n,t,i)}))},n.prototype.getFiltersSupportedByPart=function(n){return this._getFilterUpdatingApi().then((function(t){return t.getFiltersSupportedByPart(n)}))},n.prototype.getFilterWarning=function(n,t){return this._equalityFilterRuntimes[u.getFilterKindFromId(n)].getFilterWarning(t)},n.prototype._createDashboardFilterViewModel=function(n){var t=this._filtersLifetime.createChildLifetime();return{id:ko.observable(n.id),kind:ko.observable(n.kind),kindLifetime:t,model:ko.observable(n.model),isApplicable:ko.observable(!0),filterIdDisplayText:n.filterIdDisplayText,filterValueDisplayText:n.filterValueDisplayText,warningMessage:ko.observable(""),filteredPartIds:n.filteredPartIds||[]}},n.prototype._ensureTimeRangeFilter=function(n){var t=this._appliedFilters.peek(),r=MsPortalFx.find(t,(function(n){return n&&n.kind()===0})),u=n.includes(i.TimeRangeFilter.filterId);!r&&u&&l.Promises.cancelOnDispose(this._filtersLifetime,this._getFilterUpdatingApi()).then((function(n){return n.addTimeRangeFilter()}))},n.prototype.resetFilters=function(){this._filtersLifetime&&this._filtersLifetime.dispose();this._filtersLifetime=this._parent.createChildLifetime();this._appliedFilters([])},n.prototype.dispose=function(){this._filtersLifetime&&this._filtersLifetime.dispose()},n.prototype.toExtensionModel=function(n,t){return o.getFilterProcessor(n).toExtensionModel(MsPortalFx.extend2(t,{selectAllState:undefined}))},n.prototype.fromExtensionModel=function(n,t){return o.getFilterProcessor(n).fromExtensionModel(t)},n.prototype._activateFilter=function(n){var i=n.kind,r=n.kindLifetime,t=i();t!==0&&this._equalityFilterRuntimes[t].activateFilter(r,n)},n.prototype._normalizeEqualityFilterValue=function(n,t){return this._equalityFilterRuntimes[n].normalizeFilterValue(t)},n.prototype._getFilterUpdatingApi=function(){var n=this;return this._filterUpdatingModulePromise||(this._filterUpdatingModulePromise=l.Promises.cancelOnDispose(this._parent,MsPortalFx.require("MsPortalImpl/UI/UI.DashboardFiltersManager.Updating").then((function(t){return n._parent.widget&&n._parent.widget.element.attr("data-filterupdatingloaded",!0),new t.DashboardFiltersUpdatingImpl(n._diContainer,n._parent,{appliedFilters:n._appliedFilters,getDashboardLifetime:function(){return n._filtersLifetime},activateFilter:function(t){return n._activateFilter(t)},createDashboardFilterViewModel:function(t){return n._createDashboardFilterViewModel(t)},ensureTimeRangeFilter:function(t){return n._ensureTimeRangeFilter(t)},normalizeEqualityFilterValue:function(t,i){return n._normalizeEqualityFilterValue(t,i)},subscriptions:n._subscriptions})})))),this._filterUpdatingModulePromise},n.prototype._isFilterUpdatingModuleLoadingOrLoaded=function(){return!!this._filterUpdatingModulePromise},n.prototype._getPartStaticFilters=function(n){return l.Promises.cancelOnDispose(this._filtersLifetime,n.getDashboardFiltering()).then((function(n){return n.staticFilters.map(nt)}))},n})();t.DashboardFiltersManager=tt;c=(function(){function n(){}return n.prototype.activateFilter=function(){},n.prototype.getFilterWarning=function(){return Q("")},n})();t.EqualityFilterRuntimeBase=c;v=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.normalizeFilterValue=function(n){return n},t})(c);t.EqualityFilterRuntime=v;y=(function(n){function t(t){var i=n.call(this)||this;return i._subscriptions=t,i}return __extends(t,n),t.prototype.activateFilter=function(n,t){var i=this;ko.reactor(n,[t.model,this._subscriptions.selectedSubsUpdateTriggered],(function(){return i.getFilterWarning(t.model()).then((function(n){t.warningMessage(n)}))}))},t.prototype.normalizeFilterValue=function(n){return n.toLowerCase()},t.prototype.getFilterWarning=function(n){return n.selectAllState!==0||o.isSubstringFilterModel(n)?Q(""):Q(this._subscriptions.getSelectedSubscriptions().then((function(t){var i=!n.values.some((function(n){return!t.some((function(t){return t.subscriptionId.toLowerCase()===n.toLowerCase()}))}));return i?"":f.Filtering.Subscription.subscriptionFilterUsingExcludedSubscriptions})))},t})(c);t.SubscriptionFilterRuntime=y;p=(function(n){function t(){return n.call(this)||this}return __extends(t,n),t.prototype.normalizeFilterValue=function(n){return n},t})(c);t.LocationFilterRuntime=p;w=(function(n){function t(t){var i=n.call(this)||this;return i._subscriptions=t,i}return __extends(t,n),t.prototype.activateFilter=function(n,t){var i=this;ko.reactor(n,[t.model,this._subscriptions.selectedSubsUpdateTriggered],(function(){i.getFilterWarning(t.model()).then((function(n){t.warningMessage(n)}))}))},t.prototype.getFilterWarning=function(n){return n.selectAllState!==0||o.isSubstringFilterModel(n)?Q(""):Q(this._subscriptions.getSelectedSubscriptions().then((function(t){var i=!n.values.some((function(n){var i=k(n),r=i.subscription;return!t.some((function(n){return n.subscriptionId.toLowerCase()===r.toLowerCase()}))}));return i?"":f.Filtering.ResourceGroup.resourceGroupFilterUsingExcludedSubscriptions})))},t.prototype.normalizeFilterValue=function(n,t){return it(n,t)||n},t})(c);t.ResourceGroupFilterRuntime=w;b=(function(n){function t(){return n.call(this)||this}return __extends(t,n),t.prototype.normalizeFilterValue=function(n){var r=n.resourceType,t=n.resourceKind,i={resourceType:r.toLowerCase()};return t&&(i.resourceKind=t.toLowerCase()),i},t})(c);t.ResourceTypeFilterRuntime=b;t.normalizeResourceGroupId=it;t.parseResourceGroupId=k}));
define("MsPortalImpl/Weave/LazyControls",["require","exports","MsPortalImpl/Weave/Util"],(function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LazyNotice=t.LazyInfoBox=t.LazyCustomHtml=t.LazyPillCollection=t.LazyCheckBox=t.LazyTextBox=t.LazySection=void 0;t.LazySection=i.createControlLazyComponentForKO((function(){return MsPortalFx.require("MsPortalImpl.Controls/Fields/Section")}));t.LazyTextBox=i.createControlLazyComponent((function(){return MsPortalFx.require("MsPortalImpl.Controls/Fields/TextField")}));t.LazyCheckBox=i.createControlLazyComponent((function(){return MsPortalFx.require("MsPortalImpl.Controls/Fields/CheckBoxField")}));t.LazyPillCollection=i.createControlLazyComponent((function(){return MsPortalFx.require("MsPortalImpl/Controls/Controls.PillCollection")}));t.LazyCustomHtml=i.createControlLazyComponentForKO((function(){return MsPortalFx.require("MsPortalImpl.Controls/Fields/CustomHtmlField")}));t.LazyInfoBox=i.createControlLazyComponentForKO((function(){return MsPortalFx.require("MsPortalImpl/Controls/Controls.InfoBox")}));t.LazyNotice=i.createControlLazyComponentForKO((function(){return MsPortalFx.require("MsPortalImpl/Controls/Controls.Notice")}))}));
define("_generated/MsPortalImpl/Svg/Library/Copy.svg",["require","exports"],(function(){"use strict";return{type:338,data:"<svg viewBox='0 0 14 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M14 6.3V16H4v-3H0V0h6.7l3 3h1zM4 3h4.3l-2-2H1v11h3zm9 4h-3V4H5v11h8zm-2-1h1.3L11 4.7z'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Startup/CaretDown.svg",["require","exports"],(function(){"use strict";return{type:286,data:"<svg viewBox='0 0 14.7 8.1' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M.7 0l6.7 6.6L14 0l.7.7-7.3 7.4L0 .7.7 0z'/><\/g><\/svg>"}}));
define("_generated/MsPortalImpl/Svg/Startup/Share.svg",["require","exports"],(function(){"use strict";return{type:324,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M14.9 10.4l.4.4.4.5a1.4 1.4 0 0 1 .2.6 1.3 1.3 0 0 1 .1.6 3.6 3.6 0 0 1-.2 1 3.5 3.5 0 0 1-.5.8l-.8.5-1 .2a2 2 0 0 1-1.3-.4 5.4 5.4 0 0 1-2 1A5.4 5.4 0 0 1 8 16a5.7 5.7 0 0 1-2.2-.4 5.4 5.4 0 0 1-2-1 2 2 0 0 1-1.3.4l-1-.2-.8-.5a3.5 3.5 0 0 1-.5-.8 3.6 3.6 0 0 1-.2-1 1.3 1.3 0 0 1 .1-.6 1.4 1.4 0 0 1 .2-.6l.4-.5c.1-.2.3-.3.4-.4a1.7 1.7 0 0 0-.1-.7V9a7.6 7.6 0 0 1 .3-2.1A6.6 6.6 0 0 1 2.2 5l1.5-1.5a5.2 5.2 0 0 1 1.8-1 3 3 0 0 1 .2-1 2.2 2.2 0 0 1 .5-.8L7 .2 8 0l1 .2.8.5a2.2 2.2 0 0 1 .5.8 3 3 0 0 1 .2 1 5.2 5.2 0 0 1 1.8 1L13.8 5a6.6 6.6 0 0 1 .9 1.9A7.6 7.6 0 0 1 15 9v.7a1.7 1.7 0 0 0-.1.7zM1 12.5a1.3 1.3 0 0 0 .1.6l.3.5.5.3h1.2l.5-.3.3-.5a1.3 1.3 0 0 0 .1-.6 1.3 1.3 0 0 0-.1-.6l-.3-.5-.5-.3H1.9l-.5.3-.3.5a1.3 1.3 0 0 0-.1.6zM8 15a5.7 5.7 0 0 0 1.8-.3 4.8 4.8 0 0 0 1.6-.8l-.3-.7a1.5 1.5 0 0 1-.1-.7 3.6 3.6 0 0 1 .2-1 3.5 3.5 0 0 1 .5-.8l.8-.5 1-.2h.4a3.4 3.4 0 0 0 .1-1 5.7 5.7 0 0 0-.3-1.8 4.1 4.1 0 0 0-.7-1.5 4.9 4.9 0 0 0-1.2-1.3 3.8 3.8 0 0 0-1.5-.9l-.4.6c-.1.2-.3.3-.5.5l-.7.3H7.3l-.7-.3-.5-.5-.4-.6a3.8 3.8 0 0 0-1.5.9A4.9 4.9 0 0 0 3 5.7a5.1 5.1 0 0 0-.7 1.5A5.7 5.7 0 0 0 2 9a3.4 3.4 0 0 0 .1 1h1.1l.9.5a2.7 2.7 0 0 1 .7.8 4.3 4.3 0 0 1 .2 1.2 1.5 1.5 0 0 1-.1.7l-.3.7a4.8 4.8 0 0 0 1.6.8A5.7 5.7 0 0 0 8 15zM8 1h-.6l-.5.3-.3.5a1.3 1.3 0 0 0-.1.6 1.3 1.3 0 0 0 .1.6l.3.5.5.3h1.2l.5-.3.3-.5a1.3 1.3 0 0 0 .1-.6 1.3 1.3 0 0 0-.1-.6l-.3-.5-.5-.3zm5.5 13h.6l.5-.3.3-.5a1.3 1.3 0 0 0 .1-.6 1.3 1.3 0 0 0-.1-.6l-.3-.5-.5-.3h-1.2l-.5.3-.3.5a1.3 1.3 0 0 0-.1.6 1.3 1.3 0 0 0 .1.6l.3.5.5.3z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Widgets/Widgets.StartBoard.Component",["require","exports","Weave/DirectMode","Weave","WeaveDOM/DirectRender/DataAttribute","Fx/Weave","Fx/Weave/Components/Button","FxInternal/AsyncLoader","FxInternal/Weave/Util","_generated/MsPortalImpl/Svg/Startup/CaretDown.svg","_generated/MsPortalImpl/Svg/Library/Copy.svg","_generated/MsPortalImpl/Svg/Startup/Share.svg","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Interactions/Interactions.FullScreenMode","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Weave/LazyControls","MsPortalImpl/Widgets/Widgets.DropMenu.Component","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Widgets/Widgets.Portal"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g){"use strict";function ot(n){var t=n.vm,rt=n.commandContextBinder,e=y.Dashboard,ot=t.headerMode.compose((function(n){var t=["fxs-startboard-header"];return n===1?t.push("fxs-startboard-header-normal"):n===2&&t.push("fxs-startboard-header-migration"),t.join(" ")})),tt;return{focusOnDropMenu:function(){tt&&tt.setFocus()},tsxNode:i(r.GetContext,{fn:function(n){var y=n.diContainer,at=y.get(p.OpenBrowseDashboardsPane),vt=y.get(g.ViewModel),pt=vt.displayMode.compose((function(n){return n==="Dashboard"})),ht=t.title,ct=t.isShared,wt=e.sharedDashboard+" | "+e.readOnlydDashboard,yt=r.composeComputation([ct,t.dashboardWritable],(function(n,t){return n?t?e.sharedDashboard:wt:e.privateDashboard})),bt=y.get(v.FullScreenMode),kt=y.get(w.DesktopManagerMode).value,lt=f.toComputation(kt).compose((function(n){return n===1}));return i(r.Fragment,null,i(r.Once,{condition:pt,trueFn:function(){function n(n){var i=n.event,r;(i.type!=="keydown"||(i.keyCode===13||i.keyCode===32)&&a.getModifierKeys(i)===0)&&(r=u.getElementData(i.currentTarget),i.preventDefault(),i.stopPropagation(),t.switchDashboard&&t.switchDashboard(r).then((function(){if(tt){var n=tt.element,t=Math.min(Math.max(n.outerWidth()+50,400),560);n.find(".fxs-dropmenu-content").css({minWidth:t})}})),t.dashboardDropMenuViewModel.close())}return i(r.Fragment,null,i("div",{className:"fxs-startboard-loadanimation"},i("div",{className:"fxs-splashscreen-loader-container fxs-loading5dots-container"},i("div",null),i("div",null),i("div",null),i("div",null),i("div",null))),i("div",{className:ot},i("div",{className:"fxs-startboard-title-next"},i("div",{className:"fxs-startboard-title-content"},i(r.If,{condition:ct,concealmentBehavior:"remove",trueFn:function(){return i("div",{className:"fxs-startboard-button-icon az-noprint",image:l})}}),i("div",{className:"fxs-startboard-title",title:ht},ht)),i("div",{className:["fxs-startboard-subtitle",{"fxs-startboard-subtitle-shared":ct}]},yt)),i("div",{className:"fxs-startboard-header-item fxs-startboard-dropdown",afterMount:function(n,i){tt=new d.Widget($(n),t.dashboardDropMenuViewModel,!0,!0);i.registerForDispose((function(){tt.dispose();tt=null}))}},i(k.DropMenuInner,{button:i("div",{className:"fxs-startboard-dropdown-button fxs-portal-hover"},i("div",{className:"fxs-startboard-title-container"},i(r.If,{condition:ct,concealmentBehavior:"remove",trueFn:function(){return i("div",{className:"fxs-startboard-button-icon az-noprint",image:l})}}),i("div",{className:"fxs-startboard-title",title:ht},ht),i("div",{className:"fxs-startboard-button-icon az-noprint",image:it.CustomImageWithOptions(h,{palette:99})})),i("div",{className:["fxs-startboard-subtitle",{"fxs-startboard-subtitle-shared":ct}]},yt)),content:i("div",{className:"fx-dropmenu-dropdown"},i("ul",{className:"fxs-dropmenu-list-system",role:"menu","aria-label":e.recentMenuLabel},i(r.If,{condition:t.dashboardList,concealmentBehavior:"remove",trueFn:function(){return i(r.Fragment,null,i(r.If,{condition:t.dashboardList.compose(s.isEmptyArray),concealmentBehavior:"remove",trueFn:function(){return i("li",{className:"fxs-startboard-dropdown-item",role:"menuitem",tabindex:"-1"},i("div",{className:"fxs-dropmenu-list-content"},e.emptynext))}}),i(r.ForEach,{collection:t.dashboardList,fn:function(t){var r=t.item,u=r.id.indexOf("private")===-1;return i("li",{className:["fxs-startboard-dropdown-item","fxs-startboard-dropdown-dashboard","fxs-portal-hover","msportalfx-tooltip-overflow"],role:"menuitem",tabindex:"-1","aria-label":r.title+(u?" "+e.sharedStatusLabel:""),data:r,onClick:n,onKeyDown:n},i("div",{className:"fxs-dropmenu-list-content fxs-startboard-item-container"},i("div",{className:"fxs-startboard-item-icon fxs-portal-svg",image:u?l:null}),i("div",{className:"fxs-startboard-item-title"},r.title)))}}))},falseFn:function(){return i("li",{className:"fxs-startboard-dropdown-item",role:"menuitem",tabindex:"-1"},i("div",{className:"fxs-tile-progress-transparent fxs-loading5dots-container"},i("div",null),i("div",null),i("div",null),i("div",null),i("div",null)))}}),i("li",{className:["fxs-startboard-dropdown-item","fxs-startboard-dropdown-browseall","fxs-portal-hover"],role:"menuitem"},i("div",{className:"fxs-startboard-dropdown-subscriptions"},t.subscriptionsInfo),i("a",{tabindex:"-1",href:"#",className:"fxs-startboard-button-browse fxs-portal-text-primary",afterMount:function(n){rt(at,n)},onClick:function(n){var t=n.event;t.preventDefault();at.execute(!1)}},e.browseAll)))),vm:t.dashboardDropMenuViewModel})),i("input",{type:"text",className:"fxs-startboard-header-item fxs-startboard-title-edit fxs-hide-in-normal",maxlength:200,value:ht,"aria-label":e.titleLabel,onValueChange:function(n){var i=n.value;return t.title(i)},onBlur:function(n){var t=n.event;$(t.target).trigger(ut)}}),i(r.Once,{condition:f.toComputation(bt.isActive),trueFn:function(){return i(r.PromiseFragment,{promise:nt(t,rt,!0)})}}),i("div",{className:"fxs-startboard-header-item fxs-startboard-migration",role:"menubar"},i("button",{type:"button",role:"menuitem",className:"fxs-startboard-button fxs-startboard-button-migrate fxs-portal-hover",title:e.migrate,tabindex:"0",onClick:function(n){var t=n.event;$(t.currentTarget).trigger(ft)}},i("div",{className:"fxs-startboard-button-icon","aria-hidden":"true",image:it.CustomImageWithOptions(c,{palette:99})}),i("div",{className:"fxs-startboard-button-text"},e.migrate))),et?st(t,lt):null),i(r.PromiseFragment,{promise:nt(t,rt)}),i("div",{className:"fxs-startboard-filter",afterMount:function(n,i){if(t.filtersWidgetViewModel){var r=i.createChildLifetime();t.filtersWidgetViewModel.showDashboardFilteringUi.subscribeAndRun(r,(function(u){u&&(r.dispose(),o.get("MsPortalImpl/Widgets/Widgets.DashboardFilters","Widget").then((function(r){i.registerForDispose(new r($(n.parentElement),t.filtersWidgetViewModel,y))})))}))}}}),i("div",{className:"fxs-startboard-customize-header fxs-hide-in-normal"},i(r.If,{condition:lt,trueFn:function(){return i(r.PromiseFragment,{promise:nt(t,rt,!1,!0)})}}),i("div",{className:"fxs-startboard-customize-description"},e.editDescription)),i(r.If,{condition:r.composeComputation([t.dashboardWritable,lt],(function(n,t){return t&&!n})),trueFn:function(){return i(r.LifetimeManagerScoped,{fn:function(n){return i(b.LazyInfoBox,{className:"fxs-startboard-warning",vm:function(t){return t.createVm(n,{style:4,text:e.readOnlyWarningMsg,ariaLabel:e.readOnlyWarningMsg})}})}})}}),i(r.If,{condition:t.dashboardErrorMessage.compose(s.isNonEmptyString),trueFn:function(){return i(r.LifetimeManagerScoped,{fn:function(n){return i(b.LazyInfoBox,{className:"fxs-startboard-error",vm:function(i){return i.createVm(n,{style:5,text:f.toObservable(n,t.dashboardErrorMessage),ariaLabel:f.toObservable(n,t.dashboardErrorMessage)})}})}})}}))}}),i("div",{className:"fxs-startboard-layout fxs-flowlayout"},i(r.Once,{condition:f.toComputation(vt.inOrganizeMode),trueFn:function(){var n=t.flowLayoutOptions.resolutionGuidesOffset,u=n.y+"px",f=n.x+"px";return i(r.Fragment,null,[{x:3840,y:2160},{x:1920,y:1080},{x:1440,y:900},{x:1366,y:768},{x:1024,y:768},].map((function(n){return i("div",{className:"fxs-flowlayout-resolutionguide fxs-flowlayout-resolutionguide-"+n.x+"x"+n.y+" fxs-hide-in-normal",style:{top:u,left:f}})})))}}),i("div",{className:"fxs-flowlayout-childcontainer",style:{height:t.flowLayoutOptions.childContainerHeight,width:t.flowLayoutOptions.childContainerWidth}})),i("div",{className:"fxs-startboard-message-container"},i("div",{className:"fxs-startboard-message-title"},e.NotFound.title),i("div",{className:"fxs-startboard-message-body"},t.notFoundMessage)))}})}}function nt(n,t,u,f){return __awaiter(this,void 0,void 0,(function(){var o,e,s;return __generator(this,(function(h){switch(h.label){case 0:return[4,Promise.all([MsPortalFx.require("MsPortalImpl/UI/Dashboard/UI.DashboardCommands"),MsPortalFx.require("MsPortalImpl/Widgets/Widgets.CommandBar"),])];case 1:return o=h.sent(),e=o[0],s=o[1],[2,i(r.GetContext,{fn:function(o){return i(r.LifetimeManagerScoped,{fn:function(r){var h=o.diContainer,c=s.CommandBar,l,a,v;return u?(l=e.initializeFullScreenCommandBar(r,h,n,t),i(c,{className:["fxs-startboard-commandBar-fullScreen az-noprint",{"az-display-none":n.headerMode.compose((function(n){return n===2}))}],vm:l})):f?(a=e.initializeOrganizeModeCommandBar(r,h,n,t),i(c,{className:"fxs-startboard-commandBar-organize az-noprint",vm:a})):(v=e.initializeCommandBar(r,h,n,t),i(c,{className:["fxs-startboard-commandBar az-noprint",{"az-display-none":n.headerMode.compose((function(n){return n===2}))}],vm:v}))}})}})]}}))}))}function st(n,t){var u=y.Dashboard.Actions,f=r.composeComputation([t,n.dashboardChanged],(function(n,t){return n||t})),o=r.composeComputation([t,n.dashboardWritable,n.dashboardChanged],(function(n,t,i){return i||n&&!t})),s=r.composeComputation([t,n.dashboardChanged],(function(n,t){return n&&t})),h=n.dashboardWritable.compose((function(n){return n?u.save:u.saveCopy}));return i("div",{className:"fxs-startboard-actions"},i(e.Button,{className:"fxs-startboard-actions-save",text:h,style:0,visible:o,loading:n.dashboardSaveInProgress,onClick:function(){var t=n.dashboardWritable.value,i=t?1:2,r=t?"DashboardPublish":"DashboardSaveACopy";tt(r);n.finishDashboardEdit(i)}}),i(e.Button,{className:"fxs-startboard-actions-preview",text:u.preview,style:1,visible:s,onClick:function(){tt("CustomizeModeExited",{dashboardChanged:!!n.dashboardChanged.value});n.exitOrganizeMode()}}),i(e.Button,{className:"fxs-startboard-actions-cancel",text:u.cancel,style:1,visible:f,onClick:function(){tt("DashboardDiscard");n.finishDashboardEdit(3)}}))}function tt(n,t){rt.trace({source:"StartBoard",action:n,data:t})}Object.defineProperty(t,"__esModule",{value:!0});t.StartBoardInner=void 0;var it=MsPortalFx.Base.Images,rt=MsPortalFx.Base.Diagnostics.Telemetry,ut="fxstartboardtitlechanged",ft="fxmigratestartboard",et=MsPortalFx.isFeatureEnabled("dashboardsaveexperience");t.StartBoardInner=ot}));
define("MsPortalImpl/UI/Compositions/UI.Composition.StartBoard",["require","exports","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart","MsPortalImpl/UI/UI.DashboardFiltersManager","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Parts/Parts","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Widgets/Widgets.StartBoard.Component"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt){"use strict";function pt(n){return n!==u.desktopSettingsKey&&n!==u.startBoardSettingsKey&&!MsPortalFx.startsWith(n,c.partIdentityStatePrefix)}function wt(n,t){var i=[],u=new p.EnterOrganizeMode(n,t,!0);return u.text(r.Dashboard.edit),i.push(new p.ResetStartBoardCommand(n,t),u,new p.ExitOrganizeMode(n,t)),i}function ct(n,t,r,u){var l=t.partName,a=t.parameters,e=t.options,v=e.extensionName,y=e.filters,f=e.initialSize,s=e.initialHeight,h=e.initialWidth,p=v||r,o=i.Locator.forExtension(p).withPartType(l),c;return l==="UnboundPart"?c=Q():(o=ot(n,o,u).locator,c=Q(n.locateAsync(o)).then((function(t){if(ut.InternalPartSize[f]){var i=ut.InternalPartSize[t.initialSize]?t.initialSize:2,u=lt(n,o,t)||[];i!==f&&u.indexOf(f)===-1&&(ft.error("Extension {0} attempted to pin using an unsupported size of part with locator '{1}'. Requested size was '{2}'. Pinned with size '{3}'.".format(r,o.toString(),ut.InternalPartSize[f],ut.InternalPartSize[i])),f=i,f===99?(s=s||t.initialHeight,h=h||t.initialWidth):s=h=undefined)}}))),c.then((function(){return{model:a,locator:o,initialSize:f,initialHeight:s,initialWidth:h,filters:y,ignoreRedirects:!0,telemetryAction:u,deepLink:e.deepLink}}))}function lt(n,t,i){if(typeof i.partKind=="number"){var r=nt.getPartFactory(n,t,i);return r.supportedSizes}}function ot(n,t,r){var f;if(t.type===6){var e=t.getExtensionLocator(),s=i.Locator.forPartTypeRedirect(e.name,t.name),o={};if(n.tryLocate(s,o)){var h=t,u=o.value,c=u.toExtension?i.Locator.forExtension(u.toExtension):e;t=c.withPartType(u.toPart);f=u.bindings;vt.trace({source:"StartBoard",action:"Redirect",name:h.toFriendlyString(),data:{reason:r,to:t.toFriendlyString()}})}}return{locator:t,newBindings:f}}var et,ht;Object.defineProperty(t,"__esModule",{value:!0});t.Instance=t.isStartboardPartKey=t.fxstartboardsettingchanged=void 0;var at=MsPortalFx.Base,st=at.Diagnostics,vt=st.Telemetry,yt=l.ReferenceScope,ut=MsPortalFx.Parts,ft=st.createLog(n);t.fxstartboardsettingchanged="fxstartboardsettingchanged";t.isStartboardPartKey=pt;et=u.startBoardSettingsKey;ht=(function(n){function u(t){var i=n.call(this,et,t,null,[],null,et)||this;return i._diContainer=t,i._partAwaiter=new s.CompositionAwaiter(!0),i._containerAwaiter=new s.CompositionAwaiter,i.masterContainer=null,i.notFound=ko.observable(!1),i.containerType=0,i._browser=t.get(g.Browser),i._store=4,i.registerForDispose(i.dashboardFiltersManager=new v.DashboardFiltersManager(t,i)),i}return __extends(u,n),u.create=function(n){return new u(n)},u.prototype.getCompositionType=function(){return e.CompositionType.Startboard},u.prototype.setGetDashboard=function(n){if(this._getDashboard)throw new Error("GetDashboard can only be set once by DashboardManager");this._getDashboard=n},u.prototype.removeGetDashboard=function(){this._getDashboard=null},u.prototype.getDashboard=function(){var n=this._getDashboard;return n?n():null},u.prototype.onDetailContainersChanged=function(){},u.prototype.getDeepLink=function(){return Q("")},u.prototype.toJSON=function(){var t=n.prototype.toJSON.call(this),i=this._getDashboard?this._getDashboard():null,r;return i&&(t.dashboardId=i.id,t.dashboardTitle=i.title,r=i.model,t.dashboardModel=r?{model:ko.toJS(r.model),metadata:MsPortalFx.clone(r.metadata,!0)}:undefined),delete t.children,t},Object.defineProperty(u.prototype,"eligibleForBinding",{get:function(){return!1},enumerable:!1,configurable:!0}),u.prototype.getInputPropertyBindings=function(){throw new Error("Unreachable code");},u.prototype.getViewModel=function(n){var i,t;if(n=MsPortalFx.isNullOrUndefined(n)?8:n,n===8){if(t=this._getDashboard&&this._getDashboard().model,!t)throw new Error("There is no current Dashboard.");i=t.model}return i||{}},u.prototype.getViewModelAsync=function(n){return Promise.resolve(this.getViewModel(n))},u.prototype.getCompatibleSourceReferences=function(n){var r=this._getDashboard&&this._getDashboard().model,t=r&&r.metadata,i,u;return t&&(i=n.type,i)?(u=Object.keys(t).filter((function(n){var r=t[n];return r===i})),u.map((function(n){return{property:n,modelType:8,scope:yt.CurrentContainer,cardinality:l.ReferenceCardinality.OneToOne}}))):null},u.prototype.getFilters=function(){return this.dashboardFiltersManager&&this.dashboardFiltersManager.getFilters()},u.prototype.updateFilters=function(n,t){return this.dashboardFiltersManager&&this.dashboardFiltersManager.updateFilters(n,t)||Q()},u.prototype.getDashboardFiltersForPart=function(n,t){return this.dashboardFiltersManager&&this.dashboardFiltersManager.getDashboardFiltersForPart(n,t)||Q({})},u.prototype.getFilterIdsForPart=function(n){return this.dashboardFiltersManager&&this.dashboardFiltersManager.getFiltersSupportedByPart(n)},u.prototype.setFilters=function(n){return this.dashboardFiltersManager&&this.dashboardFiltersManager.setFilters(n)},u.prototype.getPartInstance=function(n){return MsPortalFx.find(this.children,(function(t){return t.id===n}))},u.prototype._compose=function(n,i){var r=this,s=this.diContainer,h=this.createChildLifetime(),f=n.options,u=f.getStartBoardArea(),o=new w.ViewModel(this.id,this.widgetState(),this.dashboardFiltersManager&&this.dashboardFiltersManager.filtersWidgetViewModel,wt(h,s),f.startboardLoading,f.startboardNotFound,this.diContainer),c=this._getDashboard?this._getDashboard().title:null;c&&o.title(c);var l=rt.StartBoardInner({vm:o,commandContextBinder:function(n,t){n.bind(new y.CompositionInstanceCommandContext(t,null,r))}}),a=l.focusOnDropMenu,v=l.tsxNode;it.applyToElement({element:u[0],ltm:this,weaveNode:v,weaveContext:{diContainer:s},opName:"Startboard"});this.widget=new w.Widget(u,o,a);u.data(e.CompositionInstanceDataName,this);this.widget.ltm.registerForDispose([h,u.setEvents([b.Widget.viewSettingsChanged,function(n,i){n.stopPropagation();r.widgetState(i);u.trigger(t.fxstartboardsettingchanged)},],["fxunpin",function(n,t){var u=MsPortalFx.find(r.children,e.getIdMatchFunc(t.tileId)),o;if(u){var s=r.widget,f=s.getDomOrderedChildren(),i=f.indexOf(t.tileId);i=i===0?1:i-1;i=i>=f.length?-1:i;o=i!==-1?MsPortalFx.find(r.children,e.getIdMatchFunc(f[i])):null;ft.warning("Part '{0}' is about to be removed due to user unpin operation.".format(u));r.removeTile(u);setTimeout((function(){o?o.widget.setFocus():s.setFocus()}),50)}},]),]);i.resolve()},u.prototype.matchesLocatorAndModel=function(){return!1},u.prototype.removeTile=function(n,t){if(n){var i=void 0,u=this._diContainer.get(k.JourneyManager),e=u.activeJourney();e&&e.originTile===n&&(i=e.id);var o=n.editScopeId()&&this._diContainer.get(f.EditScopeManager).getStateObservable(n.editScopeId()),h=!o||o()===0||o()===2,c=!i||u.canDiscardJourney(i),s=t&&t.force||h&&c;(s||this._browser.confirm(r.Desktop.confirmEditScopeDiscard))&&(i&&u.forceDiscardJourney(i),n.clearIdentitySettings(),this.removeChild(n,!1,t&&t.skipSave),s||ft.warning("Part '{0}' is removed from the start board.".format(n)))}},u.prototype.resetLayout=function(n){return Q(this.diContainer.get(d.ResetDashboardPortalFunc).invoke({duringPortalStartup:!1,force:n},"Dashboard"))},u.prototype.clearStartboard=function(n){var t=this;this.dashboardFiltersManager&&this.dashboardFiltersManager.resetFilters();this.children.slice().forEach((function(n){return t.removeTile(n,{force:!0,skipSave:!0})}));n||this.save()},u.prototype.dispose=function(){n.prototype.dispose.call(this,!0)},Object.defineProperty(u.prototype,"journeyPath",{get:function(){return[]},enumerable:!1,configurable:!0}),u.prototype.getComposedParts=function(){return this._partAwaiter.resolvedCompositions},u.prototype.awaitComposedPart=function(n,t){return this._partAwaiter.await(n,t)},u.prototype.notifyPartComposed=function(n){this._partAwaiter.resolve(n)},u.prototype.awaitContainer=function(n,t){return this._containerAwaiter.await(n,t)},u.prototype.notifyContainer=function(n){this._containerAwaiter.resolve(n)},u.prototype.onInvocationStarted=function(){},u.prototype.getDiagnosticsData=function(){var t=this.diContainer.get(h.Finder).findBlades(this);return $.extend(n.prototype.getDiagnosticsData.call(this),{detailBlades:t.map((function(n){return n+""}))})},u.prototype.createStartBoardPart=function(n,t){var u,e,r,f;if(!n){ft.error("options should be specified for adding a part to the startboard.");return}if(!n.locator){ft.error("options.originPartLocator should be specified for adding a part to the startboard.");return}return u={locator:n.locator,newBindings:undefined},n.ignoreRedirects||(u=ot(this._diContainer.get(i.DefinitionFinder),n.locator,n.telemetryAction)),e=n.model,r=a.create(this._diContainer,u.locator,e,{modelContainsSensitiveData:n.modelContainsSensitiveData,filters:n.filters,pinnedBladeDeeplink:n.deepLink,duringPortalStartup:t}),u.newBindings&&(r.getInstanceBindings=function(){return u.newBindings}),f=n.defaultMenuItemId,f&&(r.defaultMenuItemId=f),ut.InternalPartSize[n.initialSize]&&(r.initialSize=n.initialSize,n.initialSize===99&&(r.initialHeight=n.initialHeight,r.initialWidth=n.initialWidth)),r},u.prototype.pinPartReferences=function(n,t){var r=this,u=n.map((function(n){var u=r._diContainer.get(i.DefinitionFinder);return ct(u,n,t,"PinPartReferences").then((function(n){return r.createStartBoardPart(n)}))}));return Q.allSettled(u).then((function(n){return n.map((function(n){return n.value}))}))},u.prototype.pinBladeToStartboard=function(n){var e=this,u=n.locator.getExtensionLocator(),t=this.diContainer.get(i.DefinitionFinder),r,f;return n.onPin?r=Q(n.onPin()).then((function(n){return ct(t,n,u.name,"Blade.onPin")})):(f=n.locator,r=Q(t.locateAsync(f)).then((function(t){var r=t.pinnedPartExtension||u.name,f=i.Locator.forExtension(r).withPartType(t.pinnedPart),e=(t.inputs||[]).concat(t.optionalInputs||[]),o=e.reduce((function(t,i){return t[i]=l.getModelValue(n.model,i).value,t}),{});return{locator:f,model:o,telemetryAction:"PinPdlBlade"}}))),r.then((function(i){var r=ot(t,i.locator,i.telemetryAction),u=r.locator,f=r.newBindings;return t.locateAsync(u).then((function(){var t=a.create(e._diContainer,u,i.model,{filters:i.filters,pinnedBladeDeeplink:n.deepLink});f&&(t.getInstanceBindings=function(){return f});var r=i.initialSize,o=i.initialHeight,s=i.initialWidth;return ut.InternalPartSize[r]&&(t.initialSize=r,r===99&&(t.initialHeight=o,t.initialWidth=s)),t.defaultMenuItemId=i.defaultMenuItemId,t}))}))},u.prototype.clonePartToStartboard=function(n){var t=this,r=n.cloneAs((function(i,r){return a.create(t.diContainer,n.locator,i,{overridesModel:r,filters:n.filters})}),!0);return r.then((function(r){var f=lt(t.diContainer.get(i.DefinitionFinder),n.locator,n.partDefinition),u;if(tt.isVariableSize(r.initialSize)&&f&&f.length>0)if(u=MsPortalFx.find(f,(function(n){return tt.isFixedSize(n)})),u!==null&&u>=0)r.initialSize=u,r.widgetState().NormalState.size=u;else throw FxImpl.createError("Requested tile size for pinning not supported");return r})).catch((function(){ft.error("Pin Part to Startboard Failed: The target part could not pinned. Part: {0}".format(n.toString()))}))},u})(o.Instance);t.Instance=ht}));
define("MsPortalImpl/UI/UI.StartboardManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Graph","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/UI/Compositions/UI.Composition.StartBoard","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/UI/UI.DesktopManagerView","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/Widgets/Widgets.Portal.init"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.StartboardManager=void 0;var g=MsPortalFx.Base,b=MsPortalFx.Hubs.Notifications.NotificationStatus,w=g.Diagnostics.createLog(n),nt=e.CompositionBinder.createObservableModel,k=r.Dashboard.Notification,d=r.Dashboard.NotFound,tt=(function(){function t(n,t,i,r){var u=this;this._diContainer=n;this._notificationManager=t;this._view=i;this._lifetime=new FxImpl.TriggerableLifetimeManager;this._portal=p.getPortalViewModel(n);this._lifetime.registerForDispose(this.startboard=l.Instance.create(this._diContainer));r.setStartBoard(this.startboard);MsPortalFx.tryImmediateResolve(this._portal.onWidgetCreate(),(function(){u._view.composeStartBoard(u.startboard)}))}return t.prototype.dispose=function(){this._lifetime&&this._lifetime.dispose()},t.prototype.setWidgetLoading=function(n){this.startboard.widget.options.loading(n)},t.prototype.collectDashboardSettings=function(n){var e=this,u={},i=n.toJSON(),t=n.children.filter((function(n){return!n.isDisposed()})),f=n.widget.getDomOrderedChildren(),r;return t.length!==f.length&&w.error("There should be the same number of composed parts to save ("+t.length+") as the number of positioned elements in the layout ("+f.length+"). The settings will be incorrect."),r=[],f.forEach((function(n){var i=MsPortalFx.remove(t,(function(t){return t.id===n}));if(i.length!==1){w.error("There should be a composed part with ID '"+n+"' yet none was found. The saved content will be incorrect. The settings will be incorrect.");return}r.push(e.getPartSettings(i[0]))})),t.length>0&&t.forEach((function(n){w.error("Part '"+n.id+"' should have a position defined in the layout, yet none was found. The settings will be incorrect.");r.push(e.getPartSettings(n))})),Q.allSettled(r).then((function(t){return t.forEach((function(n){$.extend(u,n.value)})),n.dashboardFiltersManager&&n.dashboardFiltersManager.toJSON().catch((function(){return w.error("Failed to get part filters information."),i.dashboardModel.model}))})).then((function(n){return n&&(i.dashboardModel.model.filterLocale=n.filterLocale,i.dashboardModel.model.filters=n.filters),u[c.startBoardSettingsKey]=i,JSON.parse(JSON.stringify(u))}))},t.prototype.getPartSettings=function(n,t){var i=this;return(t||t===undefined?Q(n.await(7)):Q()).catch(MsPortalFx.noop).then((function(){if(n.isDisposed())return{};var t={},r=i.partCompositionToJSON(n),u=r.partJson,f=r.containerModel;return t[u.id]=u,i.getPartIdentitySettings(n,f).then((function(n){return $.extend(t,n)}))})).catch((function(t){return w.error(t,8,"part: '"+n.id+"'."),{}}))},t.prototype.getPartIdentitySettings=function(n,t){var r=n.partDefinition,i;return!r||!r.partState?Q({}):(i=s.buildIdentitySettingKey(n.locator,t),Q(n.getPartSettingsManager().getStartboardPartIdentitySettings()).then((function(n){if(!n)return{};var t={};return t[i]=n,t})).catch((function(t){return w.error(t,9,"Failed to get part '"+n.id+"' identify settings for key '"+i+"'."),{}})))},t.prototype.enterOrganizeMode=function(n){this.startboard.widget.element.trigger("fxenterorganizemode",{openTileGallery:n})},t.prototype.pinMultipleParts=function(n,t,i,u){var f=this,e;return n.length<1?Q():(e=u&&this.startboard.notFound()?Q.reject("Can pin on not found dashboard"):this.startboard.pinPartReferences(n,t).then((function(n){if(typeof i=="undefined"||i){var t=r.Shell.pinnedToStartBoard;f.popNotification(t,t,b.Information)}return n})),e.catch((function(n){f.popNotification(k.errorTitle,d.failToPinPart,b.Error);throw n;})))},t.prototype.pinBladeToStartboard=function(n,t,i){var u=this,f;return f=i&&this.startboard.notFound()?Q.reject("Can pin on not found dashboard"):this.startboard.pinBladeToStartboard(n).then((function(i){if(!t){var f=n.bladeTitle,e=f?r.Shell.pinnedToStartBoardWithTitle.format(f):r.Shell.pinnedToStartBoard;u.popNotification(e,e,b.Information)}return i})),f.catch((function(n){u.popNotification(k.errorTitle,d.failToPinBlade,b.Error);throw n;}))},t.prototype.pinPartToStartboard=function(n){var t=this,i;return i=this.startboard.notFound()?Q.reject("Can pin on not found dashboard"):this.startboard.clonePartToStartboard(n).then((function(i){return t.popNotification(n.getTitle(),r.Shell.pinnedToStartBoard,b.Information),i})),i.catch((function(i){w.error("Pin Part to Startboard Failed: The target part could not pinned. Part: {0}".format(n.toString()));t.popNotification(k.errorTitle,d.failToPinPart,b.Error);throw i;}))},t.prototype.popNotification=function(n,t,i,r){this._notificationManager.removeNotification(t);this._notificationManager.addClientNotification({title:n,description:t,status:i,timestamp:new Date,uri:r||"#dashboard",correlationIds:[t]})},t.prototype.updateUriAndPageTitle=function(n,t){t===void 0&&(t=!1);n&&n.id&&a.updateDashboardUri(this._diContainer,n.id,t);this.startboard.widget.options.title(n.title)},t.prototype.partCompositionToJSON=function(n){var i=n.toJSON(),t=n.containerModel,r;return t&&t[u.PartContainerModelIdProperty]||(r=ko.toJS(h.createContainerModel(i.containerModel))||{},r[u.PartContainerModelIdProperty]=MsPortalFx.getUniqueId(),t=nt(r),i.containerModel=y.getSerializableContainerModel(t,!1)),{partJson:i,containerModel:t}},__decorate([__metadata("fx:diagnostics",[n,"StartboardManager"]),i.Class(),__metadata("design:paramtypes",[i.Container,f.NotificationManager,v.DesktopManagerView,o.CompositionGraph])],t)})();t.StartboardManager=tt}));
define("MsPortalImpl/UI/UI.DesktopManagerImpl",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Services/Services.AssetManagement","MsPortalImpl/Services/Services.Settings","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/Base/Base.DeepLink","FxHubs/RpcEndPoints","Fx/Composition/DashboardFilters","FxInternal/Composition/DashboardFilters","MsPortalImpl/Services/Services.Settings.Schema","FxInternal/AsyncLoader","MsPortalImpl/UI/UI.StartboardManager"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){"use strict";function d(){return b("MsPortalImpl/UI/UI.Desktop.Actions")}var b,k,w;Object.defineProperty(t,"__esModule",{value:!0});t.getFilterWarningHandler=t.getFilterValueDisplayTextHandler=t.getFilterValuesHandler=t.getDashboardFiltersHandler=t.getDashboardDeepLinkHandler=t.DesktopManagerImpl=void 0;b=MsPortalFx.require;k=4;w=(function(){function t(n){this._diContainer=n;this._lifetime=new FxImpl.TriggerableLifetimeManager;this._manifestCache=n.get(u.ManifestCache);this._mode=n.get(o.DesktopManagerMode).value;this._settingsManager=n.get(e.SettingsManager);this._journeyManager=this._diContainer.get(s.JourneyManager);this.startBoard=n.get(p.StartboardManager).startboard;this._setupOrganizeModeComponents()}return t.prototype.initialize=function(){var n=this;this._journeyManager.configure(this.startBoard);this._diContainer.get(f.AssetManager).onAssetDeleted((function(t,i,r,u){d().then((function(f){return f.handleAssetDeleted(n,n._journeyManager,t,i,r,u)}))}));return this.getSettingCollections().forEach((function(t){n._diContainer.get(e.SettingsManager).setSettings(t)})),Q()},t.prototype._getExtensionEmailAddress=function(n){var t=this._manifestCache.getManifest(n,"assetTypes");return t&&t.feedbackEmail},t.prototype.getCurrentBladeInfo=function(){var n=this._getBreadCrumb(),r=this._getExtensionEmailAddress("HubsExtension"),t=n[n.length-1],i=t&&t.extensionName||"",u=i&&this._getExtensionEmailAddress(i)||r;return{extensionName:i,feedbackTo:u,feedbackCC:r,breadcrumb:n.map((function(n){return n.title})).join(" > "),bladeLocators:n.map((function(n){return n.name})),bladeName:t&&t.name||""}},t.prototype._getBreadCrumb=function(){var t=this._journeyManager.activeJourney(),n;return t?(n=t.children,!n||!n.length)?[]:n.map((function(n){return{title:n.isDefaultTitle()?n.id:n.title(),extensionName:n.locator.getExtensionName(),name:n.locator.toFriendlyString()}})):[]},t.prototype.getSettingCollections=function(){var n={},t=[];return n[v.desktopSettingsKey]=JSON.parse(JSON.stringify(this)),t.push({store:k,settings:n}),t},t.prototype.dispose=function(){this._lifetime.dispose()},t.prototype.toJSON=function(){return{startBoardId:this.startBoard?this.startBoard.id:null}},t.prototype.getDiagnosticsData=function(){var n=this.startBoard;return{startboard:n&&n.getDiagnosticsData()}},t.prototype.getAssetDiagnosticsData=function(){var n=this._journeyManager.activeJourney();return n?d().then((function(t){return t.dumpCompositionAssets(n)})):Q.resolve("No journey")},t.prototype._setupOrganizeModeComponents=function(){var t=this,i=this._lifetime,n=i.createChildLifetime();this._mode.subscribe(n,(function(i){i===1&&(n.dispose(),r.get("MsPortalImpl/UI/UI.DragDropCompositionManager","create").then((function(n){return n(t._diContainer)})))}))},__decorate([__metadata("fx:diagnostics",[n,"DesktopManagerImpl"]),i.Class(),__metadata("design:paramtypes",[i.Container])],t)})();t.DesktopManagerImpl=w;t.getDashboardDeepLinkHandler=y.defineHandler(c.DashboardEndpoints.getDashboardDeepLink,(function(n){return h.rpcGetDashboardDeepLink(n.diContainer,n.messageArg)}));t.getDashboardFiltersHandler=y.defineHandler(c.PartFilterEndpoints.getFilters,(function(n){var u=n.diContainer.get(w),t=n.messageArg,i=u.startBoard,r=i.dashboardFiltersManager,f=i.getFilterIdsForPart(t).then((function(n){var r=[];return n.forEach((function(n){r.push(i.dashboardFiltersManager.getFilterIdTextAndOperators(t,n).then((function(t){return{id:n,displayString:t.displayString,operators:t.operators}})))})),Q.all(r)})),e=i.getDashboardFiltersForPart(t,!0);return Q.all([f,e]).then((function(n){var e={},u=n[1],f=[],o;return Object.keys(u).forEach((function(i){var o=r.fromExtensionModel(a.getFilterKindFromId(i),u[i]),s;i!==l.TimeRangeFilter.filterId&&(s=r.getFilterValueDisplayText(i,u[i],t).then((function(n){return{displayString:n,value:o.values}})),f.push(s.then((function(t){var r=MsPortalFx.find(n[0],(function(n){return n.id===i})).displayString;e[i]={filterIdDisplayText:r,operator:o.operator,valueString:t.displayString,values:t.value,substring:o.substring}}))))})),o=MsPortalFx.forEachKey(MsPortalFx.clone(i.getPartInstance(t).filters,!0)||{},(function(n,i,u){var e=r.getFilterValueDisplayText(n,i,t).then((function(t){u[n]=MsPortalFx.extend(r.fromExtensionModel(a.getFilterKindFromId(n),i),{valueString:t})}));f.push(e)}),{}),Q.all(f).then((function(){return{dashboardFilterDisplays:e,dashboardTimeRangeFilter:u[l.TimeRangeFilter.filterId],partFilters:o||{},allPossibleFilters:n[0]}}))}))}));t.getFilterValuesHandler=y.defineHandler(c.PartFilterEndpoints.getFilterValues,(function(n){var i=n.diContainer.get(w),t=n.messageArg;return i.startBoard.dashboardFiltersManager.getFilterValues(t.filterId,t.filterText,t.partId)}));t.getFilterValueDisplayTextHandler=y.defineHandler(c.PartFilterEndpoints.getFilterValueDisplayText,(function(n){var i=n.diContainer.get(w),t=n.messageArg,r=i.startBoard.dashboardFiltersManager.toExtensionModel(a.getFilterKindFromId(t.filterId),t);return i.startBoard.dashboardFiltersManager.getFilterValueDisplayText(t.filterId,r,t.partId)}));t.getFilterWarningHandler=y.defineHandler(c.PartFilterEndpoints.getFilterWarning,(function(n){var i=n.diContainer.get(w),t=n.messageArg;return i.startBoard.dashboardFiltersManager.getFilterWarning(t.filterId,MsPortalFx.extend2(t.filterModel,{selectAllState:undefined}))}))}));
define("MsPortalImpl/Base/Base.Router",["require","exports","Fx/ResourceManagement","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManagerImpl","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.Portal.init","Weave"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt){"use strict";function lt(n,t,i){var e={},u,f,r;try{for(u=0;u<n.length;){if(f=ct(n[u++]),!f)throw new Error("invalid decodeKey:"+f);r=ct(n[u++]);i&&r&&r.match(/^\s*\{.*\}\s*$/)&&(r=st.safeJSONParse(r));e[f]=r}}catch(o){throw new MsPortalFx.Errors.Error({message:"Deep link "+t+" has illegal inputs",innerErrors:o});}return e}var ft,rt,at,st,vt;Object.defineProperty(t,"__esModule",{value:!0});t.Router=t.Internal=t.bladeRedirect=void 0;var et=MsPortalFx.Base,it=et.Diagnostics,tt=window,ht=it.createLog(n),yt=/^[\w-]+$/,ct=decodeURIComponent,pt=MsPortalFx.memoizeQ((function(){return MsPortalFx.require("MsPortalImpl/Base/Base.Selectable2.Provisioning")})),ut=f.Portal.defaultPageTitle.format(f.Dashboard.defaultTitle,tt.fx.environment.branding.title),ot=FxImpl.getErrorMap({linkFormat:"",invalidLink:"",unfoundAsset:"",noResourceAsset:""});t.bladeRedirect=(ft={},ft["MyAccessBlade".toLowerCase()]="MyAccess.ReactView",ft["RPStatusBlade".toLowerCase()]="RPStatus.ReactView",ft);at=(rt={},rt[2]="directory",rt[3]="filters",rt[6]="contact",rt),(function(n){function ft(n){try{return JSON.parse(n)}catch(t){return n}}function r(n,t,i,r,u,f){return MsPortalFx.extend({extensionName:n,assetType:t,assetId:i,detailBladeInputs:r,defaultMenuItemId:u},f)}function g(n){var t=(n||"").split("/"),r=t.length,u,i,f;return r<2?null:t[1]?(i=r%2,i===1&&(u=decodeURI(t[2])),f=lt(t.slice(2+i),n,!0),{extension:t[0],detailBlade:t[1],detailBladeInputs:f,defaultMenuItemId:u}):null}function rt(n){var t;return n.isEnabled("settingsflyout")&&!(n.isEnabled("hidedirectorypanebutton")||((t=tt===null||tt===void 0?void 0:tt.chrome)===null||t===void 0?void 0:t.hideDirectoryPaneButton))}function st(n,t){var r=1,u,i;if(t.enableOverview||(r=t.enableDirectorySettings?2:4),!n)return r;u=n.toLowerCase();n.indexOf("#settings")===0&&(u=n.split("/")[1]);switch(u){case"directory":t.enableDirectorySettings&&(i=2);break;case"filters":t.enableGlobalResourceFilters&&(i=3);break;case"contact":t.enableContactInfo&&(i=6)}return MsPortalFx.isNullOrUndefined(i)&&(i=r),i}n.safeJSONParse=ft;var ct=(function(){function n(n,t,i){var u,r=this,o;this._diContainer=n;this._portal=i;this._ltm=new FxImpl.TriggerableLifetimeManager;this._consoleOpen=!1;this._manifestCache=n.get(h.ManifestCache);this._journeyManager=n.get(w.JourneyManager);this._assetTypes=n.get(c.AssetTypeService);this._extensions=n.get(s.ExtensionManager);this._features=n.get(FxImpl.Features);this._features.isEnabled("settingsflyout")&&(nt.subscribe(this._ltm,[this._portal.settingsFlyoutState],(function(n){return __awaiter(r,void 0,void 0,(function(){var t,i;return __generator(this,(function(){return n===0?(t=e.getCurrentUri().getHashParts(),t.category&&t.category==="settings"&&(this._updateNavHistory(),this._updateTitle()),[2]):(i=at[n],e.history_pushState({},f.Portal.windowTitleFormat.format(f.TopBar.settings,tt.fx.environment.branding.title),e.getCurrentUri().setHash("#settings"+(i?"/"+i:"")).href),this._updateTitle(),[2])}))}))})),o=function(n){return Q(r._diContainer.get(l.SubscriptionsUserContext).useGlobalResourceFiltersPromise).then((function(t){return r._handleSettingsRoute(n,t)}))});this._routeHandlerMapping=(u={},u.asset=function(n,t){return r._handleAssetRoute(n,t)},u.blade=function(n,t){return r._handleBladeRoute(n,t)},u.cloudshell=this._features.isEnabled("azureconsole")?function(n,t){return r._handleCloudShellRoute(n,t)}:undefined,u.create=function(n,t){return r._handleCreateRoute(n,t)},u.menu=function(n){return r._handleMenuRoute(n)},u.resource=function(n,t){return r._handleResourceRoute(n,t)},u.dashboard=function(n,t){return r._handleDashboardRoute(n,t)},u.home=this._features.isEnabled("azurehome")?function(n,t){return r._handleHomeRoute(t)}:undefined,u.allservices=function(n){return r._handleAllServicesRoute(n)},u.settings=o,u);MsPortalFx.ViewModels.navigateToDashboardEndPoint.register(t,null,(function(n){var t=n[0],i=n[1];r.navigateToDashboard(t,i)}))}return n.prototype._getHandler=function(n){var t=n.getHashParts().category;return this._routeHandlerMapping[t]},n.prototype.route=function(n,t){return this._route(new o.Uri(n),{openedByContext:t})},n.prototype._route=function(n,t){var i=this,r;return t===void 0&&(t={}),r=MsPortalFx.extend(t.openedByContext||{},{deepLink:n.hash}),MsPortalFx.tryImmediateResolve(Q(),(function(){i._consoleOpen&&i._getAzureConsole().then((function(n){return n.minimizeIfOpen()}));n.isHashEmpty()&&(n.setHash(k.isLandingPageDashboard(i._diContainer)?"dashboard":"home"),e.history_replaceState(null,ut,n.href),n=e.getCurrentUri());var u=i._getHandler(n);return u?u(n,{skipFocus:t.skipFocus,openedByContext:r,invokedByInitRoute:t.invokedByInitRoute}):FxImpl.QReject("{0} is not a valid deep link".format(n.hashWithHashQueryString))}))},n.prototype.initialRoute=function(n,t){var u=this,i=e.getCurrentUri(),r;return r=this._getHandler(i)?this._route(i,t).catch(n):n(),this.startListening(),r.catch((function(n){ht.warning(n,1,"Unable to load initial route.");u.goToLandingPage(t)}))},n.prototype.startListening=function(){var n=this,t=this._isListening;t&&t.dispose();t=this._isListening=this._ltm.createChildLifetime();this._portal.customEvents.addHandler(null,"fxjourneychanged",(function(t,i){n._updateNavHistory({addToHistory:!0,openedAsHome:i})}));this._portal.customEvents.addHandler(null,"fxbladerebound",(function(){n._updateNavHistory()}));t.registerForDispose([$(window).setEvents(["hashchange",function(){var i,r,t;if(n._portal.displayMode.value==="Dashboard"&&(i=n._portal.panorama.getStartBoardWidget(),n._portal.inOrganizeMode()||i.options.dashboardChanged.value)){if(r=n._diContainer.get(b.Browser),!r.confirm(f.Desktop.confirmEditScopeDiscard))return;n._portal.topBar.finishDashboardEdit(3)}t=e.getCurrentUri();n._route(t,{skipFocus:!1}).catch((function(){window.history.back();it.Telemetry.trace({source:"Base.Router",action:"UriHashChange",data:{uri:t}})}))},]),])},n.prototype.stopListening=function(){var n=this._isListening;n&&n.dispose();this._isListening=null},n.prototype.dispose=function(){this.stopListening();this._ltm.dispose();window.location.hash=""},n.prototype.navigateToDashboard=function(n,t){it.Telemetry.trace({source:n||"Base.Router",action:"DashboardNavigation"});var i=t?e.getCurrentUri().setHash(e.getDashboardDeepLink(this._diContainer,t)):e.getCurrentUri().setHash("dashboard").clearHashQueryStringIfEmpty();e.history_pushState({},"",i.href);this._route(i)},n.prototype.goToLandingPage=function(n){var t=k.isLandingPageDashboard(this._diContainer),i;return it.Telemetry.trace({source:n.interactionSource||"Base.Router",action:"LandingPageNavigation"}),i=e.getCurrentUri().setHash(t?"dashboard":"home"),(n.replaceHistory?e.history_replaceState:e.history_pushState)(null,ut,i.href),t?this._handleDashboardRoute(null,n):this._handleHomeRoute(n)},n.prototype._tryCleanupJourney=function(){if(this._journeyManager.tryDeactivateJourney()){if(!this._getActiveJourneyId()){var n=this._portal.panorama,t=n&&n.getJourneyWidget();t&&t.close()}return!0}return!1},n.prototype._handleDashboardRoute=function(n,t){var i=this;return this._tryCleanupJourney()?(this._portal.settingsFlyoutState(0),t.interactionSource||(t.interactionSource="Router"),t.dashboardId=n&&e.getDashboardIdFromUri(n),Q(this._diContainer.get(a.SwitchDashboardPortalFunc).invoke({id:t.dashboardId,title:t.dashboardId},t.interactionSource).then((function(){i._updateTitle()})))):Q.reject()},n.prototype._handleHomeRoute=function(n){var t,i,r;return n=n||{},it.Telemetry.trace({source:"Base.Router",action:"AzureHomeNavigation"}),this._tryCleanupJourney()?(t=this._features.getValue("bladeashomedeeplink"),this._portal.settingsFlyoutState(0),t?(i=new o.Uri("#"+t),r={deepLink:i.hash,openedAsHome:!0},this._portal.customEvents.trigger("fxshowcustomhomepage"),this._handleBladeRoute(i,{openedByContext:r})):this._portal.customEvents.trigger("fxshowdefaulthomepage",n),this._updateTitle(),Q()):Q.reject()},n.prototype._handleAllServicesRoute=function(n){if(this._tryCleanupJourney()){var t=n.getHashParts().rest;this._portal.customEvents.trigger("fxshowallservices",{filter:t&&decodeURIComponent(t)});this._updateTitle()}return Q()},n.prototype._handleSettingsRoute=function(n,t){var f=this,e=n.getHashParts().rest,i=this._diContainer.get(FxImpl.Features),o=st(e,{enableDirectorySettings:rt(i),enableGlobalResourceFilters:t,enableContactInfo:i.isEnabled("contactinfo"),enableOverview:!i.isEnabled("hidesettingsoverview")}),r,u;this._portal.settingsFlyoutState(o);this._portal.settingsFlyoutState.value!==0&&(this._diContainer.get(v.RightContextPane).close(!0),r=this._diContainer.get(p.DialogManager),r.hasOpenDialog&&(it.Telemetry.trace({source:"Base.Router",action:"SettingsFlyoutClosedDialogsOnOpen"}),r.dismissOpenDialog()));u=this._ltm.createChildLifetime();nt.subscribe(u,[this._portal.settingsFlyoutState],(function(n){return __awaiter(f,void 0,void 0,(function(){var t;return __generator(this,(function(i){switch(i.label){case 0:return(n===0)?(t=this._journeyManager.activeJourney(),!(!t||!t.children.length))?[3,2]:[4,this.goToLandingPage({interactionSource:"Router",replaceHistory:!1,invokedByInitRoute:!0,skipFocus:!0})]:[3,3];case 1:i.sent();i.label=2;case 2:u.dispose();i.label=3;case 3:return[2]}}))}))}))},n.prototype._handleBladeRoute=function(n,i){var s=this,w=n.getHashParts().rest,r=i&&i.route||g(w),l,u,v,h,y,p;if(r.openedByContext=i&&i.openedByContext,this._portal.settingsFlyoutState(0),l=Q(),r.extension&&r.extension.toLowerCase()==="HubsExtension".toLowerCase()){if(u=(r.detailBlade||"").toLowerCase(),v=this._diContainer.get(FxImpl.Features),u==="contactinfoblade"&&v.isEnabled("settingsflyout")&&v.isEnabled("contactinfo")){this._portal.settingsFlyoutState(6);return}if(u==="settingsblade")return it.Telemetry.trace({source:"Base.Router",action:"SettingsPaneRedirect"}),e.history_pushState({},ut,e.getCurrentUri().setHash("#menu/settings").href),this._handleMenuRoute(new o.Uri("#menu/settings"));h=function(t,i){l=MsPortalFx.tryImmediateResolve(s._assetTypes.assetTypesComplete,(function(){var u="",f;return t===et.Constants.ResourceTypes.AllResources?u=c.lowerCaseAllResourcesId:(f=s._assetTypes.getAssetTypeByResourceType(t),f&&(u=f.id.toLowerCase())),u?c.getBrowseBladeUri(s._diContainer,u,n.hash,f,i).then((function(t){if(n.hash!==t){n=new o.Uri(t);var i=n.getHashParts().rest,u=g(i);r=u}})):void 0}))};u==="browseallresourcesblade"?h(et.Constants.ResourceTypes.AllResources):u==="browseresourceblade"?(y=r.detailBladeInputs||{},h(y.resourceType,y.kind)):u==="browseresourcegroupblade"?h(et.Constants.ResourceTypes.ResourceGroups):Object.keys(t.bladeRedirect).indexOf(u)!==-1&&(r.detailBlade=t.bladeRedirect[u])}return p=this._journeyManager.activeJourney(),l.then((function(){return Q.fcall((function(){return p&&p.getDeepLink()||Q("")})).catch((function(){return""})).then((function(t){if(n.hash!==t)return s._diContainer.get(a.CreateJourneyForBladeFunc).invoke(r).then(MsPortalFx.identity,(function(n){s._notify(f.Shell.deepLinkErrorLoading.format(w));throw n;}))}))}))},n.prototype._handleCloudShellRoute=function(n,t){return t===void 0&&(t={}),this._consoleOpen=!0,this._getAzureConsole().then((function(n){return n.showFullscreen()}))},n.prototype._getAzureConsole=function(){return this._diContainer.getAsync(u.get("MsPortalImpl/UI/UI.AzureConsole","AzureConsole"))},n.prototype._handleCreateRoute=function(n,t){var h=this,i,r,u,e,s,c;return(t===void 0&&(t={}),i=n&&n.getHashParts().rest,r=(i||"").split("/"),!r.length)?(this._notify(f.Shell.deepLinkInvalid.format(i)),FxImpl.QReject("Deep link "+i+" should be #{routeTypes.create}/{package-id}.")):(it.Telemetry.trace({source:"Gallery",action:"DeepLinkVisited",name:i}),u=r.shift(),e=lt(r,i),u!=="hub"&&u!=="Microsoft.Support"?pt().then((function(i){return i.getDynamicCreateBladeReference(h._diContainer,{galleryItemId:u,inputs:e}).then((function(i){return i.defaultMenuItemId=r[2],t.route=i,h._handleBladeRoute(n,t)}))})):(s="",this._extensions.initializedExtensions.some((function(n){return n.name==="Microsoft_Azure_Marketplace"}))||(s="/useDelayedBlade/true/bladeWidth/1"),c="{0}/{1}/package/{2}/additionalConfig/{3}/selectedMenuItemId/undefined/createLanding/undefined{4}".format(MsPortalFx.Base.Constants.ExtensionNames.Marketplace,MsPortalFx.Base.Constants.BladeNames.Hubs.CreateHubBlade,encodeURIComponent(u),encodeURIComponent(JSON.stringify(e)),s),this._handleBladeRoute(new o.Uri("#blade/"+c),t)))},n.prototype._handleMenuRoute=function(n){var t=this,i=n.getHashParts().rest;return yt.test(i)||ot.linkFormat(i),Q(this._diContainer.get(l.SubscriptionsUserContext).useGlobalResourceFiltersPromise).then((function(r){var e=i.toLowerCase(),u,s,f;if(e==="directory"&&rt(t._diContainer.get(FxImpl.Features)))return u=new o.Uri(n.toString()),u.setHash("#settings"),Q(t._handleSettingsRoute(u,r));if(e==="subscriptions"){if(r)return u=new o.Uri(n.toString()),u.setHash("#settings"),Q(t._handleSettingsRoute(u,r));e="directory"}s="fxs-menu-"+e;f=t._portal.getRootElement().findByClassName(s);f.length>1&&(f=d.filterVisible(t._portal.getRootElement()[0],"."+s));f.length!==1&&ot.invalidLink(i);t._updateNavHistory({skipFocus:!0});f[0].click()}))},n.prototype._handleAssetRoute=function(n,t){var h=this,c=n.getHashParts().rest,e=c.match(/([^\/]+)\/([^\/]+)\/(.+)/i);if(!e||e.length<4)return this._notify(f.Shell.deepLinkInvalid.format(c)),FxImpl.QReject("'"+c+"' is invalid. Correct format is #asset/{ExtensionName}/{AssetType}/{AssetId}");var s=decodeURI(e[1]),u=decodeURI(e[2]),o=decodeURI(e[3]),l=typeof o=="string"&&i.ArmId.parse("/"+o,!0);return l&&l.kind!==0&&(o="/"+o),MsPortalFx.tryImmediateResolve(this._manifestCache.getManifestAsync(s,"assetTypes"),(function(n){var e=u.toLowerCase(),i=MsPortalFx.find(n.assetTypes,(function(n){return n.name.toLowerCase()===e}));return i||(h._notify(f.Shell.deepLinkNotFound.format(u)),ot.unfoundAsset(u)),u=i.name,it.Telemetry.trace({source:"Asset",action:"DeepLinkVisited",name:s,data:u}),h._diContainer.get(a.CreateJourneyForAssetFunc).invoke(r(s,u,o,{},null,t))}),(function(n){h._notify(f.Shell.deepLinkNotFound.format(s));throw n;}))},n.prototype._handleResourceRoute=function(n,t){var e=this,u=n.getHashParts().rest,o,s;return u="/"+u.replace(/^\//,""),u=decodeURI(u),o=u.split("/"),s=null,o.length%2==0&&(s=o[o.length-1],u=u.substr(0,u.length-s.length-1)),MsPortalFx.tryImmediateResolve(Q(),(function(){return MsPortalFx.tryImmediateResolve(e._assetTypes.assetTypesComplete,(function(){var o=e._assetTypes.getAssetTypeByResourceType(i.ArmId.parse(u,!0).resourceType)||e._assetTypes.getAssetTypeByResourceTypeWithFallback(i.ArmId.parse(u).resourceType),h=o.assetTypeManifest,c=h.name,l=o.extension,n=h.resourceType.resourceTypeName;return c||(e._notify(f.Shell.deepLinkNotFound.format(n)),ot.noResourceAsset(n)),it.Telemetry.trace({source:"Resource",action:"DeepLinkVisited",name:l,data:n||MsPortalFx.Base.Constants.AssetNames.NonAssetResource}),e._diContainer.get(a.CreateJourneyForAssetFunc).invoke(r(l,c,u,{},s,t))}))}),(function(n){e._notify(f.Shell.deepLinkErrorLoading.format(u));throw n;}))},n.prototype._updateTitle=function(){var o=this._diContainer.get(y.DesktopManagerImpl),t=this._journeyManager.activeJourney(),n,i,r;if(this._titleLifetime&&this._titleLifetime.dispose(),this._titleLifetime=null,this._portal.settingsFlyoutState.value!==0)tt.document.title=f.Portal.windowTitleFormat.format(f.TopBar.settings,tt.fx.environment.branding.title);else if(t&&t.children.length>0){this._titleLifetime=this._ltm.createChildLifetime();var s=t.children[t.children.length-1],u=s.containerWidget,e=u&&u.options;e&&e.crumb.subscribeAndRun(this._titleLifetime,(function(n){MsPortalFx.isNullOrUndefined(n)||(tt.document.title=f.Portal.windowTitleFormat.format(n,tt.fx.environment.branding.title))}))}else{n=ut;switch(this._portal.getDisplayMode()){case"Home":n=f.Portal.windowTitleFormat.format(f.AzureHome.home,tt.fx.environment.branding.title);break;case"Dashboard":i=o.startBoard;r=i&&i.getDashboard()||{};r.title&&(n=f.Portal.windowTitleFormat.format(r.title,tt.fx.environment.branding.title));break;default:n=f.Portal.windowTitleFormat.format(f.SideBar.allServices,tt.fx.environment.branding.title)}tt.document.title=n}},n.prototype._getActiveJourneyId=function(){var n=this._journeyManager.activeJourney();return!n||n.isStartedWithContextBlade()?"":n.id},n.prototype._notify=function(n){var t=new Date;this._diContainer.getAsync(u.get("MsPortalImpl/UI/Hubs/UI.NotificationManager","NotificationManager")).then((function(i){i.addClientNotification({title:f.Shell.deepLinkInvalidTitle,description:MsPortalFx.encodeHtml(n),status:MsPortalFx.Hubs.Notifications.NotificationStatus.Error,timestamp:t,correlationIds:[t.getTime().toString()]})}))},n.prototype._updateNavHistory=function(n){var u=this,o=n&&n.addToHistory?e.history_pushState:e.history_replaceState,h=n&&n.skipFocus,i=this._journeyManager.activeJourney(),s=!0,t,f,r;if(!i){t=void 0;switch(this._portal.getRootPageDisplayType()){case"Dashboard":t="dashboard";break;case"Home":t="home";break;default:t="allservices"}return f=e.getCurrentUri(),r=f.getHashParts().category,MsPortalFx.localeCompareIgnoreCase(r,"dashboard")&&MsPortalFx.localeCompareIgnoreCase(r,"home")&&MsPortalFx.localeCompareIgnoreCase(r,"allservices")&&o(null,ut,f.setHash(t).href),this._route(e.getCurrentUri(),{skipFocus:h})}return MsPortalFx.tryImmediateResolve(i.getDeepLink(),(function(t){var l=u._getActiveJourneyId(),r;if(l){var f=i.children,h=f[f.length-1],c=h&&h.bladeDefinition;if(c&&c.menuBlade){s=!1;return}r=e.getCurrentUri();n&&n.openedAsHome?r.setHash("#home"):r.setHash(t);r.href.toLowerCase()!==location.href.toLowerCase()&&o({},document.title,r.href)}}),(function(n){ht.warning(new MsPortalFx.Errors.Error({message:"Failed to update address bar.",data:{id:u._getActiveJourneyId(),key:i.templateKey},innerErrors:n}))})).finally((function(){s&&u._updateTitle()}))},n})();n.RouterImpl=ct})(st=t.Internal||(t.Internal={}));vt=(function(){function t(){}return t.create=function(n,t){return new st.RouterImpl(n,t,g.getPortalViewModel(n))},__decorate([__metadata("fx:diagnostics",[n,"Router"]),r.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[r.Container,FxImpl.Rpc.Client]),__metadata("design:returntype",t)],t,"create",null),t})();t.Router=vt}));
define("MsPortalImpl/Base/ClaimsIdentity",["require","exports","MsPortalImpl/Services/Services.Storage"],(function(n,t,i){"use strict";function o(n){var t=Q.defer(),i=new FileReader,r="data:image/jpeg;base64,";return i.onload=function(n){for(var i=n.target.result,u="",e=new Uint8Array(i),f=0;f<e.byteLength;f++)u+=String.fromCharCode(e[f]);try{atob(u);i=r+u}catch(o){if(o.code===5)i=r+btoa(u);else{t.reject(o);return}}t.resolve(i)},i.onerror=function(){return t.reject(FxImpl.createError("Error reading thumbnail photo. Error:"+i.error))},i.readAsArrayBuffer(n),t.promise}function s(n,t,r,u,s){var h=r,c,l;return t&&(c=i.ComponentName.Avatar,l=0,h=!s&&u.getValue(c,n,l),!h)?Q(f.ajax({uri:t,type:"GET",dataType:"binary",responseType:"arraybuffer",isBackgroundTask:!0,setAuthorizationHeader:{resourceName:"graph"}})).then((function(n){return o(n)}),(function(n){var t=n.jqXHR&&n.jqXHR.status;return t!==404&&t!==403&&e.warning("Failed to get user's profile image. Status code: "+t+". Error: \n"+n),r})).then((function(t){return u.setValue(c,n,t,l),t})):Q(h)}Object.defineProperty(t,"__esModule",{value:!0});t.getAvatarImage=void 0;var r=MsPortalFx.Base,u=r.Diagnostics,f=r.Net2,e=u.createLog(n);t.getAvatarImage=s}));
define("MsPortalImpl/Base/JQueryExtensions",["require","exports","MsPortalImpl/Base/JQueryHelper"],(function(n,t,i){"use strict";function h(n,t,r){var u=MsPortalFx.find(n,(function(n){var t=$(n);return!t.hasClass(s)&&!t.hasClass("fxs-display-none")&&!MsPortalFx.startsWith(t.attr("tabindex"),"-")&&i.isVisible(t)&&(!r||r(t))}),t?-1:0);return u?$(u):$([])}function f(n){return function(i){var r=this;return[t.focusableSelector].reduce((function(t,u){return(t&&t.length)?t:h(r.find(u).toArray(),n,i)}),null)}}Object.defineProperty(t,"__esModule",{value:!0});t.focusableSelector=void 0;var u=i.findByClassName,e=window,o=e.document,s="msportalfx-skip-initial-focus",r=$.fn;t.focusableSelector="a[href], select, button, input, textarea, [tabindex]:not([tabindex='-1'])";r.setEvents=function(){for(var n,i,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return n=this,i=function(t){var i=function(){return n[t].apply(n,arguments)};r.forEach((function(n){var u=n[0],t=n[1],r;typeof t=="function"?i(u,t):(r=n[2],r&&i(u,t,r))}))},i("on"),{dispose:function(){n&&(i("off"),n=null)}}};r.findByClassName=function(n){return u(this,n)};r.findFirstTabbable=f();r.findLastTabbable=f(!0);r.isInScrollView=function(n){var u,t=n?this.closest("."+n):u=this.scrollParent();if(!t.length||!t[0].offsetParent||!t.is(u||this.scrollParent())&&!this.isInScrollView())return!1;var i=t.offset().top,f=i+t.height(),r=this.offset().top,e=r+this.height(),o=r>=i&&r<=f,s=e<=f&&e>=i;return o&&s};r.handleTransitionEndOnce=function(n,t,i){var f=this,r,e=!1,u;this.on("transitionend",r=function(t){for(var o,s=[],u=1;u<arguments.length;u++)s[u-1]=arguments[u];(o=t&&t.originalEvent,o&&o.propertyName!==n)||e||(e=!0,f.off("transitionend",r),i.apply(f,[t].concat(s)))});return u=function(){var t=$.Event("transitionend",{originalEvent:{propertyName:n}});r(t)},$.fx.off?u():setTimeout(u,t),this};$.enableAnimations=function(n){var t="fxs-transition-off-style-head-marker",r=$(FxImpl.createElement("style")).addClass(t).text("* {transition: none !important;animation-iteration-count: .5 !important;animation-duration: 0s !important;animation-delay: 0s !important;}"),i=$.querySelectorAll("head");$.fx.off=!n;n?u(i,t).remove():u(i,t).length===0&&i.append(r)};$.querySelectorAll=function(n){return $(o.querySelectorAll(n))}}));
define("MsPortalImpl/Controls/ControlBindings.Async",["require","exports","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Controls/ControlBindings"],(function(n,t,i){"use strict";function o(n,t,i,r){e.push({name:t,moduleId:n+i,initOptions:r})}function r(n,t,i){o("MsPortalImpl.Controls/",n,t,i)}function u(n,t,i){o("MsPortalImpl/Controls/",n,t,i)}function s(){t.portalControlBindings.forEach((function(n){ko.bindingHandlers[n.name]=i.getAsyncBindingHandler(n.moduleId,n.initOptions)}))}var e,f;Object.defineProperty(t,"__esModule",{value:!0});t.initialize=t.portalControlBindings=void 0;e=[];f={controlsDescendantBindings:!1};r("pcAccordion","Controls/Accordion");r("pcButton","Controls/SimpleButton");r("pcChart","Controls/Visualization/Chart");r("pcCheckBoxField","Fields/CheckBoxField");r("pcClipboardButton","Controls/ClipboardButton");r("pcConsole","Controls/Console");r("pcCopyableLabel","Controls/Forms/CopyableLabel");r("pcCreatorAndSelectorV2","Fields/CreatorAndSelectorFieldV2");r("pcCustomHtmlField","Fields/CustomHtmlField");r("pcCustomValueSlider","Fields/CustomValueSliderField");r("pcCustomRangeSlider","Fields/CustomRangeSlider");r("pcDatePickerField","Fields/DatePickerField");r("pcDateTimePickerField","Fields/DateTimePickerField");r("pcDateTimeRangePickerField","Fields/DateTimeRangePickerField");r("pcDayPickerField","Fields/DayPickerField");r("pcDiffEditor","Controls/Documents/DiffEditor");r("pcDockedBalloon","Controls/DockedBalloon");r("pcDonut","Controls/Visualization/Donut");r("pcDropDownField","Fields/DropDownField");r("pcDurationPickerField","Fields/DurationPickerField");r("pcEditor","Controls/Documents/Editor");r("pcFilterComboField","Fields/FilterComboField");r("pcFormSection","Fields/SectionField",f);r("pcGallery","Controls/Lists/List1/Gallery");r("pcGraph","Controls/Visualization/Graph");r("pcGrid","Controls/Lists/Grid1/Grid1");r("pcEditableGrid","Controls/Lists/Grid2/Grid2.EditableGrid.ctl");r("pcArrayGrid","Controls/Lists/Grid2/Grid2.ArrayGrid.ctl");r("pcDataGrid","Controls/Lists/Grid2/Grid2.DataGrid.ctl");r("pcDocsControl","Controls/DocsControl");r("pcPagedDataGrid","Controls/Lists/Grid2/Grid2.PagedDataGrid.ctl");r("pcSequentialDataGrid","Controls/Lists/Grid2/Grid2.SequentialDataGrid.ctl");r("pcPager","Controls/Pager");r("pcHeatMap","Controls/HeatMap");r("pcIFrame","Controls/IFrame");r("pcIFrame2","Controls/IFrameV2");r("pcLegend","Controls/Visualization/Legend");r("pcList2","Controls/Lists/List2/List");r("pcListView","Controls/Lists/List1/ListView");r("pcLogStream","Controls/LogStream");r("pcMap","Controls/Visualization/Map");r("pcMediaPlayer","Controls/AzureMediaPlayer");r("pcMenu","Controls/Lists/Menu");r("pcMetrics","Controls/Visualization/Metrics");r("pcMonitorChart","Controls/Visualization/MonitorChartV2/MonitorChartV2");r("pcMonitorChartV2","Controls/Visualization/MonitorChartV2/MonitorChartV2");r("pcMetricGrid","Controls/Visualization/MonitorChartV2/MetricGrid");r("pcMultiLineTextField","Fields/MultiLineTextField");r("pcNumericTextBoxField","Fields/NumericTextBoxField");r("pcOAuthButtonField","Fields/OAuthButtonField");r("pcOptionsGroupField","Fields/OptionsGroupField");r("pcPairedTimeline","Controls/Visualization/PairedTimeline");r("pcPairedTimelineBadges","Controls/Visualization/PairedTimelineBadges");r("pcPartPinner","Controls/PartPinner");r("pcPasswordField","Fields/PasswordField");r("pcPricingControl","Controls/PricingControl");r("pcPreviewTag","Controls/PreviewTag");r("pcProgressBar","Controls/Visualization/ProgressBar");r("pcQueryBuilder","Controls/Data/QueryBuilder");r("pcQuotaGauge","Controls/Visualization/QuotaGauge");r("pcRangeSliderField","Fields/RangeSliderField");r("pcSearchBox","Controls/SearchBox");r("pcResourceFilter","Controls/ResourceFilter");r("pcSection","Fields/Section");r("pcSelectorField","Fields/SelectorField");r("pcSimpleButton","Controls/SimpleButton");r("pcSingleValueGauge","Controls/Visualization/SingleValueGauge");r("pcSliderField","Fields/SliderField");r("pcSpecComparisonTable","Controls/SpecComparisonTable");r("pcSplitter","Fields/Splitter",f);r("pcSplitter2","Fields/Splitter2");r("pcSummary","Controls/Summary");r("pcTextBlock","Controls/TextBlock");r("pcTextBox","Fields/TextField");r("pcTextField","Fields/TextField");r("pcTimePickerField","Fields/TimePickerField");r("pcToolbar","Controls/Toolbars/Toolbar");r("pcTreeView","Controls/Lists/Tree1/TreeView");r("pcTriStateCheckBox","Fields/TriStateCheckBox");r("pcMarkdown","Controls/Markdown");r("pcVideo","Controls/Video");r("pcRecommendations","Controls/Recommendations/Recommendations");u("pcAsyncFileUpload","Forms/AsyncFileUpload");u("pcDeleteAssetConfirmation","Controls.DeleteAssetConfirmation");u("pcEssentials","Controls.Essentials");u("pcFileDownloadButton","Controls.FileDownloadButton");u("pcResourceDropDown","Forms/ResourceDropDown");u("pcHeroBanner","Controls.HeroBanner");u("pcHotSpot","Controls.HotSpot",f);u("pcInfoBox","Controls.InfoBox");u("pcNotice","Controls.Notice");u("pcPicker","Controls.Picker");u("pcPickerV3","Controls.PickerV3");u("pcPill","Controls.Pill");u("pcPillCollection","Controls.PillCollection");u("pcPillList","Controls.PillList");u("pcTagsByResource","Controls.TagsByResource");u("pcWizard","Controls.Wizard");u("pcIntuneAppFileUpload","Forms/IntuneAppFileUpload");u("pcFileShareDropDown","Storage/FileShareDropDown");u("pcArmErrorList","ArmErrorList/Controls.ArmErrorList");u("pcStorageAccountDropDown","Storage/StorageAccountDropDown");u("pcToggle","Controls.Toggle");u("pcBlobContainerDropDown","Storage/BlobContainerDropDown");u("pcGroupDropDownField","Forms/DropDown");t.portalControlBindings=e;t.initialize=s}));
define("MsPortalImpl/InitShellWorker",["require","exports","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Extension/Extension","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/Services/Services.AssetTypes","ShellWorker/ExtensionWorkerPrewarmer","ShellWorker/IFrameExtensionLoader","ShellWorker/AuthorizationState","ShellWorker/Browse","ShellWorker/Locations","ShellWorker/Subscriptions","ShellWorker/GlobalResourceFilters","ShellWorker/UserInfo","ShellWorker/AssetTypes","ShellWorker/PreloadData"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d){"use strict";function et(n,t){nt(n,t).then((function(){it(n,t)}))}function nt(n,t){var o=new MessageChannel,s;return FxImpl.localRpcPort=o.port1,s=o.port2,Promise.all([n.getAsync(e.AuthStateManager),n.getAsync(u.ExtensionManagerOptions),n.getAsync(f.InitializedManifestCache),n.getAsync(r.ManifestCache),n.getAsync(FxImpl.Rpc.Client),n.getAsync(i.ExtensionManager),]).then((function(n){var i=n[0],r=n[1],o=n[2],f=n[3],e=n[4],u=i.getCurrentUser();tt({extensions:r.extensionsAsMap,manifests:FxImpl.mapValues(r.extensionsAsMap,(function(n){return f.getManifest(n.name,"assetTypes")})),extensionRedirectMap:r.extensionRedirectMap,authState:MsPortalFx.extend2(i,{userObjectId:u.objectId,userTenantId:u.tenantId})},s,t);st(e,i,t)}))}function tt(n,t,i){var r={onBootstrapError:function(n){MsPortalFx.Base.Diagnostics.Log.writeEntry2(2,"InitShellWorker",n.error||"unknown error from worker",9999,n.message&&[n.message])},uploadDiagnostics:function(n){var i=n.telemetryEvent,t=n.logEntry,r=n.flush;i&&MsPortalFx.Base.Diagnostics.Telemetry.trace(i);t&&MsPortalFx.Base.Diagnostics.Log.writeEntry2(t.level,t.area,t.message,t.code,t.args);r&1&&MsPortalFx.Base.Diagnostics.Telemetry.flush();r&2&&MsPortalFx.Base.Diagnostics.Upload.flush()}};MsPortalEarly.ShellWorkerLoader.initWorker(ot(n),t,r,i)}function it(n,t){var u=this,i=n.getAsync(s.SubscriptionsUserContext),r=n.getAsync(s.ServicesSubscriptions),f=function(){return __awaiter(u,void 0,void 0,(function(){var t,r;return __generator(this,(function(u){switch(u.label){case 0:return[4,i];case 1:return t=u.sent(),[4,t.useGlobalResourceFiltersPromise];case 2:return(r=u.sent(),!r)?[2]:[2,MsPortalFx.require("MsPortalImpl/Services/Services.GlobalResourceFilters").then((function(t){return n.getAsync(t.ResourceFilterManager)})).then((function(n){return n.currentFilterObservable}))]}}))}))};rt(n.get(FxImpl.Rpc.Client),{locations:o.lazyUserDataMemo(n).then((function(n){var t=n.locations;return t.value})),preloadedData:MsPortalEarly.preload,startupSubscriptionsInfo:r.then((function(n){return n.startupSubscriptionsInfoMemo()})).then((function(n){var t=n.subscriptionsMap;return{subscriptions:FxImpl.mapValues(t,(function(n){return n.subscription}))}})),subscriptionsCount:i.then((function(n){return n.getAllSubscriptionsCount()})),inSessionSelectedSubscriptions:i.then((function(n){return n.getInSessionSelectedSubscriptions()})),userInfo:n.getAsync(e.AuthStateManager).then((function(n){return n.getUserInfo()})),assetTypes:n.getAsync(h.AssetTypeService).then((function(n){return h.assetTypesMemo(n)})),globalSelectedSubscriptions:i.then((function(n){return n.useGlobalResourceFiltersPromise})).then((function(n){return n?r.then((function(n){return n.globalSelectedSubscriptionsObservable})):undefined})),globalResourceFilter:f()},t)}function rt(n,t,i){var nt=this,r,u,f,e,o,s,h,c,l,a;i===null||i===void 0?void 0:i.registerForDispose((function(){n=null}));l=t.preloadedData;l&&(a=MsPortalFx.require("MsPortalImpl/Services/Services.Settings"),l.then((function(t){return __awaiter(nt,void 0,void 0,(function(){var i,u,f,y,e,c,l,r,o,s,h;return __generator(this,(function(p){switch(p.label){case 0:return n&&d.pushPreloadDataEndPoint.invoke(n,"fxw",{variants:t===null||t===void 0?void 0:t.variants}),i=t===null||t===void 0?void 0:t.settings,[4,a];case 1:return u=p.sent(),f=u.Internal,y=u.SettingStore,e=f.getSettingStoreName(15),c=(r={},r[15]=(o=i===null||i===void 0?void 0:i[e])===null||o===void 0?void 0:o[g],r[6]=(s=i===null||i===void 0?void 0:i[f.getSettingStoreName(6)])===null||s===void 0?void 0:s[g],r),l=(h=i===null||i===void 0?void 0:i[e])===null||h===void 0?void 0:h[ft],n&&v.pushBrowseMetadataEndPoint.invoke(n,"fxw",{columns:c,favoriteViewIds:l,browseManifestsUri:MsPortalEarly.siteRelUriToAbsolute(MsPortalEarly.getCachedManifestUri("assetTypesBrowse"))}),[2]}}))}))})));(r=t.locations)===null||r===void 0?void 0:r.then((function(t){var i=MsPortalFx.extendArrayIntoMap(Object.create(null),t,(function(n){return n.name}),(function(n){var t=n.metadata||{};return{displayName:n.displayName,latitude:t.latitude,longitude:t.longitude}}));n&&y.pushLocationsEndPoint.invoke(n,"fxw",i)}));(u=t.inSessionSelectedSubscriptions)===null||u===void 0?void 0:u.then((function(t){t.subscribeAndRun(new FxImpl.TriggerableLifetimeManager,(function(t){n&&t&&p.pushSelectedSubscriptionsEndpoint.invoke(n,"fxw",{inSession:t})}))}));(f=t.globalSelectedSubscriptions)===null||f===void 0?void 0:f.then((function(t){t===null||t===void 0?void 0:t.subscribe(new FxImpl.TriggerableLifetimeManager,(function(t){n&&p.pushGlobalFilterSubscriptionsEndpoint.invoke(n,"fxw",t)}))}));(e=t.globalResourceFilter)===null||e===void 0?void 0:e.then((function(t){t===null||t===void 0?void 0:t.subscribeAndRun(new FxImpl.TriggerableLifetimeManager,(function(t){n&&t&&w.pushActiveGlobalResourceFilterEndPoint.invoke(n,"fxw",t)}))}));(o=t.startupSubscriptionsInfo)===null||o===void 0?void 0:o.then((function(t){n&&p.pushStartupSubscriptionsEndpoint.invoke(n,"fxw",t)}));(s=t.subscriptionsCount)===null||s===void 0?void 0:s.then((function(t){n&&p.pushSubscriptionsCountEndpoint.invoke(n,"fxw",t)}));(h=t.userInfo)===null||h===void 0?void 0:h.then((function(t){n&&b.pushUserInfoEndpoint.invoke(n,"fxw",t)}));(c=t.assetTypes)===null||c===void 0?void 0:c.then((function(t){n&&k.pushAssetTypesEndPoint.invoke(n,"fxw",t)}))}function ot(n){var r,u=n.extensions,h=n.manifests,c=n.extensionRedirectMap,t=n.authState,f=Object.keys(u).reduce((function(n,t){return u[t].flags&256||(n[t]=u[t]),n}),{}),o=Object.keys(f).reduce((function(n,t){return n[t]=h[t],n}),{}),l=location.host,a=location.protocol,v=location.origin,y=location.pathname,i=t.bootstrapState,p=t.tokenCache,w=t.userObjectId,b=t.userTenantId,k=((r=fx===null||fx===void 0?void 0:fx.environment)===null||r===void 0?void 0:r.writesDisallowedTenants)||[],d=k.indexOf(b)!==-1,e=i===null||i===void 0?void 0:i.oAuthToken,g={portalToken:e&&{header:e.authHeader,expiresAt:e.expiresInMs+i.createdOn},extensionTokens:p||{},userObjectId:w,isWritesDisallowedTenant:d},s=fx.internalEnv,nt=fx.environment;return{internalEnv:s,environment:MsPortalFx.extend2(nt,{requireConfig:MsPortalFx.extend2(s.fxRequireConfig,{deps:[]})}),location:{host:l,protocol:a,origin:v,pathname:y},shellFeatures:FxImpl.features.shellFeatures,initOptions:{extensions:f,manifests:FxImpl.mapValues(o,(function(n){var t=n.pageVersion,i=n.prewarmerScript,r=n.weaveBladesMap,u=n.enableExperimentation;return{pageVersion:t,prewarmerScript:i,weaveBladesMap:r,enableExperimentation:u}})),loadTypes:FxImpl.mapValues(o,(function(n,t){var i=n.flags;return ut(f[t],i)})),extensionRedirectMap:c,authorizationState:g,effectiveLocale:FxImpl.Intl.effectiveLocale},userQuery:MsPortalEarly.userQuery}}function st(n,t,i){i===null||i===void 0?void 0:i.registerForDispose((function(){n=null}));t.onTokensUpdated((function(t){var i=t.bootstrapState,u=t.tokenCache,r=i===null||i===void 0?void 0:i.oAuthToken;n&&a.pushShellAuthTokensEndPoint.invoke(n,"fxw",{portalToken:r&&{header:r.authHeader,expiresAt:r.expiresInMs+i.createdOn},extensionTokens:u})}));(function(){var t=Object.create(null);l.loadExtensionInIFrameEndPoint.register(n,"fxw",(function(i){var u,f=new Promise(function(n){u=function(t){n({telemetry:MsPortalFx.extend2(r.telemetry,{loadType:0}),error:t})}}),e=n.detachPort("fxw",i.portId),r=new MsPortalEarly.ExtensionLoader.IFrameLoadContext(__assign(__assign({},i),{errorHandler:u,port:e}));return r.initializeReceived.then((function(){u()})),r.startLoad(),t[i.iframeId]=function(){r.cleanup();delete t[i.iframeId]},f}));l.disposeExtensionIFrameEndPoint.register(n,"fxw",(function(n){var r=n.iframeId,i=t[r];i===null||i===void 0?void 0:i()}))})(),(function(){var t=Object.create(null),r;i===null||i===void 0?void 0:i.registerForDispose((function(){MsPortalFx.forEachKey(t,(function(n){t[n].terminate()}))}));r=i?MsPortalEarly.ExtensionLoader.createPrewarmer():MsPortalEarly.ExtensionLoader.prewarmer;r.setListener({onCreated:function(i){var f=i.workerId,e=i.bootstrapPort,o=i.terminate,r,u;t[f]={terminate:function(){r===null||r===void 0?void 0:r();o()}};n&&(u=n.acquireWindow("fxw",0,e),r=function(){u.dispose()},c.pushNewWorkerEndPoint.invoke(n,"fxw",{workerId:f,portId:u.value}))},onBootComplete:function(i,r){n&&t[i]&&c.onWorkerBootCompleteEndPoint.invoke(n,"fxw",{workerId:i,error:r});r&&delete t[i]}});c.terminateWorkerEndPoint.register(n,"fxw",(function(n){var r=n.workerId,i=t[r];delete t[r];i===null||i===void 0?void 0:i.terminate()}));c.onGetWorkerCalledEndPoint.register(n,"fxw",(function(){r.onGetWorkerCalled()}))})()}Object.defineProperty(t,"__esModule",{value:!0});t.pushShellState=t.pushShellStateFromContainer=t.initWorker=t.initWorkerFromContainer=t.init=void 0;var ut=MsPortalEarly.ExtensionLoader.getLoadType,g="browse_columns",ft="favorite_views";t.init=et;t.initWorkerFromContainer=nt;t.initWorker=tt;t.pushShellStateFromContainer=it;t.pushShellState=rt}));
define("_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css",["module"],(function(n){"use strict";return{css:".fxs-keyboardshortcuts{width:355px;height:100%;max-width:100%}.fxs-keyboardshortcuts-scrollcontent{padding-top:10px;overflow:auto;height:100%}.fxs-keyboardshortcuts-category{margin-top:20px}.fxs-keyboardshortcuts-shortcut{display:flex}.fxs-keyboardshortcuts-key{flex:0 0 auto;width:113px}",moduleId:n.id}}));
define("MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/Widgets/Widgets.Portal","MsPortalImpl/Base/Base.Router","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.DeepLink","FxInternal/Css","_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";c.injectCss(l);var a;return (function(t){function ot(n){var t=n.getDisplayMode()==="Journey"&&n.panorama;return t&&t.getJourneyWidget()}function y(n){var t=ot(n),i=t&&t.getFocusedBlade();return i?i:t&&MsPortalFx.last(t.getBlades())}function w(n,t,i,r,u,f){return new b(n,t,i,r,u,f)}function ht(){a=!0}var p=MsPortalFx.Base.Diagnostics,k=p.Telemetry,l=window,d="#blade/HubsExtension/BrowseAllResourcesBlade/resourceType/Microsoft.Resources%2Fresources",g="#blade/HubsExtension/BrowseResourceGroupBlade/resourceType/Microsoft.Resources%2Fsubscriptions%2FresourceGroups",a=s.isMac,nt="fxs-sidebar-collapse-button",tt="fxs-topbar-sidebar-collapse-button",it="fxs-topbar-home",c=r.KeyboardShortcuts,v=c.GoTo,rt=p.createLog(n),ut=k.trace,ft=[49,50,51,52,53,54,55,56,57,48,],et=[97,98,99,100,101,102,103,104,105,96,],st=(function(){function t(){}return t.create=function(n,t,i,r){return w(n,t,(function(){return i.invoke()}),(function(){return r.invoke()}),null,l.fx.environment.chrome.hideShortcuts)},__decorate([__metadata("fx:diagnostics",[n,"KeyboardShortcutHandler"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[e.ViewModel,o.Router,f.DownloadDiagnosticsJson,f.ShowDebugTools]),__metadata("design:returntype",t)],t,"create",null),__decorate([__metadata("fx:diagnostics",[n,"KeyboardShortcutHandler"]),i.Class()],t)})(),b;t.KeyboardShortcutHandler=st;t.setup=w;t.fakeMacOS=ht;b=(function(){function n(n,t,i,r,u,f){this._keyShortcuts={};this._goToShortcuts={};this._eventHandlers=[];this._errorLoggingFunc=u||function(n){rt.error(n)};this._registerShortcut(c.showDiagnostics,i,65,9);this._registerShortcut(c.showDebugHelper,r,68,9);f||(this._addKeyShortcuts(n),this._addGoToShortcuts(t,n),this._registerShortcut(c.moveFavoritesUp,(function(){n.sideBar.reorderFavorites(38)}),38,5),this._registerShortcut(c.moveFavoritesDown,(function(){n.sideBar.reorderFavorites(40)}),40,5));this._attachEventHandlers()}return n.prototype.dispose=function(){this._removeEventHandlers()},n.prototype._attachEventHandlers=function(){var t=this;this._removeEventHandlers();var n=!1,r=function(i){var s,f,r;if(!i.repeat){var e=u.getModifierKeys(i),o=i.keyCode;if(o===71&&e===0){n=!0;return}(s=n?t._goToShortcuts[o]:t._keyShortcuts[o],f=s&&s[e],f)&&((r=$(document.activeElement),r.length>0&&e===0&&(r.is("input")||r.is("textarea")||["azc-editableControl","fxc-editor","fxc-console"].some((function(n){return r.closest("."+n).length>0}))))||(f.handler(),ut({source:"KeyboardShortcuts",action:"KeyboardShortcutExecuted",name:f.id}),i.preventDefault()))}},f=function(t){t.keyCode===71&&(n=!1)},i=this._eventHandlers;i.push({eventType:"keydown",handler:r},{eventType:"keyup",handler:f});i.forEach((function(n){l.document.addEventListener(n.eventType,n.handler)}))},n.prototype._removeEventHandlers=function(){this._eventHandlers.forEach((function(n){l.document.removeEventListener(n.eventType,n.handler)}))},n.prototype._registerShortcut=function(n,t,i,r){var f,u,e,o;r===void 0&&(r=0);f=this._keyShortcuts[i];u=r;a&&u&8&&n!==c.showDebugHelper&&(u=u^8|2);e=this._generateIdForKeyboardShortcut(i,u);o={description:n,handler:t,id:e};f?f[u]&&this._errorLoggingFunc("Duplicate shortcut: "+e):this._keyShortcuts[i]=[];this._keyShortcuts[i][u]=o},n.prototype._addKeyShortcuts=function(n){this._registerGotoShortcut(c.toggleFocusSideAndTopBar,(function(){var n=$(document).findByClassName(it)[0],t=$(document).findByClassName(tt)[0];$(document.activeElement)[0]===n?$(t).is(":visible")?t.focus():$(document).findByClassName(nt)[0].focus():n.focus()}),190);this._registerGotoShortcut(c.moveFocusToCommandBar,(function(){var t=y(n),i=t&&t.getContentWidget();i&&i.setFocusOnCommandBar()}),188);this._registerShortcut(c.bladeSearch,(function(){var t=y(n);t&&t.focusSearchBox()}),191,8);this._registerShortcut(c.bladeSearch,(function(){var t=y(n);t&&t.focusSearchBox()}),55,12)},n.prototype._registerGotoShortcut=function(n,t,i){var r=0,u=this._goToShortcuts[i],f=this._generateIdForKeyboardShortcut(i,r,!0),e={description:n,handler:t,id:f};u?u[r]&&this._errorLoggingFunc("Duplicate goto shortcut: "+f):this._goToShortcuts[i]=[];this._goToShortcuts[i][r]=e},n.prototype._addGoToShortcuts=function(n,t){var r=this,i;this._registerGotoShortcut(c.browse,(function(){l.location.href=h.getAllServicesDeeplink()}),66);this._registerGotoShortcut(c.new,(function(){t.sideBar.openCreate()}),78);this._registerGotoShortcut(c.search,(function(){t.topBar.searchViewModel.setFocus()}),191);[[v.allResources,d,65],[v.resourceGroups,g,82],].forEach((function(t){r._registerGotoShortcut(t[0],(function(){n.route(t[1])}),t[2])}));this._registerGotoShortcut(v.dashboard,(function(){n.navigateToDashboard("KeyboardShortcuts")}),68);i=function(n,i){var u=i+1;r._registerGotoShortcut(v.sideBarItem+u,(function(){t.sideBar.openFavorite(i)}),n)};ft.forEach(i);et.forEach(i)},n.prototype._generateIdForKeyboardShortcut=function(n,t,i){i===void 0&&(i=!1);var r=i?"G+":"";return t>15&&this._errorLoggingFunc("Not allowed modifier!"),t&8&&(r+="CTRL+"),t&1&&(r+=a?"OPT+":"ALT+"),t&2&&(r+=a?"CMD+":"WIN+"),r+u.mapKeyCodeToString((t&4)==4,n)},n.prototype.getShortcuts=function(){return{key:this._keyShortcuts,goTo:this._goToShortcuts}},n})()})(a||(a={})),a}));
define("MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop",["require","exports","MsPortalImpl/Base/Base.Events","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.FlowLayout"],(function(n,t,i,r,u,f,e){"use strict";function ht(n){var i=n.target,t=$(i);if(!o||o.htmlTarget===i){if(o={htmlTarget:i,elementObject:t,width:t.outerWidth(!1),height:t.outerHeight(!1)},y.top=-n.offsetY,y.left=-n.offsetX,s=tt(t.closest(c),e.Widget),!s){n.preventDefault();nt(n);return}t.css("opacity",.75);b=h=g({left:n.pageX,top:n.pageY});r.register(ut)}}function k(n){if(o){l.off(c);var t=o.elementObject,i=t.attr("dragdrop.revert")==="true",u={left:n.pageX,top:n.pageY};r.unregister(ut);i&&t.attr("dragdrop.revert","false");d();i&&lt();t.css("opacity",1);h=i?b:g(u);s.moveChild(o.elementObject,Math.max(h.col,0),Math.max(h.row,0),!0);et()}}function ft(){o.elementObject.attr("dragdrop.revert","true").trigger("mouseup")}function ct(n,t){if(s){var i=g(t);i.col===h.col&&i.row===h.row||(h=i)}d();a=setTimeout((function(){a=null;s&&s.moveChild(o.elementObject,Math.max(h.col,0),Math.max(h.row,0),!1)}),50)}function d(){a&&(clearTimeout(a),a=null)}function lt(){s&&(d(),s.refreshLayout())}function g(n){var t=s.element,i=t.offset(),r={left:n.left+y.left,top:n.top+y.top},f=r.left-i.left+t.scrollLeft(),e=r.top-i.top+t.scrollTop(),o=Math.floor((f+.33*u.GridSpacingWidth)/u.GridSpacingWidth),h=Math.floor((e+.33*u.GridSpacingHeight)/u.GridSpacingHeight);return{col:o,row:h}}function et(){s=null;b=null;h=null;o=null}function ot(){var t=$.querySelectorAll(c),n=[];return t.each((function(t,i){var r=tt($(i),e.Widget),u=r.options;u.allowReorder&&!u.locked()&&n.push(r.element.findByClassName("fxs-flowlayout-childcontainer"))})),n}function nt(n){ft();k(n)}var st;Object.defineProperty(t,"__esModule",{value:!0});t.FlowLayoutDragDrop=void 0;var p=window,l=$(p.document.body),tt=f.Widget.getWidget,it="ui-draggable",v="draggable",rt=it+" fxs-drag-disableTouchAction",w=".fxs-tile:not(.fxs-tilesize-herowidefitheight):not(.fxs-tilesize-fullwidthfitheight):not(.fxs-tilesize-fittocontainer)",c=".fxs-flowlayout",ut={dismissFn:ft,logName:"flowlayoutdragdrop"},o,s,b,h,a,y={left:0,top:0};st=(function(){function n(){if(n._singleton)throw new Error("FlowLayoutDragDrop operates as a singleton.");n._singleton=this}return n.prototype.dispose=function(){this.disableDragDropTargets();et();n._singleton=null},Object.defineProperty(n,"Instance",{get:function(){return n._singleton||(n._singleton=new n),n._singleton},enumerable:!1,configurable:!0}),n.prototype.enableDragDropOnSingleTarget=function(n){if(n.attr(v)!=="true"){n.attr(v,"true");var t=n.filter(w).addClass(rt);t.on("dragstart",(function(n){var t,r;if(o&&nt(n),i.isFullscreen()||n.target!==n.currentTarget){n.preventDefault();return}t={left:n.pageX,top:n.pageY};l.on("dragover"+c,(function(n){n.preventDefault();var i={left:n.pageX,top:n.pageY};(i.left!==t.left||i.top!==t.top)&&ct(n,t=i)}));l.on("drop"+c,(function(n){n.preventDefault();k(n)}));l.on("dragend"+c,(function(n){k(n)}));l.on("dragleave"+c,(function(n){0<n.clientX&&n.clientX<p.innerWidth&&0<n.clientY&&n.clientY<p.innerHeight||nt(n)}));r=n.originalEvent.dataTransfer;r.setData("text","fxs-draganddrop");r.effectAllowed="move";ht(n)}))}},n.prototype.enableDragDropTargets=function(){var n=this;ot().forEach((function(t){t.on("mouseenter",w,(function(t){var i=$(t.currentTarget);i.attr(v)!=="true"&&n.enableDragDropOnSingleTarget(i)}))}))},n.prototype.disableDragDropTargets=function(){ot().forEach((function(n){return n.off("mouseenter",w)}));$.querySelectorAll("."+it).removeClass(rt).off("dragstart").removeAttr(v)},n})();t.FlowLayoutDragDrop=st}));
define("_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css",["module"],(function(n){"use strict";return{css:".fxs-desktop-organize .fxs-tile .fxs-tile-content{z-index:0}.fxs-desktop-organize .fxs-tile .fxs-tile-overlay{display:block;-ms-touch-action:none;touch-action:none}.fxs-desktop-organize .fxs-tile:hover .fxs-tile-overlay{background-color:transparent}.fxs-desktop-organize .fxs-tile.fxs-tilesize-custom .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-mini .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-small .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-tall .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-wide .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-normal .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-large .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herotall .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herowide .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-hero .fxs-tile-overlay{cursor:move}.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-help .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-context .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-contextaction .fxs-tile div.fxs-tile-overlay{background-color:transparent}.fxs-desktop-organize .fxs-sidebar{display:none !important}.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-migration,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-dropdown,.fxs-desktop-organize .fxs-startboard-filter,.fxs-desktop-organize .fxs-startboard-commandBar{display:none}.fxs-desktop-organize .fxs-hide-in-customize{visibility:hidden}.fxs-desktop-organize .fxs-startboard-layout>.fxs-flowlayout-childcontainer{min-height:2155px;min-width:3865px}.fxs-desktop-organize .fxc-hotspot-customclick{z-index:1}.fxs-desktop-organize .fxs-startboard-customize-header .fxs-startboard-button{padding:15px 5px}.fxs-desktop-organize .fxs-contextpane .fxs-tile .fxs-tile-overlay{display:none}.fxs-desktop-normal .fxs-hide-in-normal{display:none}@media(max-width:700px){.fxs-startboard-customize-header{min-height:initial}.fxs-startboard-customize-description{display:none}}",moduleId:n.id}}));
define("MsPortalImpl/UI/UI.DesktopModeManager",["require","exports","MsPortalImpl/Base/Base.Events","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop","MsPortalImpl/Services/Services.Settings","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.DesktopManagerImpl","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Resources/Resources.Images","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){"use strict";function rt(n,t,r){var c=n.get(s.DesktopManagerImpl),e=n.get(o.DesktopManagerMode).value,u=new b(t,n,r),h=function(n){var t=$(n.target).closest(g);return l.Widget.getWidget(t,a.Widget)},f=t.panorama.getStartBoardArea();t.topBar.exitOrganizeMode=function(){n.get(o.DesktopManagerMode).value(0);var t=c.startBoard.widget.element.find(".fxs-startboard-button-edit>.azc-toolbarButton-container");t.length&&t.focus()};f.on("fxenterorganizemode",(function(n,t){n.stopPropagation();var i=h(n);t=$.extend({},t);MsPortalFx.isNullOrUndefined(t.trigger)&&(t.trigger=i?0:1);i&&(i.options.selected(!0),u.updateTileSelection(i));u.startPartManagement(t).then((function(){i&&i.showTileManagementContextMenu()}))}));f.on("fxopentilegallery",(function(n){e()===1&&(n.stopPropagation(),u.startPartManagement({openTileGallery:!0}))}));f.on("click",d,(function(n){var i=h(n),t=i&&i.options;t&&!t.locked()&&(t.selected(!t.selected()),u.updateTileSelection(i))}));f.on("click",nt,(function(n){if(e()===1){var i=h(n),t=i&&i.options;!t||t.locked()||t.selected()||(t.selected(!0),u.updateTileSelection(i))}}));f.on("dragstart",it,(function(n){if(i.isFullscreen()){n.preventDefault();return}e()!==1&&e(1);var t=h(n),r=t&&t.options;r&&!r.selected()&&(r.selected(!0),u.updateTileSelection(t))}));f.on("fxpartcreated",(function(n,t){n.stopPropagation();var i=t.widget;i.options.selected(!0);u.updateTileSelection(i)}));return u}var b;Object.defineProperty(t,"__esModule",{value:!0});t.DesktopModeManagerImpl=t.createDesktopModeManager=void 0;p.injectCss(w,{moduleId:"flowlayoutGridShadowUri",css:".fxs-desktop-organize .fxs-flowlayout-childcontainer {"+("background: url("+v.getFlowLayout().gridShadow+");")+"}"});var k=l.Widget.widgetRemoveEvent,d="."+a.overlayClassName,g="."+a.widgetClassName,nt="."+a.actionBarContainerClassName,tt="fxs-partgallery-container",it=".ui-draggable";t.createDesktopModeManager=rt;b=(function(){function n(n,t,i){var r=this;this._diContainer=t;this._dismissHandle={dismissFn:function(){r._mode(0)},logName:"desktopmodemanager"};this._mode=t.get(o.DesktopManagerMode).value;this._portal=n;this._lifetime=i;this._userSettingsManager=t.get(f.SettingsManager);this._contextPane=t.get(e.RightContextPane);this._partMgmtStarted=!1;this._selectedTile=null;this._handleModeChange(i)}return Object.defineProperty(n.prototype,"selectedTile",{get:function(){return this._selectedTile},enumerable:!1,configurable:!0}),n.prototype.updateTileSelection=function(n){var t=this;if(this._deselectCurrentTile(),n.options.selected()&&(this._selectedTile=n),this._selectedTile)this._selectedTile.element.on(k,this._tileRemoveHandler=function(n){n.target===t._selectedTile.element[0]&&t._deselectCurrentTile()})},n.prototype.startPartManagement=function(n){var t=this,i;return this._partMgmtStarted?Q():(this._mode(1),n.openTileGallery?(i=this._contextPane,this._partMgmtStarted=!0,i.tryOpen(this).then((function(){var n=t._partGalleryVm;return MsPortalFx.require("MsPortalImpl/UI/UI.PartGalleryManager").then((function(i){t._partGalleryManager||(t._partGalleryManager=i.create(t._lifetime.createChildLifetime(),t._diContainer,n))}))}))):Q())},n.prototype.onAddingContent=function(n){var t=this;return MsPortalFx.require("MsPortalImpl/Widgets/Widgets.PartGallery").then((function(i){var u,r;return t._partGalleryVm||(t._partGalleryVm=new i.ViewModel(t._lifetime,t._diContainer)),u=t._partGalleryVm,t._partGalleryWidget?void 0:(r=$(FxImpl.createElement("div",{"class":tt})),n.getWidget().getBladeHost(r,{title:y.PartGallery.title,bladeWidth:0}).then((function(f){n.getWidget().addChild(f);var e=t._partGalleryWidget=i.create(r,u);e.ltm.registerForDispose(f)})))}))},n.prototype.onRemovingContent=function(n){this._partMgmtStarted=!1;this._partGalleryWidget.dispose();this._partGalleryWidget=null;n.getWidget().clear()},n.prototype._enterOrganizeMode=function(){var n=this._portal;return(n.inOrganizeMode(!0),r.register(this._dismissHandle),u.FlowLayoutDragDrop.Instance.enableDragDropTargets(),!this._partMgmtStarted)?this.startPartManagement({}):Q()},n.prototype._exitOrganizeMode=function(){var t=this._portal,n;u.FlowLayoutDragDrop.Instance.disableDragDropTargets();t.inOrganizeMode(!1);n=this._contextPane;n.close(!0);this._deselectCurrentTile();this._userSettingsManager.flushSettings();r.unregister(this._dismissHandle)},n.prototype._handleModeChange=function(n){var t=this;this._mode.subscribe(n,(function(n){switch(n){case 1:t._diContainer.getAsync(c.DialogManager).then((function(n){n.dismissOpenDialog()}));var r=t._diContainer.get(h.JourneyManager),u=r.activeJourney();u&&r.forceDiscardJourney(u.id);t._enterOrganizeMode();i.isFullscreen()&&i.exitFullscreen();break;case 0:default:t._exitOrganizeMode()}}))},n.prototype._deselectCurrentTile=function(){this._selectedTile&&(this._selectedTile.element.off(k,this._tileRemoveHandler),this._tileRemoveHandler=null,this._selectedTile.options.selected(!1),this._selectedTile=null)},n})();t.DesktopModeManagerImpl=b}));
define("MsPortalImpl/UI/Compositions/UI.Composition.Services",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.Router","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/UI/Commands/UI.CommandManager","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManagerImpl","MsPortalImpl/UI/UI.DesktopModeManager","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Portal"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";function b(n,t,i){return t.get(f.PortalCommandManager),t.get(r.Router),h.createNotificationManager(t),MsPortalFx.tryImmediateResolve(i.onWidgetCreate(),(function(){s.createDesktopModeManager(t,i,n)})),t}var a,v,y,p,w;Object.defineProperty(t,"__esModule",{value:!0});t.initialize=t.FeedbackPaneInfo=t.WhatsNewModal=t.HatsModal=t.UpdateContactModal=void 0;a=MsPortalFx.require;v=(function(){function t(n){this.callBack=n}return t.create=function(n,i){return new t(function(t){a("MsPortalImpl/Widgets/Dialogs/Widgets.UpdateContact").then((function(r){new r.Widget($(FxImpl.createElement("div")),new r.ViewModel,t.profile,t.irisNotificationDetails,i.getRootElement(),n)}))})},__decorate([__metadata("fx:diagnostics",[n,"UpdateContactModal"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.Container,l.ViewModel]),__metadata("design:returntype",t)],t,"create",null),t})();t.UpdateContactModal=v;y=(function(){function t(n){this.callBack=n}return t.create=function(n,i){return new t(function(t){a("MsPortalImpl/Widgets/Dialogs/Widgets.HatsModal").then((function(r){new r.Widget($(FxImpl.createElement("div")),new r.ViewModel,t.tasks,i.getRootElement(),n)}))})},__decorate([__metadata("fx:diagnostics",[n,"HatsModal"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.Container,l.ViewModel]),__metadata("design:returntype",t)],t,"create",null),t})();t.HatsModal=y;p=(function(){function t(n){this.callBack=n}return t.create=function(n,i){return new t(function(t){MsPortalFx.isFeatureEnabled("whatsnew")&&n.whatsNewEnabledKey()&&a("MsPortalImpl/Widgets/Widgets.WhatsNew").then((function(n){var r=t.items.map((function(n){var t=n.published?new Date(n.published).toLocaleString():"";return n.description+="\r\n"+t,n}));new n.Widget($(FxImpl.createElement("div")),new c.ViewModel,r,i.getRootElement())}))})},__decorate([__metadata("fx:diagnostics",[n,"WhatsNewModal"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[u.GeneralSettings,l.ViewModel]),__metadata("design:returntype",t)],t,"create",null),t})();t.WhatsNewModal=p;w=(function(){function t(){}return t.create=function(t,i,r){return a("../../Widgets/Widgets.FeedbackPane",n).then((function(n){return{amdModule:n,widget:new n.FeedbackPane(t,i,function(){return r.getCurrentBladeInfo()})}}))},__decorate([__metadata("fx:diagnostics",[n,"FeedbackPaneInfo"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.Container,e.RightContextPane,o.DesktopManagerImpl]),__metadata("design:returntype",void 0)],t,"create",null),t})();t.FeedbackPaneInfo=w;t.initialize=b}));
define("MsPortalImpl/Notifications/WhatsNewCheck",["require","exports","FxHubs/HubsSettingsSchema","MsPortalImpl/Notifications/NotificationsClientStrings","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/Services/Services.Settings","MsPortalImpl/UI/Compositions/UI.Composition.Services","MsPortalImpl/UI/Hubs/UI.NotificationManager"],(function(n,t,i,r,u,f,e,o){"use strict";function c(n,t){var i=t.length===1?r.WhatsNewNotification.oneTitle:r.WhatsNewNotification.twoOrMoreTitle.format(t.length);return n.getAsync(o.NotificationHandler).then((function(u){return u.notificationCallback({diContainer:n,messageContext:{callStack:null,destWindowId:null,srcWindowId:null},messageArg:new s.ClientNotification({status:a.Information,title:i,description:r.WhatsNewNotification.description.format("<ul>"+t.map((function(n){return"<li>"+MsPortalFx.encodeHtml(n.title)+"<\/li>"})).join("")+"<\/ul>"),descriptionAsHtml:!0,linkedBlade:l.getBladeSelection("HubsExtension","WhatsNewBlade",{})}).package()})}))}function v(n){var t=i.Keys.whatsNewLastNotificationTime,r=n.get(f.SettingsManager);return f.readUserSettings(r,[t]).then((function(i){var o=i[t],s;o?Q(MsPortalEarly.preload).then((function(n){return n&&n.whatsNew})).then((function(i){var s,l;if(i&&i.length&&(s=i.filter((function(n){return n.published&&new Date(n.published)>new Date(o)})),s&&s.length)){if(l={},l[t]=(new Date).toISOString(),f.writeUserSettings(r,l,null),!MsPortalFx.isFeatureEnabled("whatsnew")||u.hideSmallModals()||h)return c(n,s);h=!0;n.get(e.WhatsNewModal).callBack({items:i.map((function(n){return{title:n.title,description:n.content,published:n.published,uri:n.uri}}))})}})):(s={},s[t]=(new Date).toISOString(),f.writeUserSettings(r,i,null))}))}Object.defineProperty(t,"__esModule",{value:!0});t.checkForPortalUpdates=t.showWhatsNewNotification=void 0;var l=MsPortalFx.ViewModels,s=MsPortalFx.Hubs.Notifications,a=s.NotificationStatus,h=!1;t.showWhatsNewNotification=c;t.checkForPortalUpdates=v}));
define("MsPortalImpl/Services/Services.PortalPollingManager",["require","exports","Fx/DependencyInjection","Fx/Ajax","MsPortalImpl/Services/Services.Subscriptions","Weave","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/Services/Services.SecurityTokens"],(function(n,t,i,r,u,f,e,o){"use strict";function k(t){return __awaiter(this,void 0,void 0,(function(){var f,l,a,w,k,i,d,g,c,nt,tt,it;return __generator(this,(function(rt){switch(rt.label){case 0:f=["whatsNew"];l=t.get(e.PrivateLinkState).isPrivateLinked.value;a=t.get(e.ServiceDependencyState).azureResourceGraphUnavailable.value;b&&f.push("outages");!h||l||a||f.push("serviceHealthAlerts");w=s.startTrace({action:"PollPortalOnDemandData",source:y});rt.label=1;case 1:return rt.trys.push([1,8,,9]),[4,t.get(o.SecurityTokensManager).getToken({extensionName:"fx",resourceName:"",skipCache:!1,isBackground:!1})];case 2:return d=rt.sent()||{token:{}},[4,t.get(u.SubscriptionsUserContext).getInSessionSelectedSubscriptions()];case 3:return g=rt.sent(),c=g().map((function(n){return n.subscriptionId})),[4,r.postJSON({isBackgroundTask:!0,uri:v,setAuthorizationHeader:p?{resourceName:"self"}:!0},{armAuthorizationHeader:d.token.header||"",subscriptionIds:c,queries:f})];case 4:return(i=rt.sent(),!c.length)?[3,7]:[4,MsPortalFx.require(n.normalize("MsPortalImpl/Notifications/NotificationsFetchedFromClientHelper"))];case 5:return(nt=rt.sent(),!(l&&h&&!a))?[3,7]:(tt=i,[4,nt.getServiceHealthAlerts(c,t)]);case 6:tt.serviceHealthAlerts=rt.sent();rt.label=7;case 7:return[3,9];case 8:return it=rt.sent(),k=it,[3,9];case 9:return s.endTrace(w,"complete",{counts:{irisNotifications:Object.keys(((i===null||i===void 0?void 0:i.irisNotifications)||{}).Notifications||{}).length,outages:((i===null||i===void 0?void 0:i.outages)||[]).length,whatsNew:((i===null||i===void 0?void 0:i.whatsNew)||[]).length,serviceHealthAlerts:((i===null||i===void 0?void 0:i.serviceHealthAlerts)||[]).length},error:k,queries:f}),[2,i]}}))}))}var l;Object.defineProperty(t,"__esModule",{value:!0});t.DEV=t.PollingManager=void 0;var a=MsPortalFx.Base,s=a.Diagnostics.Telemetry,v="/api/Portal/GetOnDemandData"+MsPortalEarly.settingsUriQuery,y="PortalPollingManager",p=FxImpl.features.isEnabled("cae"),w,h=MsPortalFx.isFeatureEnabled("pollservicehealthalerts"),b=MsPortalFx.isFeatureEnabled("outagebanner"),c=!0;l=(function(){function t(n){this._diContainer=n;this._polledData=f.makeWritableComputation();this._lifetime=new FxImpl.TriggerableLifetimeManager}return t.prototype.startPolling=function(){var n=this;this._pollingHandle||Q.delay(w||12e4).then((function(){var t=function(){k(n._diContainer).then((function(i){i&&n._polledData(i);n._pollingHandle=setTimeout((function(){t()}),6e5)}))},i=c?Q():Q.delay(6e5);i.then((function(){return t()}))}))},t.prototype.getPolledDataObservable=function(){return this._polledData},t.prototype.dispose=function(){this._pollingHandle&&clearTimeout(this._pollingHandle);this._lifetime.dispose();c=!0},__decorate([__metadata("fx:diagnostics",[n,"PollingManager"]),i.Class(),__metadata("design:paramtypes",[i.Container])],t)})();t.PollingManager=l}));
define("MsPortalImpl/Notifications/NotificationsArea",["require","exports","Fx/DependencyInjection","MsPortalImpl/Notifications/WhatsNewCheck","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/Services/Services.PortalPollingManager","MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers","MsPortalImpl/Services/Services.BrowserSettings","Weave"],(function(n,t,i,r,u,f,e,o,s){"use strict";function y(t,i){var u=i===null||i===void 0?void 0:i.Notifications,r=0;r=Number(c||1)>1&&Array.isArray(u)?u.length:u?1:0;r&&MsPortalFx.require(n.normalize("./PortalNotifications")).then((function(n){n.init(t,i)}));h.trace({source:"NotificationsArea",action:r?"IrisNotificationPresent":"IrisNotificationNotPresent",data:{count:r,requestedCount:c}})}function a(t,i){if(!i||!i.length)return h.trace({source:"NotificationsArea",action:"NoServiceHealthAlertsShown"});MsPortalFx.require(n.normalize("./PortalNotifications")).then((function(n){n.initServiceHealthAlerts(t,i)}))}var h,c,l,v;Object.defineProperty(t,"__esModule",{value:!0});t.DEV=t.DataContext=t.delayTimeout=void 0;t.delayTimeout=MsPortalFx.isDevelopmentMode&&MsPortalFx.isFeatureEnabled("fasteventservice")?1e4:3e4;h=MsPortalFx.Base.Diagnostics.Telemetry;c=MsPortalFx.getFeatureValue("irismessagelimit");l=y;v=(function(){function h(i,u){var h=this,v;this._diContainer=i;this._lifetime=new FxImpl.TriggerableLifetimeManager;var c=FxImpl.features.isNativePerf,y=MsPortalFx.getFeatureValue("skipeventpoll"),p=MsPortalFx.isFeatureEnabled("portalpolling"),b=MsPortalFx.isFeatureEnabled("pollservicehealthalerts"),k=MsPortalFx.isFeatureEnabled("showservicehealthalerts"),w=y==="true"||c&&y!=="false";if(w){k&&e.lazyUserDataMemo(this._diContainer).then((function(n){var t=n.serviceHealthAlerts||[];a(h._diContainer,t)}));return}v=ko.observable([]);u.getInSessionSelectedSubscriptions().then((function(n){n.subscribeAndRun(h._lifetime,(function(n){return v(n)}))}));v.subscribeAndRun(this._lifetime,(function(i){if(i&&i.length&&!h._initialized&&(h._initialized=!0,w||Q.delay(t.delayTimeout).then((function(){MsPortalFx.require(n.normalize("./NotificationsFetchedFromClientHelper")).then((function(n){n.startPollingForDigestEvents(h._diContainer,i)}))})),!p&&b)){var r=function(){h._diContainer.get(o.ServiceDependencyState).azureResourceGraphUnavailable.value||MsPortalFx.require(n.normalize("./NotificationsFetchedFromClientHelper")).then((function(n){Q.delay(n.defaultPollingInterval).then((function(){n.getServiceHealthAlerts(i.map((function(n){return n.subscriptionId})),h._diContainer).then((function(n){a(h._diContainer,n);r()}))}))}))};Q.delay(t.delayTimeout).finally(r)}}));c||Q.delay(t.delayTimeout).then((function(){r.checkForPortalUpdates(h._diContainer)}));p&&s.subscribeAndRun(this._lifetime,[this._diContainer.get(f.PollingManager).getPolledDataObservable()],(function(n){n&&(n.irisNotifications&&l(h._diContainer,n.irisNotifications),n.whatsNew&&r.showWhatsNewNotification(h._diContainer,n.whatsNew),n.serviceHealthAlerts&&a(h._diContainer,n.serviceHealthAlerts))}));c||Q(MsPortalEarly.preload).then((function(n){n=n||{};n.irisNotifications&&l(h._diContainer,n.irisNotifications);n.whatsNew&&r.showWhatsNewNotification(h._diContainer,n.whatsNew)}))}return h.prototype.dispose=function(){this._lifetime.isDisposed()||this._lifetime.dispose()},__decorate([__metadata("fx:diagnostics",[n,"DataContext"]),i.Class(),__metadata("design:paramtypes",[i.Container,u.SubscriptionsUserContext])],h)})();t.DataContext=v}));
define("MsPortalImpl/Notifications/ContactabilityHelper",["require","exports","Fx/Ajax","Fx","MsPortalFx/Globalization","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/UI/Compositions/UI.Composition.Services"],(function(n,t,i,r,u,f,e){"use strict";function c(n,t){var r;return!1&&r?Q(r):i.ajax(t)}function ft(n,t){var i=o.startTrace({source:t,action:"UpdateAEO"});return Q(c("sendAEOEmail",{uri:tt,type:"POST",setAuthorizationHeader:ut,headers:{"Content-Type":h},data:JSON.stringify({EventId:"contactability-email-change-confirmation",Email:n,Culture:u.formatCulture})})).then((function(n){o.endTrace(i,!0,{messageIds:n&&n.messageIds})}),(function(n){var t=(n&&n.content||{}).error;o.endTrace(i,"Failed",{code:t&&t.code||"",message:t&&t.message,status:n.jqXHR&&n.jqXHR.status||n.httpStatusCode})})).catch((function(n){o.endTrace(i,"Failed",{message:"Error: "+MsPortalFx.sanitizeMessage(MsPortalFx.getLogFriendlyMessage(n))})}))}function k(){var i=o.startTrace({source:"Contactability",action:"GetCMEmail"}),t=!1,n={code:"",hasProfile:!1,error:""};return Q(c("getCMProfile",{type:"POST",uri:MsPortalFx.Base.Resources.getAppRelativeUri("/api/jarvis/profile"),setAuthorizationHeader:a})).then((function(i){t=!0;var r=(i.items||[])[0];return n.hasProfile=!!r,r}),(function(t){var i,r=""+(((i=t===null||t===void 0?void 0:t.jqXHR)===null||i===void 0?void 0:i.status)||(t===null||t===void 0?void 0:t.httpStatusCode));return(n.code=r,r==="404"||r==="202")?null:(n.error=MsPortalFx.getLogFriendlyMessage(JSON.stringify(t,null,4)),Q.reject(t))})).finally((function(){o.endTrace(i,t,n)}))}function et(n,t,i,f){var s,e,l=n===null||n===void 0?void 0:n.id;l?(s=p.format(l),e="PATCH"):(s=p.format(""),e="POST");var v=MsPortalFx.newGuid(),y=MsPortalFx.newGuid(),w=o.startTrace({source:i,action:"UpdateCMEmail",data:{type:e,currentProfileId:l,correlationId:v,trackingId:y}}),k=u.formatCulture.split("-").slice(-1)[0];return Q(c("CMProfile",{uri:s,type:e,setAuthorizationHeader:a,headers:{Accept:h,"x-ms-correlation-id":v,"api-version":nt,"Content-Type":h,"x-ms-tracking-id":y,"If-Match":n===null||n===void 0?void 0:n.etag},data:JSON.stringify({azure_preferred_email:t,azure_locale:u.formatCulture,type:"marketing"})})).then((function(){o.endTrace(w,!0);var e=it.map((function(n){return{cultureName:u.formatCulture,originalSource:rt,topicId:n}})),s={email:t,country:k,topicSettings:e},n=o.startTrace({source:i,action:"UpdateCPM"});return f?Q(c("CPMEmailContact",{uri:b,type:"PATCH",setAuthorizationHeader:a,headers:{"Content-Type":h},data:JSON.stringify(s)})).then((function(){return o.completeTrace(n),r.isFeatureEnabled("enableaeoemails")?ft(t,i):void 0}),(function(t){o.cancelTrace(n);throw new Error(t);})):(o.completeTrace(n,"User opted out"),Q())}),(function(n){o.cancelTrace(w);throw new Error(n);}))}function ot(n,t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(){return d?[2]:[2,k().then((function(i){n.get(e.UpdateContactModal).callBack({irisNotificationDetails:t,profile:i})}))]}))}))}var b,l;Object.defineProperty(t,"__esModule",{value:!0});t.setTestValues=t.invokeUpdateContactModal=t.updateContactEmail=t.getCMProfile=void 0;var s=MsPortalFx.Base,o=s.Diagnostics.Telemetry,d=f.hideSmallModals(),g=MsPortalFx.ensureSuffix(FxImpl.internalEnv.aeoEndpoint,"/"),v=MsPortalFx.ensureSuffix(FxImpl.internalEnv.jarvisEndpoint,"/"),y=new s.UriBuilder(v);y.setRelativePath("JarvisCM/my/profiles/{0}");var p=y.toString(),nt="2015-03-31",w=new s.UriBuilder(v);w.setRelativePath("CPM/api/EmailContacts");b=w.toString();l=new s.UriBuilder(g);l.setRelativePath("api/v1/event");var tt=l.toString(),it=["40c64c7a-6e71-4633-9745-e687a3fafdfa","599099f1-6c31-4a1e-ba9a-04fd8eebaa17","00000000-0000-0000-0000-000000000001","8db9e93f-2467-4588-a194-0bb4241d5b13",],rt="AzurePortal",h="application/json",a={resourceName:"jarvis"},ut={resourceName:"aeo"};t.getCMProfile=k;t.updateContactEmail=et;t.invokeUpdateContactModal=ot}));
define("MsPortalImpl/Notifications/PortalNotifications",["require","exports","Fx/Ajax","FxHubs/RpcEndPoints","MsPortalFx/Globalization","MsPortalImpl/Notifications/NotificationsClientStrings","MsPortalImpl/Notifications/ContactabilityHelper","MsPortalImpl/Resources/PortalNotificationsTelemetry","FxInternal/AsyncLoader","Fx/DependencyInjection","MsPortalImpl/Services/Services.BrowserSettings"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function at(n){return!it&&(n||"").toLowerCase()==="contactability"}function rt(n){var i=t.irisDurationMap[(n.duration||"").toString().toLowerCase()];return i!==undefined?i:(i=Number.parseInt(n.duration),i||0)}function v(n,t,i){et.trace({source:tt.PortalNotifications,action:n,actionModifier:t,data:i||{}})}function vt(n,t){return t.indexOf("{ACTION}")<0?(v(a.IrisNotification,l.InvalidIrisTelemetryUri,{originalAction:n,originalUri:((t||"").split("?")[0]||"")+(""+(t.indexOf("?")>-1?"?_QUERY_PARAMS_REDACTED_":""))}),""):t.replace("{ACTION}",n)}function y(n,t){for(var r,u=((n||"").split("?")[1]||"").split("&").filter((function(n){return!!n})),i=0;i<u.length;i++)if(r=u[i].split("="),(r[0]||"").toLowerCase()===t)return r[1]||"";return""}function yt(n,t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(i){switch(i.label){case 0:return[4,n.get(p).publishIrisNotifications(t)];case 1:return i.sent(),[2]}}))}))}function pt(n,t){n.get(p).publishServiceHealthNotifications(t)}var p;Object.defineProperty(t,"__esModule",{value:!0});t.DEV=t.initServiceHealthAlerts=t.init=t.getCMProfileHandler=t.updateContactEmailHandler=t.irisTelemetryHandler=t.PortalNotifications=t.irisDurationMap=t.getToastDuration=void 0;var ut=MsPortalFx.Base,ft=ut.Diagnostics,a=o.Action,l=o.ActionModifier,tt=o.Source,et=ft.Telemetry,w=MsPortalFx.Hubs.Notifications.NotificationStatus,ot=FxImpl.Hubs.Notifications,k=ot.InternalClientNotification,d=f.ServiceHealthAlertTypeNames,g=f.CloudDeprecationModal,b=new Map;b.set("serviceissue",d.serviceIssue);b.set("plannedmaintenance",d.plannedMaintenance);b.set("healthadvisory",d.healthAdvisory);b.set("securityadvisory",d.securityAdvisory);var st=MsPortalFx.isFeatureEnabled("showcontactabilitymodal"),it=MsPortalFx.isFeatureEnabled("testcontactabilitymodal"),nt=Number(MsPortalFx.getFeatureValue("irismessagelimit")||1),ht=MsPortalFx.isFeatureEnabled("allowirismodalnotifications"),ct=MsPortalFx.isFeatureEnabled("showirisadvisor"),lt=c.hideSmallModals();t.getToastDuration=rt;t.irisDurationMap={modal:4,sticky:2,long:1,short:0,suppress:3};p=(function(){function t(){this._contactabilityModalDetails=null;this._shouldShowContactability=!1;this._shouldShowIrisAdvisor=!1;this.updateContactEmail=e.updateContactEmail;this.getCMProfile=e.getCMProfile}return t.prototype._makeIrisAdvisorContent=function(n,t,i){var r,u;return{timestamp:new Date,title:n.title,description:n.description,status:n.status||w.Information,descriptionAsHtml:!0,toastDuration:i,inlineForm:{fields:(r=n.field&&[n.field])!==null&&r!==void 0?r:null,buttons:(u=n.button&&[n.button])!==null&&u!==void 0?u:null},irisNotificationDetails:t,notificationId:a.IrisNotification+MsPortalFx.getUniqueId()}},t.prototype._handleContactabilityNotification=function(n){return this._contactabilityModalDetails=n,this._shouldShowContactability=st,this.logIrisNotificationTelemetry({irisNotificationDetails:n,action:l.ContactabilityNotificationReceived})},t.prototype._handleIrisAdvisor=function(n,t,i){if(ct)return this._shouldShowIrisAdvisor=!0,this._irisAdvisorContent=this._makeIrisAdvisorContent(n,t,i),this.logIrisNotificationTelemetry({irisNotificationDetails:t,action:l.AdvisorNotificationReceived})},t.prototype._logIrisNotificationTelemetry=function(n){var t,u,r,s;if(n=n||{},t=n.action,u=n.irisNotificationDetails,t&&u){var e=u.actionBeaconUri,o=u.impressionsUri,f={actionASID:y(e,"asid"),actionPID:y(e,"pid"),impressionASID:y(o,"asid"),impressionPID:y(o,"pid"),messageLimit:nt,originalModifier:t};return(v(a.IrisNotification,t,f),r=t===l.NotificationShown||t===l.ControlNotificationReceived?l.ImpressionsBeaconCall:l.ActionsBeaconCall,s=r===l.ImpressionsBeaconCall?o:vt(t,e||""),!s)?Q():i.ajax({type:"POST",uri:MsPortalFx.Base.Resources.getAppRelativeUri(r===l.ImpressionsBeaconCall?"/api/iris/impressionsbeacon":"/api/iris/actionsbeacon"),isBackgroundTask:!0,setAuthorizationHeader:!0,headers:{Accept:"application/json","x-ms-correlation-id":MsPortalFx.newGuid(),"Content-Type":"application/json","x-ms-tracking-id":MsPortalFx.newGuid()},data:JSON.stringify({beaconParams:"?"+s.split("?")[1],beaconAction:t})}).then((function(){var n=r+"Success";v(a.IrisNotification,n,f)})).catch((function(n){var t=r+"Failed";f.error=JSON.stringify(n===null||n===void 0?void 0:n.jqXHR);v(a.IrisNotification,t,f)}))}},t.prototype.logIrisNotificationTelemetry=function(n){return this._logIrisNotificationTelemetry(n)},t.prototype.publishIrisNotification=function(n){var t,i,r,u,f;return __awaiter(this,void 0,void 0,(function(){var p,o,s,e,h,c,b;return __generator(this,(function(d){switch(d.label){case 0:return(p=(t=n===null||n===void 0?void 0:n.ad)===null||t===void 0?void 0:t.properties,o=(i=n===null||n===void 0?void 0:n.prm)===null||i===void 0?void 0:i._imp,s=(r=n===null||n===void 0?void 0:n.tracking)===null||r===void 0?void 0:r.baseUri,!p||!o||!s)?(v(a.IrisNotification,l.NotificationNotShown_InvalidContent,{ad:!!n.ad,adProperties:!!p,tracking:!!n.tracking,trackingBaseUri:!!s,prm:!!n.prm,prmImp:!!o}),[2]):(e=p,h={actionBeaconUri:s,impressionsUri:o},!((e===null||e===void 0?void 0:e.isControl)==="true"||(e===null||e===void 0?void 0:e.isControl)===!0))?[3,2]:[4,this.logIrisNotificationTelemetry({irisNotificationDetails:h,action:l.ControlNotificationReceived})];case 1:return[2,d.sent()];case 2:return at(e===null||e===void 0?void 0:e.type)?[4,this._handleContactabilityNotification(h)]:[3,4];case 3:return[2,d.sent()];case 4:return(e.title&&e.description)?(c=rt(e),b=e.type==="advisor",b)?[2,this._handleIrisAdvisor(e,h,c)]:(c!==4||ht||(c=1),k.internalPublish({timestamp:new Date,title:e.title,description:e.description,status:e.status||w.Information,descriptionAsHtml:!0,toastDuration:c,inlineForm:{fields:(u=e.field&&[e.field])!==null&&u!==void 0?u:null,buttons:(f=e.button&&[e.button])!==null&&f!==void 0?f:null},irisNotificationDetails:h,notificationId:a.IrisNotification+MsPortalFx.getUniqueId()}),[4,this.logIrisNotificationTelemetry({irisNotificationDetails:h,action:l.NotificationShown})]):[3,6];case 5:return[2,d.sent()];case 6:return v(a.IrisNotification,l.NotificationNotShown_NoTitleOrDescription,{actionASID:y(s,"asid"),actionPID:y(s,"pid"),description:e.description,title:e.title,impressionASID:y(o,"asid"),impressionPID:y(o,"pid"),messageLimit:nt}),[2]}}))}))},t.prototype.publishIrisNotifications=function(n){return __awaiter(this,void 0,void 0,(function(){var t,i,r,f=this;return __generator(this,(function(e){switch(e.label){case 0:return(t=n===null||n===void 0?void 0:n.Notifications,!t||MsPortalFx.localeCompareIgnoreCase(u.formatCulture,n.FormatCulture)!==0)?(v(a.IrisNotification,l.NotificationNotShown_NoNotificationsOrCultureMismatch,{cultureMatch:MsPortalFx.localeCompareIgnoreCase(u.formatCulture,n&&n.FormatCulture)===0,formatCulture:u.formatCulture,hasIrisNotifications:!!(n&&n.Notifications),irisFormatCulture:n&&n.FormatCulture}),[2]):(i=!MsPortalFx.isArrayOrObservableArray(t),!(nt===1&&i))?[3,2]:[4,this.publishIrisNotification(t)];case 1:return[2,e.sent()];case 2:return i?(v(a.IrisNotification,l.NotificationNotShown_NoNotificationsOrCultureMismatch,{type:typeof t}),[2]):(r=[],t.forEach((function(n){r.push(f.publishIrisNotification(n))})),[4,Q.allResolved(r)]);case 3:return e.sent(),[2]}}))}))},t.prototype.publishServiceHealthNotifications=function(n){n.forEach((function(n){var t=n.eventType&&b.get((n.eventType||"").toLowerCase());if(t&&n.description)return k.internalPublish({timestamp:new Date,title:t,description:n.description,status:n.eventType.toLowerCase()==="serviceissue"?w.Error:w.Information,notificationId:a.ServiceHealthAlertNotification+MsPortalFx.getUniqueId(),correlationIds:[n.trackingId],isServerEvent:!0,uri:"#blade/Microsoft_Azure_Health/AzureHealthBrowseBlade/trackingId/"+n.trackingId});v(a.ServiceHealthAlertNotification,l.NotificationNotShown_InvalidContent,{title:n.eventType,description:n.description})}))},t.prototype.shouldShowContactability=function(){return this._shouldShowContactability||it},t.prototype.shouldShowIrisAdvisor=function(){return this._shouldShowIrisAdvisor},t.prototype.showIrisAdvisor=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(n){switch(n.label){case 0:return(this._shouldShowIrisAdvisor=!1,lt)?[2]:this._irisAdvisorContent?(k.internalPublish(this._irisAdvisorContent),[4,this.logIrisNotificationTelemetry({irisNotificationDetails:this._irisAdvisorContent.irisNotificationDetails,action:l.NotificationShown})]):[3,2];case 1:return[2,n.sent()];case 2:return[2]}}))}))},t.prototype.shouldShowCloudDeprecationModal=function(n){if(!MsPortalFx.isFeatureEnabled("showclouddeprecationmodal"))return!1;var t=parseInt(MsPortalFx.getFeatureValue("cdmintervaldays"))||0,i=t*864e5,r=Date.now()-i;return n<r},t.prototype.showCloudDeprecationModal=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(){return k.internalPublish({timestamp:new Date,title:g.title,description:'<div style="margin-bottom: 40px; margin-top: 15px; max-width: 490px; padding-left: 9px;">'+g.description+"<\/div>",status:w.Information,descriptionAsHtml:!0,toastDuration:4,notificationId:a.IrisNotification+MsPortalFx.getUniqueId(),inlineForm:{buttons:[{label:g.linkLabel,externalLink:{uri:"https://www.microsoft.com/en-us/cloud-platform/germany-cloud-regions"}},]}}),[2]}))}))},t.prototype.showContactabilityModal=function(n){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(){return this.shouldShowContactability()?(this._shouldShowContactability=!1,[2,e.invokeUpdateContactModal(n,this._contactabilityModalDetails||null)]):[2]}))}))},t.prototype.showHatsModal=function(n,t){return __awaiter(this,void 0,void 0,(function(){var i;return __generator(this,(function(r){switch(r.label){case 0:return[4,MsPortalFx.require("MsPortalImpl/Notifications/HatsHelper")];case 1:return i=r.sent(),[4,i.invokeHatsModal(n,t)];case 2:return[2,r.sent()]}}))}))},__decorate([__metadata("fx:diagnostics",[n,"PortalNotifications"]),h.Class("")],t)})();t.PortalNotifications=p;t.irisTelemetryHandler=s.defineHandler(r.Impl.irisTelemetryEndpoint,(function(n){n.diContainer.get(p).logIrisNotificationTelemetry(n.messageArg)}));t.updateContactEmailHandler=s.defineHandler(r.UpdateContact.updateContactEmail,(function(n){return n.diContainer.get(p).updateContactEmail(n.messageArg.currentProfile,n.messageArg.emailAddress,tt.UpdateContactabilityDialog,n.messageArg.optIn)}));t.getCMProfileHandler=s.defineHandler(r.UpdateContact.getCMProfile,(function(n){return n.diContainer.get(p).getCMProfile()}));t.init=yt;t.initServiceHealthAlerts=pt}));
define("_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css",["module"],(function(n){"use strict";return{css:".fxs-part-buttonpart{display:flex;width:100%;height:100%;box-sizing:border-box;text-align:center;align-items:center;flex-direction:column}.fxs-part-buttonpart-iconcontainer{flex:0 0 auto;box-sizing:border-box;display:flex;align-items:center}.fxs-part-buttonpart-iconcontainer>img,.fxs-part-buttonpart-iconcontainer>svg{flex:0 0 auto;height:50px;width:50px}.fxs-part-buttonpart-textcontainer{width:100%;font-size:13px;line-height:normal}.fxs-part-buttonpart-assetname{margin:0;font-size:10px;line-height:10px;padding-bottom:1px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-part-buttonpart-desc{display:none;position:relative;margin-top:10px}.fxs-part-buttonpart-desc:empty{margin-top:0}.fxs-part-buttonpart-titlecontainer{display:flex;flex-flow:row nowrap;align-items:flex-start;justify-content:center}.fxs-part-buttonpart-title{position:relative;margin:0;font-size:14px;font-weight:600;display:block;display:-webkit-box;line-height:18px;max-height:36px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:2;-webkit-box-orient:vertical}.fxs-part-buttonpart-title.fxs-should-use-single-line{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>svg,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>svg{height:30px;width:30px}.fxs-tilesize-small .fxs-part-buttonpart,.fxs-tilesize-wide .fxs-part-buttonpart{text-align:left;flex-direction:row}.fxs-tilesize-small .fxs-part-buttonpart-titlecontainer,.fxs-tilesize-wide .fxs-part-buttonpart-titlecontainer{justify-content:flex-start}.fxs-tilesize-small .fxs-part-buttonpart-textcontainer,.fxs-tilesize-wide .fxs-part-buttonpart-textcontainer{flex:0 1 auto;display:flex;flex-direction:column;justify-content:center}.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer{padding-top:3px}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer{width:51px;padding-left:6px}.fxs-tilesize-normal .fxs-part-buttonpart-titlecontainer{margin:13px 0 5px}.fxs-tilesize-normal .fxs-part-buttonpart-iconcontainer{padding-top:28px}.fxs-tilesize-normal .fxs-part-part-title-visible .fxs-part-buttonpart-iconcontainer{padding-top:0}.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer{width:85px;padding-left:15px}.fxs-tilesize-wide .fxs-part-buttonpart-title{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-tilesize-wide .fxs-part-buttonpart-assetname{padding-top:2px}.fxs-tilesize-wide .fxs-part-buttonpart-desc{display:block;display:-webkit-box;line-height:18px;max-height:90px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:5;-webkit-box-orient:vertical}.fxs-part-buttonpart-externallink{height:12px;width:12px;margin-left:3px;margin-top:2px}.fxs-part-buttonpart-externallink>img,.fxs-part-buttonpart-externallink>svg{height:12px;width:12px}",moduleId:n.id}}));
define("MsPortalImpl/Parts/Parts.ButtonPart",["require","exports","MsPortalImpl/Parts/Parts","FxInternal/Composition/ViewModel","FxInternal/Css","_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css"],(function(n,t,i,r,u,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ButtonPart=t.template=void 0;u.injectCss(f);t.template="<div class='fxs-part-buttonpart'><div class='fxs-part-buttonpart-iconcontainer' data-bind='image: icon, attr: { title: _displayTitle }'><\/div><div class='fxs-part-buttonpart-textcontainer'><div class='fxs-part-buttonpart-titlecontainer'><h3 class='fxs-part-buttonpart-title msportalfx-tooltip-overflow' data-bind='text: _displayTitle, css: { \"fxs-should-use-single-line\": _assetNameVisible }, attr: { \"aria-describedby\": _assetName() && _id }'><\/h3><!-- ko if: _isExternalLink --><div class='fxs-part-buttonpart-externallink azc-fill-heavy' data-bind='image: _linkSvg, attr: { \"aria-label\": _linkUri }'><\/div><!-- /ko --><\/div><div data-bind='text: _assetName, visible: _assetNameVisible, attr: { id: _id }' class='fxs-part-buttonpart-assetname msportalfx-tooltip-overflow'><\/div><div data-bind='text: description' class='fxs-part-buttonpart-desc msportalfx-tooltip-overflow'><\/div><\/div><\/div>";var e=(function(n){function i(){var i=n!==null&&n.apply(this,arguments)||this;return i.template=t.template,i}return __extends(i,n),i.prototype._getContentForBinding=function(t){var f=this,l=this._viewModel,u=l.content,o=l.container,i=o.clickableLink,s=function(n){return n.target()==="_self"||n.uri&&MsPortalFx.startsWith(n.uri(),"#")&&n.target()==="auto"},h=ko.observable(!!i&&!s(i)),c,e,a;return ko.computed(t,(function(){f.ariaLabel(u().title())})),c=i&&i.target,c&&c.subscribe(t,(function(){h(!s(i))})),e=i&&i.uri,e&&e.subscribe(t,(function(){h(!s(i))})),a=r.isV2(u())?function(){return f._options.size()}:function(){return u().size&&u().size()},ko.computed(t,(function(){return MsPortalFx.extend2(n.prototype._getContentForBinding.call(f,t)(),{_displayTitle:ko.computed(t,(function(){var n=a(),t=u(),i=t.title();return n===0||n===1?t.shortTitle()||i:i})),_assetName:o.assetName,_isExternalLink:h,_linkUri:e,_linkSvg:MsPortalFx.Base.Images.Hyperlink(),_assetNameVisible:ko.computed(t,(function(){return!f.inContainerOfSameAsset()&&o.assetName()})),_id:MsPortalFx.getUniqueId()})}))},i})(i.PartImpl);t.ButtonPart=e}));
define("_generated/Less/MsPortalImpl/Parts/Parts.Collection.css",["module"],(function(n){"use strict";return{css:'.fxs-part-collectionpart .azc-grid table thead tr th{height:28px;line-height:28px;border-top-width:1px;border-top-style:solid}.fxs-part-collectionpart .azc-grid table thead tr th>a{line-height:normal}.fxs-part-collectionpart .azc-grid table thead tr th:first-child a{padding-left:15px}.fxs-part-collectionpart .azc-grid table tbody tr td{height:27px}.fxs-part-collectionpart .azc-grid table td.azc-grid-cell:first-of-type{padding-left:15px}.fxs-part-collectionpart .azc-grid table td:last-of-type,.fxs-part-collectionpart .azc-grid table td:last-child{padding-right:15px}.fxs-part-collectionpart .azc-grid table .azc-grid-resizableColumn-handle{height:28px}.fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:none}.fxs-part-collectionpart.fxs-part-collectionpart-rollup-forceshow .fxs-part-collectionpart-rollup-container{display:block}.fxs-part-collectionpart-more-data{font-weight:600;font-size:12px;line-height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;position:absolute;right:0}.fxs-part-collectionpart-more-data:hover{text-decoration:underline}.fxs-part-collectionpart-rollup-container{margin:-6px 0 6px}.fxs-part-collectionpart-rollup-count{font-weight:600;font-size:30px;line-height:30px;letter-spacing:-.025em}.fxs-part-collectionpart-rollup-label{font-weight:700;font-size:15px;line-height:15px;letter-spacing:-.02em;margin-left:4px}.fxs-part-collectionpart-part-title{font-size:10px;line-height:10px;padding-bottom:1px;margin:5px 0 0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:none}.fxs-part-collectionpart-rollup-icon{width:21px;height:21px;margin-left:4px;display:inline-block}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:block;margin:0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label{display:none}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count{line-height:25px}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count{width:30px;height:30px;margin-left:0}.fxs-tilesize-mini .fxs-part-collectionpart{text-align:center;padding:5px 6px 0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-part-title{display:block}.fxs-tilesize-small .fxs-part-collectionpart{float:right;margin-top:-15px}html[lang^="ja"] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^="ko"] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^="zh"] .fxs-part-collectionpart .fxs-part-collectionpart-part-title{font-size:11px;line-height:11px}',moduleId:n.id}}));
define("MsPortalImpl/Parts/Parts.Collection",["require","exports","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Parts/Parts","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Css","_generated/Less/MsPortalImpl/Parts/Parts.Collection.css"],(function(n,t,i,r,u,f,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CollectionPart=void 0;f.injectCss(e);var o=u.Parts,s='<div class="fxs-part-collectionpart" data-bind="css: {\'fxs-part-collectionpart-rollup-forceshow\': alwaysShowRollupCount()}"><div class="fxs-part-collectionpart-rollup-container"><span class="fxs-part-collectionpart-rollup-count" data-bind="text: rollupCount, visible: !noRollupCount()"><\/span><span class="fxs-part-collectionpart-rollup-label" data-bind="text: rollupCountLabel"><\/span><img class="fxs-part-collectionpart-rollup-icon" data-bind="attr: { src: rollupCountIconUri }, visible: rollupCountIconUri, css: {\'fxs-part-collectionpart-no-rollup-count\': noRollupCount }" alt=""/><div class="fxs-part-collectionpart-rollup-icon" data-bind="image: rollupCountIcon, visible: rollupCountIcon, css: {\'fxs-part-collectionpart-no-rollup-count\': noRollupCount }"><\/div><h4 class="fxs-part-collectionpart-part-title fxs-display-none" data-bind="text: _partTitle"><\/h4><\/div><!-- ko if: emptyGrid() && noRowsHtml() --><div class="fxs-part-collectionpart-norowshtml fxs-display-none" data-bind="pcControl: noRowsHtml"><\/div><!-- /ko --><!-- ko if: !emptyGrid() || !noRowsHtml() --><!-- ko if: !!gridMode() --><div data-bind="pcGrid: grid" class="msportalfx-removepartpaddingside"><\/div>'+('<a href="#" class="fxs-part-collectionpart-more-data fxs-portal-text-primary" tabindex="0" data-bind="visible: hasMoreData">'+MsPortalFx.encodeHtml(o.more)+"<\/a>")+"<!-- /ko --><!-- /ko --><\/div>",h=(function(n){function t(t,i,r,u){var f=n.call(this,t,i,r,u)||this,e;f.template=s;e=f._container=$(t);e.on("click keydown","a.fxs-part-collectionpart-more-data",(function(n){(n.which===13||n.type==="click")&&n.preventDefault();n.stopPropagation();var t=$.Event(n.type);t.keyCode=n.keyCode;$(n.delegateTarget).trigger(t)}));return f}return __extends(t,n),t.prototype._getContentForBinding=function(n){var t=this._viewModel,r=this._container.findByClassName("fxs-part-collectionpart-part-title"),u=this._container.findByClassName("fxs-part-collectionpart-norowshtml");return ko.computed(n,(function(){var n=t.content().size();i.toggle(r,n!==0||!!t.container.partTitle());i.toggle(u,n!==0&&n!==1)})),ko.observable(MsPortalFx.extend2(t.content(),{_partTitle:t.container.partTitle}))},t})(r.PartImpl);t.CollectionPart=h}));
define("_generated/Less/MsPortalImpl/Parts/Parts.ItemSummary.css",["module"],(function(n){"use strict";return{css:".fxpart-itemsummary{height:100%;background:#00f;display:block;color:#fff}.fxpart-itemsummary-name{font-size:19px;padding:20px 20px;text-transform:uppercase}.fxpart-itemsummary-sourceControl{font-size:16px;padding:0 20px}",moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css",["module"],(function(n){"use strict";return{css:".msportalfx-pricingTier .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.msportalfx-pricingTier .msportalfx-pricingTier-normal-iconContainer,.msportalfx-pricingTier .msportalfx-pricingTier-wide-iconContainer{height:55px;border-bottom:1px solid #dcdfe2}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:10px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-specCode{float:left;margin-right:8px;max-width:100px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-promotedFeatures{line-height:12px;padding-top:4px}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon{width:30px;height:30px;margin-top:1.7em}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon.msportalfx-pricingTier-icon-small{margin-top:-.15em}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:10px}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:30px;height:30px;margin-right:15px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:18px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:20px;height:20px;margin-right:5px}.fxs-tilesize-small .msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:-12px}.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specTitle,.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specCode{text-align:center;float:initial}",moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css",["module"],(function(n){"use strict";return{css:".msportalfx-specpicker{width:175px;height:320px;position:relative;border-color:inherit}.msportalfx-specpicker::after{right:10px;left:auto;transform:skew(8deg) rotate(3deg)}.msportalfx-specpicker .msportalfx-specpicker-table{table-layout:auto}.msportalfx-specpicker ul{list-style-type:none;padding:0}.msportalfx-specpicker .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.fxs-mode-dark .msportalfx-specpicker{box-shadow:0 1px 4px rgba(255,255,255,.3),0 0 40px rgba(255,255,255,.1) inset}.fxs-mode-dark .msportalfx-specpicker::before,.fxs-mode-dark .msportalfx-specpicker::after{box-shadow:0 0 20px rgba(255,255,255,.8)}.fxs-mode-light .msportalfx-specpicker{box-shadow:0 1px 4px rgba(0,0,0,.3),0 0 40px rgba(0,0,0,.1) inset}.fxs-mode-light .msportalfx-specpicker::before,.fxs-mode-light .msportalfx-specpicker::after{box-shadow:0 0 20px rgba(0,0,0,.8)}.msportalfx-specpicker-star{width:14px;height:14px;fill:#ffb900;stroke:#000;stroke-width:1px;float:right;margin-right:4px;margin-top:1px}.msportalfx-specpicker-header{color:#fff;font-size:14px;height:26px;line-height:26px}.msportalfx-specpicker-header .msportalfx-specpicker-header-specCode{font-weight:600;text-transform:uppercase;padding-left:11px}.msportalfx-specpicker-header .msportalfx-specpicker-header-title{padding-left:6px}.msportalfx-specpicker-header-text{fill:#ffb900;stroke:#000;stroke-width:1px;width:161px;position:absolute}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade1{background-color:#4668c5}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade2{background-color:rgba(70,104,197,.2)}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade3{background-color:rgba(70,104,197,.1)}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade1{background-color:#8a2da5}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade2{background-color:rgba(138,45,165,.2)}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade3{background-color:rgba(138,45,165,.1)}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade1{background-color:#578000}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade2{background-color:rgba(87,128,0,.2)}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade3{background-color:rgba(87,128,0,.1)}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade1{background-color:#c40}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade2{background-color:rgba(204,68,0,.2)}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade3{background-color:rgba(204,68,0,.1)}.msportalfx-specpicker-table{table-layout:auto;width:100%;border-collapse:collapse}.msportalfx-specpicker-table .msportalfx-specpicker-feature-name{font-weight:600;font-size:13px;line-height:1.385;margin-left:6px}.msportalfx-specpicker-table .msportalfx-specpicker-feature-value{font-weight:600;font-size:17px}.msportalfx-specpicker-row td{white-space:nowrap;padding:0}.msportalfx-specpicker-row td .msportalfx-specpicker-cell{height:30px;line-height:30px}.msportalfx-specpicker-row td.msportalfx-specpicker-right{overflow:hidden;text-overflow:ellipsis;max-width:1px;width:100%}.msportalfx-specpicker-row.msportalfx-specpicker-promotedFeatures td{padding-bottom:1px}.msportalfx-specpicker-row.msportalfx-specpicker-borderBottom td{border-bottom:1px solid #e9e9f3}.msportalfx-specpicker-row .msportalfx-specpicker-left{text-align:center;min-width:39px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-value{font-size:13px;line-height:1.385;padding-top:6px;margin-left:6px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-name{font-size:10px;line-height:normal;margin-top:-3px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-mutipleline .msportalfx-specpicker-feature-value{padding-top:1px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{min-width:29px;text-align:center}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell img{width:22px;height:22px;margin-top:8px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell div{width:20px;height:20px;padding-top:5px;padding-left:0;display:inline-block}.msportalfx-specpicker-footer-container{position:absolute;bottom:0;left:0;right:0;height:46px;text-align:right}.msportalfx-specpicker-footer{margin-right:10px;margin-bottom:8px;background-color:inherit}.msportalfx-specpicker-footer-value{margin-top:6px;text-transform:uppercase;line-height:22px !important;font-weight:600;font-size:22px;line-height:22px;letter-spacing:-.025em}.msportalfx-specpicker-footer-details{font-size:10px;line-height:14px;text-transform:uppercase}.msportalfx-specpicker-footer-statusMessage,.msportalfx-specpicker-footer-channelMessage{margin-left:5px;margin-right:5px;font-size:11px;text-align:left}.msportalfx-specpicker-footer-statusMessage{margin-top:25px}.msportalfx-specpicker-footer-channelMessage{margin-top:10px;position:absolute;background-color:inherit;white-space:normal;display:block;display:-webkit-box;line-height:16px;max-height:32px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:2;-webkit-box-orient:vertical}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker{background-color:rgba(189,189,189,.05)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-header{background-color:#bdbdbd}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.2)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-right .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.1)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-footer-container{background-color:#dedede}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-feature-value,.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-feature-name,.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-footer-value{color:#bdbdbd}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-blockui-shield{position:absolute;top:0;left:0;bottom:0;right:0}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor{position:absolute;text-align:center;left:15px;right:15px;top:40%}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container{display:inline-block;background-color:rgba(50,56,63,.8);margin-top:20px;padding:15px 10px;width:100%;box-sizing:border-box}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container .msportalfx-specpicker-disable-message{display:inline;color:#fff}.ext-hubs-specPickerGrid-container{height:100%;overflow:hidden;display:flex;flex-direction:column}.ext-hubs-specPicker-container{width:100%;min-height:100%}.ext-hubs-specPicker-container .ext-hubs-specPicker-filtersContainer.ext-hubs-specPicker-filtersContainer{margin-top:0;padding-top:5px}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptionsContainer{height:25px;padding-top:5px;padding-right:15px}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions{font-size:14px;float:right}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .msportalfx-specpicker-recommendationsIcon{width:14px;height:14px;display:inline-block}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-selected{cursor:default;background-color:inherit}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-clickable{color:#0058ad;fill:#0058ad}.ext-hubs-specPicker-container .ext-hubs-specPicker-content{height:100%}.ext-hubs-specPicker-container .ext-hubs-specPicker-message{margin-top:0;border-left:6px solid #ffb900;padding:15px;white-space:pre-wrap}.ext-hubs-specPicker-container .ext-hubs-specPicker-listView{margin-left:19px}.ext-hubs-specPicker-container .fxc-hotspot{outline:none;padding:5px}.ext-hubs-specPicker-container .fxc-hotspot:focus{outline-style:dotted;outline-width:1px}",moduleId:n.id}}));
define("MsPortalImpl/Parts/Parts.Intrinsics",["require","exports","MsPortalImpl/Parts/Parts","FxInternal/Css","_generated/Less/MsPortalImpl/Parts/Parts.ItemSummary.css","_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css","_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css"],(function(n,t,i,r,u,f,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.parts=void 0;r.injectCss(u,f,e);var o=MsPortalFx.Parts.PartKind,l=0,c=1,s=2,h=3,a=10,v=4,y=5,p=6,d=7,w=8,g=9,b="<div data-bind='{0}: $root'><\/div>",k={defaultSize:w,supportedSizes:[w],viewStateProperties:["content.selection.selectedItems","content.selection.activatedItems"]};t.parts=[{kind:o.Asset,factory:i.createAmdPartFactory("MsPortalImpl/Parts/Parts.Asset",(function(n,t,i,r,u){return new n.AssetPart(t,i,r,u)}),{defaultSize:c,supportedSizes:[l,c,s]})},{kind:o.Button,factory:i.createAmdPartFactory("MsPortalImpl/Parts/Parts.ButtonPart",(function(n,t,i,r,u){return new n.ButtonPart(t,i,r,u)}),{supportedSizes:[l,c,s,h,]})},{kind:o.Chart,factory:i.createAmdPartFactory("MsPortalImpl/Parts/Parts.Chart",(function(n,t,i,r,u){return new n.Chart(t,i,r,u)}),{supportedSizes:[c,s,v,h,a,y,p,d,w,g,]})},{kind:o.Collection,factory:i.createAmdPartFactory("MsPortalImpl/Parts/Parts.Collection",(function(n,t,i,r,u){return new n.CollectionPart(t,i,r,u)}),{supportedSizes:[l,c,s,h,v,a,y,p,d,g,w,]})},{kind:o.CollectionSummary,factory:i.createAmdPartFactory("MsPortalImpl/Parts/Parts.CollectionSummary",(function(n,t,i,r,u){return new n.Part(t,i,r,u)}),{supportedSizes:[l,c,s,h]})},{kind:o.DiffEditor,factory:i.createPartFactory(b.format("pcDiffEditor"))},{kind:o.Donut,factory:i.createAmdPartFactory("MsPortalImpl/Parts/Parts.Donut",(function(n,t,i,r,u){return new n.Donut(t,i,r,u)}),{supportedSizes:[s,y,h,a,v,p,]})},{kind:o.Editor,factory:i.createPartFactory(b.format("pcEditor"))},{kind:o.Grid,factory:i.createPartFactory(b.format("pcGrid"),{viewStateProperties:["content.selectableData.selectedItems","content.selectableData.activatedItems","content.selectableData.itemsWithChildEdits"]})},{kind:o.InfoList,factory:i.createAmdPartFactory("MsPortalImpl/Parts/Parts.InfoList",(function(n,t,i,r,u){return new n.InfoListPart(t,i,r,u)}),k)},{kind:o.ItemSummary,factory:i.createPartFactory("<div class='fxpart-itemsummary'><div class='fxpart-itemsummary-name' data-bind='text: name'><\/div><\/div>")},{kind:o.LogStream,factory:i.createPartFactory(b.format("pcLogStream"))},{kind:o.Properties,factory:i.createAmdPartFactory("MsPortalImpl/Parts/Parts.Properties",(function(n,t,i,r,u){return new n.PropertiesPart(t,i,r,u)}),k)},{kind:o.Provisioning,factory:i.createAmdPartFactory("MsPortalImpl/Parts/Parts.Provisioning",(function(n,t,i,r,u){return new n.ProvisioningPart(t,i,r,u)}),{supportedSizes:[s,h,]})},{kind:o.QuickStart,factory:i.createAmdPartFactory("MsPortalImpl/Parts/Parts.QuickStart",(function(n,t,i,r,u){return new n.QuickStartPart(t,i,r,u)}),{defaultSize:c,supportedSizes:[l,c,s,h,]})},{kind:o.QuotaGauge,factory:i.createAmdPartFactory("MsPortalImpl/Parts/Parts.QuotaGauge",(function(n,t,i,r,u){return new n.QuotaGauge(t,i,r,u)}),{supportedSizes:[s,a,h,v,p,y,]})},{kind:o.ResourceSummary,factory:i.createAmdPartFactory("MsPortalImpl/Parts/Parts.ResourceSummary",(function(n,t,i,r,u){return new n.ResourceSummaryPart(t,i,r,u)}),k)},{kind:o.SingleValueGauge,factory:i.createAmdPartFactory("MsPortalImpl/Parts/Parts.SingleValueGauge",(function(n,t,i,r,u){return new n.SingleValueGauge(t,i,r,u)}),{supportedSizes:[s,a,h,v]})},{kind:o.Unavailable,factory:i.createPartFactory("<div><\/div>")},];t.parts.forEach((function(n){i.registerFactory(o[n.kind],n.factory)}))}));
define("MsPortalImpl/Services/Clarity",["require","exports"],(function(n,t){"use strict";function u(){var n,u=MsPortalEarly.query.clientoptimizations||MsPortalEarly.query.trace||MsPortalEarly.query.healthCheck||MsPortalFx.isFeatureEnabled("canmodifyextensions")||MsPortalFx.isFeatureEnabled("canaddgallerypackages")||MsPortalFx.isFeatureEnabled("canmodifystamps")||MsPortalFx.isFeatureEnabled("disableextensions")||MsPortalFx.isFeatureEnabled("prefetch")||MsPortalFx.isFeatureEnabled("ci"),t,r;MsPortalFx.isFeatureEnabled("clarity")&&((n=i===null||i===void 0?void 0:i.clarity)===null||n===void 0?void 0:n.projectId)&&!u&&(t=document.createElement("script"),r='(function(c,l,a,r,i,t,y){\n                                c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};\n                                t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;\n                                y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);\n                               })(window, document, "clarity", "script", "'+i.clarity.projectId+'");',t.append(r),document.head.appendChild(t))}Object.defineProperty(t,"__esModule",{value:!0});t.initialize=void 0;var r=window,i=r.fx.environment;t.initialize=u}));
define("MsPortalImpl/Services/Services.BrowserTelemetry",["require","exports"],(function(n,t){"use strict";function c(n,t){var i=Date.now();h.Diagnostics.Telemetry.trace({timestamp:i,source:"BrowserTelemetry",action:t,data:n})}function l(){var n=i.navigator||{},t=r.availHeight,s=r.availWidth,h=e=r.height,c=o=r.width,l=u=i.innerHeight,a=f=i.innerWidth;return{AppName:n.appName,AppVersion:n.appVersion,UserAgent:n.userAgent,Language:n.language,SystemLanguage:n.systemLanguage,UserLanguage:n.userLanguage,Location:i.location.href,Platform:n.platform,CpuClass:n.cpuClass,Orientation:v,PrefersMsHighContrast:b,PrefersColorScheme:y,PrefersContrast:p,PrefersReducedMotion:w,ScreenAvailableHeight:t,ScreenAvailableWidth:s,ScreenAvailableResolution:s+"x"+t,ScreenHeight:h,ScreenWidth:c,ScreenResolution:c+"x"+h,WindowHeight:l,WindowWidth:a,WindowResolution:a+"x"+l,ScreenColorDepth:r.colorDepth}}function a(){var n=r.height,t=r.width,s=i.innerHeight,h=i.innerWidth,l;(e!==n||o!==t||u!==s||f!==h)&&(l={PreviousWindowHeight:u,PreviousWindowWidth:f,PreviousWindowResolution:f+"x"+u},e=n,o=t,u=s,f=h,c(MsPortalFx.extend(l,{ScreenHeight:n,ScreenWidth:t,ScreenResolution:t+"x"+n,WindowHeight:s,WindowWidth:h,WindowResolution:h+"x"+s}),"WindowSizeChanged"))}var e,o,u,f,s;Object.defineProperty(t,"__esModule",{value:!0});t.getBrowserInfo=void 0;var h=MsPortalFx.Base,i=window,r=i.screen||{};t.getBrowserInfo=l;s=0;$(i).on("resize",(function(){clearTimeout(s);s=setTimeout(a,5e3)}));var v=i.matchMedia("(orientation: landscape)").matches?"landscape":i.matchMedia("(orientation: portrait)").matches?"portrait":"undetermined",y=i.matchMedia("(prefers-color-scheme: light)").matches?"light":i.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"nopreference",p=i.matchMedia("(prefers-contrast: high)").matches?"high":i.matchMedia("(prefers-contrast: low)").matches?"low":"nopreference",w=i.matchMedia("(prefers-reduced-motion: reduce)").matches?"reduce":"nopreference",b=i.matchMedia("(-ms-high-contrast: active)").matches&&i.matchMedia("(-ms-high-contrast: black-on-white)").matches?"light":i.matchMedia("(-ms-high-contrast: active)").matches&&i.matchMedia("(-ms-high-contrast: white-on-black)").matches?"dark":"off"}));
define("MsPortalImpl/Services/Services.FileUploadEndpointRegistration",["require","exports"],(function(n,t){"use strict";function e(){f||(f=!0,r.uploadActionEndPoint.register(i.client,null,(function(n){return u().then((function(t){return t.invokeUploadAction(n.uploadKey,n.action,n.context)}))})),r.getUploadInfosEndPoint.registerObjectFactory(i.client,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(n){return u().then((function(t){return t.getUploadInfos(n.uploadKeys,n.category,n.resumable)}))}}))}Object.defineProperty(t,"__esModule",{value:!0});t.registerFileUploadEndpoints=void 0;var i=FxImpl.Rpc,r=FxImpl.FileUpload,u=MsPortalFx.memoizeQ((function(){return MsPortalFx.require("MsPortalImpl/Services/Services.FileUploadManager").then((function(n){return n.fileUploadManagerInstance()}))})),f=!1;t.registerFileUploadEndpoints=e}));
define("MsPortalImpl/Services/Services.FileUploadInitialization",["require","exports"],(function(n,t){"use strict";function u(n){i||(i=!0,t.uploadSettingsManager=n,Q(n.querySettings({store:10})).then((function(t){MsPortalFx.isEmpty(t)||r().then((function(t){return t.init(n)}))})))}Object.defineProperty(t,"__esModule",{value:!0});t.init=t.uploadSettingsManager=t.hasFileUploads=void 0;var r=MsPortalFx.memoizeQ((function(){return MsPortalFx.require("MsPortalImpl/Services/Services.FileUploadSettings").then((function(n){return n.fileUploadResumableTrackerInstance()}))})),i=!1;t.init=u}));
define("MsPortalImpl/Services/Services.HatsSettings",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.SettingsProcessor"],(function(n,t,i,r,u){"use strict";function s(n,t){return Number((t/n).toFixed(5))}function h(n){return Object.keys(n).map((function(t){var i;return(i=n[t])!==null&&i!==void 0?i:0})).reduce((function(n,t){return n+t}),0)}var o,f,e;Object.defineProperty(t,"__esModule",{value:!0});t.HatsSettings=t.HatsSettingsManager=void 0;o=18;f=(function(t){function f(){return t!==null&&t.apply(this,arguments)||this}return __extends(f,t),f.create=function(n){return u.create(f,n,new e,o,!0)},__decorate([__metadata("fx:diagnostics",[n,"HatsSettingsManager"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[r.SettingsManager]),__metadata("design:returntype",Object)],f,"create",null),f})(u.SettingsProcessor);t.HatsSettingsManager=f;e=(function(){function t(){this.hatsExtensions=ko.observable("")}return t.create=function(n){return n.value},t.prototype.addExtensionCounts=function(n){if(n.length){var t=JSON.parse(this.hatsExtensions()||"{}");n.forEach((function(n){var i,r=((i=t[n.extension])!==null&&i!==void 0?i:0)+n.count;t[n.extension]=r}));this.hatsExtensions(JSON.stringify(t))}},t.prototype.getHatsExtensionsList=function(){var n=JSON.parse(this.hatsExtensions()||"{}"),t=h(n);return Object.keys(n).map((function(i){var r=n[i];return{bladeLoadCount:r,extension:i,extensionWeight:s(t,r),totalBladeLoadCount:t}}))},__decorate([__metadata("fx:diagnostics",[n,"HatsSettings"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[f]),__metadata("design:returntype",t)],t,"create",null),t})();t.HatsSettings=e}));
define("MsPortalImpl/Services/Services.ProjectedDirectories",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/UI.AuthStateManager","Fx/ResourceManagement","FxHubs/ArmHelpers/ArmApisStartup","MsPortalImpl/Services/Services.Tenants","FxHubs/RpcEndPoints","FxHubs/HubsSettingsSchema","MsPortalImpl/Services/Services.Settings","FxInternal/AsyncLoader"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resetState=t.getDirectoriesMapHandler=t.getSubscriptionsForSelectedDirectoriesHandler=t.ServicesProjectedDirectories=void 0;var b=MsPortalFx.Base,k=b.Diagnostics,l=k.Telemetry,p=6,w=s.Keys.directoriesSelected,a="Services.ProjectedDirectories",v=MsPortalFx.memoizeQ((function(n){return n.getTenants().then((function(n){var c=n.tenants||[],r=FxImpl.lowerCaseStringMap(),i=[],u,t,s,h;if(c.forEach((function(n){var t=n.id,u=n.displayName,f=n.tenantCategory;r.set(t,n);!u&&f.toLowerCase().includes("projectedby")&&i.push(t)})),u=i.length,u){var e=l.start({source:a,action:"_getDirectoriesMapMemo"}),o=[],v=f.listTenantsApi();for(t=0;t<u;t=Math.min(u,t+10))s=i.slice(t,t+10),h=f.callUsingBatch({armApiOrUri:v+"&$filter=tenantId in ('"+s.join("','")+"')",telemetry:a+".getDirectoryNames"}),o.push(h);return Q.allSettled(o).then((function(n){var t=!1,u=0;return n.forEach((function(n){n&&n.state==="fulfilled"&&n.value?(n.value.value||[]).forEach((function(n){var i=n.tenantId,t=n.displayName;t&&(u++,r.get(i).displayName=t)})):t=!0})),l.completeTrace(e,{directoriesToResolve:i.length,directoriesResolved:u,hasErrors:t}),r})).catch((function(n){l.cancelTrace(e,{directoriesToResolve:i.length});throw n;}))}return r}))})),y=(function(){function t(n,t,i){var o=this,r,u,f,e;this._tenantsService=n;this._settingsManager=t;r=this._selectedDirectoriesInSession=ko.observable([]);u=i.getCurrentUser().tenantId;u||l.trace({source:a,action:"constructor",name:"CurrentUserDirectoryIdIsUndefined"});f=(u||"").toLowerCase();e=this._defaultSelectedDirectories=[f];this._initPromise=Q(t.querySetting(p,w).then((function(n){var t=n&&n.toLowerCase().split(";"),i=t&&t.length?t:e;r(i)})));this._hasProjectedDirectories=Q.spread([n.getTenants(),this._initPromise,],(function(n){var e={},t=!1,i,u;return n.tenants.forEach((function(n){var i=n.id.toLowerCase(),r=i!==f,u=n.tenantCategory.toLowerCase().includes("projectedby");t=t||r&&u;(!r||u)&&(e[i]=!0)})),i=r(),u=i.filter((function(n){return e[n]})),u.length!==i.length&&o.setSelectedDirectoriesInSession(u),t}));v(n)}return t.prototype.hasProjectedDirectories=function(){var n=this;return this._initPromise.then((function(){return n._hasProjectedDirectories}))},t.prototype.setSelectedDirectoriesInSession=function(n){var t=this;return this._initPromise.then((function(){var i=n&&n.length?n.map((function(n){return n||l.trace({source:a,action:"setSelectedDirectoriesInSession",name:"DirectoryIdIsUndefined"}),(n||"").toLowerCase()})):t._defaultSelectedDirectories;return t._selectedDirectoriesInSession(i),t._settingsManager.setSetting(p,w,i.join(";"))}))},t.prototype.getSelectedDirectoriesInSession=function(){var n=this;return this._initPromise.then((function(){return n._selectedDirectoriesInSession}))},t.prototype.getSubscriptionsForSelectedDirectories=function(n){var t=this;return this._initPromise.then((function(){n=n||[];var i=t._selectedDirectoriesInSession();return n.filter((function(n){var t=n.tenantId,r=n.subscriptionId;return t||l.trace({source:a,action:"getSubscriptionsForSelectedDirectories",name:"SubHasNoTenant",data:r}),i.includes((t||"").toLowerCase())}))}))},t.prototype.getDirectoriesMap=function(){return Q.spread([v(this._tenantsService),this._initPromise,],(function(n){return n}))},t.prototype.getDirectoryByResourceId=function(n){var t=u.ArmId.parse(n,!0);return t.subscription?Q.spread([MsPortalFx.Azure.getSubscriptionInfo(t.subscription),v(this._tenantsService),this._initPromise,],(function(n,t){var i=n&&n.tenantId;return i?t.get((i||"").toLowerCase())||{id:i,displayName:"",domainName:"",tenantCategory:""}:null})):Q(null)},__decorate([__metadata("fx:diagnostics",[n,"ServicesProjectedDirectories"]),i.Class(),__metadata("design:paramtypes",[e.TenantsService,h.SettingsManager,r.AuthStateManager])],t)})();t.ServicesProjectedDirectories=y;t.getSubscriptionsForSelectedDirectoriesHandler=c.defineHandler(o.Directories.getSubscriptionsForSelectedDirectoriesEndPoint,(function(n){return n.diContainer.get(y).getSubscriptionsForSelectedDirectories(n.messageArg)}));t.getDirectoriesMapHandler=c.defineHandler(o.Directories.getDirectoriesMapEndPoint,(function(n){return n.diContainer.get(y).getDirectoriesMap().then((function(n){var t={};return n.forEach((function(n,i){t[i]=n})),t}))}))}));
define("MsPortalImpl/Services/Services.SharedSettings",["require","exports","FxInternal/AsyncLoader"],(function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSharedSettings=void 0;var u=window,r=u.fx.environment.links;t.getSharedSettings=i.defineHandler(FxImpl.Extension.getSharedSettingsEndPoint,(function(){return{links:{accountPortal:r.accountPortal,classicPortal:r.classicPortal,createSupportRequest:r.createSupportRequest,helpAndSupport:r.helpAndSupport,manageSupportRequests:r.manageSupportRequests,submitAnIdea:r.submitAnIdea,privacyAndTerms:r.privacyAndTerms,privacyStatement:r.privacyStatement,promotionalCommunicationsManager:r.promotionalCommunicationsManager,learnRelatedResources:r.learnRelatedResources,resourceGroupOverview:r.resourceGroupOverview,roadmap:r.roadmap,filteringGranularity:r.filteringGranularity}}}))}));
define("MsPortalImpl/Services/Services.ShellProvisioner",["require","exports","Fx/Composition/Selectable","MsPortalImpl/UI/UI.BladeOpener","MsPortalImpl/UI/UI.JourneyManager"],(function(n,t,i,r,u){"use strict";var f;return (function(t){function l(n){return s||(s=new e(n,n.get(u.JourneyManager),n.get(FxImpl.Rpc.Client)))}var f=FxImpl.ViewModels.ParameterCollectionV3,h=MsPortalFx.Base,c=h.Diagnostics,o,s,e;t.promiseCleanupDelay=3e4;o=c.createLog(n);t.create=l;e=(function(){function n(n,t,i){this._diContainer=n;this._journeyManager=t;this.provisioningPromisesLookup={};this._registerRpcCallbacks(i)}return n.prototype.processProvisioningRequest=function(n){var o=this,s=!0,f="Provisioning request is ",h,t,u,e;if(!n)throw new Error(f+" undefined.");if(h=n.provisioningRefKey,!h)throw new Error(f+"missing the provisioningReferenceKey.");if(!n.provisioningPromise)throw new Error(f+"missing the provisioningPromise.");return n.provisioningPromise.catch((function(n){var t=(n||{}).error||n;o._logWarning("Provisioning promise rejected. "+(t.message||JSON.stringify(t)))})),t=n.provisioningConfig,t&&!!t.dontDiscardJourney&&(s=!1),u=t&&t.launchPostCreate&&t.postProvisioningBladeInputs,u&&u.then((function(n){var t=new i.PdlBladeReference("DeploymentDetailsBlade","HubsExtension",{parameters:{id:n.deploymentId,packageId:n.galleryItemId,packageIconUri:n.galleryItemIconUri,primaryResourceId:n.primaryResourceId,provisioningHash:n.provisioningHash,createBlade:n.createBlade}});o._diContainer.get(r.BladeOpener).openBlade(t,{flags:8,telemetryName:"ShellProvisioner"})})),s&&!u&&(e=this._journeyManager.activeJourney(),e&&this._journeyManager.forceDiscardJourney(e.id)),n.provisioningPromise},n.prototype._registerRpcCallbacks=function(n){var t=this;f.initiateProvisioningRequestEndPoint.registerObjectFactory(n,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(i,r){var e=r.srcWindowId,u="Can't initiate the provisioning request. ";return i.provisionerId?i.provisioningRefKey?(f.getProvisioningRequestEndPoint.acquireObject(n,e,i).then((function(n){t.processProvisioningRequest(n.value).finally((function(){n.dispose()}))}),(function(n){throw new Error(n);})),Q(i)):Q.reject(u+"provisioningRefKey unspecified."):Q.reject(u+"provisionerId unspecified.")}});f.getProvisioningOperationEndPoint.registerObjectFactory(n,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(n){if(!n)return Q.reject("Can't return provisioning operation. provisioningRefKey unspecified.");var i=t.provisioningPromisesLookup[n],r=i&&i.promise;return r&&(t.provisioningPromisesLookup[n].wasAcquired=!0),Q({provisioningPromise:r,data:i&&i.data})}})},n.prototype._logWarning=function(n){o.warning(n)},n})();t.ShellProvisionerImpl=e})(f||(f={})),f}));
define("MsPortalImpl/Services/Services.TelemetrySharing",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/ExtensionManager"],(function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SharingTelemetryProcessor=void 0;var e=MsPortalFx.Base,f=e.Constants,u=FxImpl.Rpc,o=(function(){function t(n,t){var i=this;this._extensionManager=n;this._extensions={};t.registerRpcEndPoint(f.TelemetrySharing.RegisterExtension,{allowedOrigin:null,handler:function(){i._extensions[u.getMessageContext().srcWindowId]=!0}})}return t.prototype.registerExtensionUnloadCallback=function(){var n=this;this._extensionManager.onUnload((function(t){var i=t;return n._extensions[i]&&delete n._extensions[i],!0}))},t.prototype.trace=function(n){var t=n.extension,i=n.data&&n.data.srcExtension,r=f.TelemetrySharing.TraceTelemetry;n.action!=="Ajax"&&(this._extensions[t]&&u.client.invokeRpc(r,t,n),t!==i&&this._extensions[i]&&u.client.invokeRpc(r,i,n))},t.prototype.flush=function(){return Q()},__decorate([__metadata("fx:diagnostics",[n,"SharingTelemetryProcessor"]),i.Class(),__metadata("design:paramtypes",[r.ExtensionManager,u.Client])],t)})();t.SharingTelemetryProcessor=o}));
define("MsPortalImpl/Services/Services.Util",["require","exports"],(function(n,t){"use strict";function o(n,t){var o="./Services.UtilHandlers";i(r.pinParts,o,"pinPartsRpcHandler",n,t);i(r.getClientIp,o,"getClientIpHandler",n);i(r.getHmacSha256,o,"hmacShaRpcHandler",n);i(f,o,"x509CertificateRpcHandler",n);i(e,o,"getPublishingProfileRpcHandler",n,null,[""+u.ClassicResources,"fx"])}function i(t,i,r,u,f,e){return u.registerRpcEndPoint(t,{allowedOrigin:e,handler:function(t,u){return MsPortalFx.require(n.normalize(i)).then((function(n){var i=n[r];return i(t,u,u.ltm,f)}))}})}function s(n){n=n||"";var t=n.toLowerCase();return["password","pwd","azure_storage_access_key","sharedkey"].some((function(n){return t.includes(n)}))?"_REDACTED_SENSITIVE_DATA_":MsPortalFx.sanitizeMessage(n)}Object.defineProperty(t,"__esModule",{value:!0});t.redactSensitiveData=t.registerEndpoints=void 0;var r=FxImpl.Constants.RpcMethods,u=MsPortalFx.Base.Constants.ExtensionNames,f="MsPortalFx.Internal.Constants.RpcMethods.X509Certificate.getX509Certificates",e="MsPortalFx.Internal.Constants.RpcMethods.PublishingProfile.getPublishingProfile";t.registerEndpoints=o;t.redactSensitiveData=s}));
define("MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder",["require","exports","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding"],(function(n,t,i,r,u,f){"use strict";function b(n,t){var s=n.diContainer.get(r.Finder),i=n.parent&&s.findPartsContainer(n),h=function(n){if(i&&i.getCompatibleSourceReferences){var t=i.getCompatibleSourceReferences(n);return t&&t[0]}},o,u;return t=t||[],o=n.overridesModel,u=[],t.forEach((function(n){var i=n.name,t;t=f.getModelValue(o,i).exists?null:h(n);u.push(e(n,t))})),u}function c(n){if(n.adapter){var i=l(n),t={},r=a(n,!1);return r.forEach((function(n){var r,f=n.compositionBindingDefinition,u=f&&f.source,e;u&&u.modelType===h&&(e=u.property,r=i[e]);r||(r={bindingSources:[],activeBindingSourceName:null});t[n.targetProperty]=r})),t}return l(n)}function k(n,t,r){function u(u,e){var a,p,h,l;t&&i.CompositionBinder.turnOnInputsSetSuppressionOn(t);i.CompositionBinder.turnOnInputsSetSuppressionOn(r);try{var w=u.inputs,v=u.settings,b=u.inputsMetadata,y=n.getSettingsModel(),s=n.partDefinition&&n.partDefinition.partState,k=s?(s.inputIdentityProperties||[]).concat((s.sharedProperties||[]).map((function(n){return n.property}))):[],nt=Object.keys(v);k.forEach((function(n){var r=ko.unwrap(f.getModelValue(y,n).value),t=n.startsWith("content.")?n.slice(8):n,i=ko.toJS(f.getModelValue(v,t).value);o(i,r)||(f.setModelValue(y,n,i),a=!0);MsPortalFx.remove(nt,t)}));h=c(n);Object.keys(h).forEach((function(t){var i=h[t],r=b[t],u=w[t];g(n,t,i,r.activeBindingSourceName,u)&&(p=!0)}));p&&(n.widgetState.valueHasMutated(),d(n,n.hasUserInteractedRecently()),n.save())}finally{return l=(a?2:1)|(e?0:4),Q.all([t&&i.CompositionBinder.turnOnInputsSetSuppressionOff(t,l,!0)||Q(),i.CompositionBinder.turnOnInputsSetSuppressionOff(r,l,!0),])}}n.getViewModel().internal.updateConfigFn(u)}function d(n,t){var i=n.widget;i&&i.element.trigger(u.fxpartinputchanged,{part:n,isUserInteraction:t})}function e(n,t){var r=n,i=n,e=i.targetProperty||r.name,o=!!n.optional,f;return t||(f=i.source&&i.source.property||r.name,t=u.createOverridesOrContainerModelSourceReference(f)),{targetProperty:e,optional:o,source:t,isDynamicBinding:!0}}function l(n){var o=n.diContainer.get(r.Finder),t=n.parent&&o.findPartsContainer(n),i=n.adapter?n.adapter.inputDefinitions:n.partDefinition.inputDefinitions,s=function(n){var u,r;return i&&t&&t.getCompatibleSourceReferences&&(r=MsPortalFx.find(i,(function(t){return t.name===n})),r&&(u=t.getCompatibleSourceReferences(r))),(u||[]).map((function(n){return{sourceReference:n,name:n.property,acceptsValueUpdates:!1}}))},u=n.overridesModel,h=function(n){if(!n||f.isDynamicBindingWithNonLocalSource(n))return!1;var t=n.source&&n.source.property;return u&&t&&f.getModelValue(u,t).exists},e={},c=a(n);return c.forEach((function(n){var r=n.targetProperty,u=s(r),t=n.compositionBindingDefinition,i=t&&t.source,f=!h(t)&&i&&MsPortalFx.find(u,(function(n){var t=n.sourceReference;return t.modelType===i.modelType&&t.property===i.property}));e[r]={bindingSources:u,activeBindingSourceName:f&&f.name}})),e}function a(n,t){return t===void 0&&(t=!0),n.getNonDetailsContainerPropertyBindings(t).filter((function(n){var t=n.targetProperty;return!p.isBladeCallerInput(t)&&t!==v.EditScopeId}))}function g(n,t,r,u,c){var v=u&&MsPortalFx.find(r.bindingSources,(function(n){return n.name===u})),y,l,b,k,it,rt,p,tt;if(u&&!v){s.error("Source with name '{0}' for configurable Part input named '{1}' does not exist at the Dashboard/Blade-level.".format(u,t));return}if(y=n.getInputPropertyBindings(),l=MsPortalFx.find(y.properties,(function(n){return n.targetProperty===t})),v?(it=r.activeBindingSourceName,v.name!==it&&(b=!0)):(rt=ko.unwrap(f.getModelValue(l.targetModel,l.targetProperty).value),o(ko.toJS(c),rt)||(k=!0)),!(b||k))return!1;if(n.adapter){var ut=MsPortalFx.find(n.bindings,(function(n){return n.targetProperty===t})),d=ut&&ut.source,ft=d&&d.modelType===h&&d.property;if(ft)p=ft;else return s.error("For Adapted Part '{0}', input named '{1}' to the inner Part is not configurable.  Presently, only those inner Part inputs using the 'AdapterInput' binding are configurable.".format(n.toString(),t)),!1}else p=t;var g=n.adapter?n.adapter.inputPropertyBindings:n.getInputPropertyBindings(),nt=MsPortalFx.find(g.properties,(function(n){return n.targetProperty===p})),et=nt.compositionBindingDefinition,ot=n.overridesModel,a;if(b){var st=n.adapter?n.adapter.inputDefinitions:n.partDefinition.inputDefinitions,ht=MsPortalFx.find(st,(function(n){return n.name===p})),ct=v.sourceReference;a=e(ht,ct)}return k&&(f.setModelValue(ot,nt.sourceProperty,ko.toJS(c)),a=e(et)),a&&(g.removeProperty(nt),tt=n.adapter?n.adapter.bindings:n.bindings,w(tt,et),i.CompositionBinder.setupPropertyBindings(n.diContainer,n,g,[a],(function(t){return n.bindAgainstOverridesOrContainerModel(t)})),tt.push(a),n.adapter&&(y.removeProperty(l),i.CompositionBinder.setupPropertyBindings(n.diContainer,n,y,l&&[l.compositionBindingDefinition],(function(t){return n.bindAdaptedInput(t)})))),!0}Object.defineProperty(t,"__esModule",{value:!0});t.listenForConfigurationChanges=t.getConfigurableInputsMetadata=t.inferInitialBindingsForInputDefinitions=void 0;var v=MsPortalFx.Base.Constants.BladeParameterNames,y=MsPortalFx.Base.Diagnostics,p=MsPortalFx.ViewModels.Internal,w=MsPortalFx.remove,o=MsPortalFx.deepEquals,s=y.createLog(n),h=9;t.inferInitialBindingsForInputDefinitions=b;t.getConfigurableInputsMetadata=c;t.listenForConfigurationChanges=k}));
define("MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration",["require","exports","MsPortalImpl/ViewModels/ViewModels.BladeCaller"],(function(n,t,i){"use strict";var r;return (function(n){function u(n,t,i){var u=t.internal,r=ko.observableArray([]);r.map(n,(function(n,t){ko.ignoreDependencies((function(){f(n,t,u,i)}))}));ko.computed(n,u.registeredSelectables,(function(n){n===void 0&&(n={});r.splice.apply(r,[0,r.peek().length].concat(Object.keys(n)))})).extend({deferred:!0})}function f(n,u,f,e){var c=e.getBladeOpener(),s={invocationInputArguments:[{valuesFrom:[{referenceType:0,property:t+"."+u}]}]},h=ko.unwrap(f.registeredSelectableOptions),o;h&&(o=h[u],o&&(o.parameterCollector&&i.addCallerBindings(r+"."+u+".parameterCollector.bladeCaller",s,0),s.openInContextPane=o.openInContextPane,s.persistentContextPane=o.persistentContextPane));c.registerInvocationProperty(s,null,n)}var t="internal.registeredSelectables",r="internal.registeredSelectableOptions";n.listenForRegistrationChanges=u})(r||(r={})),r}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.ModalToast.css",["module"],(function(n){"use strict";return{css:".fxs-modaltoast-item{position:absolute;top:50%;left:50%;padding:15px;transform:translate(-50%,-50%);min-width:80%;max-width:90%;max-height:calc(100vh - 50px);overflow-y:auto}@media screen and (min-width:600px){.fxs-modaltoast-item{min-width:500px;min-height:200px;max-width:1024px}}.fxs-mode-dark .fxs-modaltoast-item{background-color:#323130}.msportalfx-iris-hideonzoom{display:none}@media screen and (min-width:940px){.msportalfx-iris-hideonzoom{display:block}}.fxs-modaltoast-description{width:100%}.fxs-modaltoast-title{text-align:center;font-size:16px;font-weight:bold;width:100%;margin-bottom:5px;padding-top:5px}.fxs-modaltoast-inlineform{text-align:center}.fxs-modaltoast-inlineform .fxc-section{display:flex;justify-content:center}.fxs-modaltoast-inlineform .fxc-simplebutton{margin-right:5px}.fxs-modaltoast-inlineform .fxc-simplebutton .fxs-button{display:inline-flex;max-width:100%}.fxs-modaltoast-inlineform .fxs-button-text{display:inline-block;width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-modaltoast-close{position:sticky;top:0;float:right;background:none;border:none;cursor:pointer}.fxs-modaltoast-close svg{height:12px;width:12px}.fxs-mode-dark .fxs-modaltoast-close{background-color:#323130}",moduleId:n.id}}));
define("MsPortalImpl/Widgets/Widgets.ModalToast",["require","exports","Weave/DirectMode","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Interactions/Interactions.DismissHandler","_generated/Less/MsPortalImpl/Widgets/Widgets.ModalToast.css","Weave","MsPortalImpl/Weave/Components","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f,e,o,s){"use strict";function c(t){var y=t.vm,c=y.modalToast,l,a={dismissFn:function(){v()},logName:"modalToast"},v=function(){l.dispose();u.unregister(a);var n=c.value;if(n&&n.onDismissFn)n.onDismissFn(!1);h.focus()};return u.register(a),i("div",{className:"fxs-portal-shield"},i(e.Css,{css:f}),i("div",{className:"fxs-portal-modaltoast",role:"presentation",afterMount:function(n,t){l=new r.KeyboardNavigation(t,{element:$(n)});h=$(document.activeElement);var i=$(n).findByClassName("fxs-modaltoast-inlineform").findFirstTabbable();i.length>0?i.focus():$(n).findFirstTabbable().focus()}},i(e.If,{condition:c,trueFn:function(){return i("div",{className:"fxs-modaltoast-item fxs-portal-bg-txt-br fxs-popup msportalfx-shadow-level2"},i("button",{tabindex:1,className:"fxs-modaltoast-close fxs-portal-svg fxs-button-default","aria-label":s.ModalToast.closeModal,image:MsPortalFx.Base.Images.Close(),onClick:function(n){var t=n.event;v();t.preventDefault()}},s.NotificationMenu.dismissToast),i("div",{className:"fxs-modaltoast-title fxs-portal-text",tabindex:"-1"},c.compose((function(n){return n.title}))),i("div",{className:"fxs-modaltoast-description fxs-portal-title",tabindex:"-1"},i(o.ShellHtml,{content:c.compose((function(n){return n.description})),require:n})),c.compose((function(n){return n.formSection?n.formSection.section("msportalfx-form fxs-modaltoast-inlineform"):null})))}})))}Object.defineProperty(t,"__esModule",{value:!0});t.ModalToast=void 0;var h;t.ModalToast=c}));
define("MsPortalImpl/Widgets/Widgets.ModalToastViewModel",["require","exports","Weave"],(function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ViewModel=void 0;var r=(function(){function n(){this.modalToast=i.makeWritableComputation()}return n.prototype.addModalToast=function(n){var i,t;this.modalToast.value||(this.modalToast(n),i=n.formSection,i&&(t=i.buttons,t.forEach((function(i,r){var u=t[r].onClick;t[r].onClick=function(){u();n.onDismissFn&&n.onDismissFn(!0,r)}}))))},n})();t.ViewModel=r}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.NotificationsPane.css",["module"],(function(n){"use strict";return{css:"@keyframes fxs-notificationmenu-indeterminate-progress{from{left:-100%}to{left:150%}}.fxs-notificationspane-progressbar{position:absolute;overflow:hidden;height:2px;top:35px;left:1px;bottom:1px;right:1px;transition:opacity 1.5s ease-in-out 1s}.fxs-notificationspane-progressbar>div{position:absolute;width:60%;height:100%;animation:fxs-notificationmenu-indeterminate-progress 1.5s linear infinite;background-color:#00bcf2}.fxs-notificationspane-button-unreadcount{font-size:10px;position:absolute;top:5px;right:5px;border-radius:16px;text-align:center}.fxs-notificationspane-button-unreadcount-circle{height:16px;width:16px}.fxs-notificationspane-button-unreadcount-oval{width:28px}.fxs-notificationspane-header{padding:0 20px 10px}.fxs-notificationspane{width:525px;max-width:100%;height:100%;box-sizing:border-box;font-size:13px;line-height:normal;display:flex;flex-direction:column;overflow:hidden}.fxs-notificationspane-label{color:#fff;padding-bottom:3px}.fxs-notificationspane-top{overflow:auto;width:100%;padding:0 20px;box-sizing:border-box}.fxs-notificationspane-top .nodata-content{padding:15px 0;text-align:center;font-weight:bold;font-size:14px}.fxs-notificationspane-dismisscontainer{margin-left:auto;display:flex}.fxs-notificationspane-dismissitem{display:flex}.fxs-notificationspane-list{overflow:hidden;list-style:none;padding:0;margin:0;width:100%}.fxs-notificationmenu-notification-wrapper{padding:10px 5px 10px 10px;display:flex;position:relative}.fxs-notificationmenu-notification-li.fxs-portal-border{border-top-width:1px;border-top-style:solid}.fxs-notificationmenu-notification-li.fxs-portal-border:last-child{border-bottom-width:1px;border-bottom-style:solid}.fxs-notificationmenu-notificationclick:hover{text-decoration:underline}.fxs-notificationmenu-notification-dismissIcon{cursor:pointer;background-color:transparent;border:0;margin:0;padding:0;height:14px;width:10px;opacity:.4;margin-left:4px;padding-right:15px;padding-bottom:8px;flex:0 0 auto;position:absolute;top:8px;right:0;opacity:1}.fxs-notificationmenu-notification-dismissIcon svg{padding:5px}.fxs-mode-light .fxs-notificationmenu-notification-dismissIcon svg{fill:#605e5c}.fxs-notificationmenu-notification-expandIcon{cursor:pointer;background-color:transparent;border:0;margin:0;padding:0;height:8px;width:8px;opacity:.4}.fxs-notificationmenu-notification-dismissIcon:hover,.fxs-notificationmenu-notification-expandIcon:hover{opacity:1}.fxs-notificationmenu-notification-details{margin-top:10px;text-decoration:underline;cursor:pointer}.fxs-notificationmenu-notification-iconVerticalTransform{transform:scale(-1,-1);background-color:rgba(255,255,255,.3);padding-bottom:9px}.fxs-notificationmenu-notification-title{display:flex;padding-bottom:2px;max-width:calc(100% - 20px)}.fxs-notificationmenu-notification-title-icon{margin-right:4px;min-width:16px}.fxs-notificationmenu-notification-title-icon svg{height:16px;width:16px;vertical-align:middle}.fxs-notificationmenu-notification-title-text{font-size:14px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin:0 4px;height:20px;flex:1 0 0;font-weight:600}.fxs-notificationmenu-notification-title-subtitle{font-size:13px;line-height:normal}.fxs-notificationmenu-notification-description{font-size:13px;line-height:normal;display:block;line-height:18px;max-height:144px;overflow:hidden;position:relative;padding-top:5px;text-overflow:ellipsis;white-space:pre-wrap;width:100%}.fxs-notificationmenu-notification-expandedDescription{max-height:100%;overflow-y:auto}.fxs-notification-inlineform{padding-top:15px}.fxs-notification-inlineform .fxc-section{display:flex}.fxs-notification-inlineform .fxc-simplebutton{margin-right:5px}.fxs-notification-inlineform .fxc-simplebutton .fxs-button{display:inline-flex;max-width:100%}.fxs-notification-inlineform .fxs-button-text{display:inline-block;width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-notificationmenu-notification-progressbar{margin-top:10px}.fxs-notification-dropdown-button-icon{height:14px;width:14px;display:flex;align-items:center;justify-content:center;cursor:pointer}.fxs-notification-dropdown-button-icon>svg{height:100%;width:100%}.fxs-notification-dropdown-button-container{display:flex;align-items:center}.fxs-notification-dropdown-button{margin:4px 5px 0;padding:4px 5px;opacity:.7;border:none;width:100%;text-align:left}.fxs-notifications-empty{display:flex;flex-direction:column;align-items:center;justify-content:center}.fxs-notifications-emptyicon{height:100px;width:100px;padding-top:40px;padding-bottom:20px;opacity:.4}.fxs-notification-header-content{display:flex;flex:1 1 auto;padding-top:15px}.fxs-notification-action-menu{margin-top:-5px}.fxs-notification-user-time-info{min-height:20px;padding-top:10px;text-decoration:#7a7a7a;display:flex}.fxs-notification-user-time-info .fxs-notification-user-time-info-part{margin-left:auto}.fxs-notification-user-time-info .fxs-notification-user-time-info-part:first-child{margin-left:0}.fxs-notification-seemore-link{display:flex;width:fit-content}.fxs-notification-feedback-wrapper{float:right;margin-left:auto;min-height:20px;padding-top:10px}.fxs-notification-is-this-helpful,.fxs-notification-thank-you{color:#323130;display:inline-flex;font-size:12px;font-weight:normal;line-height:15px}.fxs-notification-is-this-helpful{margin-right:6px}.fxs-notification-like-button,.fxs-notification-dislike-button{color:#0078d4;cursor:pointer;display:inline-block;fill:#0078d400;height:11px;margin:-1px 0 0 7px;stroke:#0078d4;width:13px;transform:scale(-1,1)}.fxs-notification-like-button:focus,.fxs-notification-dislike-button:focus{color:#106ebe;fill:#106ebe00;stroke:#106ebe;transform:scale(-1.1,1.1)}.fxs-notification-like-button:hover,.fxs-notification-dislike-button:hover{color:#106ebe;fill:#106ebe00;stroke:#106ebe;transform:scale(-1.1,1.1)}.fxs-notification-like-button.fxs-notification-feedback-selected,.fxs-notification-dislike-button.fxs-notification-feedback-selected{color:#106ebe;fill:#106ebe;stroke:#106ebe}.fxs-notification-dislikeButton{margin:3px 0 0 14px}.fxs-notification-hide{display:none}.fxs-notification-see-more-less{padding-right:5px}.fxs-notificationmenu-notification{width:100%}.fxs-notificationmenu-arrow{padding-top:2px;padding-left:3px;height:10px;width:10px}",moduleId:n.id}}));
define("MsPortalImpl/UI/Hubs/UI.NotificationHelper",["require","exports","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.ModalToastViewModel","MsPortalImpl/Widgets/Widgets.ModalToast","MsPortalImpl/Resources/PortalNotificationsTelemetry","MsPortalImpl/Notifications/PortalNotifications","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.NotificationsPane.css","MsPortalImpl/Weave/DirectRender"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function b(n,t,i,r){var u=t.irisNotificationDetails;u?o.irisTelemetryHandler({diContainer:n,messageArg:{irisNotificationDetails:u,action:i},messageContext:null}):d.Telemetry.trace({source:r,action:i,data:{notificationId:t.notificationId}})}function k(n){var t=$.querySelectorAll(".fxs-topbar-notifications");v=n;t.attr("aria-label",nt.overflowTitle.format(n));t.findByClassName(w).remove();n>20?t.append(FxImpl.createElement("div",{"class":w+" "+et},MsPortalFx.encodeHtml(nt.overflowCountMessage))):n&&t.append(FxImpl.createElement("div",{"class":w+" "+ot},n+""))}function st(n,e,o,s){var h,a,d=e.status===l.InProgress?!0:!1,y,w;if(d&&(tt++,r.unhide($.querySelectorAll(".fxs-topbar-notifications>.fxs-notificationspane-progressbar"))),e.toastDuration===4)if(it)ft.warning("Modal toast already shown. Showing current toast as sticky. Details: "+JSON.stringify(e.irisNotificationDetails)+"; Correlation ids: "+e.correlationIds.join(","));else{it=!0;y=new u.ViewModel;w=new FxImpl.TriggerableLifetimeManager;y.addModalToast({title:e.title,description:e.description,formSection:e.formSection,onDismissFn:function(t,i){w.dispose();t?b(n,e,g.NotificationClicked+i,p.ToastTray):b(n,e,ut.NotificationDismissed,p.ToastTray)}});c.appendToElement({element:$.querySelectorAll("body")[0],ltm:w,weaveContext:{diContainer:n},weaveNode:f.ModalToast({vm:y})});return}o.isPaneOpen()?(((a=e.inlineForm)===null||a===void 0?void 0:a.buttons)||[]).forEach((function(n){n.id="NotificationClicked"+n.id})):((((h=e.inlineForm)===null||h===void 0?void 0:h.buttons)||[]).forEach((function(n){n.id="ToastClicked"+n.id})),e.timestamp.getTime()>=o.lastPaneOpenedTime()&&k(++v),s.addToasts({notificationId:e.notificationId,icon:t.iconMap[e.status],title:e.title,description:e.description||"",descriptionAsHtml:e.descriptionAsHtml,time:e.timestamp.toString({hour:"numeric",minute:"numeric"}),ids:e.correlationIds,descriptiveText:i.Toast.description.format(e.title),data:e,clickable:!!e.asset||!!e.linkedBlade||!!e.uri,formSection:e.formSection,duration:e.toastDuration,onDismissFn:function(){b(n,e,g.ToastDismissed,p.ToastTray)},uri:e.uri}))}function ht(n,t,i){!i.isPaneOpen()&&t.timestamp.getTime()>=i.lastPaneOpenedTime()&&!!v&&k(--v);t.status===l.InProgress&&(--tt||r.hide($.querySelectorAll(".fxs-topbar-notifications>.fxs-notificationspane-progressbar")));t.lifetimeManager&&!t.lifetimeManager.isDisposed()&&t.lifetimeManager.dispose()}Object.defineProperty(t,"__esModule",{value:!0});t.DEV=t.updateNotificationCount=t.showToastAndUpdateCount=t.updateUnreadCountOnButton=t.iconMap=void 0;s.injectCss(h);var y=MsPortalFx.Base,d=y.Diagnostics,a=y.Images.StatusBadge,rt=MsPortalFx.Hubs.Notifications,l=rt.NotificationStatus,p=e.Source,g=e.Action,ut=e.ActionModifier,ft=d.createLog(n),w="fxs-notificationspane-button-unreadcount",et="fxs-notificationspane-button-unreadcount-oval",ot="fxs-notificationspane-button-unreadcount-circle",nt=i.NotificationMenu;t.iconMap={};t.iconMap[l.Information]=a.Info();t.iconMap[l.Warning]=a.Warning();t.iconMap[l.Error]=a.Error();t.iconMap[l.InProgress]=y.Images.Loading.EllipsisSquare();t.iconMap[l.Success]=a.Success();var tt=0,v=0,it=!1;t.updateUnreadCountOnButton=k;t.showToastAndUpdateCount=st;t.updateNotificationCount=ht}));
define("MsPortalImpl/UI/Hubs/UI.NotificationsPane",["require","exports"],(function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ViewModel=void 0;var i=(function(){function n(n){this.diContainer=n;this.lastPaneOpenedTime=ko.observable(Date.now());this.isPaneOpen=ko.observable(!1)}return n})();t.ViewModel=i}));
define("MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration",["require","exports","MsPortalImpl/Extension/ViewModelManager"],(function(n,t,i){"use strict";function u(){var n=r+"All.Part";i.registerWithDi("BrowseAllBlade$ServicesListPartViewModel","ServicesListPartViewModel",n)}Object.defineProperty(t,"__esModule",{value:!0});t.registerViewModels=void 0;var r="MsPortalImpl/UI/Hubs/ViewModels/UI.Browse";t.registerViewModels=u}));
define("MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration",["require","exports","MsPortalImpl/Extension/ViewModelManager","FxInternal/Composition/Part"],(function(n,t,i,r){"use strict";function e(n){var e=i.registerWithState,t=u+(f+"DiagnosticsPart");e("HelpAndSupportBlade$DiagnosticsPartViewModel",t,(function(i){return r.composePartViewModel((function(t){return new i.DiagnosticsPartViewModel(t,n)}),{logArea:t})}))}Object.defineProperty(t,"__esModule",{value:!0});t.registerViewModels=void 0;var u="./MsPortalImpl/UI/Hubs/ViewModels/",f="UI.Settings.";t.registerViewModels=e}));
define("MsPortalImpl/UI/UI.AdvisorNotificationHelper",["require","exports","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/Base/Languages","MsPortalImpl/Resources/PortalNotificationsTelemetry"],(function(n,t,i,r,u,f){"use strict";function h(){return o||!y&&!p&&t.percentageOfUsersShownAdvisorNotification>0&&!w&&!b}function k(n){if(!h())return Q(!1);var r=Date.now()-s,f=MsPortalFx.Base.Resources.getVersionlessContentUri("Content/static/MsPortalImpl/AdvisorNotifications/AdvisorDashboard_"+u.getCultureSpecificLanguage().split("-").join("")+".png");return Q(n.querySetting(13,"AdvisorNotification").then((function(u){if(o||(u||0)<r&&Math.random()<t.percentageOfUsersShownAdvisorNotification){FxImpl.Hubs.Notifications.InternalClientNotification.internalPublish({notificationId:"AdvisorModal",timestamp:new Date,title:e.title,description:"<h1>"+MsPortalFx.encodeHtml(e.description)+"<a href='"+MsPortalFx.encodeAttribute(v.fx.environment.links.learnAdvisor)+'\' target="_blank"><span>'+MsPortalFx.encodeHtml(i.Blade.helpText)+'<\/span><\/a><img style="padding-top: 20px; display: block; margin-left: auto; margin-right: auto;" src= "'+MsPortalFx.encodeAttribute(f)+'"><\/h1>',status:MsPortalFx.Hubs.Notifications.NotificationStatus.Information,descriptionAsHtml:!0,toastDuration:4,inlineForm:{buttons:[{label:e.buttonText,id:"LaunchAdvisorBladeButton",deepLink:{uri:"#blade/Microsoft_Azure_Expert/AdvisorMenuBlade"}}]}});var h=Date.now();return n.setSetting(13,"AdvisorNotification",h),MsPortalFx.Base.Diagnostics.Telemetry.trace({source:c.ToastTray,action:l.AdvisorNotificationShown,actionModifier:a.NotificationShown,data:{advisorNotificationOccurence:s,percentageOfUsersShownAdvisorNotification:t.percentageOfUsersShownAdvisorNotification,testAdvisorFlag:o,timeElapsedInMs:r,advisorLastShown:u,advisorShownTime:h}}),!0}return!1})))}Object.defineProperty(t,"__esModule",{value:!0});t.DEV=t.showAdvisorNotification=t.shouldShowAdvisorNotification=t.percentageOfUsersShownAdvisorNotification=void 0;var c=f.Source,l=f.Action,a=f.ActionModifier,v=window,e=i.AdvisorNotification,s=(parseInt(MsPortalFx.getFeatureValue("advisornotificationdays"))||30)*864e5;t.percentageOfUsersShownAdvisorNotification=parseFloat(MsPortalFx.getFeatureValue("advisornotificationpercent"))/100;var y=r.hideSmallModals(),p=MsPortalFx.isFeatureEnabled("hideadvisormodals"),w=MsPortalFx.isFeatureEnabled("ci"),b=FxImpl.features.isNativePerf,o=MsPortalFx.isFeatureEnabled("testadvisor");t.shouldShowAdvisorNotification=h;t.showAdvisorNotification=k}));
define("MsPortalImpl/UI/UI.DirectoryHelper",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.FavoritesSettings","MsPortalImpl/Services/Services.Tenants","MsPortalImpl/UI/UI.AuthStateManager"],(function(n,t,i,r,u,f,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SaveDirectorySettingsHandler=void 0;var o=MsPortalFx.Hubs.Notifications,s=(function(){function t(n,t){this._diContainer=n;this._authStateManager=t}return t.prototype.saveDirectorySettings=function(){return __awaiter(this,void 0,void 0,(function(){var h,c,e,v,l,a,n,y,t,i,s;return __generator(this,(function(p){switch(p.label){case 0:return[4,this._diContainer.getAsync(u.UserDirectorySettings)];case 1:return h=p.sent(),c=h.userDefaultDirectory,e=c()||{},v=((typeof e=="string"?e:e.id)||"").toLowerCase(),l="",[4,Promise.all([this._authStateManager.getUserInfo(),this._diContainer.get(f.TenantsService).getHomeTenants(),])];case 2:return a=p.sent(),n=a[0],y=a[1],l=(n.directoryId||"").toLowerCase(),t=MsPortalFx.find(y,(function(n){return n.id.toLowerCase()===v})),i=h.signInToLastVisitedDirectory,i()===!1?t||(l&&o.ClientNotification.publish({title:r.defaultDirectoryNotFoundTitle,description:r.defaultDirectoryNotFoundDescription.format(n.domainName),status:o.NotificationStatus.Warning,uri:"#menu/directory"}),i(!0)):i(!0),s=i()?{id:n.directoryId,displayName:n.directoryName,domainName:n.domainName}:{id:t.id,displayName:t.displayName,domainName:t.domainName},s.id&&c(s),[2]}}))}))},__decorate([__metadata("fx:diagnostics",[n,"SaveDirectorySettingsHandler"]),i.Class(),__metadata("design:paramtypes",[i.Container,e.AuthStateManager])],t)})();t.SaveDirectorySettingsHandler=s}));
define("MsPortalImpl/UI/UI.NpsHelper",["require","exports","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/Resources/PortalNotificationsTelemetry"],(function(n,t,i,r){"use strict";function f(n){return u=n}function v(n,i,r,u,f,v,y){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(){return p?(e({source:o.ToastTray,action:s.NPSNotShown,actionModifier:h.SmallModalsHidden}),[2]):c||!a&&l&&!t.npsShownInSession?[2,MsPortalFx.require("MsPortalImpl/Widgets/Widgets.Nps").then((function(c){e({source:o.ToastTray,action:s.NPSShown,actionModifier:h.NotificationShown,data:MsPortalFx.extend({productId:f},v)});c.showSurvey(n,i,r,u,f,y);t.npsShownInSession=!0}))]:[2]}))}))}function k(n,t,i,r){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(){return u?(u=!1,[2,v(n,t,i,null,null,{surveyLastCompleted:r()},(function(){r(Date.now())}))]):[2]}))}))}function d(n){if(c)return f(!0);if(!l||a)return f(!1);var t=n(),i=Date.now()-b,r=t<i;return r?f(Math.random()<w):f(!1)}Object.defineProperty(t,"__esModule",{value:!0});t.setTestValues=t.shouldShowPortalNps=t.showPortalNps=t.showNps=t.npsShownInSession=void 0;var y=MsPortalFx.Base,e=y.Diagnostics.Telemetry.trace,o=r.Source,s=r.Action,h=r.ActionModifier,p=i.hideSmallModals(),c=MsPortalFx.isFeatureEnabled("testnps"),l=MsPortalFx.isFeatureEnabled("nps"),a=MsPortalFx.isFeatureEnabled("ci"),w=(parseFloat(MsPortalFx.getFeatureValue("npspercent"))||1)/100,b=(parseInt(MsPortalFx.getFeatureValue("npsintervaldays"))||90)*864e5,u=!1;t.npsShownInSession=!1;t.showNps=v;t.showPortalNps=k;t.shouldShowPortalNps=d}));
define("MsPortalImpl/UI/UI.SessionHandlerDeferred",["require","exports"],(function(n,t){"use strict";function l(n,t,o,l){var y,b,a,p;if(!i)return Q(!1);if(y=Date.now(),y-e<3e5)return Q(!0);e=y;b=f.startTrace({source:"Shell",action:l});a=FxImpl.createElement("iframe");a.classList.add("fxs-extension-frame");a.setAttribute("tab-index","-1");a.setAttribute("aria-hidden","true");a.src=u.Resources.getAppRelativeUri("/signin/validateSession/@"+t+"/?sid="+(n.aadSessionId||""));p=s.body;p.appendChild(a);var w=Q.defer(),v=function(n){if(n.origin.toLowerCase()===h){var t=n.data||{};if(t.signature===c&&(i=t.valid!==!1,k(i,i?"SessionValid":"SessionExpired"),!i))o.onStatus({code:7},"fx")}},k=function(n,t){w.promise.isPending()&&(w.resolve(n),f.endTrace(b,t));a&&(p.removeChild(a),a=null);v&&(r.removeEventListener("message",v,!1),v=null)};return Q.delay(3e5).then((function(){k(!0,"ErrorValidatingSession")})),r.addEventListener("message",v,!1),w.promise}Object.defineProperty(t,"__esModule",{value:!0});t.validateSessionLifetime=void 0;var u=MsPortalFx.Base,o=u.Diagnostics,f=o.Telemetry,r=window,s=r.document,h=FxImpl.trustedParentOrigin.toLowerCase(),c="ValidateSession",e=0,i=!0;t.validateSessionLifetime=l}));
define("MsPortalImpl/UI/UI.SessionHandler",["require","exports","MsPortalImpl/UI/UI.SessionHandlerDeferred","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/Resources/SessionHandlerResources"],(function(n,t,i,r,u){"use strict";function s(n,t,i,f,e){var h=!1,s;return f.addCallbacks({onBusy:function(){s=undefined},onIdle:function(c){var l=ko.unwrap(i),a=t&&l?Math.min(t,l):Math.max(t,l);a&&c>=a?(MsPortalFx.Base.Diagnostics.Telemetry.trace({source:o,action:"TimedSignout",data:{signedOutTime:Date.now(),idleTime:c,userSetting:l,tokenTimeout:t}}),s&&MsPortalFx.Base.Diagnostics.Telemetry.endTrace(s,"InactiveUserSignout",{signedOutTime:Date.now(),idleTime:c,userSetting:l,tokenTimeout:t}),e()):MsPortalFx.isFeatureEnabled("logouttimerpopup")&&a&&c+1===a&&!h&&n.getAsync(r.DialogManager).then((function(n){s=MsPortalFx.Base.Diagnostics.Telemetry.startTrace({source:o,action:"SessionInactivtyTimeoutPrompt",data:{idleTime:c,userSetting:l,tokenTimeout:t}});h=!0;var i=MsPortalFx.ViewModels.Dialogs.DialogResult;n.showModalDialog({description:u.TimeoutDialog.description,title:u.TimeoutDialog.title,buttons:2,cancelButtonText:u.TimeoutDialog.cancelButton,defaultButtonText:u.TimeoutDialog.acceptButton}).then((function(n){h=!1;switch(n){case 1:MsPortalFx.Base.Diagnostics.Telemetry.cancelTrace(s,{signedOutTime:Date.now(),idleTime:c,userSetting:l,tokenTimeout:t});e();break;case 4:MsPortalFx.Base.Diagnostics.Telemetry.completeTrace(s,{idleTime:c,userSetting:l,tokenTimeout:t});f.signalBusy()}}))}))}})}function a(n,t,r,u,o,h,c,a){var v=r.bootstrapState.idleTimeoutSeconds/60,y;v?f=s(n,v,u,o,h):u.subscribeAndRun(t,(function(t){t&&!f?f=s(n,0,u,o,h):t||v||!f||(o.removeCallbacks(f),f=null)}));MsPortalFx.isFeatureEnabled("sessionvalidity")&&(y=function(){return Q.delay(l).then((function(){e().then((function(n){n&&i.validateSessionLifetime(r.bootstrapState,c,a,"SessionValidityPoll").then((function(n){n&&y()}))}))}))},y())}Object.defineProperty(t,"__esModule",{value:!0});t.setTestValues=t.initialize=void 0;var o="SessionHandlerTimedSignout",h=window,c=MsPortalFx.Base.Diagnostics.createLog(n),l=parseInt(MsPortalFx.getFeatureValue("sessionpollinterval"))||36e5,f,e=MsPortalFx.memoizeQ((function(){var n=h.fx.environment.links.graphPoliciesEndpoint;return n?Q(MsPortalFx.Base.Net2.ajax({uri:n,setAuthorizationHeader:{resourceName:"graph"}})).then((function(n){return(n.value||[]).some((function(n){return(n.type||"").toLowerCase()==="tokenlifetimepolicy"&&(n.definition||[]).some((function(n){return(n||"").toLowerCase().includes("maxagesession")}))}))})).catch((function(n){var t=(n.jqXHR||{}).status;return t===401||t===403?!0:t===0?(e.clear(),!1):(e.clear(),c.verbose("Error calling graph for policy details",0,n),!0)})):Q(!0)}));t.initialize=a}));
define("_generated/Less/MsPortalImpl/UI/UI.Portal.Actions.css",["module"],(function(n){"use strict";return{css:".fxt-copy{display:flex;margin-top:5px}.fxt-copy-control{padding-left:10px}",moduleId:n.id}}));
define("MsPortalImpl/UI/UI.StatusHandler",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Services/Services.SecurityTokens","Fx/Composition","FxInternal/Css","_generated/Less/MsPortalImpl/UI/UI.Portal.Actions.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function w(n,t,i,r,u){v.trace({source:"Shell",action:"StatusHandlerShowNotification",name:a,data:{title:n,description:t,correlationId:i}});rt.ClientNotification.publish({title:n,description:t,status:r||b.Information,descriptionAsHtml:u,correlationIds:[i]})}var ot;Object.defineProperty(t,"__esModule",{value:!0});t.StatusHandler=t.errorUri=void 0;h.injectCss(c);var tt=MsPortalFx.Base,st=tt.Constants,it=tt.Diagnostics,v=it.Telemetry,rt=MsPortalFx.Hubs.Notifications,b=rt.NotificationStatus,y=window,ut=y.document,k=it.createLog(n),a=st.Shell,ft=r.Shell,d=ft.Notifications,l=ft.Dialogs,g=d.SessionEnding,p=d.TokenFailure,et=d.VersionChanged,ht={sessionId:MsPortalFx.sessionId};t.errorUri=y.fx.internalEnv.portalApplicationUri+"/Error";var ct=[12e5,6e5,],lt='<div class="fxt-copy"><a href="#" data-bind="text: copyText, click: copyClick"><\/a><\/div>',nt=y.fx.environment.links.aadErrorCodes,at='<a class="msportalfx-ext-link" href="" data-bind="text: learnMoreText, fxclick: onClickLearnMore"><\/a>';ot=(function(){function r(n,t,i,r,u){var f=this;this._diContainer=n;this._dialogManager=t;this._rootElements=i;this._windowManager=r;this.isShellInitialized=Q.defer();this._pageBlockingPrompt=!1;this._isDialogVisible=!1;this.isOfflineDialogVisible=!1;this._unknownNetworkErrorCount=0;this._unknownNetworkErrorCanceled=!1;u.sessionEndedHandler=function(n,t){return f.onLastTokenRefresh(n,t)};u.tokenFailedHandler=function(n,t,i){f.onStatus({code:2,message:i,data:{resourceName:t}},n)};u.tokenMfaErrorHandler=function(n,t,i){f.onStatus({code:8,message:i,data:{resourceName:t}},n)};u.tokenClaimsErrorHandler=function(n,t,i,r){var u=Object.create(null);nt&&(u.learnMoreText=l.learnMore,u.onClickLearnMore=new s.ClickableLink(nt,"_blank",null,MsPortalFx.noop,"AadErrorCodes"));f.onStatus({code:9,data:{missingClaims:i,resourceName:t},message:r},n,u)};u.unauthorizedTokenHandler=function(n){f.onStatus({code:7},n)};window.onoffline=function(n){f.onOfflineEvent(n)};window.ononline=function(n){f.onOnlineEvent(n)}}return r.prototype.onOfflineEvent=function(n){this._isDialogVisible||this.isOfflineDialogVisible||(this._showDialog({extensionName:a,telemetryAction:"OfflineEvent",messageTitle:l.connectionErrorMessageTitle,messageDescription:l.offlineEventMessageDescription,defaultButtonText:l.newVersionDefaultButtonText,cancelButtonText:l.connectionErrorCancelButtonText,delayMilliSeconds:0,buttons:2,actions:0,additionalDetails:{type:n.type}}),this.isOfflineDialogVisible=!0)},r.prototype.onOnlineEvent=function(){this.isOfflineDialogVisible&&(this._dismissDialog(),this.isOfflineDialogVisible=!1,v.trace({source:"Shell",action:"OnlineEvent",name:a}))},r.prototype.onLastTokenRefresh=function(n,t){var i=Date.now();if(v.trace({source:"Shell",action:"OnLastTokenRefresh",name:a,data:{tokenExpiresAt:t}}),t<=i)this.onStatus({code:2},n);v.trace({source:"Shell",action:"SessionEndWarning",name:a,data:{tokenExpiresAt:t}});ct.forEach((function(n){var r=t-n;setTimeout((function(){var t=Math.floor(n/6e4),i=t>10?g.messageFmt.format(t):g.message;w(g.title,i,"lastTokenRefresh")}),r-i)}))},r.prototype.onStatus=function(n,i,r){var u,f,e;return __awaiter(this,void 0,void 0,(function(){var c,o,tt,y,it,h,rt,s,d,ut,g;return __generator(this,(function(ft){switch(ft.label){case 0:if(!n||this._pageBlockingPrompt)return[2];c=i===a||i==="HubsExtension";o=(u=n.data)!==null&&u!==void 0?u:{};tt=(f=o.uri)!==null&&f!==void 0?f:"";y=(e=n.message)!==null&&e!==void 0?e:"";it=n.code;switch(it){case 0:return[3,1];case 1:return[3,2];case 2:return[3,6];case 7:return[3,7];case 4:return[3,9];case 6:return[3,11];case 8:return[3,12];case 9:return[3,14]}return[3,16];case 1:return[2];case 2:return c?[4,this._showDialog({extensionName:i,telemetryAction:"ShellVersionChanged",messageTitle:l.newVersionMessageTitle,messageDescription:l.newVersionMessageDescription,defaultButtonText:l.newVersionDefaultButtonText,delayMilliSeconds:3e4,buttons:2,actions:5,additionalDetails:o})]:[3,4];case 3:return ft.sent(),[2];case 4:v.trace({source:"Shell",action:"ExtensionVersionChanged",data:i});k.warning("Extension reporting incompatible server version. "+i+":"+o.version);w(et.title,et.messageFmt.format(i),"VersionChanged-"+i);ft.label=5;case 5:return[2];case 6:return h=o.resourceName,h?(s=p.description.format(i),h&&(s+="\n"+p.resourceName.format(h)),y&&(s+="\n"+p.errorDetails.format(y)),w(p.title,s,"AuthTokenError-"+i,b.Information)):this._windowManager.redirect({uri:t.errorUri+"/UE_SessionExpired"+window.location.hash,redirectAction:3,reason:"authorizationExpired_Arm_"+i}),[2];case 7:return[4,this._showDialog({extensionName:a,telemetryAction:"SessionExpired",messageTitle:l.sessionExpired,messageDescription:l.sessionExpiredMessage,defaultButtonText:l.refresh,buttons:1,actions:2,additionalDetails:o})];case 8:return ft.sent(),[2];case 9:return(k.verbose("Received a status code zero from extension "+i+" for URL '"+tt+"'."),!c)?[2]:this._unknownNetworkErrorCount>3||this._isDialogVisible||this._unknownNetworkErrorCanceled?[2]:(this._unknownNetworkErrorCount++,[4,this._showDialog({extensionName:a,telemetryAction:"UnknownNetworkError",messageTitle:l.connectionErrorMessageTitle,messageDescription:l.connectionErrorMessageDescription,defaultButtonText:l.newVersionDefaultButtonText,cancelButtonText:l.connectionErrorCancelButtonText,buttons:2,actions:0,additionalDetails:o})]);case 10:return rt=ft.sent(),this._unknownNetworkErrorCanceled=rt===1,[2];case 11:return s=l.tooManyRequestsDescription,d=o.retryAfter,d&&(s=s+" "+l.tooManyRequestsRetry.format(d)),w(l.tooManyRequestsTitle,s,"TooManyRequests-"+i,b.Warning,!0),[2];case 12:return[4,this._showDialog({extensionName:i,telemetryAction:"MfaError",messageTitle:l.mfaError,messageDescription:n.message,defaultButtonText:l.signOutText,buttons:2,actions:2,additionalDetails:o})];case 13:return ft.sent(),[2];case 14:return ut=l.claimsErrorDescription.format(nt?at:""),[4,this._showDialog({extensionName:i,telemetryAction:"ClaimsError",messageTitle:l.claimsErrorTitle,messageDescription:ut,defaultButtonText:l.claimsErrorButtonText,buttons:1,actions:0,missingClaims:o.missingClaims,additionalDetails:MsPortalFx.extend2(o,{errorMessage:n.message}),templateViewModel:r})];case 15:return ft.sent(),[2];case 16:return g="Received unknown extension event '"+n.code+"' for extension '"+i+"'.",k.error(g),[2,Promise.reject(g)];case 17:return[2]}}))}))},r.prototype._showDialog=function(t){return __awaiter(this,void 0,void 0,(function(){var u,f,o,i,s,r,h,c,p,w=this;return __generator(this,(function(b){switch(b.label){case 0:return(f=e.hasFlag(t.actions,2),this._pageBlockingPrompt=e.hasFlag(t.actions,1),t.telemetryAction&&v.trace({source:"Shell",action:t.telemetryAction,name:t.extensionName,data:t.additionalDetails}),f&&(o=3),i=function(n,i){w._windowManager.redirect({skipFlushBuffers:f,delayPromise:n&&t.delayMilliSeconds?Q.delay(t.delayMilliSeconds):null,redirectAction:o,reason:i})},s=e.hasFlag(t.actions,4)&&Q.isPending(this.isShellInitialized.promise),s)?(u=Q.defer().promise,i(!1,"shouldSkipPrompt"),[2,u]):(r=Q.defer(),this._isDialogVisible=!0,[4,this._dialogManager.showModalDialog({title:t.messageTitle,description:t.messageDescription+lt,templateViewModel:MsPortalFx.extend2(t.templateViewModel,{copyText:l.copyText,copyClick:function(){var u=JSON.stringify(MsPortalFx.extend2(ht,t.additionalDetails),null,2),n=FxImpl.createElement("pre"),i,r;n.textContent=u;ut.body.appendChild(n);i=y.getSelection();i.removeAllRanges();r=ut.createRange();r.selectNodeContents(n);i.addRange(r);y.document.execCommand("copy");n.remove()}}),defaultButtonText:t.defaultButtonText,cancelButtonText:t.cancelButtonText,buttons:t.buttons,uiShield:{hidePromise:r.promise}})]);case 1:return(h=b.sent(),!t.missingClaims)?[3,7]:[4,MsPortalFx.require(n.normalize("./UI.NavigationManager.ForceSignIn"))];case 2:c=b.sent();b.label=3;case 3:return b.trys.push([3,5,,6]),[4,c.forceSignIn(this._diContainer,{bladeDeepLink:window.location.hash,signInParameters:JSON.parse(t.missingClaims),reason:"MissingClaims"},a)];case 4:return b.sent(),[3,6];case 5:return p=b.sent(),v.trace({source:"UIStatusHandler",action:"ErrorForcingMfaSignIn",data:{error:MsPortalFx.sanitizeMessage(JSON.stringify(p))}}),[3,6];case 6:return[2];case 7:return this._pageBlockingPrompt?(this._rootElements.showSplash(!0),r.resolve(),i(!0,"isPageBlockingPrompt")):h===4?i(!1,"isNotPageBlockingPrompt_Ok"):r.resolve(),this._isDialogVisible=!1,[2,u]}}))}))},r.prototype._dismissDialog=function(){this._dialogManager.hasOpenDialog&&this._dialogManager.dismissOpenDialog(0);this._isDialogVisible=!1},__decorate([__metadata("fx:diagnostics",[n,"StatusHandler"]),i.Class(),__metadata("design:paramtypes",[i.Container,u.DialogManager,f.RootElements,f.WindowManager,o.SecurityTokensManager])],r)})();t.StatusHandler=ot}));
define("MsPortalImpl/UI/UI.Initialize",["require","exports","Fx","Fx/Diagnostics","Fx/DependencyInjection","Fx/Feedback","Fx/Telemetry","Fx/UriBuilder","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Services/Services.BrowserTelemetry","FxInternal/Experimentation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl.Controls/Controls/ResourceFilterHelper","FxInternal/AsyncLoader","MsPortalImpl/RpcEndPoints","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.KnockoutExtensions.FxParameterCollector","MsPortalImpl/Base/Base.Router","MsPortalImpl/Base/ClaimsIdentity","MsPortalImpl/Base/Languages","MsPortalImpl/Base/Themes","MsPortalImpl/Controls/ControlBindings.Async","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Interactions/Interactions.PrintHandler","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.BrowseCuration","MsPortalImpl/Services/Clarity","MsPortalImpl/Services/Services.HatsSettings","MsPortalImpl/Services/Services.FavoritesSettings","MsPortalImpl/Services/Services.FileUploadEndpointRegistration","MsPortalImpl/Services/Services.FileUploadInitialization","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Services/Services.PortalIdleState","MsPortalImpl/Services/Services.PortalPollingManager","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Recents","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Services/Services.ShellProvisioner","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/Services/Services.TelemetrySharing","MsPortalImpl/Services/Services.Tenants","MsPortalImpl/Services/Services.Util","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Widgets/Widgets.Portal","MsPortalImpl/Widgets/Widgets.ToastViewModel","MsPortalImpl/UI/Compositions/UI.Composition.Services","MsPortalImpl/UI/UI.DirectoryHelper","MsPortalImpl/UI/Hubs/UI.FavoritesManager","MsPortalImpl/UI/Hubs/UI.NotificationHelper","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/Notifications/NotificationsArea","MsPortalImpl/UI/Hubs/UI.NotificationsPane","MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration","MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration","MsPortalImpl/UI/UI.AdvisorNotificationHelper","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManagerImpl","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/UI.NpsHelper","MsPortalImpl/UI/UI.SessionHandler","MsPortalImpl/UI/UI.StatusHandler","MsPortalImpl/Services/Services.ProjectedDirectories","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Notifications/PortalNotifications","MsPortalImpl/Widgets/Widgets.Portal.init","MsPortalImpl/Services/Services.BrowserSettings","FxInternal/Events","MsPortalImpl/Base/Base.KnockoutExtensions","MsPortalImpl/Base/Base.KnockoutExtensions.FxClick","MsPortalImpl/Base/Base.KnockoutExtensions.Image","MsPortalImpl/Controls/ControlBindings","MsPortalImpl/Base/Base.KnockoutExtensions.Copy","MsPortalImpl/Base/Base.KnockoutExtensions.HtmlTemplateBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding","MsPortalImpl/Base/JQueryExtensions","MsPortalImpl/Parts/Parts.Intrinsics","MsPortalImpl/Parts/Parts.ButtonPart","MsPortalImpl/Parts/Parts.Collection","MsPortalImpl/Services/Services.ExtensionTokensManager","MsPortalImpl/Services/Services.SharedSettings","MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder","MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci,li,ai,vi,yi,pi,wi,bi,ki,di,gi,nr,tr,ir,rr,ur,fr,er,or,sr,hr,cr){"use strict";function ff(n,t){t&&t.startsWith("#")&&n.route(t)}function lr(n,t,i){e.trace({source:n,action:t,data:i})}function oe(){return Math.random()<(parseFloat(MsPortalFx.getFeatureValue("hatspercentage"))||0)/100}function au(n,t,i,r){ir.showPortalNps(n,t,i,r);lr(vr,"PortalInitializeNpsModal")}function se(n,t){if(MsPortalFx.isFeatureEnabled("canmodifyextensions")||MsPortalFx.isFeatureEnabled("testdevsat"))return yr("MsPortalImpl/UI/UI.DevSATSurvey").then((function(i){i.showDevSAT(n,t)}))}function sf(n){var t=cr.temporaryExtensionCount.getExtensionCountsAsList();n.addExtensionCounts(t);cr.temporaryExtensionCount.flush()}function he(n,t){var i;return __awaiter(this,void 0,void 0,(function(){var e,o,r,s,h,f,u;return __generator(this,(function(c){switch(c.label){case 0:return(e=(i=t.userInfo.isTenantParityDependent)!==null&&i!==void 0?i:!1,o=t.portalNotifications.shouldShowContactability(),r=ir.shouldShowPortalNps(t.generalSettings.npsTimeMs),s=t.portalNotifications.shouldShowIrisAdvisor(),h=t.portalNotifications.shouldShowCloudDeprecationModal(t.generalSettings.cdmTimeMs()||0),f=!1,MsPortalFx.isFeatureEnabled("showhatsmodal")&&(f=!MsPortalFx.isFeatureEnabled("testnps")&&r&&ef(),cr.temporaryExtensionCount.addIntervalId(setInterval((function(){return sf(t.hatsSettings)}),6e5))),!h)?[3,2]:(lr(vr,"PortalInitializeCloudDeprecationModal"),[4,t.portalNotifications.showCloudDeprecationModal()]);case 1:return c.sent(),[2,t.generalSettings.cdmTimeMs(Date.now())];case 2:return(u="",e?u="SkippedModalsWhenParityDependent":MsPortalFx.isFeatureEnabled("hidemodalswhendeeplinked")&&t.deeplinkLoadedPortal&&(u="SkippedModalsWhenDeeplinked"),u)?(lr(vr,u,{deeplink:t.deeplinkLoadedPortal,isTenantParityDependent:e,showWelcomeSequence:t.showWelcomeSequence,shouldShowContactability:o,shouldShowHats:f,shouldShowNps:r,shouldShowAdvisorNotification:di.shouldShowAdvisorNotification(),shouldShowIrisAdvisor:s}),r&&au(t.generalSettings,t.userSettingsManager,t.toastVM,t.generalSettings.npsTimeMs),[2]):t.showWelcomeSequence?[2,t.welcomeSequenceCallback().then((function(){lr(vr,"PortalInitializeWelcomeModal")}))]:o?(lr(vr,"PortalInitializeUpdateContactModal"),[4,t.portalNotifications.showContactabilityModal(n)]):[3,4];case 3:return c.sent(),[2];case 4:return s?(lr(vr,"PortalInitializeIrisAdvisor"),[4,t.portalNotifications.showIrisAdvisor()]):[3,6];case 5:return c.sent(),[2];case 6:return[2,(MsPortalFx.isFeatureEnabled("showirisadvisor")?Q(!1):di.showAdvisorNotification(t.userSettingsManager)).then((function(i){if(i){lr(vr,"PortalInitializeAdvisorModal");return}if(MsPortalFx.getFeatureValue("testhats")||f)return t.portalNotifications.showHatsModal(n,t.generalSettings.npsTimeMs).then((function(n){if(n)return t.generalSettings.npsTimeMs(Date.now()),lr(vr,"PortalInitializeHatsModal");au(t.generalSettings,t.userSettingsManager,t.toastVM,t.generalSettings.npsTimeMs)}));if(r){au(t.generalSettings,t.userSettingsManager,t.toastVM,t.generalSettings.npsTimeMs);return}se(t.toastVM,t.generalSettings.devSatTimeMs)}))]}}))}))}function ce(n){return MsPortalFx.isFeatureEnabled("mspfilter")?n.getAsync(fr.ServicesProjectedDirectories):Q()}function hf(n,t,i,r,u){n.notifications.subscribeArrayChanges(t,(function(n){vi.showToastAndUpdateCount(i,n,r,u)}),(function(n){vi.updateNotificationCount(i,n,r)}))}function le(n){return n.getAsync(dt.SettingsManager).then((function(t){return Q.spread([t.querySetting(12,eu),n.getAsync(pt.GeneralSettings),n.get(FxImpl.Features),],(function(t,i,r){var u=!t;return r.isEnabled("landalltohome")&&u&&i.landingPage(1),pt.isLandingPageDashboard(n)}))}))}function ae(n,t){var i=or.getCurrentUri().getHashParts().category.toLowerCase();switch(i){case"blade":case"create":case"asset":case"resource":["MsPortalImpl/UI/UI.CreateJourney","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener"].forEach((function(n){yr(n);lr(vr,"PortalInitializeDeeplinkPreload",{routeType:i,moduleId:n})}));uf=i;break;case"dashboard":vu(n);break;case"":MsPortalFx.isFeatureEnabled("azureHome")?t.then((function(t){t&&vu(n)})):vu(n)}}function ve(n){var t=or.getCurrentUri().getHashParts();return t.category.toLowerCase()==="dashboard"?t.rest?Q(t.rest):cf(n):cf(n)}function cf(n){return n.getAsync(dt.SettingsManager).then((function(n){return dt.queryStores(n,[4])})).then((function(n){var t=n&&n.get(4),i=t&&t[ni.startBoardSettingsKey];return i&&i.dashboardId||""}))}function vu(n){var t=n.get(dt.PortalStartupMarkers);t.preloadDashboardStart=pr();wr.markFromNavigation("preloadDashboardBundle");yr("MsPortalImpl/UI/Dashboard/DashboardManager");MsPortalFx.tryImmediateResolve(ve(n),(function(t){t=(t||"").toLowerCase();var i=n.get(dt.PortalStartupMarkers);t.indexOf("private")===0?(wr.markFromNavigation("preloadDashboardPrivateRepoBundle"),yr("MsPortalImpl/UI/Dashboard/PrivateDashboardRepository"),i.preloadDashboardRepoStart=pr(),i.preloadDashboardRepoType="private"):t.indexOf("arm")===0&&(wr.markFromNavigation("preloadDashboardArmRepoBundle"),yr("MsPortalImpl/UI/Dashboard/ArmDashboardRepository"),i.preloadDashboardRepoStart=pr(),i.preloadDashboardRepoType="arm")}))}function ye(n){var t=n.get(dt.PortalStartupMarkers);return t.hasOwnProperty("requireDashboardStart")||(t.requireDashboardStart=pr()),n.getAsync(p.get("MsPortalImpl/UI/Dashboard/DashboardManager","DashboardManagerImpl"))}function gr(n,t,i){n.get(t).setRegistration(i)}function ar(n,t,i){gr(n,t,(function(t,r){return ye(n).then((function(n){return i(n,t,r)}))}))}function lf(n){ar(n,er.StartNewDashboardPortalFunc,(function(n,t,i){return n.startNewDashboard(i)}));ar(n,er.ExportDashboardPortalFunc,(function(n){return n.getArmDashboardJson()}));ar(n,er.ImportDashboardPortalFunc,(function(n,t){return n.importDashboard(t.dashboard,t.title)}));ar(n,er.ReadDashboardPortalFunc,(function(n,t){return n.readDashboardsForType(t.repositoryType,t.subscriptions,t.useArg,t.includeRecents)}));ar(n,er.SwitchDashboardPortalFunc,(function(n,t,i){return n.switchDashboard(t,i)}));ar(n,er.ResetDashboardPortalFunc,(function(n,t){return n.resetLayout(t.duringPortalStartup,t.force)}));ar(n,er.CloneDashboardPortalFunc,(function(n){return n.cloneCurrentDashboard()}));ar(n,er.ClonePartPortalFunc,(function(n,t,i){return n.clonePartToDashboardJson(t.partComposition,i,t.dashboard,t.isCopyExperience)}));ar(n,er.AssignTagsToDashboardPortalFunc,(function(n,t,i){return n.assignTagsToDashboard(i)}));ar(n,er.ShareCurrentDashboardPortalFunc,(function(n,t){return n.shareCurrentDashboard(t.title,t.armExtras)}));ar(n,er.ShareDashboardToSessionPortalFunc,(function(n,t){n.shareCurrentDashboardToSession(t)}));ar(n,er.UnshareDashboardToSessionPortalFunc,(function(n){return n.unshareCurrentDashboard()}));ar(n,er.IsDashboardWritablePortalFunc,(function(n,t){return n.isDashboardWritable(t)}));ar(n,er.IsCurrentDashboarSharedPortalFunc,(function(n){return n.isCurrentDashboardShared()}));ar(n,er.GetCurrentDashboardPropertiesPortalFunc,(function(n){return n.getCurrentDashboardProperties()}));ar(n,er.PinTilesPortalFunc,(function(n,t,i){return n.pinMultipleParts(t.partReferences,t.originExtension,t.notify,i,t.dashboard?t.dashboard:null,t.dashboardCreationOption?t.dashboardCreationOption:null)}));ar(n,er.PinTileWithOptionsPortalFunc,(function(n,t,i){return n.addPartToStartBoard(t.options,t.duringPortalStartup,t.shouldSave,i)}));ar(n,er.PinBladePortalFunc,(function(n,t,i){return n.pinBladeToDashboard(t,i)}));ar(n,er.PinTilePortalFunc,(function(n,t,i){return n.pinPartToStartboard(t,i)}));ar(n,er.DeleteDashboardWithConfimationPortalFunc,(function(n,t){return n.deleteDashboardWithConfirmation(t.currentContext,t.reasonDeleted)}));ar(n,er.RefreshDashboardPortalFunc,(function(n,t,i){return n.refreshDashboard(i)}));gr(n,er.RoutePortalFunc,(function(t){return n.getAsync(p.get("MsPortalImpl/Base/Base.Router","Router")).then((function(n){return n.route(t)}))}));gr(n,er.ReplacePartPortalFunc,(function(t){return p.get("MsPortalImpl/UI/UI.ReplacePart","replacePart").then((function(i){return i(n,t.part,t.newLocator,t.options)}))}));gr(n,er.ReloadPartPortalFunc,(function(t){return p.get("MsPortalImpl/UI/UI.ReloadPart","reloadPart").then((function(i){return i(n,t)}))}));gr(n,er.CreateJourneyForBladeFunc,(function(t){return p.get("MsPortalImpl/UI/UI.CreateJourney","createJourney").then((function(i){return i(n,t,!1)}))}));gr(n,er.CreateJourneyForAssetFunc,(function(t){return p.get("MsPortalImpl/UI/UI.CreateJourney","createJourney").then((function(i){return i(n,t,!0)}))}));gr(n,er.ToggleCloudShell,(function(){return n.getAsync(p.get("MsPortalImpl/UI/UI.AzureConsole","AzureConsole")).then((function(n){n.toggle()}))}))}function pe(){return MsPortalFx.convertArrayToMap(["EntryPoint","SignInIndex"],(function(n){return"PageTelemetry_"+n}),(function(n,t,i){var r=MsPortalImpl.sessionStorage.getItem(i);if(r)return MsPortalImpl.sessionStorage.removeItem(i),JSON.parse(r)}))}function we(n){var f,e;if(n&&kr&&kr.getEntriesByType&&kr.timing){var u=pr(),i=function(n,t,i){af(n,{duration:t,endTime:Math.round(i+kr.timing.navigationStart)})},o=kr.getEntriesByType("resource").filter((function(n){var t=n.initiatorType;return t==="link"||t==="script"})),r=o.reduce((function(n,t){return Math.min(t.startTime,n)}),Infinity),t=o.reduce((function(n,t){return Math.max(t.responseEnd,n)}),0),s=t-r,h=t;return r=Math.max(r,n),t=Math.min(t,u),f=t-r,e=u-f-n,i("TotalTimeToSplashScreen",n,n),i("TotalStartupResourceDownload",s,h),i("StartupResourceDownload",f,t),i("StartupScriptExecution",e,u),e}}function af(n,t){t=t||{};var i=t.duration||pr(),r=t.data||{};return br.trace({timestamp:t.endTime,source:vr,action:n,actionModifier:br.ActionModifier.Complete,duration:i,data:r}),wr.markFromNavigation(n),i}function be(n,t){var i=n.getValue(tf,nf,cu);return t!==i&&n.setValue(tf,nf,t,cu),i}var ef,wr,vf;Object.defineProperty(t,"__esModule",{value:!0});t.DEV=t.Portal=t.registerAsyncHandlers=t.subscribeNotifications=t.routeIfHash=void 0;var tu=FxImpl,yf=tu.Extension,pf=tu.TriggerableLifetimeManager,ru=MsPortalFx.Base,wf=ru.Constants,bf=wf.Shell,yu=ru.Diagnostics,br=yu.Telemetry,kf=FxImpl.NetDiagnostics,df=ru.Resources,pu=FxImpl.Rpc,gf=MsPortalFx.Hubs.Notifications,wu=gf.NotificationStatus,ne=tu.Hubs.Notifications,bu=ru.Net2,nu=window,kr=nu.performance,ku=nu.fx,pr=ku.getTimestamp,ou=br.flush,te=pu.client,vr="Shell",uu=ku.environment,su=uu.links,dr="TopBar",yr=i.require,ie=MsPortalFx.ensureSuffix,hu=ie(df.getAppRelativeUri("/"),"/"),fu=nu.location,iu=r.createLog(n),du=hu+"SignOut",gu=hu+"signin/index",re=i.isDevelopmentMode,nf="loadedPageVersion",tf=ii.ComponentName.Telemetry,cu=0,eu="FirstVisitedTimestamp",ue="gallery_createLauncher_lastUsed_subscriptionId",fe=nu.portalAppApi||nu.nodeRequire,rf,lu,uf="",ee=function(){iu.warning.apply(iu,arguments)};bu.setAjaxLogFunc(ee);t.routeIfHash=ff;ef=oe;t.subscribeNotifications=hf;wr={initializeDirectoryPane:function(n,t,i){var r=this,u=MsPortalFx.memoizeQ((function(){return yr("MsPortalImpl/Widgets/Widgets.DirectoryPane")}));n.topBar.directoryButtonClick=function(){return __awaiter(r,void 0,void 0,(function(){var n,r;return __generator(this,(function(f){switch(f.label){case 0:return t.get(FxImpl.Features).isEnabled("settingsflyout")?(n=t.get(d.Router),lr(dr,"SettingsFlyoutOpen",{launchedBy:"DirectoryPaneTopbarButton"}),n.route("#settings/directory"),[3,3]):[3,1];case 1:return[4,u()];case 2:r=f.sent();r.toggleDirectoryContextPane(t,i);f.label=3;case 3:return[2]}}))}))}},initializeFeedbackPane:function(n,t){n.feedbackButtonClick=function(){t.getAsync(ci.FeedbackPaneInfo).then((function(n){var t=n.widget;lr(dr,"FeedbackSmileyClicked",{isPaneOpen:t.isVisible()});t.toggle()}))}},initializeNotificationsPane:function(n,t,i,r,u){var f=new wi.ViewModel(t),o=MsPortalFx.memoizeQ((function(){return yr("MsPortalImpl/Widgets/Widgets.NotificationsPane").then((function(n){return new n.Widget(u,f)}))})),e;hf(r,u,t,f,i);n.topBar.notificationButtonClick=function(){o().then((function(n){n.toggleNotificationsContextPane().then((function(n){n?(i.removeAllToasts(),vi.updateUnreadCountOnButton(0)):f.isPaneOpen(!1)}))}))};e={events:"fxtoastclick",handler:function(n,t){r.handleNotificationClick(t.data.value,!0)}};i.eventHandlers.push(e);fe&&(yr("MsPortalImpl/Electron/ContextMenu"),i.addOSToast=function(n){yr("MsPortalImpl/Electron/Notifications").then((function(t){t.OSToast(n,(function(){return r.handleNotificationClick(n.data,!0)}))}))})},initializeSearch:function(n,t,i){n.initOptions((function(){return yr("MsPortalImpl/Widgets/Widgets.SharedOptionsInit").then((function(r){r.initSearchWidgetOptions(i,n,t)}))}))},initializeSettingsPane:function(n,t,i,r,u){var o=this,e=n.topBar,s=MsPortalFx.memoizeQ((function(){return yr("MsPortalImpl/Widgets/Widgets.SettingsPane").then((function(n){var u=new n.Widget($(FxImpl.createElement("div")),new n.ViewModel,t,r);return i.registerForDispose(u),u}))})),f;u.isEnabled("settingsflyout")?(f=1,u.isEnabled("hidesettingsoverview")&&(f=u.isEnabled("hidedirectorypanebutton")?4:2),e.settingsButtonClick=function(){var i=n.settingsFlyoutState.value,r;lr(dr,i?"SettingsFlyoutClose":"SettingsFlyoutOpen");i===0&&t.get(gi.RightContextPane).close();r=i!==0?0:f;n.settingsFlyoutState(r)}):e.settingsButtonClick=function(){return __awaiter(o,void 0,void 0,(function(){var n;return __generator(this,(function(t){switch(t.label){case 0:return[4,s()];case 1:return n=t.sent(),lr(dr,"SettingsPaneOpen"),n.toggleSettingsContextPane(),[2]}}))}))}},initializeTopBar:function(n,t,i,r,u,f){var o=this,s=t.get(hi.ViewModel),e=n.topBar;this.initializeSettingsPane(n,t,i,u,f);this.initializeFeedbackPane(e,t);MsPortalFx.tryImmediateResolve(n.onWidgetCreate(),(function(){f.isEnabled("asyncSearch")||o.initializeSearch(e.searchViewModel,t,i)}));this.initializeNotificationsPane(n,t,s,r,i);this.initializeDirectoryPane(n,t,i)},markFromNavigation:function(n){kr.mark(n);try{kr.measure(n,"Navigation",n)}catch(i){var t=[i];try{t.push.apply(t,kr.getEntriesByName("Navigation")||[]);t.push.apply(t,kr.getEntriesByName(n)||[])}catch(r){t.push(r)}iu.error.apply(iu,__spreadArray(["Error calling Performance.measure",0],t))}}};t.registerAsyncHandlers=lf;vf=(function(){function t(n){this._diContainer=n;this._lifetime=new pf}return t.prototype.initialize=function(){return __awaiter(this,void 0,void 0,(function(){function cr(){var n,r;return __awaiter(this,void 0,void 0,(function(){var f,e,u;return __generator(this,(function(o){switch(o.label){case 0:return(f=i.isEnabled("experimentationshell"),!f)?[3,2]:[4,MsPortalEarly.preload];case 1:return u=(r=(n=o.sent())===null||n===void 0?void 0:n.variants)===null||r===void 0?void 0:r.hubsextension,[3,3];case 2:u=null;o.label=3;case 3:return e=u,t.get(c.ExperimentationManager).setExtensionFlights(e),[2]}}))}))}var r,t,wi,i,e,vi,gi,fr,di,u=this;return __generator(this,(function(c){switch(c.label){case 0:return r=this._lifetime,t=this._diContainer,wi=t.get(tr.RootElements),i=t.get(FxImpl.Features),e=t.get(ii.StorageService),vi=new o(fu.href),gi=pr(),wr.markFromNavigation("enterUIInitialize"),br.Internal.initialize({extensionName:vr,userQuery:MsPortalEarly.userQuery}),MsPortalEarly.initializedTelemetry(br.trace),ct.initialize(),fr=setInterval(ou,14e3),it.initialize(),lf(t),[4,cr()];case 1:return c.sent(),di=le(t),ae(t,di),[4,Q.spread([t.getAsync(a.AuthStateManager),t.getAsync(rt.ExtensionManager),t.getAsync(kt.SecurityTokensManager),t.getAsync(dt.SettingsManager),t.getAsync(gt.MruTokensSettingsManager),ce(t),],(function(c,a,it,ct){var vu=uu.pageVersion,ku=be(e,vu),kt=t.get(dt.PortalStartupMarkers),cr,gt,tr,ar;if(kt.defaultRoute=!1,kt.splashScreen=MsPortalEarly.splashScreenLoadTime,kt.initializeStart=pr(),kt.enterUIInitialize=gi,kt.loadedSameVersion=vu===ku,kt.previousVersion=ku||"",kt.performanceTelemetry=FxImpl.NetDiagnostics.getPerformanceTelemetry(),kt.requireConfigPerf=MsPortalImpl.requireConfigPerf,wr.markFromNavigation("initializeStart"),cr=c.bootstrapState,gt=c.getCurrentUser(),FxImpl.Base.Diagnostics.setObjectIdToScrub(gt.objectId),!cr){lr(vr,"SignInRedirect","AuthBootstrapState not found. Redirecting the user to sign-in.");b.redirectWithCdn(t,{uri:gu,parameters:null,hash:fu.hash});return}i.isEnabled("enableanimations",!0)||$.enableAnimations(!1);tr=t.get(wt.PortalIdleStateService);w.registerRpc(t);ar=new et.PortalReader(r,{idPrefix:"portal"});ar.read(l.Shell.Reader.portalLoading);var ru=t.get(ur.StatusHandler),nf=Q.spread([t.getAsync(pt.GeneralSettings),t.getAsync(sr.PortalNotifications),t.getAsync(lt.HatsSettings),t.getAsync(at.FavoritesSettings),t.getAsync(at.UserDirectorySettings),t.getAsync(tt.ThemeManager),t.getAsync(rt.ExtensionManagerOptions),],(function(o,w,rt,et,lt){function kf(n){var t=i.isEnabled("serveravatar")?ct.queryStore(0).then((function(n){return e.clearAllComponentItems(ii.ComponentName.Avatar,cu),(n||{})[ni.avatarKey]||gt.defaultAvatarUri})):g.getAvatarImage(gt.emailAddress,gt.avatarUri,gt.defaultAvatarUri,e,n);t.then((function(n){at.avatarImage(n)}))}var lf,rr,sr,vf,vt,cr,pf,ui,wt,ar,tu,wf,gi,bf,vu,dt,bu,ku,at,nf,sf,hf,df;kt.initializeGeneralSettings=pr();wr.markFromNavigation("initializeGeneralSettings");lf=it.getTokenFunc;rr=nt.initialize(r,t,i.shellFeatures.fromQuery.l,vi.query.getParameter("l")!==undefined);rr.requireRedirect&&u._redirect({uri:null,skipFlushBuffers:!0,reason:"Locale",logData:rr});MsPortalFx.isObject(uu)&&console.log("Version: "+uu.version+"\nSession: "+MsPortalFx.sessionId);sr=MsPortalImpl.sessionStorage.getItem("forceSignIn_previousSessionId");sr&&(lr(vr,"ReloadedFromFxForceSignIn",{previousSessionId:sr}),MsPortalImpl.sessionStorage.removeItem("forceSignIn_previousSessionId"));ut.initialize();r.registerForDispose((function(){ut.dispose()}));vf=t.get(ai.FavoritesManager);vf.initializeFavorites(et);vt=hr.getPortalViewModel(t);kt.portalWidgetStart=pr();t.get(si.Widget);kt.portalWidgetEnd=pr();ci.initialize(r,t,vt);kt.uiCompositionInitEnd=pr();y.initialize(t.get(st.AssetTypeService));cr=t.get(ri.SubscriptionsUserContext).getGlobalSelectedSubscriptions().then((function(n){return n()}));pf=cr.then((function(n){au(n);lr(vr,"getGlobalSelectedSubscriptions",{first100SubscriptionIds:n.slice(0,100).map((function(n){return n.subscriptionId})),globalSelectedSubscriptionCount:n.length})}));yr("MsPortalImpl/Services/Services.Recents").then((function(n){return n.loadRecentsFromLazyData(t)}));ui=t.get(yi.NotificationManager);t.get(pi.DataContext);a.lastExtensionError.subscribeAndRun(r,(function(n){n&&ui.addClientNotification({title:l.Shell.extensionError,description:l.Shell.loadingError.format(n.name),status:wu.Error,timestamp:new Date})}));yf.extensionStatusEndPoint.register(te,null,(function(n,t){n&&tf(n,t.srcWindowId)}));wt=vt.topBar;wt.exitDevMode=function(){wi.showSplash(!0);MsPortalImpl.Extension.unregisterAll().then((function(){u._redirect({uri:hu})}))};gr(t,er.DownloadDiagnosticsJson,(function(){return yr("../Base/Base.ClientRawFileDownload",n).then((function(n){n.downloadFile({provideText:function(){return wf().then((function(n){return JSON.stringify(n,null,2)}))}},"PortalDiagnostics.json","charset=utf-8;application/json")}))}));ar=MsPortalFx.memoizeQ((function(){return yr("../Base/Base.DebugInfo",n).then((function(n){return n.initialize(r,t)}))}));gr(t,er.ShowDebugTools,(function(){return ar().then((function(n){return n.toggleStickys(rf)}))}));t.get(ft.KeyboardShortcutHandler);gr(t,er.ShowWelcomeSequence,(function(){return p.get("MsPortalImpl/Widgets/Widgets.WelcomeSequence","Widget").then((function(n){var i=n.create(t,vt,ct);return r.registerForDispose(i),i}))}));tu=function(){return t.get(fi.TenantsService).getTenants()};wf=function(){return Q.all([yr("MsPortalImpl/Base/Base.DiagnosticsPopup"),pf,tu(),]).spread((function(n,i,r){return n.getDiagnosticsData(t,au,ko.observableArray(r.tenants),it)}))};wt.reportBug=function(){yr("./UI.Portal.Actions",n).then((function(n){n.reportBug(t,vi)}))};MsPortalFx.isFeatureEnabled("subscreditcheck")&&MsPortalFx.isFeatureEnabled("upgradefromtrialbutton")&&yr("MsPortalImpl/Services/SubsCreditCheck").then((function(n){n.subscriptionsRequiringUpgrade.subscribeAndRun(r,(function(n){n.length===1?(br.trace({action:"FreeTrialUpgradeShown",source:"TopBar",data:{subscriptionId:n[0].subscriptionId,creditsRemaining:n[0].remaining}}),wt.canUpgradeSubscription(!0),wt.upgradeableSubscription({subscriptionId:n[0].subscriptionId,remaining:n[0].remaining})):wt.canUpgradeSubscription(!1)}))}));gi=t.get(d.Router);bf=MsPortalFx.getIdGenerator("SideBarOpeningBlade");vt.sideBar.launchBlade=function(n,t){var f=gi.route(n,t),u=vt.panorama,i=u&&u.getJourneyWidget(),r;i&&(r=bf(),i.loadingHint(r,!0),f.finally((function(){i.loadingHint(r,!1);i.trigger("fxbladerepos",{noScroll:!0})})))};ht.initializeRpc();ei.registerEndpoints(pu.client,t);wr.markFromNavigation("beforeInitDesktopMgr");kt.beforeInitDesktopMgr=pr();vu=t.get(nr.DesktopManagerImpl).initialize().then((function(){return vt.onWidgetCreate()})).then((function(){return __awaiter(u,void 0,void 0,(function(){var t,i,r,n,f,u;return __generator(this,(function(e){switch(e.label){case 0:return wr.markFromNavigation("desktopMgrInitialized"),kt.desktopMgrInitialized=pr(),t=Date.now(),[4,Promise.all([ct.querySetting(12,eu),ct.querySetting(6,ue),])];case 1:return i=e.sent(),r=i[0],n=r===void 0?t:r,f=i[1],n===t&&ct.setSetting(12,eu,n),lr(vr,"FirstVisited",(u={},u[eu]=n,u)),lr(vr,"LastUsedSubscriptions",f),[2,di]}}))}))})).then((function(n){kt.defaultLandingView=n?"Dashboard":"Home";kt.defaultSideBarLayout=pt.isSideBarDocked(t)?"Docked":"Flyout";kt.desktopAndExtensionManagerInitialize=pr();wr.markFromNavigation("desktopAndExtensionManagerInitialize");var r=i.isEnabled("nodirectory");return gi.initialRoute((function(){return kt.defaultRoute=!0,gi.goToLandingPage({interactionSource:"UIInitialize",replaceHistory:!0,skipFocus:r,invokedByInitRoute:!0})}),{skipFocus:r})})).then((function(){var n,t,u,f,i,r;wr.markFromNavigation("setupInitialRoute");kt.setupInitialRoute=pr();wt.getWidget().initReactiveLayout();wi.showSplash(!1);kt.locationHash=vi.fragment.split("?")[0];kt.hiddenTime=MsPortalEarly.stopPageLoadTimeout();kt.earlyLoad=MsPortalEarly.earlyLoadPerfData;kt.windowSize=window.innerWidth;n=kr.timing;n&&(t=n.navigationStart,kt.fetchStart=n.fetchStart-t,kt.requestStart=n.requestStart-t,kt.responseStart=n.responseStart-t,kt.responseEnd=n.responseEnd-t,kt.domComplete=n.domComplete-t);u={data:$.extend(kt,pe())};clearInterval(fr);rf=af("TotalTimeToPortalReady",u);ou();f=tr.addCallbacks({onIdle:function(n){var t=nu.navigator;t&&t.onLine!==!1&&n%15==0&&kf(!0);tr.removeCallbacks(f)}});i=Number(MsPortalFx.getFeatureValue("reloadafterdays"));i>0&&(r=i*1440,tr.addCallbacks({onIdle:function(n){r<n&&(br.trace({source:vr,action:"ForceRefresh",actionModifier:"Idle",data:{idleTimeInMins:n,reloadAfterMinutes:r}}),ou().then((function(){fu.reload(!0)})))}}));lt.addRecentDirectory(gt.tenantId)})).catch((function(n){lu=lu||"/LoadFailed?stack="+encodeURIComponent(n&&n.stack).substr(0,1e3);u._redirect({uri:ur.errorUri+lu})}));t.get(li.SaveDirectorySettingsHandler).saveDirectorySettings();vu.then((function(){var n,r,u;ui.listenForClientNotifications();ct.querySettings({store:7,keys:["WelcomeSequence"]}).then((function(n){if(he(t,{deeplinkLoadedPortal:!kt.defaultRoute&&uf,welcomeSequenceCallback:function(){return Q(t.get(er.ShowWelcomeSequence).invoke())},showWelcomeSequence:i.isEnabled("guidedtour")&&(!n||!n.WelcomeSequence)&&!i.isEnabled("ci"),portalNotifications:w,generalSettings:o,toastVM:bu,userSettingsManager:ct,hatsSettings:rt,userInfo:gt}),i.isEnabled("nodirectory")){wt.directoryButtonClick();return}}));yt.init(ct);n=l.Portal;!i.isEnabled("internalonly")||i.isEnabled("canmodifyextensions")||c.isMicrosoftOrAmeTenant||(r=FxImpl.trustedParentOrigin,u=r.replace(/^([^\/]+\/\/).+\.([^\.]+\.[^\.]+\.[^\.]+)$/,"$1$2"),r!==u&&ui.addClientNotification({status:wu.Information,title:n.preview,description:n.unsupportedEnvironment.format(r),uri:u,timestamp:new Date,uriAction:ne.ClientNotificationUriAction.OpenInCurrentTab}));s.isSafari&&s.webKitVersion<602&&t.getAsync(v.DialogManager).then((function(t){return t.showModalDialog({title:n.unsupportedBrowser,description:n.unsupportedBrowserDesc.format(su.unsupportedBrowser),buttons:1,showErrorIcon:!0})}))}));st.setupAssetTypeServiceRpc(t);ti.create(t);i.isEnabled("portalpolling")&&t.get(bt.PollingManager).startPolling();dt=null;yu.ErrorReporter.initialize((function(){dt=dt||t.get(nr.DesktopManagerImpl);iu.debug(dt.getDiagnosticsData())}),!1,(function(){return dt=dt||t.get(nr.DesktopManagerImpl),dt.getCurrentBladeInfo()}));k.initialize(t);bu=t.get(hi.ViewModel);wr.initializeTopBar(vt,t,r,ui,lf,i);ku=t.get(FxImpl.Rpc.Client);f.Internal.showNpsEndpoint.register(ku,null,(function(n,t){ir.showNps(o,ct,bu,n.productDisplayName,(t.srcWindowId||"")+"_"+n.productId)}));f.Internal.canShowNpsEndpoint.register(ku,null,(function(){return!ir.npsShownInSession}));at=wt.avatarMenuVM;at.userIdentity(gt);at.hideTenant(i.isEnabled("hideavatartenant"));nf=i.isEnabled("tenants2020");c.getUserInfo().then((function(n){at.userInfo(n);nf&&(at.tenantDisplayName(n.uniqueDirectoryName),at.listOfTenants.setAll([{id:n.directoryId,domainName:n.domainName,displayName:n.directoryName,tenantCategory:""}]));var r;if(i.isEnabled("saveDeploymentNotification")){try{r=JSON.parse(MsPortalImpl.sessionStorage.getItem("_msPortalFx-Session-Deployments-{0}".format((n.objectId||n.email)+n.directoryId)))||{}}catch(u){return}Object.keys(r).length&&yr("MsPortalImpl/Services/Services.DeploymentSession").then((function(n){t.get(n.DeploymentSession).restoreDeployments(t)}))}}));nf||tu().then((function(n){var t=n.tenants;ef(t);at.listOfTenants.setAll(t)}));at.showDiagnostics=function(){return t.get(er.DownloadDiagnosticsJson).invoke()};at.showDebugTools=function(){return t.get(er.ShowDebugTools).invoke()};at.signedOut=function(){br.trace({source:dr,action:"AvatarMenuSignOut"});u._redirect({uri:du,redirectAction:15})};at.openAccountPortal=function(){var n=su.accountPortal;lr(dr,"AvatarMenuOpenBilling");ff(gi,n.startsWith("#")?n:n+"subscriptions")};at.switchDirectory=i.isEnabled("settingsflyout")?function(){var n=t.get(d.Router);lr(dr,"SettingsFlyoutOpen",{launchedBy:"AvatarMenu"});n.route("#settings/directory")}:wt.directoryButtonClick;kf();at.submitAnIdea=function(){lr(dr,"AvatarMenuOpenFeedback");nu.open(su.submitAnIdea,"_blank")};at.showMyAccessBlade=function(){lr(dr,"AvatarMenuOpenAccessDetails");t.get(er.CreateJourneyForBladeFunc).invoke({extension:"HubsExtension",detailBlade:"MyAccess.ReactView",detailBladeInputs:{resourceId:""},defaultMenuItemId:undefined})};cr.then((function(n){var t=(cf.selectedFormatCulture||"").toLowerCase().split("-").slice(-1)[0];at.contactInfoEnabled(n.length&&i.isEnabled("contactinfo")&&!["at","ru","de","gr"].includes(t)||i.isEnabled("testcontactinfo"))}));at.showContactInfoBlade=function(){lr(dr,"AvatarMenuOpenContactInfo");MsPortalFx.isFeatureEnabled("settingsflyout")?vt.settingsFlyoutState(6):t.get(er.CreateJourneyForBladeFunc).invoke({extension:"HubsExtension",detailBlade:"ContactInfoBlade",detailBladeInputs:{resourceId:""},openInContextPane:!0,defaultMenuItemId:undefined})};at.switchAccount=function(n){b.redirectWithCdn(t,{uri:gu,parameters:n?{loginHint:n}:{selectAccount:"true"},hash:b.getHashQueryStringSegment(fu.href),redirectAction:2})};!i.isEnabled("ci")&&(re||MsPortalEarly.query.clientoptimizations&&MsPortalEarly.query.clientoptimizations!=="true"||i.isEnabled("canmodifyextensions"))&&ar().then((function(n){return n.startErrorDetection(r)}));sf="data-click-telemetry";vt.customEvents.addHandler(r,"mousedown",(function(n){hf=n.target}));vt.customEvents.addHandler(r,"mouseup",(function(n){var i=hf;if(hf=null,n.target===i){var r=vt.getRootElement()[0],e=$(i),t=e.closest("["+sf+"]",r);if(t.length){var o=t.attr(sf)+"",u=t.closest(".fxs-tile",r).data(oi.CompositionInstanceDataName),f=u&&u.locator,s=f&&f.toFriendlyString()||vr;br.trace({source:s,action:"CustomClick",name:o})}}}));bi.registerViewModels(t);ki.registerViewModels({diContainer:t,securityTokensManager:it,subscriptions:au,tenants:ef});ru.isShellInitialized.resolve();df=t.get(ot.PrintHandler);df.init(u._lifetime);var gf=t.get(tt.ThemeManager),fe=gf.currentTheme().name,ee=gf.highContrastMode(),cf=nt.currentLocaleContext,ie=cf.selectedDisplayLanguage,oe=cf.selectedFormatCulture||ie,se=h.getBrowserInfo(),ce=vt.sideBar.isCollapsed.value?"collapsed":"expanded",le=e.clearValue(ii.ComponentName.Redirect,"Referrers",1),ae=pt.isFocusNavigationEnabled(t)?"enabled":"disabled";return Q.spread([t.get(fi.TenantsService).getHomeTenantsCount(),t.get(ri.SubscriptionsUserContext).getAllSubscriptionsCount(),t.get(ri.SubscriptionsUserContext).getGlobalDisplayedSubscriptions(),],(function(n,t){br.trace({source:"UIInitialize",action:"PortalInitialized",data:{selectedDisplayLanguage:ie,formatCulture:oe,sidebarState:ce,focusNavigationState:ae,defaultLandingView:kt.defaultLandingView,defaultSideBarLayout:kt.defaultSideBarLayout,currentTheme:fe,highContrastMode:ee,tenantsCount:n,subscriptionsCount:t.value,freeTrial:wt.canUpgradeSubscription.value,deepLinkType:or.getDashboardTypeFromUri(),referrers:le,browserInfo:se}})})),vu})),tf=function(n,t){ru.onStatus(n,t)},au=ko.observable(),ef=ko.observableArray();return kf.registerTelemetrySubmissionHandler(),tu.ProvisioningTelemetry.registerTelemetrySubmissionHandler(),bu.status.subscribe(r,(function(n){tf(n,bf)})),t.getAsync(ui.SharingTelemetryProcessor).then(br.addProcessor),we(MsPortalEarly.splashScreenLoadTime),nf.then((function(){ar.read(l.Shell.Reader.portalReady);var n=new o(du);n.query.setParameters({sid:cr.aadSessionId,tid:gt.tenantId});rr.initialize(t,u._lifetime,c,t.get(pt.GeneralSettings).idleTimeoutMins,tr,(function(){return u._redirect({uri:n.toString()})}),gt.tenantDomain,ru)})),vt.registerFileUploadEndpoints(),yt.uploadSettingsManager=ct,nf}))];case 2:return c.sent(),[2]}}))}))},t.prototype.dispose=function(){MsPortalFx.isFeatureEnabled("showhatsmodal")&&(cr.temporaryExtensionCount.flushIntervalIds(),this._diContainer.isDisposed||sf(this._diContainer.get(lt.HatsSettings)));this._lifetime.dispose();tu.resetGlobalState()},t.prototype._redirect=function(n){this._diContainer.get(tr.WindowManager).redirect(n)},__decorate([__metadata("fx:diagnostics",[n,"Portal"]),u.Class(),__metadata("design:paramtypes",[u.Container])],t)})();t.Portal=vf}));
define("_generated/Less/MsPortalImpl/Base/Base.Images.css",["module"],(function(n){"use strict";return{css:".msportalfx-svg-c01{fill:#fff}.msportalfx-svg-c02{fill:#e5e5e5}.msportalfx-svg-c03{fill:#a0a1a2}.msportalfx-svg-c04{fill:#7a7a7a}.msportalfx-svg-c05{fill:#3e3e3e}.msportalfx-svg-c06{fill:#1e1e1e}.msportalfx-svg-c07{fill:#0f0f0f}.msportalfx-svg-c08{fill:#ba141a}.msportalfx-svg-c09{fill:#dd5900}.msportalfx-svg-c10{fill:#ff8c00}.msportalfx-svg-c11{fill:#fcd116}.msportalfx-svg-c12{fill:#fee087}.msportalfx-svg-c13{fill:#b8d432}.msportalfx-svg-c14,.msportalfx-svg-c32{fill:#57a300}.msportalfx-svg-c15{fill:#59b4d9}.msportalfx-svg-c16{fill:#3999c6}.msportalfx-svg-c17{fill:#804998}.msportalfx-svg-c18{fill:#ec008c}.msportalfx-svg-c19{fill:#0072c6}.msportalfx-svg-c20{fill:#68217a}.msportalfx-svg-c21{fill:#00188f}.msportalfx-svg-c22{fill:#e81123}.fxs-mode-light .msportalfx-svg-c22{fill:#a4262c}.msportalfx-svg-c23{fill:#cae3f3}.msportalfx-svg-c24{fill:#59aed3}.msportalfx-svg-c25{fill:#4c3b12}.msportalfx-svg-c26{fill:#be9555}.msportalfx-svg-c27{fill:#4f4d52}.msportalfx-svg-c28{fill:#ef6f59}.msportalfx-svg-c29{fill:#f7cb64}.msportalfx-svg-c30{fill:#fdd8db}.msportalfx-svg-c31{fill:#f6ffec}.msportalfx-svg-c33{fill:#8a2da5}.msportalfx-svg-c34{fill:#e00b1c}.msportalfx-svg-c35{fill:#015cda}.msportalfx-svg-c36{fill:#5db300}.msportalfx-svg-c97{fill:#ffb900}.msportalfx-svg-c98{fill:#00a4ef}.msportalfx-svg-c99{fill:#f25022}.msportalfx-inverted-theme .msportalfx-svg-c05,.fxs-theme-dark .msportalfx-svg-c05{fill:#777}.msportalfx-inverted-theme .msportalfx-svg-c07,.fxs-theme-dark .msportalfx-svg-c07{fill:#f2f2f2}.msportalfx-svg-palette-white{fill:#fff}.msportalfx-svg-palette-blue{fill:#015cda}.msportalfx-svg-palette-black{fill:#1e1e1e}.msportalfx-svg-palette-green{fill:#57a300}.msportalfx-svg-palette-gray{fill:#a0a1a2}.msportalfx-svg-palette-inherit{fill:inherit}.msportalfx-svg-badge{position:absolute;left:0;bottom:0;min-height:10px;min-width:10px}.ext-fxc-menu-icon>.msportalfx-svg-badge{left:-2px;bottom:-2px;min-height:8px;min-width:8px}.msportalfx-svg-disabled{filter:grayscale(100%)}@-moz-document url-prefix(){.msportalfx-svg-disabled{filter:none;}}.msportalfx-svg-disabled .msportalfx-svg-c01{fill:#fff}.msportalfx-svg-disabled .msportalfx-svg-c02{fill:#e5e5e5}.msportalfx-svg-disabled .msportalfx-svg-c03{fill:#a1a1a1}.msportalfx-svg-disabled .msportalfx-svg-c04{fill:#7a7a7a}.msportalfx-svg-disabled .msportalfx-svg-c05{fill:#3e3e3e}.msportalfx-svg-disabled .msportalfx-svg-c06{fill:#1e1e1e}.msportalfx-svg-disabled .msportalfx-svg-c07{fill:#0f0f0f}.msportalfx-svg-disabled .msportalfx-svg-c08{fill:#676767}.msportalfx-svg-disabled .msportalfx-svg-c09{fill:#6f6f6f}.msportalfx-svg-disabled .msportalfx-svg-c10{fill:#808080}.msportalfx-svg-disabled .msportalfx-svg-c11{fill:#898989}.msportalfx-svg-disabled .msportalfx-svg-c12{fill:#c3c3c3}.msportalfx-svg-disabled .msportalfx-svg-c13{fill:#838383}.msportalfx-svg-disabled .msportalfx-svg-c14{fill:#5d5d5d}.msportalfx-svg-disabled .msportalfx-svg-c15{fill:#999}.msportalfx-svg-disabled .msportalfx-svg-c16{fill:#808080}.msportalfx-svg-disabled .msportalfx-svg-c17{fill:#717171}.msportalfx-svg-disabled .msportalfx-svg-c18{fill:#767676}.msportalfx-svg-disabled .msportalfx-svg-c19{fill:#636363}.msportalfx-svg-disabled .msportalfx-svg-c20{fill:#4e4e4e}.msportalfx-svg-disabled .msportalfx-svg-c21{fill:#484848}.msportalfx-svg-disabled .msportalfx-svg-c22{fill:#7d7d7d}.msportalfx-svg-disabled .msportalfx-svg-c23{fill:#dfdfdf}.msportalfx-svg-disabled .msportalfx-svg-c24{fill:#969696}.msportalfx-svg-disabled .msportalfx-svg-c25{fill:#2f2f2f}.msportalfx-svg-disabled .msportalfx-svg-c26{fill:#8a8a8a}.msportalfx-svg-disabled .msportalfx-svg-c27{fill:#505050}.msportalfx-svg-disabled .msportalfx-svg-c28{fill:#a4a4a4}.msportalfx-svg-disabled .msportalfx-svg-c29{fill:#aeaeae}.msportalfx-svg-disabled .msportalfx-svg-c30{fill:#ebebeb}.msportalfx-svg-disabled .msportalfx-svg-c31{fill:#f6f6f6}.msportalfx-svg-disabled .msportalfx-svg-c97{fill:#808080}.msportalfx-svg-disabled .msportalfx-svg-c98{fill:#787878}.msportalfx-svg-disabled .msportalfx-svg-c99{fill:#8a8a8a}.msportalfx-svg-loading-square{animation:ProgressFlagAnimation 1.45s infinite ease-in-out;transform-origin:50%}.msportalfx-svg-loading-square:nth-child(1){animation-delay:0s}.msportalfx-svg-loading-square:nth-child(2){animation-delay:.2s}.msportalfx-svg-loading-square:nth-child(3){animation-delay:.4s}@keyframes ProgressFlagAnimation{0%{transform:scale(1);opacity:.3}36.1%{transform:scale(1.06);opacity:1}50%{transform:scale(1.06);opacity:1}86.1%{transform:scale(1);opacity:.3}}.msportalfx-svg-flip-horizontal>svg,svg.msportalfx-svg-flip-horizontal{transform:scaleX(-1)}.msportalfx-svg-fabric-rotate360{animation:ImageRotation 1.3s cubic-bezier(.53,.21,.29,.67) infinite}@keyframes ImageRotation{0%{transform:rotate(-45deg)}100%{transform:rotate(315deg)}}.fxs-svg-number .msportalfx-font-bold{font-size:10px;fill:#0065ad}.fxs-svg-number .fxs-svg-circle{stroke-width:0%;fill:#0078d4}.fxs-svg-number .fxs-svg-text{fill:#fff;font-size:10px}.fxs-svg-number.msportalfx-svg-disabled{filter:grayscale(0%)}.fxs-svg-number.msportalfx-svg-disabled .fxs-svg-circle{fill:#fff;stroke-width:1px;stroke:#949494}.fxs-svg-number.msportalfx-svg-disabled .fxs-svg-text{fill:#949494}.fxs-theme-dark .fxs-svg-number .fxs-svg-text{fill:#0f0f0f}.fxs-theme-dark .fxs-svg-number .fxs-svg-circle{stroke-width:0%;fill:#0078d4}.fxs-theme-dark .fxs-svg-number.msportalfx-svg-disabled .fxs-svg-circle{fill:#0f0f0f;stroke-width:1px;stroke:#949494}.fxs-theme-dark .fxs-svg-number.msportalfx-svg-disabled .fxs-svg-text{fill:#949494}",moduleId:n.id}}));
define("_generated/Less/MsPortalImpl/Themes/Themes.Universal.css",["module"],(function(n){"use strict";return{css:'a{color:#0078d4}a:hover,a:active{color:#004578}a[aria-disabled="true"]{pointer-events:none}.fxs-topbar{background-color:#1c1c1c;color:#fff}.fxs-topbar-button,.fxs-topbar-avatarmenu .fxs-dropmenu-button{fill:#fff}.fxs-topbar-button:hover,.fxs-topbar-avatarmenu .fxs-dropmenu-button:hover{background-color:#605e5c}.fxs-topbar-button:active,.fxs-topbar-avatarmenu .fxs-dropmenu-button:active{background-color:#605e5c}.fxs-topbar-home{color:#fff}.fxs-topbar-home:hover{color:#fff;background-color:#605e5c}.fxs-notificationspane-button-unreadcount{color:#1c1c1c;background-color:#fff}.fxs-topbar-active .fxs-topbar-button,.fxs-topbar-active.fxs-topbar-button{background-color:#fff;fill:#1c1c1c}.fxs-topbar-active .fxs-notificationspane-button-unreadcount{color:#fff;background-color:#1c1c1c}.fxs-topbar-debug-button{color:#1c1c1c !important;background-color:#db7500 !important}.fxs-topbar-debug-button:hover{background-color:#fff0d1 !important}.fxs-topbar-upgradebutton{color:#1c1c1c !important;background-color:#bdf6e2 !important}.fxs-topbar-upgradebutton:hover{background-color:#f3fdfa !important}.fxs-search-wrapper{background-color:#e1dfdd}.fxs-search-icon-mini{fill:#3b3a39}.fxs-search-box .azc-input{color:#3b3a39}.fxs-search-box .azc-input:-ms-input-placeholder{color:#3b3a39}.fxs-search-box .azc-input::placeholder{color:#3b3a39}.fxs-search-box .azc-input:-ms-input-placeholder{color:#3b3a39}.fxs-search-box .azc-input::placeholder{color:#3b3a39}.fxs-topbar-devmode{background-color:#db7500}.fxs-topbar-devmode .fxs-topbar-avatarmenu .fxs-dropmenu-button{color:#1c1c1c}.fxs-topbar-devmode .fxs-topbar-button,.fxs-topbar-devmode .fxs-topbar-avatarmenu .fxs-dropmenu-button{fill:#1c1c1c}.fxs-topbar-devmode .fxs-topbar-button:hover,.fxs-topbar-devmode .fxs-topbar-avatarmenu .fxs-dropmenu-button:hover{background-color:#fff0d1}.fxs-search-showmenu .fxs-search-wrapper{background-color:#fff}.fxs-search-showmenu .fxs-search-box .azc-input{color:#252423}.fxs-search-showmenu .fxs-search-box .azc-input:-ms-input-placeholder{color:#252423}.fxs-search-showmenu .fxs-search-box .azc-input::placeholder{color:#252423}.fxs-search-showmenu .fxs-search-box .azc-input:-ms-input-placeholder{color:#252423}.fxs-search-showmenu .fxs-search-box .azc-input::placeholder{color:#252423}.fxs-search-showmenu .fxs-search-icon-mini{fill:#135995}.fxs-topbar-exit-customize,.fxs-topbar-dashboard{background-color:#8a2da5}.fxs-sidebar-menu-container .fxc-menu-search{margin:12px 15px 12px 15px}.fxs-sidebar-menu-container .fxc-menu-grid .ext-fxc-menu-item{color:#fff;padding:0 15px}.fxs-sidebar-menu-container .fxc-menu-grid .ext-fxc-menu-icon{width:18px;height:18px;padding-right:6px;padding-top:7px}.fxs-sidebar-menu-container .fxc-menu-grid .azc-listView-groupheader{margin:0 15px}.fxs-sidebar-menu-container .fxs-portal-activated,.fxs-sidebar-menu-container .fxs-portal-activated.fxs-portal-hover:hover{background-color:rgba(128,128,128,.25)}.fxs-sidebar-menu-container .fxs-portal-hover:hover{background-color:rgba(128,128,128,.15)}.fxs-sidebar-item-link:hover,.fxs-sidebar-collapse-button:hover{background-color:rgba(128,128,128,.15)}.fxs-sidebar .fxs-sidebar-icon.fxs-sidebar-menu-icon,.fxs-sidebar .fxs-sidebar-hamburger .fxs-sidebar-icon{fill:#0078d4}.fxs-sidebar-bar{background-color:#323130;color:#fff}.fxs-sidebar-divider,.fxs-sidebar-divider2{border-bottom-color:#3b3a39}.fxs-sidebar-hamburger-button,.fxs-sidebar-collapse-button{fill:#fff}.fxs-sidebar-shadow{width:6px;background:linear-gradient(270deg,rgba(0,0,0,.24) 0%,rgba(0,0,0,0) 100%)}.fxs-sidebar .fxs-sidebar-icon{fill:#fff}.fxs-sidebar .fxs-sidebar-icon .msportalfx-svg-c05{fill:#fff}.fxs-sidebar .fxs-sidebar-icon .msportalfx-svg-c07{fill:#fff}.fxs-sidebar-star.fxs-is-favorite svg{fill:#ffb900;stroke:#000;stroke-width:1px}.fxs-bg-white{background-color:#fff}.fxs-overlay{background:rgba(0,0,0,.7)}.fxs-highlight{color:#000;background-color:#fff100}.fxs-tile-actionbar-action:hover,.fxs-tile-actionbar-action.fxs-tile-actionbar-action-pressed{background:rgba(125,125,125,.2)}.fxs-tile-actionbar-action.fxs-tile-actionbar-command-unpinfromstartboard:hover{background:#ba141a;fill:white}.fxs-text-white{color:#fff}.fxs-fill-white{fill:#fff}.fxs-br-primary{border-color:#00bcf2}.fxs-tile-selected .fxs-tile-overlay{background-color:transparent}.fxs-bg-overlay-dark{background:rgba(0,0,0,.7)}.fxs-bg-primary-10{background-color:rgba(0,188,242,.1)}.azc-disabled:hover,.azc-row-disabled:hover{background-color:inherit}input.azc-disabled,.azc-disabled,.azc-disabled:hover,.azc-disabled:focus{cursor:default;outline:none}.azc-dockedballoon-balloon a{color:#4894fe}.fxs-portal .fxs-text-info,.fxs-portal .msportalfx-text-info{color:#0058ad}.fxs-portal .fxs-text-success,.fxs-portal .msportalfx-text-success{color:#7fba00}.fxs-portal .fxs-text-dirty,.fxs-portal .msportalfx-text-dirty{color:#8a2da5}.fxs-portal .fxs-text-warning,.fxs-portal .msportalfx-text-warning{color:#ffba01}.fxs-fill-info,.msportalfx-fill-info{fill:#015cda !important}.fxs-fill-complete,.fxs-fill-success,.msportalfx-fill-success{fill:#57a300 !important}.fxs-fill-upsell,.fxs-fill-dirty,.msportalfx-fill-dirty{fill:#8a2da5 !important}.fxs-fill-warning,.msportalfx-fill-warning{fill:#db7500 !important}.fxs-fill-error,.msportalfx-fill-error{fill:#a4262c !important}.fxs-br-info,.msportalfx-br-info{border-color:#015cda !important}.fxs-br-success,.msportalfx-br-success{border-color:#57a300 !important}.fxs-br-dirty,.msportalfx-br-dirty{border-color:#8a2da5 !important}.fxs-br-warning,.msportalfx-br-warning{border-color:#db7500 !important}.fxs-br-error,.msportalfx-br-error{border-color:#a4262c !important}.fxs-bg-info,.msportalfx-bg-info{background-color:#015cda !important}.fxs-bg-success,.msportalfx-bg-success{background-color:#57a300 !important}.fxs-bg-upsell,.fxs-bg-dirty,.msportalfx-bg-dirty{background-color:#8a2da5 !important}.fxs-bg-warning,.msportalfx-bg-warning{background-color:#db7500 !important}.fxs-bg-error,.msportalfx-bg-error{background-color:#a4262c !important}@keyframes loading-opacity{0%{opacity:0}10%{opacity:0}50%{opacity:1}100%{opacity:1}}@keyframes loading{0%{transform:translateX(-500px)}10%{transform:translateX(-500px)}90%{transform:translateX(500px)}100%{transform:translateX(500px)}}.fxs-loading5dots-container{width:100%;display:flex;align-items:center;justify-content:center}.fxs-loading5dots-container>div{flex:0 0 auto;position:relative;animation:loading 3s cubic-bezier(0,.95,1,.05) infinite,loading-opacity 1.5s ease-in-out infinite alternate;animation-fill-mode:both}.fxs-loading5dots-container>div:nth-child(1){animation-delay:.2s}.fxs-loading5dots-container>div:nth-child(2){animation-delay:.1s}.fxs-loading5dots-container>div:nth-child(4){animation-delay:-.1s}.fxs-loading5dots-container>div:nth-child(5){animation-delay:-.2s}.fxs-loading5dots-container>div::after{content:"";display:block;border-radius:50%}',moduleId:n.id}}));
define("MsPortalImpl/Init",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/UI/UI.Initialize","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Base/Base.DeepLink","FxInternal/Environment","FxInternal/Css","_generated/Less/MsPortalImpl/Base/Base.Images.css","_generated/Less/MsPortalImpl/Themes/Themes.Universal.css","MsPortalImpl/InitShellWorker","FxInternal/Experimentation","Fx/Telemetry"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){"use strict";function ft(n){var t={fx:b.version};(n?Q():Q.spread([i.container.getAsync(r.ExtensionManager),i.container.getAsync(u.ManifestCache),],(function(n,i){n.initializedExtensions.forEach((function(n){t[n.name]=i.getVersion(n.name)}))}))).then((function(){ut.custom("Session",1,++g,nt,t)}))}var g,nt;Object.defineProperty(t,"__esModule",{value:!0});h.injectCss(c,l);var p=MsPortalFx.Base,tt=p.Diagnostics,it=p.UriBuilder,w=e.ComponentName,rt=window,b=fx.environment,ut=tt.createLog(n),k=i.container.get(e.StorageService),d=new it(o.originalHref);d.query=new p.QueryStringBuilder(MsPortalEarly.userQuery);o.history_replaceState(null,rt.document.title,d.toString());k.clearValue(w.Redirect,"IdpRedirectCount",1);g=0;nt=k.getValue(w.Redirect,"Referrers",1)||"";setInterval(ft,36e5);i.container.set(s.Environment,{extensionName:b.extensionName,sdkEnv:{},shellTrustedLinkedDomains:FxImpl.internalEnv.shellTrustedLinkedDomains,trustedLinkedDomains:undefined,linkedDomainMap:FxImpl.internalEnv.linkedDomainMap}).set(v.ExperimentationManager,new v.ExperimentationManager(FxImpl.features,y.trace)).get(f.Portal).initialize();a.init(i.container)}))