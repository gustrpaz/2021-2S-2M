define("FxInternal/NetDiagnostics",["require","exports","Fx/ResourceManagement","Fx/Ajax"],(function(n,t,i,r){"use strict";function b(n,t){s=s||new f.UriBuilder(FxImpl.trustedParentOrigin).getAuthority();h=h||new f.UriBuilder(FxImpl.origin).getAuthority();c=c||new f.UriBuilder(FxImpl.origin).getScheme();var r=new f.UriBuilder(n.uri),b=r.toString(),k=b.toLowerCase(),d=r.getAuthority()||h,tt=n.headers||{},g=tt["x-ms-command-name"],y=n.stack,w=function(t,i,r){return __assign({commandName:v(t,g,n.uri,y,r&&i)},i&&{uri:i})},i,l;if(d===s)i=t?null:w("PORTAL",""+e("PORTAL")+r.getRelativePath(),!0);else if(MsPortalFx.startsWith(k,p)){i=w("ARMBATCH",e("ARMBATCH"),!1);var it=(function(){var t;try{t=JSON.parse(n.data)}catch(i){t={}}return t})(),rt=it.requests,nt=n.stacks;l=rt.map((function(n,t){var r,u,f=nt?nt[t]:y,i=(r=n===null||n===void 0?void 0:n.url)===null||r===void 0?void 0:r.toLowerCase();return i=(i===null||i===void 0?void 0:i.startsWith("/"))?i:(i===null||i===void 0?void 0:i.startsWith(o))?i.slice(o.length-1):undefined,a(i,(u=n===null||n===void 0?void 0:n.requestHeaderDetails)===null||u===void 0?void 0:u.commandName,f)}));t&&l.every((function(n){return n.commandName.includes("Notifications.load")}))&&(i=null)}else i=MsPortalFx.startsWith(k,o)?a(b.slice(o.length-1),g,y):w("UNRECOGNIZED",""+(r.getScheme()||c)+d+"/"+u,!1);return i&&__assign(__assign({},i),l&&{batchRequests:l})}function a(n,t,r){var y=new f.UriBuilder(n),c,l,o,p,w,a,s,h;return y.query.clear(),c=y.toString(),l="ARM",MsPortalFx.last(c.split("/"))==="resources"?(o=i.ArmId.parse(c.slice(0,c.lastIndexOf("/"))),o.kind!==0&&(l="ARG",w=!0)):(o=i.ArmId.parse(c),o.kind!==0?a=!0:(o=i.ArmId.parse(c+"/"+u),o.kind!==0&&(p=!0,a=!0))),o.kind!==0?(h=__assign({},o),h.subscription=u,h.resourceName=u,h.resourceGroup=u,h.resourceIds=o.resourceIds.map((function(){return u})),h.tagName=u,h.tagValue=u,s=""+e("ARM")+i.ArmId.sanitizeId(h),p?s=s.slice(0,s.lastIndexOf("/")):w&&(s=s+"/resources")):s=e("ARM")+"/"+u,{commandName:v(l,t,n,r,a&&s),uri:s}}function v(n,t,i,r,u){var s=t&&t!==w,f,o;return s?t:u?u:(MsPortalFx.isFeatureEnabled("fixajaxname")&&(f=t?"'commandName' value '"+t+"' isn't adequate as a logical name for the ajax call. ":"",o=r?"Stack: "+r:MsPortalFx.isFeatureEnabled("ajaxstacks")?"Missing ajax call stack. Please log a bug to FX.":"Pass 'feature.ajaxstacks=true' in the query string to include a call stack with this message.",console.warn(f+"Supply a 'commandName' that logically names the ajax call to '"+i+"' for inclusion in telemetry. "+o)),""+e(n)+MsPortalFx.getUniqueId())}function e(n){return"["+n+"]"}Object.defineProperty(t,"__esModule",{value:!0});t.nameNetworkCall=void 0;var y=MsPortalFx,f=y.Base,u="[REDACTED]",l=r.getEndpoints(),o=l.arm.toLowerCase(),p=l.armBatch.toLowerCase(),w=MsPortalFx.getEnvironmentValue("extensionName")+".",s,h,c;t.nameNetworkCall=b}))