define("MsPortalImpl/Base/BladeWidthHelper",["require","exports"],(function(n,t){"use strict";function r(n){return i[n]}Object.defineProperty(t,"__esModule",{value:!0});t.allWidthClasses=t.getBladeWidthInfo=t.contextPaneDefaultSizeClass=void 0;var i={};i[51]={css:"fxs-bladesize-menu",width:265};i[0]={css:"fxs-bladesize-small",width:315};i[1]={css:"fxs-bladesize-medium",width:585};i[2]={css:"fxs-bladesize-large",width:855};i[3]={css:"fxs-bladesize-xlarge",width:1125};t.contextPaneDefaultSizeClass="fxs-bladesize-contextpane-default";t.getBladeWidthInfo=r;t.allWidthClasses=MsPortalFx.map(i,(function(n){return n.css})).join(" ")}));
define("MsPortalImpl/Interactions/Interactions.FocusHandler",["require","exports","MsPortalImpl/Base/Base.Timers","Weave","MsPortalImpl/Widgets/Widgets.Common"],(function(n,t,i,r,u){"use strict";function o(n){var t=document.createEvent("CustomEvent");t.initCustomEvent("fxreadyforfocus",!1,!1,null);n.dispatchEvent(t)}function s(n,t){var r=$(n),i,u,f;if(!$.contains(r[0],document.activeElement)){if(i=r.findFirstTabbable((function(n){return n.isInScrollView(t)})),!i.length&&r.hasClass("fxs-blade-content")){var e=r.closest(".fxs-blade"),s=e.hasClass("fxs-menublade"),o=s?[]:[e.find(".fxs-blade-close")];o.push(r.closest("[tabindex]"));u=MsPortalFx.find(o,(function(n){return!!n.attr("tabindex")||n.is("button,a")}));u&&(i=u)}if(i.length)return i.hasClass("fxs-part")&&(f=i.findFirstTabbable(),f.length===1&&(i=f)),i.focus()}}function h(n){i.requestAnimationFrame((function(){Q.allSettled([u.waitForBindings(n.element[0]),r.waitForChangePropagation()]).then((function(){setTimeout((function(){n.setFocus()}),50)}))}))}var f,e;Object.defineProperty(t,"__esModule",{value:!0});t.FocusHandler=t.setFocusOnContainer=void 0;t.setFocusOnContainer=i.throttleByAnimationFrame((function(n,t){return s(n,t)}));e=(function(){function n(){var n=this;if(this._containerTargets=[],this._mapTofocusableTargets=MsPortalFx.memoize((function(){return[]})),this._mapSkipAutoFocus=new Map,this._debounceMenuBladeCleanup=i.debounce((function(){var t;n._containerTargets.length!==0||((t=n._masterMenuBladeToSetFocus)===null||t===void 0?void 0:t.isMenuBladeLoadingDetailBlade())||(n._menuBladeToSetFocus=undefined,n._masterMenuBladeToSetFocus=undefined)}),1e3),f)throw new Error("FocusHandler operates as a singleton.");this._ltm=new FxImpl.TriggerableLifetimeManager;f=this;this._ltm.registerForDispose([this._debounceMenuBladeCleanup,$.querySelectorAll("body").setEvents(["focusin",this._cancelAutofocus=function(t){n._mapTofocusableTargets.map().forEach((function(i,r){var u=!!t||r!==n._menuBladeToSetFocus;n._mapSkipAutoFocus.set(r,u)}))},]),])}return n.prototype.dispose=function(){this._ltm.dispose();f=null},Object.defineProperty(n,"Instance",{get:function(){return f||(f=new n)},enumerable:!1,configurable:!0}),n.prototype.registerContainerForFocus=function(n,t){if(n){if(!this._menuBladeToSetFocus){var i=t.isMenuBladeLoadingDetailBlade();i&&(this._menuBladeToSetFocus=n,this._masterMenuBladeToSetFocus=t)}this._cancelAutofocus();MsPortalFx.pushUnique(this._containerTargets,[n])}},n.prototype.notifyContainerReadyForFocus=function(n){var t,i;try{MsPortalFx.remove(this._containerTargets,n).length&&(this._mapSkipAutoFocus.get(n)||(t=n,this._menuBladeToSetFocus&&this._menuBladeToSetFocus!==n&&(i=this._menuBladeToSetFocus.element.closest(".fxs-blade-content-container"),i[0]&&$.contains(i[0],n.element[0])&&(t=this._menuBladeToSetFocus)),t&&h(t)),this._mapSkipAutoFocus.delete(n),this._mapTofocusableTargets.delete(n),o(n.element[0]),this._menuBladeToSetFocus&&this._containerTargets.length===0&&this._debounceMenuBladeCleanup())}catch(r){}},n})();t.FocusHandler=e}));
define("MsPortalImpl/Widgets/Widgets.BladeContent.Component",["require","exports","Weave/DirectMode","Weave","FxInternal/Weave/Util","MsPortalImpl/Resources/ImplScriptResources","Fx/Weave/Components/LoadingIndicator","MsPortalImpl/Widgets/Widgets.PartError","Fx/Weave","MsPortalImpl/Weave/LazyControls","MsPortalImpl/Widgets/Widgets.CommandBar"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function y(n){var t=n.vm,l=s.toComputation(t.title),b=l.compose((function(n){return f.Blade.collapseMenuAria.format(n)})),k=l.compose((function(n){return f.Blade.expandMenuAria.format(n)})),d=s.toComputation(t.shieldType).compose(p),y=t.noticeTmplVm,tt=s.toComputation(t.statusBar.activatable),it=r.composeComputation([s.toComputation(t.contentState),s.toComputation(t.loaded),tt],(function(n,t,i){return n===0||n===1||i&&!t})),g=s.toComputation(t.renderCmdBarWhenNoCmd),rt=r.composeComputation([s.toComputation(t.commandBar.items),g],(function(n,t){return n.length>0||t})),nt=["fxs-commandBar-target fxs-portal-border fxs-portal-background fxs-portal-svg",{"fxs-alwaysshowcommandbar":g},];return i(r.Fragment,null,i("div",{className:["fxs-blade-commandBarContainer fxs-portal-background az-noprint",{"fxs-display-none":r.composeComputation([y,t.errorTmplVm],(function(n,t){return n||t}))},]},i(r.If,{condition:rt,concealmentBehavior:"remove",trueFn:function(){return i(c.CommandBar,{className:nt,vm:t.commandBar})},falseFn:function(){return i("div",{className:nt})}})),i("div",{className:"fxs-blade-dialoghost az-noprint"},i("div",{className:"fxs-blade-dialog"})),i(r.If,{condition:s.toComputation(t.description).compose(u.isNonEmptyString),concealmentBehavior:"remove",trueFn:function(){return i(r.LifetimeManagerScoped,{fn:function(n){return i(h.LazyInfoBox,{className:"fxs-blade-description-container",vm:function(i){return i.createVm(n,{style:1,text:{htmlTemplate:'<span data-bind="text: description"><\/span><a class="msportalfx-ext-link" data-bind="text: helpText, attr: { href: helpUri }, visible: helpUri().length > 0" target="_blank"><\/a>',viewModel:{description:t.description,helpUri:t.helpUri,helpText:f.Blade.helpText}}})}})}})}}),i("div",{className:"fxs-blade-status-container"},i(r.If,{condition:it,falseFn:function(){return i(r.LifetimeManagerScoped,{fn:function(n){return i(h.LazyInfoBox,{className:"fxs-blade-status-text-container",tagName:"div",vm:function(i){return i.createVm(n,{style:ko.computed(n,t.contentState,(function(n){return v[n]||1})),text:{htmlTemplate:'<span data-bind="text: text" style="overflow: hidden; text-overflow: ellipsis;"><\/span>&nbsp;<a class="msportalfx-ext-arrow ext-fxc-stretched-link" aria-hidden="true" data-bind="image: arrowRight, visible: showArrow" href="#"><\/a>',viewModel:{showArrow:t.statusBar.activatable,text:t.contentStateDisplayText,arrowRight:MsPortalFx.Base.Images.ArrowRight()}},ariaLabel:t.contentStateDisplayText})}})}})}})),i("div",{className:"fxs-blade-content-wrapper",role:"presentation","data-contenttitle":l},i("div",{className:"fxs-blade-summary-container fxs-portal-border fxs-display-none"}),i("div",{className:"fxs-blade-content"},r.composeComputation([y,t.errorTmplVm],w).compose((function(n){return n===2?i("div",{className:"fxs-blade-stacklayout"}):n===0?i("div",{className:"msportalfx-padding"},i(r.GetContext,{fn:function(n){var r=n.diContainer;return t.errorTmplVm.compose((function(n){return i("div",{className:"fxs-blade-errorcontent",afterMount:function(t,i){i.registerForDispose(new o.Widget($(t),n,r))}})}))}})):y.compose((function(n){return n?i(h.LazyNotice,{vm:n}):null}))})),i("button",{className:"fxs-bladecontent-collapser fxs-portal-hover fxs-portal-svg","aria-expanded":"true",image:a,title:b,"aria-label":b}))),i("div",{className:"fxs-blade-actionBar fxs-display-none"}),i("button",{className:"fxs-blade-collapse-veil fxs-portal-hover fxs-portal-svg","aria-expanded":"false",image:a,title:k,"aria-label":k}),i(e.LoadingIndicator,{className:["fxs-bladecontent-progress",{"fxs-blade-shield-translucent fxs-tile-overlay":d,"fxs-portal-background":d.compose(u.negation),"fxs-display-none":s.toComputation(t.showLoadingIndicator).compose(u.negation)}]}))}function p(n){return n===1}function w(n,t){return t?0:n?1:2}var l,a,v;Object.defineProperty(t,"__esModule",{value:!0});t.BladeContentInner=void 0;t.BladeContentInner=y;a=MsPortalFx.Base.Images.DoubleChevron();v=(l={},l[2]=4,l[3]=5,l[5]=1,l[4]=1,l[6]=2,l[7]=3,l)}));
define("MsPortalImpl/Widgets/Widgets.Blade.Component",["require","exports","Weave/DirectMode","Weave","FxInternal/Weave/Util","MsPortalImpl/Resources/ImplScriptResources","Fx/Weave/Components/LoadingIndicator","MsPortalImpl/Widgets/Widgets.BladeContent.Component","MsPortalImpl/Widgets/Widgets.DropMenu.Component","MsPortalImpl/Widgets/Widgets.DropMenu","Fx/Weave"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function a(n){var t=n.vm,k={palette:99},a=f.Blade,d=c.toComputation(t.loaded),ft=d.compose(u.negation),g=t.directoryInfo,w=t.title,et=t.titleMain,ot=t.titleExtras,tt=w.compose((function(n){return a.collapseAria.format(n)})),st=w.compose((function(n){return a.pinAria.format(n)})),ht=w.compose((function(n){return a.editAria.format(n)})),ct=w.compose((function(n){return a.closeAria.format(n)})),lt=w.compose((function(n){return a.copyAria.format(n)})),at=w.compose((function(n){return a.minimizeAria.format(n)})),vt=w.compose((function(n){return a.printAria.format(n)})),nt=w.compose((function(n){return a.expandAria.format(n)})),it=t.pinEnabled.compose(u.negation),rt=t.editEnabled.compose(u.negation),yt=t.editState,ut=l.DoubleChevron(k),pt=c.toComputation(t.fullScreenModeEnabled),b=new h.ViewModel(undefined,undefined,".fxs-blade-dropmenubutton");return b.setItemFocusWhenOpen=!0,b.buttonLabel(a.moreContentActionAria),b.buttonTooltip(a.moreContentActionAria),b.alignMenu=0,b.containInViewport=!0,i(r.Fragment,null,i("header",{className:["fxs-blade-header fxs-header fxs-portal-svg fxs-portal-background",{"fxs-blade-loading-status":ft,"fxs-blade-loaded":d}]},i("div",{className:["fxs-blade-progress-translucent fxs-loading5dots-container",{"fxs-display-none":t.showTranslucentSpinner.compose(u.negation)}]},i("div",null),i("div",null),i("div",null),i("div",null),i("div",null)),i("div",{className:"fxs-blade-title-content"},i(r.If,{condition:t.showTitleImage,concealmentBehavior:"remove",trueFn:function(){return i("div",{role:"img",className:"fxs-blade-title-image","aria-label":w,style:{"background-image":t.titleImageUri.compose(v)}})}}),i(r.If,{condition:t.showBladeIcon,concealmentBehavior:"remove",trueFn:function(){return i("span",{className:"fxs-blade-header-icon",image:t.icon})}}),i("div",{className:"fxs-blade-title"},i("div",{className:"fxs-blade-title-toprow"},i("h2",{className:"fxs-blade-title-titleText msportalfx-tooltip-overflow"},et,i("span",{className:"msportalfx-font-regular"},ot)),i("div",{className:"fxs-blade-actions msportalfx-unselectable az-noprint"},i("button",{type:"button",className:["fxs-blade-button fxs-blade-collapser fxs-portal-hover",{"fxs-display-none":t.collapseVisible.compose(u.negation)}],"aria-expanded":"true",image:ut,title:tt,"aria-label":tt}),i("button",{type:"button",className:["fxs-blade-button fxs-blade-pin fxs-portal-hover msportalfx-hideonactivated",{"fxs-display-none":t.pinVisible.compose(u.negation)}],title:a.pin,"aria-label":st,image:l.Pin(k),disabled:it,"aria-disabled":it}),i("button",{type:"button",className:["fxs-blade-button fxs-blade-edit fxs-portal-hover msportalfx-hideonactivated",{"fxs-display-none":t.editVisible.compose(u.negation)}],title:f.Blade.edit,"aria-label":ht,image:yt.compose((function(n){return n?l.Save({palette:99}):l.Edit({palette:99})})),disabled:rt,"aria-disabled":rt}),i("div",{className:"fxs-blade-actiondropmenu msportalfx-hideonactivated",afterMount:function(n,t){var i=new h.Widget($(n),b,!0);t.registerForDispose(i);b.isMenuOpen.subscribe(t,(function(n){n||i.setFocus()}))}},i(s.DropMenuInner,{vm:b,button:i("div",{className:"fxs-blade-button fxs-blade-more fxs-portal-hover",image:l.Ellipsis(k)}),content:i("div",{className:"fxs-blade-dropmenucontent",role:"presentation"},i("button",{type:"button",role:"menuitem",className:"fxs-blade-dropmenubutton fxs-blade-copyname fxs-portal-hover","aria-label":lt},i("span",{className:"fxs-blade-dropmenubuttonsvg",image:l.Copy(k)}),i("span",{className:"fxs-blade-dropmenubuttontxt msportalfx-text-ellipsis"},a.copy)),i("button",{type:"button",role:"menuitem",className:["fxs-blade-dropmenubutton fxs-blade-print fxs-portal-hover",{"fxs-display-none":t.printEnabled.compose(u.negation)}],"aria-label":vt},i("span",{className:"fxs-blade-dropmenubuttonsvg",image:l.Print(k)}),i("span",{className:"fxs-blade-dropmenubuttontxt msportalfx-text-ellipsis"},a.print)),i("button",{type:"button",role:"menuitem",className:"fxs-blade-dropmenubutton fxs-blade-fullscreen fxs-portal-hover","aria-label":a.fullScreenAria,"aria-pressed":pt},i("span",{className:"fxs-blade-dropmenubuttonsvg",image:l.Fullscreen(k)}),i("span",{className:"fxs-blade-dropmenubuttontxt msportalfx-text-ellipsis"},a.fullScreen)))})),i("div",{className:"fxs-blade-actions-spacefiller msportalfx-hideonactivated"}),i("button",{type:"button",className:["fxs-blade-button fxs-blade-minimize msportalfx-hideonactivated fxs-portal-hover",{"fxs-display-none":!(t.isHelpBlade&&MsPortalFx.isFeatureEnabled("helpblademinimize"))}],title:a.minimize,"aria-label":at,image:l.Minimize()}),i("button",{type:"button",className:["fxs-blade-button fxs-blade-close msportalfx-hideonactivated",{"fxs-display-none":t.customHome}],title:a.close,"aria-label":ct,image:l.Close()}))),i("div",{className:"fxs-blade-title-subtitle"},i("div",{className:["fxs-blade-title-subtitleText msportalfx-tooltip-overflow fxs-portal-subtext",{"fxs-display-none":t.subtitle.compose(u.negation)}]},t.subtitle),i(r.If,{condition:g,concealmentBehavior:"remove",trueFn:function(){return i("div",{className:"fxs-blade-title-subtitleDirectory fxs-blade-title-subtitleText fxs-portal-subtext"},i("span",{className:"fxs-blade-title-subtitleDirectoryIcon fxs-blade-header-icon fxs-portal-border",image:g.compose(y),title:a.DelegatedDirectory.info}),i("div",{className:"fxs-blade-title-subtitleDirectoryText"},g.compose(p)))}})))),i("button",{className:["fxs-blade-expander fxs-portal-hover",{"fxs-display-none":t.collapsed.compose(u.negation)}],"aria-expanded":"false",title:nt,"aria-label":nt,image:ut})),i("div",{className:["fxs-blade-content-container",{"fxs-blade-disabled":c.toComputation(t.disabled)}]},i("div",{className:"fxs-blade-content-container-default"},i(o.BladeContentInner,{vm:t.defaultContent})),i("div",{className:"fxs-blade-content-container-details fxs-blade-content-container-details-primary"}),i("button",{className:"fxs-blade-collapse-veil fxs-portal-hover fxs-portal-svg",tabindex:"-1","aria-hidden":"true",title:nt})),i(e.LoadingIndicator,{className:["fxs-blade-progress fxs-portal-background",{"fxs-display-none":d}]}))}function v(n){if(n){var t=n.split(",");return t.map((function(n){return"url('"+n.trim()+"')"})).join(",")}}function y(n){return n&&n.directoryIcon}function p(n){return n&&n.directoryName}Object.defineProperty(t,"__esModule",{value:!0});t.BladeInner=void 0;var l=MsPortalFx.Base.Images;t.BladeInner=a}));
define("MsPortalImpl/Widgets/Widgets.Lens.Component",["require","exports","Weave/DirectMode","Weave","Fx/Weave"],(function(n,t,i,r,u){"use strict";function f(n){var t=n.vm,f=u.toComputation(t.title),e=u.toComputation(t.title);return i(r.Fragment,null,i("div",{className:"fxs-lens-title-container"},i("div",{className:"fxs-lens-title",visible:e},f)),i("div",{className:"fxs-lens-layout"}))}Object.defineProperty(t,"__esModule",{value:!0});t.LensInner=void 0;t.LensInner=f}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Lens.css",["module"],(function(n){"use strict";return{css:".fxs-lens{position:relative;padding-bottom:10px}.fxs-lens-title-container{display:flex;align-items:center;height:30px}.fxs-lens-title{flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:14px;line-height:30px;height:30px}.fxs-lens-fit{padding-bottom:0;height:100%}.fxs-lens-fit>.fxs-lens-title{display:none}.fxs-lens-fit>.fxs-lens-layout{height:100%}.fxs-bladestyle-create .fxs-lens.fxs-lens-fit{width:calc(100% + 2*20px);margin-left:-20px}.fxs-blade-locked .fxs-stacklayout-child:last-child.fxs-lens{padding-bottom:0}.fxs-bladecontent-unlocked .fxs-lens.fxs-lens-fit{padding-top:15px}.fxs-blade-locked .fxs-blade-stacklayout.fxs-stacklayout-vertical .fxs-lens>.fxs-lens-title-container{height:auto}.fxs-blade-stacklayout.fxs-stacklayout-horizontal .fxs-lens>.fxs-lens-layout{height:calc(100% - 30px)}.fxs-blade-content-container .fxs-bladestyle-hub .fxs-blade-summary-container,.fxs-blade-content-container .fxs-bladestyle-hubsubmenu .fxs-blade-summary-container{border:none}.fxs-blade-summary-container{position:relative;overflow:hidden;border-bottom-width:1px;border-bottom-style:solid}.fxs-blade-summary-container .fxs-lens{padding-bottom:0}.fxs-blade-summary-container .fxs-lens .fxs-lens-title-container{display:none}.fxs-blade-summary-container .fxs-lens .fxs-tile{min-height:35px;width:100% !important;height:auto}.fxs-blade-summary-container .fxs-lens .fxs-tile .fxs-tile-progress{top:35px;height:calc(100% - 35px);overflow:hidden}.fxs-blade-summary-container .fxs-lens .fxs-tile .fxs-part{padding:0;box-shadow:none !important}.fxs-blade-summary-container .fxs-lens .fxs-tile .fxs-part.fxs-part-part-title-visible .fxs-part-content{top:0}.fxs-blade-summary-container .fxs-lens .fxs-tile .fxs-part .fxs-part-title{display:none}.fxs-blade-summary-container .fxs-lens .fxs-tile .fxs-part .fxs-part-blockui-shield{top:35px}.fxs-blade-summary-container .fxs-lens .fxs-tile .fxs-tile-actionbar-actionlist{visibility:hidden}.fxs-lens-layout-flow .fxs-lens-layout{display:flex;flex-flow:row wrap;align-items:flex-start;margin:0 -5px -5px 0}.fxs-lens-layout-flow .fxs-tile{flex:0 0 auto;margin:0 5px 5px 0}",moduleId:n.id}}));
define("MsPortalImpl/Widgets/Widgets.Lens",["require","exports","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.Lens.Component","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Widgets/Widgets.UIElementBase","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Lens.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function p(n,t){var i=t.findByClassName("fxs-lens-layout").children().toArray(),r=i.map((function(n){return l($(n),c)}));return MsPortalFx.find(r,(function(t){return t&&t.options&&t.options.id===n}))}var a,v;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.ViewModel=void 0;s.injectCss(h);var c=u.Widget,y=o.Widget,l=r.Widget.getWidget;a=(function(n){function t(t,i){var r=n.call(this,t)||this;return r.diContainer=i,r.title=ko.observable(),r}return __extends(t,n),t.prototype.getViewSettings=function(){return{}},t.prototype.applyViewSettings=function(){},t})(o.ViewModel);t.ViewModel=a;v=(function(n){function t(t,i){var r=n.call(this,t,i)||this;return t.addClass("fxs-lens"),e.applyToElement({element:t[0],ltm:r.ltm,weaveNode:f.LensInner({vm:i}),weaveContext:{diContainer:i.diContainer},opName:"blade"}),ko.computed(r.ltm,[i.locked,i.title],(function(n,i){var u=t.findByClassName("fxs-lens-layout"),f=t.findByClassName("fxs-lens-title"),r;n||MsPortalFx.isNullOrWhiteSpace(i)?(u.removeAttr("aria-describedby"),f.removeAttr("id")):(r=MsPortalFx.getUniqueId(),u.attr("aria-describedby",r),f.attr("id",r))})),r}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement("fxs-lens","fxs-lens-fit","fxs-lens-layout-flow");n.prototype.dispose.call(this)},t.prototype.addChild=function(n){var t;if(!n)throw new Error("Can't add null child.");var f=n.element||n,r=l(f,c),u=r.options,e=i.isVariableSize(u.size()),o=u.size()===9;e||this.element.addClass("fxs-lens-layout-flow");t=this.element;t.findByClassName("fxs-lens-layout").append(r.element);t.toggleClass("fxs-lens-fit",o)},t.prototype.removeChild=function(n,t){var r=!1,u=p(n,this.element),i;return u&&(i=u.element,t?i.detach():i.remove(),r=!0),r},t.prototype.setSize=function(){this.element.findByClassName("fxs-lens-layout").children().each((function(n,t){var i=l($(t),c);i&&i.element.trigger("fxsizechanged")}))},t.prototype.saveViewSettings=function(){return this.options.getViewSettings()},t.prototype.getTelemetrySource=function(){return"Lens"},t})(y);t.Widget=v}));
define("MsPortalImpl/Widgets/Widgets.StackLayout",["require","exports","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.LayoutBase","MsPortalImpl/Widgets/Widgets.UIElementBase","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.StackLayout.css"],(function(n,t,i,r,u,f,e){"use strict";var l,s;Object.defineProperty(t,"__esModule",{value:!0});t.StackLayoutPositioningEngine=t.Widget=t.ViewModel=void 0;f.injectCss(e);var h="fxs-stacklayout-horizontal",c="fxs-stacklayout-vertical",o="fxs-stacklayout-child",a=(function(n){function t(t,i,u){var f=n.call(this,t)||this;return f._positions=[],f.orientation=ko.observable(r.Orientation.Vertical),f.childElements=ko.observableArray(),f.applyViewSettings(i),f.insertBeforeChildSelector=u,f}return __extends(t,n),t.prototype.getViewSettings=function(){return{positions:this.positions}},t.prototype.applyViewSettings=function(n){n&&n.positions&&(this.positions=n.positions)},Object.defineProperty(t.prototype,"positions",{get:function(){return this._positions},set:function(n){this._positions=n?n:[]},enumerable:!1,configurable:!0}),t})(u.ViewModel);t.ViewModel=a;l=(function(n){function t(t,i){var u=n.call(this,t,i)||this;return u._engine=new s,u._engine.positions=i.positions,t.addClass("fxs-stacklayout"),ko.computed(u.ltm,(function(){var n=u.options.orientation();u.element.toggleClass(c,n===undefined||n===r.Orientation.Vertical).toggleClass(h,n===r.Orientation.Horizontal)})),u._bindDescendants(),u}return __extends(t,n),t.prototype.dispose=function(){this.options.childElements().slice().forEach((function(n){ko.cleanNode(n[0]);n.remove()}));this._cleanElement(c,h,"fxs-stacklayout");n.prototype.dispose.call(this)},t.prototype.addChild=function(n){this._addInsertChild(n)},t.prototype.insertChild=function(n,t){this._addInsertChild(n,t)},t.prototype.removeChild=function(n){var t=MsPortalFx.find(this.options.childElements(),(function(t){return u.Widget.getId(t)===n}));return t?(i.hide(t).removeClass(o),setTimeout((function(){t.remove()}),100),this.options.childElements().splice(this.options.childElements().indexOf(t),1),this._engine.remove(n),this._applyPositioning(),!0):!1},t.prototype.saveViewSettings=function(){return this.options.positions=this._engine.positions,this.options.getViewSettings()},t.prototype.discardStateOfUnusedChildren=function(){var t={stateDiscarded:!1},n;return this._engine&&(n=this._engine.discardUnusedPositions(),n&&n.length&&(t.stateDiscarded=!0,t.message="Removed Positions: "+JSON.stringify(n))),t},t.prototype._addInsertChild=function(n,t){var e=this.options,s=this.element,h=e.childElements(),i,r,f;if(!n)throw new Error("Cannot add a null child.");i=n.element?n.element:n;i.addClass(o);h.push(i);this._engine.insert(u.Widget.getId(i),t);r=s.children("."+o).toArray().filter((function(n){var t=n&&n.style,i=t&&t.display;return i!=="none"}));f=e.insertBeforeChildSelector&&s.children(e.insertBeforeChildSelector);t>=0||(t=r.length);r.length>t?$(r[t]).before(i):(f===null||f===void 0?void 0:f.length)?$(f[0]).before(i):r.length?$(r[r.length-1]).after(i):s.append(i);this._applyPositioning()},t.prototype._applyPositioning=function(){var n=this.options.childElements,t=[];this._engine.positions.forEach((function(i){var r=MsPortalFx.find(n(),(function(n){return u.Widget.getId(n)===i.id}));r&&(n().splice(n().indexOf(r),1),t.push(r))}));Array.prototype.unshift.apply(n(),t);n.valueHasMutated()},t})(u.Widget);t.Widget=l;s=(function(){function n(){this._items=[];this._filledPositions={}}return n.prototype.append=function(n){var t=this._getExistingItem(n);return this._filledPositions[n]=!0,t||this._insert(n),this._items},n.prototype.insert=function(n,t){var i=this._getExistingItem(n);return this._filledPositions[n]=!0,i&&this._items.splice(this._items.indexOf(i),1),this._insert(n,t),this._items},n.prototype.move=function(n,t){var i=this._getExistingItem(n),r=this._items.indexOf(i);return r>=0&&(this._items.splice(r,1),this._items.splice(t,0,i)),this._items},n.prototype.remove=function(n){var i=this._getExistingItem(n),t=this._items.indexOf(i);return t>=0&&(this._items.splice(t,1),this._filledPositions[n]=!1),this._items},Object.defineProperty(n.prototype,"positions",{get:function(){return this._items},set:function(n){this._items.length=0;this._items=n},enumerable:!1,configurable:!0}),n.prototype.discardUnusedPositions=function(){var n=this,t=[];return this._items.slice(0).forEach((function(i){n._filledPositions[i.id]||(t.push(i),n.remove(i.id))})),t},n.prototype._insert=function(n,t){var i={id:n};t>=0&&t<this._items.length?this._items.splice(t,0,i):this._items.push(i)},n.prototype._getExistingItem=function(n){return MsPortalFx.find(this._items,(function(t){return t.id===n}))},n})();t.StackLayoutPositioningEngine=s}));
define("MsPortalImpl/Widgets/Widgets.BladeContent",["require","exports","MsPortalImpl/Interactions/Interactions.RightClick","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Interactions/Interactions.FocusHandler","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.CommandBar","MsPortalImpl/Widgets/Widgets.ContextMenu","MsPortalImpl/Widgets/Widgets.LayoutBase","MsPortalImpl/Widgets/Widgets.Lens","MsPortalImpl/Widgets/Widgets.StackLayout","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/BladeWidthHelper","MsPortalImpl/Base/Base.BrowserDetection","Viva.Controls/Util/Viva.Resize","Weave"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";function ki(n){return n.map((function(n){return n.css})).join(" ")}var ft,et,ni,ti;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.ViewModel=t.BladeStatusBarViewModel=t.combineAllCssClasses=t.defaultSvg=void 0;var ot=MsPortalFx.Base,ii=ot.Diagnostics,nt=MsPortalFx.Blades,st=nt.Internal.BladeStyle,ri=nt.Internal.BladeWidth,ui=nt.Internal.DisplayState,fi=ot.Images,ei=c.Orientation,tt=o.Widget,oi=l.Widget,g=v.Widget,d=r.Blade.StatusBar,si=ii.createLog(n),hi=MsPortalFx.isNullOrUndefined,ci=g.viewSettingsChanged,ht="fxs-mode-locked",ct="fxs-blade-unauthorized",lt="fxs-blade-locked",it="fxs-blade-content",at="fxs-blade-summary-container",li="fxs-blade-status-container",rt=".fxs-blade-status-text-container .ext-fxc-stretched-link",ai="fxs-blade-status-visible",vt="fxs-blade-stacklayout",yt="fxs-blade-dialoghost",vi="fxs-blade-dialog",pt="fxs-blade-dialogmodal",yi="fxs-blade-actionBar",pi="fxs-display-none",wt="fxs-bladestyle-default",bt="fxs-bladecontent",kt="fxs-bladecontent-unlocked",wi="fxs-commandBar-target",ut="fxs-blade-collapsed",dt="fxs-bladecontent-collapser",gt="fxs-blade-collapse-veil",bi=y.getBladeWidthInfo(1),k={};k[2]=d.warning;k[3]=d.error;k[4]=d.dirty;k[5]=d.info;k[6]=d.upsell;k[7]=d.complete;t.defaultSvg=fi.Polychromatic.DefaultBlade();ft={rateLimit:{timeout:100,method:"notifyWhenChangesStop"}};t.combineAllCssClasses=ki;et=(function(){function n(){this.activatable=ko.observable(!1);this.activated=ko.observable(!1)}return n})();t.BladeStatusBarViewModel=et;ni=(function(n){function i(i,r,u){var f=n.call(this,i)||this,e;return f.statusBar=new et,f.bladeStyle=b.makeWritableComputation(),f.title=ko.observable(),f.subtitle=ko.observable(),f.titleSuffix=ko.observable(),f.subtitleSuffix=ko.observable(),f.description=ko.observable(""),f.helpUri=ko.observable(""),f.contextMenu=new h.ViewModel,f.commandBar=new s.ViewModel,f.renderCmdBarWhenNoCmd=ko.observable(!1),f.icon=ko.observable(t.defaultSvg),f.contentState=ko.observable(0),f.contentStateDisplayText=ko.observable(),f.noticeTmplVm=b.makeWritableComputation(),f.errorTmplVm=b.makeWritableComputation(),f.statusIcon=ko.observable(),f.forcedMaximize=ko.observable(!1),f.bladeWidth=ko.observable(1),f.hasIcon=ko.observable(),f.isV2Blade=ko.observable(!1),f.reflowReady=ko.observable(!1),f.showLoadingIndicator=ko.observable(!1),r=r||{},f.loaded=r.loaded||ko.observable(!1),f.shieldType=r.shieldType||ko.observable(),f.displayState=r.displayState||ko.observable(1),f.isUiBlocked=r.isUiBlocked||ko.observable(!1),f.diContainer=r.diContainer,r.disabled&&(f.disabled=r.disabled),e=new a.ViewModel("fxs-blade-stacklayout-instanceid"),e.orientation(ei.Vertical),f.stackLayoutOptions=e,f.bladeName=u||{name:i,extensionName:null},f}return __extends(i,n),i.prototype.getTelemetryName=function(){return["Extension",this.bladeName.extensionName,"Blade",this.bladeName.name].join("/")},i.prototype.getViewSettings=function(){this._viewSettings||(this._viewSettings=$.extend(this._viewSettings,{}));var n=this._viewSettings;return n.DisplayState=this.displayState(),n.BladeWidth=this.bladeWidth(),n.BladeStyle=this.bladeStyle.value,n},i.prototype.applyViewSettings=function(n){var t,i,r,u;n&&(t=this._viewSettings=MsPortalFx.extend2(this._viewSettings,ko.toJS(n)),i=t.BladeWidth,ri[i]&&this.bladeWidth(i),r=t.BladeStyle,st[r]&&this.bladeStyle(r),u=t.DisplayState,ui[u]&&this.displayState(u))},i})(v.ViewModel);t.ViewModel=ni;ti=(function(n){function t(t,r){var f=n.call(this,t,r)||this,e,o,h,s;return f._initialRenderingComplete=ko.observable(!1),f.titleResolved=ko.observable(),f.timer=MsPortalFx.startTimer(),t.addClass(bt),e=f.ltm,f._$bladeContent=f.element.findByClassName(it),r.contextMenu.registerForCleanup(e),r.contentState.subscribe(e,(function(n){var i=!hi(n)&&n!==0&&n!==1;t.toggleClass(ai,i)})),ko.computed(e,[r.contentState,ko.computed(e,[r.contentStateDisplayText],(function(n){return n||""})),r.statusBar.activatable,],(function(n,t,i){if(n!==1&&t){f._statusBarMessageLifetime&&f._statusBarMessageLifetime.dispose();f._statusBarMessageLifetime=e.createChildLifetime();var o=new u.PortalReader(f._statusBarMessageLifetime,{idPrefix:"statusbar"});ko.computed(f._statusBarMessageLifetime,[r.title],(function(r){var f=k[n]?k[n]:"",u=r+"-"+f+"-"+t;i&&(u+="-"+d.linkDesc);o.read(u)})).extend(ft)}})).extend(ft),ko.reactor(e,(function(){var n=!!r.locked();r.stackLayoutOptions.locked(n);t.toggleClass(ht,n).toggleClass(lt,n).toggleClass(kt,!n)})),b.subscribeAndRun(e,[r.noticeTmplVm],(function(n){t.toggleClass(ct,!!n);n&&(r.locked(!0),r.loaded(!0),r.isUiBlocked(!1),r.bladeStyle(4),f.trigger("fxbladerepos"))})),ko.reactor(e,[r.forcedMaximize,r.bladeWidth,r.reflowReady],(function(){f.applyBladeWidth();t.trigger(ci,f.saveViewSettings());f.trigger("fxbladerepos")})),w.track(e,f.element.find(".fxs-blade-content"),(function(n){f.element.toggleClass("fxs-blade-layout-sm",n>=0).toggleClass("fxs-blade-layout-md",n>=480).toggleClass("fxs-blade-layout-lg",n>=640).toggleClass("fxs-blade-layout-xl",n>=1024).toggleClass("fxs-blade-layout-xxl",n>=1366).toggleClass("fxs-blade-layout-xxxl",n>=1920)}),{notifyInitialSize:!0}),e.registerForDispose([t.findByClassName(li).setEvents(["click",rt,function(n){n.preventDefault();t.trigger("fxbladestatusbarclicked")},],["keydown",rt,function(n){n.which===13&&(n.preventDefault(),t.trigger("fxbladestatusbarclicked"))},]),t.setEvents(["keydown",function(n){var i=t.find(rt);if(i.length&&n.which===113)return t.trigger("fxbladestatusbarclicked"),!1},]),]),b.subscribeAndRun(e,[r.errorTmplVm],(function(n){t.toggleClass(ct,!!n);n&&(r.locked(!0),r.loaded(!0),r.isUiBlocked(!1),r.bladeStyle(4),f.trigger("fxbladerepos"))})),e.registerForDispose([i.setup(t,r.contextMenu.menuItems),]),r.contextMenu.menuItems.subscribeAndRun(e,(function(n){var u=!!o,f=n.length>0;u&&!f?o.dispose():!u&&f&&(o=e.createChildLifetime()).registerForDispose(i.setup(t,r.contextMenu.menuItems))})),f.applyBladeWidth(),h=f.element.find("."+gt+", ."+dt),e.registerForDispose(h.setEvents(["click",function(n){var t=f.element.hasClass(ut);f.element.toggleClass(ut);f.trigger("fxbladerepos",{noScroll:!0});f.element.findByClassName(t?dt:gt).focus();n.stopPropagation();MsPortalFx.Base.Diagnostics.Telemetry.trace({source:r.getTelemetryName(),action:"MenuCollapse",actionModifier:t?"Expand":"Collapse",name:"fxs-blade-menu-expandcollapse"})},])),ko.computed(f.ltm,[r.isUiBlocked,r.loaded],(function(n,t){f.options.showLoadingIndicator(!t||n)})),s=f._initialRenderingComplete=ko.observable(!1),ko.reactor(f.ltm,[f.options.showLoadingIndicator],(function(n){n||s(!0);f.options.commandBar.disabled(n)})),ko.reactor(f.ltm,[r.title,s],(function(n,t){(n||t)&&f.titleResolved(!0)})),f}return __extends(t,n),t.prototype.dispose=function(){this._cleanElementClasses([y.allWidthClasses,ht,bt,this.bladeStyleClass,kt,lt,ut,]);n.prototype.dispose.call(this)},t.prototype.setContentWidth=function(){var n=this.element.findByClassName(vt),t=y.getBladeWidthInfo(this.options.bladeWidth())||bi;n.css("width",t.width+50+"px")},t.prototype.saveViewSettings=function(){return this.options.getViewSettings()},t.prototype.setSummary=function(n){var t=this.element.findByClassName(at);e.hide(t);t.empty().append(n);e.unhide(t)},t.prototype.setActionBar=function(n){if(this._actionBar){si.error("The blade '{0}' already contains an action bar.".format(this.options.id));return}if(this.ltm&&!this.ltm.isDisposed()){var i=this.element.findByClassName(yi).removeClass(pi),t=$(FxImpl.createElement("div"));i.append(t);this.ltm.registerForDispose(this._actionBar=n(t))}},t.prototype.getForm=function(){return{element:this.element.findByClassName(vi)[0],ltm:this.ltm}},t.prototype.showForm=function(n,t){this.element.findByClassName(yt).toggleClass(pt,t&&t.modal||!1)},t.prototype.hideForm=function(){this.element.findByClassName(yt).removeClass(pt)},t.prototype.initializeLayout=function(){var t=this.element,i=t.findByClassName(vt),n;if(this._layout)throw new Error("Blade widget's layout can only be initialized once.");n=this.options.stackLayoutOptions;this._layout=new a.Widget(i,n);this.ltm.registerForDispose(this._layout);this.applyBladeWidth()},t.prototype.childRelayout=function(){this._layout&&this._layout.options.childElements().forEach((function(n){var t=tt.getWidget(n,oi);t&&t.setSize(-1,-1)}))},t.prototype.addChild=function(n){var t;if(!n)throw new Error("Can't add null child.");this._layout&&this._layout.addChild(n);t=n instanceof g?n:tt.getWidget(n,g);t&&t.setSize(-1,-1)},t.prototype.removeChild=function(n){return!!this._layout&&this._layout.removeChild(n)},t.prototype.setFocus=function(){var t=this,i,r,n,u,o;!p.isAndroidOrMobile&&this._layout?(i="fxs-lens",r=this.element.findByClassName(at).findByClassName(i),e.isVisible(r)?n=r:(i=it,n=this._$bladeContent),n.length&&(u=document.activeElement,u&&$.contains(n[0],u)||this._initialRenderingComplete.fxAwaitAndRun(this.ltm).then((function(){var r=function(){var i=t._actionBar,n=i&&i.contentElement;if(n&&e.isVisible(n))return f.setFocusOnContainer(n[0],null);t.setFocusOnCommandBar()},u=function(){return f.setFocusOnContainer(n[0],i)};u().then((function(n){if(!n&&!$.contains(t.element[0],document.activeElement))return Q.delay(150).then(u)})).then((function(n){n||$.contains(t.element[0],document.activeElement)||r()})).catch(r)})))):(o=this._$bladeContent.closest(".fxs-blade").find(".fxs-blade-close"),o.length&&o[0].focus())},t.prototype.setFocusOnCommandBar=function(){var n=tt.getWidget(this.element.findByClassName(wi),s.Widget);n&&n.setFocus()},t.prototype.initializeStyleReactor=function(){var n=this,t=this.element,i=this.options;b.subscribeAndRun(this.ltm,[i.bladeStyle],(function(i){var u=n.bladeStyleClass,r;t.removeClass(Object.keys(MsPortalFx.Blades.Internal.BladeStyle).filter((function(n){return!parseInt(n)})).map((function(n){return"fxs-bladestyle-"+n.toLowerCase()})).concat([wt]).join(" "));r=st[i];u=n.bladeStyleClass=r?"fxs-bladestyle-"+r.toLowerCase():wt;t.addClass(u)}))},t.prototype.applyBladeWidth=function(){var t=this.options.bladeWidth.peek(),n,i=y.getBladeWidthInfo(t),r;n=t!==51&&this.options.reflowReady.peek()?"fxs-blade-size-reflow":i.css;this.element.removeClass(y.allWidthClasses).addClass(n);r=this.element.findByClassName(it).removeClass(y.allWidthClasses).addClass(n);this.options.forcedMaximize.peek()&&r.css("width",i.width+"px")},t})(g);t.Widget=ti}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Blade.css",["module"],(function(n){"use strict";return{css:'.fxs-blade{position:relative;height:100%;max-width:100%;display:flex;flex-direction:column}.fxs-blade.fxs-blade-initializing{transition:none !important}.fxs-blade-dialoghost{display:block;position:relative;z-index:200;width:100%;left:0;overflow:visible;height:0}.fxs-blade-dialogmodal{display:flex;position:absolute;padding:25px;height:100%;box-sizing:border-box}.fxs-blade-dialogmodal::before{content:"";display:block;background:rgba(0,0,0,.35);position:absolute;top:0;right:0;bottom:0;left:0}.fxs-blade-dialogmodal .fxs-blade-dialog{position:relative;margin:auto}.fxs-blade-stacklayout{height:100%;-ms-overflow-style:auto;box-sizing:border-box;padding:10px 20px 20px 20px}.fxs-blade-header{position:relative;height:64px;flex-shrink:0;box-sizing:border-box}.fxs-blade-title{flex:1 1 auto;min-width:0;width:100%}.fxs-blade-title-toprow{display:flex}.fxs-blade-title-titleText,.fxs-blade-title-subtitleText{margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-blade-title-subtitle,.fxs-blade-title-subtitleDirectory{display:flex;height:16px}.fxs-blade-title-subtitleText,.fxs-blade-title-subtitleDirectoryIcon{flex:0 0 auto}.fxs-blade-title-subtitleDirectoryIcon{border-left:solid 1px;height:14px;margin-left:20px;margin-right:5px;padding-left:5px;width:10px}.fxs-blade-title-subtitleDirectoryIcon>svg{height:100%;width:100%}.fxs-blade-title-titleText{font-weight:600;font-size:24px;line-height:28px;flex:0 1 auto;margin-right:16px}.fxs-blade-title-subtitleText{max-width:100%;font-size:12px;line-height:14px}.fxs-blade-header-icon{flex:0 0 auto;display:flex;align-items:center;justify-content:center;margin-right:10px;position:relative}.fxs-blade-header-icon img,.fxs-blade-header-icon svg{height:28px;width:28px}.fxs-blade-title-image{background-size:100%;width:48px;height:48px;display:block;margin-right:10px;flex:0 0 auto}.fxs-blade-title-content{display:flex;height:100%;box-sizing:border-box;padding:8px 20px}.fxs-commandBar-target{border-bottom-width:1px;border-bottom-style:solid;margin:0 20px}.fxs-commandBar-target.fxs-alwaysshowcommandbar{height:36px}.fxs-commandBar-target:empty{border:0}.fxs-blade-disabled .fxs-blade-commandBarContainer{display:none}.fxs-blade-content-container{height:100%;position:relative;display:flex;flex-direction:row;flex:1 1 auto;min-height:0}.fxs-blade-content-container>div{display:none}.fxs-blade-content-container .fxs-bladestyle-create .fxs-blade-stacklayout{padding-left:20px;padding-right:20px}.fxs-blade-content-container .fxs-bladestyle-create .fxs-blade-stacklayout .fxs-part{padding-left:0;padding-right:0}.fxs-blade-content-wrapper{height:100%;overflow:auto;display:flex;flex-direction:column;flex:1 1 auto;box-sizing:border-box;position:relative}.fxs-blade-status-text-container{position:relative}.fxs-blade-description-container.fxc-infoBox,.fxs-blade-status-text-container.fxc-infoBox{display:block;margin:0 20px}.fxs-blade-status-container .fxc-infoBox-text{align-items:center;display:flex}.fxs-blade-status-container .fxc-infoBox-text .msportalfx-ext-arrow{height:12px;flex:0 0 12px;margin-left:5px}.fxs-blade-status-container .fxc-infoBox-text .msportalfx-ext-arrow svg{height:12px;width:12px}.fxs-blade-status-container a.ext-fxc-stretched-link::after{position:absolute;top:0;right:0;bottom:0;left:0;z-index:1;content:""}.fxs-blade-button,.fxs-blade-dropmenubutton{cursor:pointer;padding:0;border:0;background-color:transparent;margin:0;transition:background-color .2s ease-out;height:32px;display:flex;align-items:center;justify-content:center}.fxs-blade-button svg,.fxs-blade-dropmenubutton svg{height:12px;width:12px}.fxs-blade-button{width:32px}.fxs-blade-dropmenucontent{display:flex;flex-direction:column;width:192px}.fxs-blade-actiondropmenu{z-index:203}.fxs-mode-light .fxs-blade-actiondropmenu .fxs-dropmenu-button[aria-expanded=true]{background-color:#eee}.fxs-mode-dark .fxs-blade-actiondropmenu .fxs-dropmenu-button[aria-expanded=true]{background-color:#333}.fxs-blade-dropmenubutton{justify-content:flex-start;padding:7px 8px 7px 0;height:auto;box-sizing:border-box;text-align:left}.fxs-blade-dropmenubuttonsvg{height:18px;width:32px;flex:0 0 auto;display:flex;align-items:center;justify-content:center;align-self:flex-start}.fxs-blade-dropmenubuttontxt{flex:0 1 auto;overflow:hidden;text-overflow:ellipsis}.fxs-blade-button:not(.fxs-blade-close),.fxs-blade-title{visibility:hidden}.fxs-blade-loaded .fxs-blade-button,.fxs-blade-loaded .fxs-blade-title{visibility:visible}.fxs-blade-actions{display:flex;flex:1 0 auto;justify-content:flex-end}.fxs-blade-actions-spacefiller{flex:1 1 auto}.fxs-blade-pin[aria-disabled=true]{cursor:default;opacity:.5}.fxs-blade-copyname svg,.fxs-blade-pin svg,.fxs-blade-print svg{height:14px;width:14px}.fxs-blade-close:hover{background-color:#ba141a;fill:#fff !important}.fxs-blade.fxs-blade-maximized{width:100%}.fxs-blade-content{height:100%;flex:1 1 auto;position:relative;box-sizing:border-box;min-height:0}.fxs-blade-content-container .fxs-bladecontent{display:flex;flex-direction:column;position:relative;flex:1 1 100%;min-width:0}.fxs-blade-content-container .fxs-bladecontent:first-child{flex:0 0 auto}.fxs-blade-progress,.fxs-part-frame.fxs-blade-floated-frame{top:64px;height:calc(100% - 64px);z-index:202}.fxs-journey-nobladeheader .fxs-blade-header{display:none !important}.fxs-journey-nobladeheader .fxs-blade-progress,.fxs-journey-nobladeheader .fxs-part-frame.fxs-blade-floated-frame{top:0;height:100%}.fxs-bladecontent-progress{z-index:201}.fxs-blade-progress-translucent{height:8px;position:absolute;z-index:202;overflow:hidden;left:0;top:4px}.fxs-blade-progress-translucent>div{margin-left:6px}.fxs-blade-progress-translucent>div::after{height:4px;width:4px}.fxs-blade-hide-translucent .fxs-blade-progress-translucent{display:none}.fxs-blade-summary-container{flex:0 0 auto}.fxs-blade-content-container-details{height:100%}.fxs-blade-content-container-details .fxs-part-resourcesummary-shortcuts,.fxs-blade-content-container-details .fxs-part-resourcesummary-bottom{display:none}.fxs-blade-content-container-details .fxs-part-resourcesummary .fxs-part-properties{margin-bottom:6px}.fxs-blade-appblade .fxs-blade-content{padding:0}.fxs-bladestyle-app .fxs-blade-stacklayout{padding:0;top:0;bottom:0}.fxs-bladestyle-app .fxs-part{padding:0 !important;height:100% !important}.fxs-bladestyle-app .fxs-part-content{height:100% !important}.fxs-bladestyle-app .fxs-tile,.fxs-bladestyle-app .fxs-lens-layout,.fxs-bladestyle-app .fxs-lens{height:100% !important}.fxs-bladestyle-app .fxs-blade-summary-container{border-bottom-width:0}.fxs-bladestyle-basic .fxs-blade-content,.fxs-bladestyle-basicwithcommands .fxs-blade-content,.fxs-bladestyle-context .fxs-blade-content,.fxs-bladestyle-create .fxs-blade-content{padding:0}.fxs-bladestyle-basic .fxs-blade-stacklayout,.fxs-bladestyle-basicwithcommands .fxs-blade-stacklayout,.fxs-bladestyle-context .fxs-blade-stacklayout,.fxs-bladestyle-create .fxs-blade-stacklayout{padding:0}.fxs-bladestyle-context .fxs-blade-content .fxs-tile{background:none}.fxs-bladestyle-context .fxs-blade-content .fxs-part-content .fxc-hotspot{padding:0}.fxs-bladestyle-context .fxs-blade-content .fxs-part-content button.fxc-hotspot{padding:3px 10px 5px 10px}.fxs-bladestyle-context .fxs-blade-content .fxs-part-content .msportalfx-partdivider::after{margin:0}.fxs-bladestyle-help .fxs-blade-content .fxs-tile{background:none}.fxs-bladestyle-help .fxs-blade-content .fxs-part-content h1,.fxs-bladestyle-help .fxs-blade-content .fxs-part-content h2{font-weight:200}.fxs-bladestyle-help .fxs-blade-content .fxs-part-content h1{font-size:34px;margin:14px 0 33px}.fxs-bladestyle-help .fxs-blade-content .fxs-part-content h2{font-size:22px;margin:0 0 17px}.fxs-bladestyle-help .fxs-blade-content .fxs-part-content h3{font-size:14px;margin:10px 0 8px}.fxs-bladestyle-help .fxs-blade-content .fxs-part-content h4{text-transform:uppercase;font-weight:700;margin:0}.fxs-bladestyle-help .fxs-blade-content .fxs-part-content button.fxc-hotspot{padding:3px 10px 5px}.fxs-bladestyle-hub .fxs-blade-content,.fxs-bladestyle-hubsubmenu .fxs-blade-content{padding:0}.fxs-bladestyle-hub .fxs-blade-stacklayout,.fxs-bladestyle-hubsubmenu .fxs-blade-stacklayout{padding:0}.fxs-bladestyle-hub .fxs-blade-actions .fxs-blade-pin,.fxs-bladestyle-hubsubmenu .fxs-blade-actions .fxs-blade-pin{display:none}.fxs-bladestyle-hub .fx-text-title,.fxs-bladestyle-hubsubmenu .fx-text-title{display:none}.fxs-bladestyle-hub .fxs-blade-statusbar-wrapper,.fxs-bladestyle-hubsubmenu .fxs-blade-statusbar-wrapper{background-color:inherit}.fxs-blade-maximized .fxs-blade-stacklayout{width:100%}.fxs-blade-unauthorized .fxs-blade-summary-container,.fxs-blade-unauthorized .fxs-blade-status-container{display:none}.fxs-blade-unauthorized .fxc-notice{position:absolute;width:100%}.fxs-blade-has-activation .msportalfx-hideonactivated,.fxs-blade-has-activation .azc-collapsed-hidden{display:none !important}.fxs-blade-shield-translucent{pointer-events:none}.fxs-blade-shield-translucent .fxs-progress-dots{display:none}.fxs-blade-content-container-default{width:100%;height:100%}.fxs-bladesize-small.fxs-blade-content-container-details{width:315px}.fxs-bladesize-small.fxs-blade-content{min-width:298px}.fxs-bladesize-medium.fxs-blade-content-container-details{width:585px}.fxs-bladesize-medium.fxs-blade-content{min-width:568px}.fxs-bladesize-large.fxs-blade-content-container-details,.fxs-bladesize-expandable.fxs-blade-content-container-details{width:855px}.fxs-bladesize-large.fxs-blade-content,.fxs-bladesize-expandable.fxs-blade-content{min-width:838px}.fxs-bladesize-xlarge.fxs-blade-content-container-details{width:1125px}.fxs-bladesize-xlarge.fxs-blade-content{min-width:1108px}.fxs-blade-has-activation .fxs-blade-content{min-width:auto}.fxs-menublade .fxs-blade-content-container-default{flex-shrink:0;width:265px}.fxs-menublade .fxs-blade-content-container-default .fxs-blade-content{min-width:248px}.fxs-menublade .fxs-blade-content-container-default.fxs-blade-unauthorized{width:100%}.fxs-menublade .fxs-blade-content-container-default.fxs-blade-collapsed{width:32px}.fxs-menublade .fxs-blade-content-container-default .fxs-blade-stacklayout{padding:0}.fxs-menublade .fxs-blade-disabled .fxs-blade-content-container-default{width:100%}.fxs-blade-firstblade .fxs-blade-content-container-default.fxs-blade-collapsed{width:32px}.fxs-blade-firstblade .fxs-blade-content-container-default,.fxs-blade-firstblade .fxs-blade-header,.fxs-blade-firstblade>.fxs-progress,.fxs-blade-firstblade>fxs-progress{border-left-width:0}.fxs-bladecontent-unlocked .fxs-lens-layout-flow{margin-right:-15px}.fxs-blade-collapser svg,.fxs-bladecontent-collapser svg{transform:rotate(270deg)}.fxs-blade-actions .fxs-blade-collapser>svg{height:8px;width:8px}.fxs-blade-collapse-veil,.fxs-blade-expander{height:100%;width:100%}.fxs-blade-collapse-veil svg,.fxs-blade-expander svg{transform:rotate(90deg);height:8px;width:8px}.fxs-bladecontent-collapser svg{height:8px;width:8px}.fxs-blade-collapse-veil svg{position:absolute;top:12px;right:12px}.fxs-menu-show-search~.fxs-blade-collapse-veil svg{top:15px}.fxs-bladecontent-collapser,.fxs-blade-expander,.fxs-blade-collapse-veil{display:none;position:absolute;cursor:pointer;padding:0;width:100%;border-width:0}.fxs-menublade .fxs-blade-content-container-default .fxs-bladecontent-collapser{display:block;top:0;right:0;width:24px;height:24px}.fxs-menublade .fxs-blade-content-container-default .fxs-menu-show-search .fxs-bladecontent-collapser{width:32px;height:32px;top:2px}.fxs-menublade .fxs-blade-content-container-default.fxs-blade-unauthorized .fxs-bladecontent-collapser,.fxs-menublade .fxs-blade-content-container-default.fxs-blade-collapsed .fxs-bladecontent-collapser{display:none}.fxs-blade-collapsed{width:32px}.fxs-blade-collapsed .fxs-blade-expander,.fxs-blade-collapsed .fxs-blade-collapse-veil{display:block}.fxs-blade-collapsed .fxs-blade-content-container-details,.fxs-blade-collapsed .fxs-blade-content-container-default,.fxs-blade-collapsed .fxs-blade-title-content{display:none}.fxs-blade-collapsed.fxs-blade-content-container-default>div{display:none}.fxs-contextpane .fxs-blade{max-width:100%}.fxs-contextpane .fxs-blade .fxs-blade-actions .fxs-blade-actiondropmenu{display:none}.fxs-contextpane .fxs-blade:not(.fxs-bladesize-contextpane-default) .fxs-blade-content-wrapper{overflow:auto}.fxs-contextpane .fxs-blade.fxs-bladesize-small{width:315px}.fxs-contextpane .fxs-blade.fxs-bladesize-medium{width:585px}.fxs-contextpane .fxs-blade.fxs-bladesize-large{width:855px}.fxs-contextpane .fxs-blade.fxs-bladesize-xlarge{width:1125px}.fxs-contextpane .fxs-blade.fxs-bladesize-contextpane-default{max-width:435px}.fxs-blade.fxs-bladesize-contextpane-default .fxs-blade-content{min-width:auto}.fxs-part-frame.fxs-blade-floated-frame{position:absolute;width:100%}.fxs-blade-known-menu.fxs-blade-initializing .fxs-blade-content-container-details{flex:1 1 auto;display:block;position:relative}.fxs-blade-known-menu.fxs-blade-initializing .fxs-blade-progress{display:none}.fxs-blade-known-menu.fxs-blade-initializing .fxs-blade-content-container-default .fxs-bladecontent-progress,.fxs-blade-known-menu.fxs-blade-initializing .fxs-blade-content-container-default .fxs-bladecontent-collapser{display:none}',moduleId:n.id}}));
define("MsPortalImpl/Widgets/Widgets.Blade",["require","exports","Weave/DirectMode","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/BladeWidthHelper","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Widgets/Widgets.BladeContent","MsPortalImpl/Interactions/Interactions.FocusHandler","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Interactions/Interactions.FullScreenMode","MsPortalImpl/Interactions/Interactions.PrintHandler","MsPortalImpl/Widgets/Widgets.UIElementBase","Viva.Controls/Util/Viva.Resize","MsPortalImpl/Base/Base.Timers","Fx/Weave/Components/LoadingIndicator","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Widgets/Widgets.BladeContent.Component","MsPortalImpl/Widgets/Widgets.Blade.Component","MsPortalImpl/Weave/Util","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Blade.css","MsPortalImpl/Services/Services.GeneralSettings","Weave"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it){"use strict";function gt(n){return ft.untitled.format(n)}function et(n){var t="";return n.forEach((function(n){n&&(t=t?ft.titleFormat.format(t,n):n)})),t}function ni(n,t){var u=new FxImpl.TriggerableLifetimeManager,r;return w.applyToElement({element:n[0],ltm:u,weaveNode:i(k.BladeInner,{vm:t}),weaveContext:{diContainer:t.diContainer},opName:"blade"}),r=new ot(n,t),r.ltm.registerForDispose(u),r}var yt,ot;Object.defineProperty(t,"__esModule",{value:!0});t.createBladeWidget=t.Widget=t.ViewModel=t.getDefaultTitle=t.widgetProperties=t.DisplayStateHelper=void 0;var pt=MsPortalFx.Base,rt=pt.Diagnostics.Telemetry,wt=MsPortalFx.Blades,bt=wt.Internal.DisplayState;g.injectCss(nt);var kt=window,ut=document,st=a.Widget.viewSettingsChanged,ht=u.getBladeWidthInfo(0).width,ct=u.getBladeWidthInfo(1).width,lt=ht,at=u.getBladeWidthInfo(51).width,dt=lt+at,vt=r.Controls.Container.preview.toUpperCase(),ft=r.Blade;t.DisplayStateHelper=[];t.DisplayStateHelper[1]={css:""};t.DisplayStateHelper[2]={css:"fxs-blade-maximized"};t.widgetProperties={title:"title",subtitle:"subtitle",titleSuffix:"menuContent.title",subtitleSuffix:"menuContent.subtitle",description:"description",helpUri:"helpUri",icon:"icon",showBladeIcon:"showBladeIcon",titleImageUri:"titleImageUri",contentState:"contentState",contentStateDisplayText:"contentStateDisplayText"};t.getDefaultTitle=gt;yt=(function(n){function t(t,i,r,u){var f=n.call(this,t)||this,s,e;return f.diContainer=i,f.close=$.noop,f.closed=$.noop,f.pinblade=$.noop,f.editblade=$.noop,f.title=it.makeWritableComputation(),f.titleMain=it.makeWritableComputation(),f.titleExtras=it.makeWritableComputation(),f.crumb=ko.observable(),f.titleSuffix=ko.observable(),f.subtitle=it.makeWritableComputation(""),f.icon=it.makeWritableComputation(),f.titleImageUri=it.makeWritableComputation(),f.displayState=ko.observable(2),f.pinEnabled=it.makeWritableComputation(!1),f.editEnabled=it.makeWritableComputation(!1),f.editState=it.makeWritableComputation(!1),f.printEnabled=it.makeWritableComputation(!1),f.pinVisible=it.makeWritableComputation(!1),f.editVisible=it.makeWritableComputation(!1),f.customHome=!1,f.collapseVisible=it.makeWritableComputation(!1),f.collapsed=it.makeWritableComputation(!1),f.loaded=ko.observable(!1),f.shieldType=ko.observable(),f.isUiBlocked=ko.observable(!1),f.showBladeIcon=it.makeWritableComputation(!1),f.associatedWithAsset=ko.observable(!1),f.showPreviewTag=ko.observable(!1),f.isMenuBlade=ko.observable(!1),f.isDefaultItemSelected=ko.observable(!0),f.useActivationStyle=!1,f.showTranslucentSpinner=it.makeWritableComputation(!1),f.asSubJourney=!1,f.directoryInfo=it.makeWritableComputation(),f.deepLink=ko.observable("#"),f.showTitleImage=it.makeIndirectComputation(!1),f.hideCloseButton=it.makeWritableComputation(!1),f.isHelpBlade=!1,f.bladeName=u||{name:t,extensionName:null},s=f.defaultContent=new o.ViewModel(t,{diContainer:i,loaded:f.loaded,disabled:f.disabled,displayState:f.displayState,shieldType:f.shieldType,isUiBlocked:f.isUiBlocked},f.bladeName),r&&(e=r.DisplayState,bt[e]&&f.displayState(e)),f.fullScreenModeEnabled=i.get(c.FullScreenMode).isActive,s.applyViewSettings(r),f}return __extends(t,n),t.prototype.getTelemetryName=function(){return["Extension",this.bladeName.extensionName,"Blade",this.bladeName.name].join("/")},t})(a.ViewModel);t.ViewModel=yt;ot=(function(n){function r(t,i){var r=n.call(this,t,i)||this,e,u,f;return r._detailContent=[],t.addClass("fxs-blade-initializing").addClass("fxs-blade").addClass("msportalfx-shadow-level3").addClass("fxs-portal-bg-txt-br"),e=t.findByClassName("fxs-blade-content-container-default"),u=r._defaultContent=new o.Widget(e,i.defaultContent),u.initializeStyleReactor(),v.track(r.ltm,r.element,(function(){return r._relayoutChildren()}),{ignoreInitialState:!0}),i.displayState.subscribeAndRun(r.ltm,(function(){r.refreshDisplayState()})),i.defaultContent.locked.subscribeAndRun(r.ltm,(function(n){i.locked(n)})),r.ltm.registerForDispose(u),r._accessibility(),r._attachEventHandlers(),r._setupDefaultReactors(i),e.trigger(st,u.saveViewSettings()),r.options.displayState.subscribeAndRun(r.ltm,(function(){r.trigger("fxbladerepos")})),r._setupLoadingReactor=function(){var n=r.getContentWidget();f&&f.dispose();f=r.ltm.createChildLifetime();ko.computed(f,[r.options.loaded,n.options.showLoadingIndicator,n.options.shieldType,],(function(n,t,i){r.element.toggleClass("fxs-blade-hide-translucent",(!n||t)&&i!==1)}))},r._setupLoadingReactor(),r}return __extends(r,n),r.prototype.dispose=function(){var i=this._defaultContent;this._cleanElementClasses(["fxs-blade","fxs-portal-bg-txt-br","fxs-menublade","fxs-blade-initializing",u.allWidthClasses,o.combineAllCssClasses(t.DisplayStateHelper),i.bladeStyleClass,"fxs-display-none","fxs-blade-collapsed","fxs-blade-firstblade","msportalfx-shadow-level3","fxs-blade-lastblade","fxs-blade-hide-translucent",]);this.trigger("fxloadingontopbar",{id:this.options.id,cancel:!0});n.prototype.dispose.call(this)},r.prototype.refreshDisplayState=function(){this.element.trigger(st,this._defaultContent.saveViewSettings())},r.prototype.initializeLayout=function(n){var o=this,u=this.element,f,e,t,r;u.removeClass("fxs-blade-initializing");n&&(f=this.element.hasClass("fxs-menublade"),n.callback&&n.callback(u),e=!f&&this.element.hasClass("fxs-menublade"),e&&v.track(this.ltm,this._defaultContent.element,(function(){return o._relayoutChildren()}),{ignoreInitialState:!0}),n.setPlaceholderDetailContent&&(t=u.findByClassName("fxs-blade-content-container-details-primary").addClass("fxs-bladecontent fxs-blade-color-locked"),r=this._childLifetime.createChildLifetime(),r.registerForDispose((function(){return t.removeClass("fxs-bladecontent fxs-blade-color-locked")})),w.applyToElement({element:t[0],ltm:r,weaveNode:i(p.LoadingIndicator,{className:"fxs-bladecontent-progress fxs-portal-background"}),weaveContext:{diContainer:this.options.diContainer}}),this._detailContent.push({container:t,widget:null,lifetime:r,bindingLifetime:null})))},r.prototype.resetInternalState=function(){this._$lastFocused=null;this._$lastFocusedChain=null},r.prototype._openBladeContent=function(n,t){return w.applyToElement({element:n.container[0],ltm:n.lifetime,weaveNode:i(b.BladeContentInner,{vm:t}),weaveContext:{diContainer:t.diContainer},opName:"openBladeContent"}),n.widget=new o.Widget(n.container,t),n.widget.initializeStyleReactor(),n.lifetime.registerForDispose(n.widget),n.lifetime.registerForDispose((function(){n.widget=null})),n.bindingLifetime=n.lifetime.createChildLifetime(),this._setupDetailReactors(n.bindingLifetime,this.options,t,this._detailContent.length>1),n.widget},r.prototype.focusSearchBox=function(){this.element.find(".fxc-search input").first().focus()},r.prototype.getContentWidget=function(){var n=MsPortalFx.last(this._detailContent);return n&&n.widget||this._defaultContent},r.prototype.setDetailContent=function(n){var t,i;return this._detailContent.length?(t=this._detailContent[0],t.lifetime.dispose()):(t={lifetime:undefined,bindingLifetime:undefined,container:this.element.findByClassName("fxs-blade-content-container-details-primary"),widget:undefined},this._detailContent.push(t)),t.lifetime=this._childLifetime.createChildLifetime(),i=this._openBladeContent(t,n),this.trigger("fxbladerepos"),this._setupLoadingReactor(),i},r.prototype.openBladeInPlace=function(n,t){var i=this,u=MsPortalFx.last(this._detailContent),r,o;u&&(u.container.addClass("fxs-display-none"),u.bindingLifetime&&u.bindingLifetime.dispose());var f=n.createChildLifetime(),s=this.element.findByClassName("fxs-blade-content-container"),e=$(FxImpl.createElement("div",{"class":"fxs-blade-content-container-details fxs-blade-border fxs-portal-border"}));return s.append(e),r={container:e,lifetime:f,bindingLifetime:null,widget:null},this._detailContent.push(r),f.registerForDispose((function(){r.container.remove();MsPortalFx.remove(i._detailContent,r);var n=MsPortalFx.last(i._detailContent);n&&n.widget&&(n.container.removeClass("fxs-display-none"),n.bindingLifetime=n.lifetime.createChildLifetime(),i._setupDetailReactors(n.bindingLifetime,i.options,n.widget.options));i.trigger("fxbreadcrumbupdate")})),o=this._openBladeContent(r,t),this.trigger("fxbreadcrumbupdate"),o},r.prototype.clearDetailContent=function(n){this._setupDefaultReactors(this.options);var t=this._detailContent[0];t&&t.lifetime&&t.lifetime.dispose();this._detailContent=[];this.initializeLayout(n)},r.prototype.close=function(n){var i=a.Widget.getId(this.element),t={id:i,completed:n},r=this.trigger("close",t);r&&this.trigger("closed",t)},r.prototype.minimize=function(){var n=a.Widget.getId(this.element);this.trigger("minimized",{id:n})},r.prototype.setFocus=function(){var i=this,t,n;e.isAndroidOrMobile?this.element.findByClassName("fxs-blade-close").focus():(t=ut.activeElement,t&&$.contains(this.element[0],t)||(n=void 0,this._$lastFocused&&$.contains(this.element[0],this._$lastFocused[0])&&f.isVisible(this._$lastFocused)&&(this._$lastFocused.focus(),n=!0),!n&&this._$lastFocusedChain&&(n=this._$lastFocusedChain.some((function(n){return n.length&&$.contains(i.element[0],n[0])&&f.isVisible(n)?(s.setFocusOnContainer(n[0],null),$.contains(i.element[0],ut.activeElement)):!1}))),n||this.getContentWidget().setFocus()))},r.prototype.idealWidth=function(n){var e=this.element.hasClass("fxs-menublade"),i=this._defaultContent,o=i.element.hasClass("fxs-blade-collapsed"),f=32,r,t;return n?this.options.collapsed.value?f:e?o?f+ht:dt:lt:(r=this.getContentWidget(),t=u.getBladeWidthInfo(r.options.bladeWidth()).width,e?i.options.noticeTmplVm.value||i.options.errorTmplVm.value||this.options.disabled()?u.getBladeWidthInfo(2).width:(r===i?t=r.element.siblings().hasClass("fxs-bladecontent")||this.element.hasClass("fxs-blade-initializing")?ct:0:tt.isFocusNavigationEnabled(this.options.diContainer)&&(t=ct),t+(o?f:at)):t)},r.prototype.setContextPaneWidth=function(n){this.element.removeClass(u.contextPaneDefaultSizeClass+" "+u.allWidthClasses);MsPortalFx.isNullOrUndefined(n)?this.element.addClass(u.contextPaneDefaultSizeClass):(this.getContentWidget().options.bladeWidth(n),this.element.addClass(u.getBladeWidthInfo(n).css))},r.prototype.isMenuBladeLoadingDetailBlade=function(){return this.element.hasClass("fxs-menublade")&&this.getContentWidget()===this._defaultContent&&!this._defaultContent.options.noticeTmplVm.value&&!this._defaultContent.options.errorTmplVm.value&&!this.options.disabled()&&this._defaultContent.element.siblings().hasClass("fxs-bladecontent")},r.prototype._setupDefaultReactors=function(n){var i=this._resetChildLifetime(),t;i&&(t=n.defaultContent,ko.reactor(i,(function(){var i=t.title();n.title(i);n.crumb(i);n.titleMain(i)})),ko.reactor(i,(function(){var i=[t.subtitle()];n.showPreviewTag()&&i.push(vt);n.subtitle(et(i))})),ko.reactor(i,(function(){n.icon(t.icon());n.showBladeIcon(t.isV2Blade()?t.hasIcon():n.associatedWithAsset())})),n.showTitleImage.reseat(it.composeComputation([t.bladeStyle,n.titleImageUri,],(function(n,t){return n===2&&!!$.trim(t)}))))},r.prototype._setupDetailReactors=function(n,t,i,r){if(n){var u=t.defaultContent;ko.reactor(n,(function(){var f=r?[u.title(),i.title()]:[u.title(),t.titleSuffix(),i.titleSuffix()],n=et(f);t.title(n);r||t.crumb(u.title());t.titleMain(u.title());t.titleExtras(n.replace(u.title(),""))}));ko.reactor(n,(function(){var n=[u.subtitle(),i.subtitleSuffix()];t.showPreviewTag()&&n.push(vt);t.subtitle(et(n))}));ko.reactor(n,(function(){var n=i.hasIcon()?i:u;t.icon(n.icon());t.showBladeIcon(n.isV2Blade()?n.hasIcon():t.associatedWithAsset())}));t.showTitleImage.reseat(it.composeComputation([i.bladeStyle,t.titleImageUri,],(function(n,t){return n===2&&!!$.trim(t)})))}},r.prototype._resetChildLifetime=function(){if(this.ltm)return MsPortalFx.disposeDisposable(this._childLifetime),this._childLifetime=this.ltm.createChildLifetime()},r.prototype._accessibility=function(){var i=this.element.findByClassName("fxs-blade-title-titleText"),n=MsPortalFx.getUniqueId(),t;i.attr("aria-describedby",n);this.element.findByClassName("fxs-blade-title-subtitleText").attr("id",n);t=MsPortalFx.getUniqueId();i.attr("id",t);this.element.attr("aria-labelledby",t+" "+n);this.element.findByClassName("fxs-blade-header").attr("aria-labelledby",t+" "+n)},r.prototype._attachEventHandlers=function(){var n=this,t=this.element,i=function(){return n.options.getTelemetryName()},r;t.findByClassName("fxs-blade-close").on("click",(function(t){rt.trace({source:i(),action:"CommandExecuted",name:"fxs-blade-close"});t.preventDefault();n.close(!1)}));t.findByClassName("fxs-blade-fullscreen").on("click",(function(){rt.trace({source:i(),action:"CommandExecuted",name:"fxs-blade-fullscreen"});n.options.diContainer.get(c.FullScreenMode).toggle()}));t.findByClassName("fxs-blade-minimize").on("click",(function(t){rt.trace({source:i(),action:"CommandExecuted",name:"fxs-blade-minimize"});t.preventDefault();n.minimize()}));t.findByClassName("fxs-blade-pin").on("click",(function(){return rt.trace({source:i(),action:"CommandExecuted",name:"fxs-blade-pin"}),n.options.pinblade(null),!1}));t.findByClassName("fxs-blade-edit").on("click",(function(){return rt.trace({source:i(),action:"CommandExecuted",name:"fxs-blade-edit"}),n.options.editblade(null),!1}));t.findByClassName("fxs-blade-copyname").on("click",(function(){var u,r,f,e;rt.trace({source:i(),action:"CommandExecuted",name:"fxs-blade-copyname"});u=ut.createRange();u.selectNodeContents(t.findByClassName("fxs-blade-title-titleText")[0]);r=kt.getSelection();r.removeAllRanges();r.addRange(u);ut.execCommand("copy");r.removeAllRanges();f=n.ltm.createChildLifetime();e=new h.PortalReader(f);e.read(ft.copyAriaResult);f.dispose()}));t.findByClassName("fxs-blade-print").on("click",(function(){var r,u,f;rt.trace({source:i(),action:"CommandExecuted",name:"fxs-blade-print"});r=t.findByClassName("fxs-part-reactframe")[0];r?(u=r.getAttribute("data-react-id"),f=parent.window.frames[u],f.contentWindow.postMessage({signature:"Az",kind:3036,data:n.options.isMenuBlade()?{titleMain:n.options.titleMain.value,titleExtras:n.options.titleExtras.value,subtitle:n.options.subtitle.value}:null},"*")):n.options.diContainer.get(l.PrintHandler).printBlade(t[0],{name:n.getContentWidget().options.getTelemetryName(),source:"BladeCommand",menuBladeCtx:n.options.isMenuBlade.peek()?i():null})}));r=y.throttle(this.ltm,(function(t){for(var i=n._$lastFocused=$(t.target),r=n._$lastFocusedChain=[];i.length;)if(i=i.parent().closest(".azc-control, .fxs-tile, .fxs-commandBar, .fxs-commandBar-item-expandList, .fxs-commandBar-item",n.element[0]),i.length)r.push(i);else break}));this.ltm.registerForDispose(t.setEvents(["focusout",r],["click",".fxs-blade-collapser, .fxs-blade-expander, .fxs-blade-collapse-veil",function(t){var r=n.options.collapsed.value;n.options.collapsed(!r);n.trigger("fxbladerepos",{noScroll:!0});d.tryFocusAfterChangePropagation(n.element.findByClassName(r?"fxs-blade-collapser":"fxs-blade-expander")[0]);t.stopPropagation();rt.trace({source:i(),action:"BladeCollapse",actionModifier:r?"Expand":"Collapse",name:"fxs-blade-expandcollapse"})}],["fxupdatelastfocus",function(t){n._$lastFocused=t.$lastFocused}]));it.subscribeAndRun(this.ltm,[this.options.collapsed],(function(t){n.element.toggleClass("fxs-blade-collapsed",t)}))},r.prototype.goToDefaultItem=function(){this.options.isMenuBlade()?this.trigger("fxgotodefaultitem"):this.goToFirstDetailContent()},r.prototype.goToFirstDetailContent=function(){var n=this._detailContent[0];n&&n.widget&&this.goToDetailContent(n.widget.options.id)},r.prototype.goToDetailContent=function(n){for(var u,i=this._detailContent.length,r=i,t=0;t<i;++t)if(u=this._detailContent[t],u.widget&&u.widget.options.id===n){r=t;break}for(t=i-1;t>r;--t)this._detailContent[t].lifetime.dispose();return r!==i},r.prototype.getBreadCrumbs=function(){return[{bladeId:this.options.id,bladeTitle:this.options.crumb,bladeTitleResolved:this._defaultContent.titleResolved,isCustomHome:this.options.customHome,deepLink:this.options.deepLink,isDefaultItemSelected:this.options.isDefaultItemSelected}].concat(this._detailContent.filter((function(n,t){return t&&n.widget})).map((function(n){return{bladeId:n.widget.options.id,bladeTitle:n.widget.options.title,bladeTitleResolved:n.widget.titleResolved,isCustomHome:!1,deepLink:ko.observable("#"),isDefaultItemSelected:ko.observable(!0)}})))},r.prototype.setupAsKnownMenuBlade=function(){if(this.element.hasClass("fxs-blade-initializing")){this.element.addClass("fxs-blade-known-menu fxs-menublade");var n=this.element.findByClassName("fxs-blade-content-container-details").empty();n.append(FxImpl.createElement("fxs-progress"));ko.applyBindingsToDescendants({},n[0])}},r.prototype._relayoutChildren=function(){this._defaultContent.childRelayout();this._detailContent.forEach((function(n){n.widget&&n.widget.childRelayout()}))},r})(a.Widget);t.Widget=ot;t.createBladeWidget=ni}))