define("MsPortalImpl.Controls/Fields/CustomHtmlField",["require","exports","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl.Controls/Fields/Base/LabelAndBalloonWidget","MsPortalImpl.Controls/Controls/Base/Loadable","FxInternal/Css","_generated/Less/MsPortalImpl/CssLibrary/CustomForm.css","Fx/Controls/CustomHtml"],(function(n,t,i,r,u,f,e,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.createVm=void 0;f.injectCss(e);Object.defineProperty(t,"createVm",{enumerable:!0,get:function(){return o.create}});var s="msportalfx-form-formelement",h="msportalfx-customHtml",c=(function(n){function t(t,i,u){var f=n.call(this,t,i,u)||this,e;return f._vms=ko.observableArray(),f.element.addClass(h).addClass(s),f._htmlContentDiv=$(FxImpl.createElement("div",{"class":"azc-formElementContainer","data-bind":"untrustedHtml: { html: htmlTemplate, data: innerViewModel, isolated: isolated }"})),e=new r.LabelAndBalloonWidgetHelper(f._diContainer,f.ltm,MsPortalFx.extend({infoBalloonTabbable:!0},i)),e.appendWidgetToDom(f.element,f._htmlContentDiv),e.attachSubLabelClass(f.element),e.attachKeyboardEvents(f.element),e.insertLabelBefore(f._htmlContentDiv),e.insertSubLabelAfter(f._htmlContentDiv),f._bindElement(i,f._htmlContentDiv),f._updateTemplate(),f.options.htmlTemplate.subscribe(f.ltm,(function(){f._updateTemplate()})),f}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement("msportalfx-form-formelement","msportalfx-customHtml");this._htmlContentDiv&&(this._cleanDescendants(),this._htmlContentDiv.remove(),this._htmlContentDiv=null);n.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),t.prototype._updateTemplate=function(){var n=this,t=i.gatherFormFields(this._htmlContentDiv,!0).map((function(n){return n.viewmodel}));this._vms(t);this._vmsLifetimeManager&&this._vmsLifetimeManager.dispose();this._vmsLifetimeManager=this.ltm.createChildLifetime();ko.reactor(this._vmsLifetimeManager,(function(){var t=n._vms();n.options.dirty(t.some((function(n){return n&&n.dirty&&n.dirty()})))}));ko.reactor(this._vmsLifetimeManager,(function(){var t=n._vms();n.options._msPortalFxRequired(t.some((function(n){return n&&n._msPortalFxRequired&&n._msPortalFxRequired()})))}));ko.reactor(this._vmsLifetimeManager,(function(){var t=i.gatherFormFields(n._htmlContentDiv,!0).map((function(n){return n.viewmodel}));n.options.valid(t.every((function(n){return n&&n.valid?n.valid():!0})))}));this.options._msPortalFxClearValidation((function(){var t=[];return n._vms().forEach((function(n){if(typeof n.clearValidation=="function"){var i=n.clearValidation();i&&t.push(i)}})),Q.all(t)}));this.options._msPortalFxTriggerValidation((function(){var t=n._vms().map((function(n){if(typeof n.triggerValidation=="function")return n.triggerValidation()})).filter(MsPortalFx.identity);return Q.all(t).then((function(n){return n.every(MsPortalFx.identity)}))}))},t})(u.Widget);t.Widget=c}))