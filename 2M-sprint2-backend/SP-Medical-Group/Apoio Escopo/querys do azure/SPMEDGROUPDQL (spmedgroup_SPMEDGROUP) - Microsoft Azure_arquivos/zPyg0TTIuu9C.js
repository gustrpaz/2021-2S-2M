define("MsPortalImpl/UI/UI.BladeOpenerImpl",["require","exports","Fx/DependencyInjection","Fx/Composition/Selectable","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase"],(function(n,t,i,r,u,f,e,o,s){"use strict";function v(n){var t;return((t=FxImpl.shellInterface(n))===null||t===void 0?void 0:t.type)===21298}function y(n){return __awaiter(this,void 0,void 0,(function(){var u,i,t,r,f,o;return __generator(this,(function(s){switch(s.label){case 0:return(u=n.get(e.JourneyManager),i=u.activeJourney(),t=MsPortalFx.find(i===null||i===void 0?void 0:i.children,(function(n){return!!(~n.flags&1)}),-1),!t)?[3,4]:(r=!t.isComposed,!r)?[3,2]:[4,t.await(7)];case 1:r=s.sent();s.label=2;case 2:return r,f=t.children[0].children[0],[4,f.getViewModelAsync()];case 3:return o=s.sent(),[2,a(o.container)];case 4:return[2,n.get(h).selectable]}}))}))}function a(n){return n[l]}var c,h,l;Object.defineProperty(t,"__esModule",{value:!0});t.BladeOpener=void 0;c=(function(){function t(n){this._diContainer=n}return t.prototype.openBlade=function(n,t){return t===void 0&&(t={}),__awaiter(this,void 0,void 0,(function(){var r,u,i,e,o,f,s;return __generator(this,(function(h){switch(h.label){case 0:return(r=t.selectable,u=t.container,i=t.flags,e=t.selectedItem,o=t.telemetryName,f=MsPortalFx.getUniqueId(),!Q.isPromiseAlike(n))?[3,2]:(this.requestOpenBlade(r,u,{bladeReference:undefined,reason:4,flags:i,operationId:f}),[4,n]);case 1:n=h.sent();h.label=2;case 2:return[4,this.requestOpenBlade(r,u,{bladeReference:n,reason:3,operationId:f,flags:MsPortalFx.isNullOrUndefined(i)?2:i,selectedItem:e,telemetryName:o})];case 3:return s=h.sent(),[2,s.success]}}))}))},t.prototype.requestOpenBlade=function(n,t,i){return __awaiter(this,void 0,void 0,(function(){var r,f;return __generator(this,(function(e){switch(e.label){case 0:return(!n&&t&&(n=a(t)),!(i.flags&8))?[3,1]:(r=this._diContainer.get(h),n=i.flags&32?r.helpPane:r.selectable,[3,3]);case 1:return(!n||i.flags&16&&~i.flags&4)?[4,y(this._diContainer)]:[3,3];case 2:n=e.sent();e.label=3;case 3:return f=v(n)?u.getOrCreate(this._diContainer,n):n,[4,f.processRequest(i)];case 4:return[2,e.sent()]}}))}))},__decorate([__metadata("fx:diagnostics",[n,"BladeOpener"]),i.Class(),__metadata("design:paramtypes",[i.Container])],t)})();t.BladeOpener=c;h=(function(){function t(n,t){this._diContainer=n;this._viewModel={selectable:new r.Selectable2({supplyBladeReferenceAsync:MsPortalFx.noop}),helpPane:new r.Selectable2({supplyBladeReferenceAsync:MsPortalFx.noop}),internal:{selectable:ko.observable()}};var i=n.createChildContainer("composition");i.set(s.OpenerConfiguration,{masterModel:this._viewModel,masterModelId:"UI.BladeOpener",referenceComposition:null,referenceExtension:t.locate(f.Locator.forExtension("HubsExtension")),isBladeOpenedByMaster:function(){return!0},configureBladeDescriptor:MsPortalFx.noop});this._opener=i.get(o.BladeOpener);this._createSelectable("selectable");this._createSelectable("helpPane")}return t.prototype._createSelectable=function(n){this[n]=u.getOrCreate(this._diContainer,this._viewModel[n]);this._opener.registerInvocationProperty({invocationInputArguments:[{valuesFrom:[{referenceType:0,property:n}]}]})},__decorate([__metadata("fx:diagnostics",[n,"SelectableContainer"]),i.Class(),__metadata("design:paramtypes",[i.Container,f.DefinitionFinder])],t)})();l="_msPortalFxOpenBladeSelectable"}));
define("MsPortalImpl/UI/UI.CreateJourney",["require","exports","Fx/Composition/Selectable","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/UI/UI.BladeOpenerImpl"],(function(n,t,i,r,u){"use strict";function l(n,t,r){return __awaiter(this,void 0,void 0,(function(){var c,f,o,e,h;return __generator(this,(function(l){switch(l.label){case 0:c=s.startTrace({source:"Desktop",action:"JourneyOpened",name:"BladeLauncher",assetType:t.assetType});l.label=1;case 1:return(l.trys.push([1,,7,8]),f=t instanceof i.PdlBladeReference?t:undefined,o=!1,!!f)?[3,5]:(e=t,!r)?[3,3]:[4,a(n,e)];case 2:return f=l.sent(),[3,4];case 3:f=new FxImpl.Composition.Selectable.PdlBladeReference(t.detailBlade,e.extension,{parameters:e.detailBladeInputs,onClosed:e.onClosed});l.label=4;case 4:f.context=e.openedByContext;f.menuId=e.defaultMenuItemId;f.disableRebind=!0;o=e.openInContextPane;l.label=5;case 5:return h=8,h|=o&&1,[4,n.get(u.BladeOpener).openBlade(f,{flags:h})];case 6:return l.sent(),[3,8];case 7:return s.completeTrace(c),[7];case 8:return[2]}}))}))}function a(n,t){return __awaiter(this,void 0,void 0,(function(){function y(n){var t=n===null||n===void 0?void 0:n.data;return(n===null||n===void 0?void 0:n.status)||(n===null||n===void 0?void 0:n.httpStatusCode)||(t===null||t===void 0?void 0:t.status)||(t===null||t===void 0?void 0:t.httpStatusCode)}var a,v,f,p,w,u,s,o,b,l,k;return __generator(this,(function(d){switch(d.label){case 0:return d.trys.push([0,3,,4]),[4,n.get(r.AssetTypeService)];case 1:return a=d.sent(),[4,a.mapAssetIdToDynamicSelectionAndIcon({assetId:t.assetId,extensionName:t.extensionName,assetType:t.assetType},"AssetBladeLauncher")];case 2:if(v=d.sent(),f=v.selection,!f.detailBlade){p=a.getAssetType(t.extensionName,t.assetType);w=MsPortalFx.Errors.getErrorOptions("Blade name is missing for asset "+t.extensionName+":"+t.assetType,{data:{assetSelector:t,selectionAndIcon:v,assetTypeReturned:p}});throw new MsPortalFx.Errors.Error(w);}return[2,new i.PdlBladeReference(f.detailBlade,f.extension,{parameters:f.detailBladeInputs})];case 3:return u=d.sent(),u=u||new MsPortalFx.Errors.Error("Unknown error"),s=u.innerErrors&&u.innerErrors.first(),o=y(u)||y(s),b=u.message||s&&s.message||u,o!==0&&c.warning(b,1,u.data),l=e.UnavailableAssetBlade,k={id:typeof t.assetId=="string"?t.assetId:t.assetType},o===401||o===403?l=e.UnauthorizedAssetBlade:o===404&&(l=e.NotFoundAssetBlade),[2,new i.PdlBladeReference(l,h,{parameters:k})];case 4:return[2]}}))}))}Object.defineProperty(t,"__esModule",{value:!0});t.createJourney=void 0;var f=MsPortalFx.Base,o=f.Diagnostics,s=o.Telemetry,e=f.Constants.BladeNames.Hubs,h=f.Constants.ExtensionNames.Hubs,c=o.createLog(n);t.createJourney=l}))