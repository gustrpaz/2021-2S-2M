define("_generated/Less/MsPortalImpl/Widgets/Widgets.HoverCard.css",["module"],(function(n){"use strict";return{css:"@keyframes cardOpen{0%{opacity:0;transform:scale(.7)}100%{opacity:1;transform:scale(1)}}.fxs-hover-card-balloon{background-color:transparent;list-style-type:none;padding:0;margin:0}.fxs-hover-card-balloon .azc-balloon-pointer2{display:none}.fxs-hover-card-balloon.azc-balloon-hidden .fxs-hover-card{animation:none;display:none}.fxs-hover-card-balloon>.azc-balloon-content{padding:0;background-color:transparent;box-shadow:0 8px 16px 0 rgba(0,0,0,.28);animation-name:stretch;animation-duration:.2s;animation-timing-function:ease-out;animation-delay:0;animation-direction:alternate;animation-fill-mode:none;animation-play-state:running}@keyframes stretch{0%{transform:scale(.1);box-shadow:none}100%{transform:scale(1);box-shadow:0 8px 16px 0 rgba(0,0,0,.28)}}.fxs-hover-card-balloon.fxs-portal-bg-txt-br{background-color:transparent}.fxs-hover-card-balloon.azc-balloon-hidden .fxs-hover-card{animation:none;display:none}.fxs-hover-card-balloon>.azc-balloon-content{margin:0;background-color:transparent;box-shadow:0 8px 16px 0 rgba(0,0,0,.28);animation-name:stretch;animation-duration:.2s;animation-timing-function:ease-out;animation-delay:0;animation-fill-mode:none;animation-direction:alternate;animation-play-state:running}@keyframes stretch{0%{transform:scale(.1);box-shadow:none}100%{transform:scale(1);box-shadow:0 8px 16px 0 rgba(0,0,0,.28)}}.fxs-hover-card-container{font-family:az_ea_font,'Segoe UI',az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif;font-weight:400;border:1px solid #f3f2f1;font-size:13px;line-height:18px;color:inherit;width:320px;max-height:512px;overflow:hidden;cursor:default}.fxs-hover-card-header{display:flex;padding:0 0 10px}.fxs-hover-card-header .fxs-hover-card-h3 .fxs-hover-card-icon{float:left}.fxs-hover-card-favoriteicon{margin:0 0 auto auto;float:right;cursor:pointer}.fxs-hover-card-favoriteicon svg{height:14px;width:14px;opacity:.6;fill:#0078d4}.fxs-hover-card-favoriteicon:hover svg{opacity:1}.fxs-mode-dark .fxs-hover-card-favoriteicon svg{fill:#f2f2f2}.fxs-hover-card-icon{height:50px;width:50px;flex:0 0 auto;float:right;text-align:center;border:1px solid transparent;margin:0 20px 0 0;box-sizing:border-box}.fxs-hover-card-border{opacity:0;height:0;margin:0 20px;border-top:1px solid #f3f2f1}.fxs-hover-card{animation:cardExpand .467s ease 1500ms;animation-fill-mode:forwards;transition:opacity 1500ms cubic-bezier(.5,0,0,1) 3s;visibility:hidden;opacity:0;height:0;max-height:0;width:100%;overflow:hidden}@keyframes cardExpand{0%{opacity:0;height:0;max-height:0}99%{visibility:visible;opacity:1;height:100%;max-height:356px}100%{visibility:visible;opacity:1;height:100%;max-height:100%}}.fxs-hover-card-initial{padding:20px 20px 0 20px}.fxs-hover-card-additional{overflow-y:auto;max-height:376px;margin-top:-1px}.fxs-hover-card-padleftright{padding:0 20px}.fxs-hover-card-commands{position:relative;padding:0 0;display:flex;margin-bottom:10px}.fxs-hover-card-training-icon{padding:0 5px 0 0;min-width:24px;min-height:24px;height:24px;width:24px}.fxs-hover-card-training-item{display:flex;align-items:center;padding:5px 20px}.fxs-hover-card-padless-header{padding:10px 0 0 0;margin:0 20px;border-top:1px solid #f3f2f1}.fxs-hover-card-training-link{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-bottom:-3px}.fxs-hover-card-training-sub{line-height:17px;margin-top:-2px;display:flex}.fxs-hover-card-list{list-style-type:none;padding-left:0}.fxs-hover-card-title{font-weight:600;font-size:18px;line-height:20px;overflow:hidden;-webkit-line-clamp:2;-webkit-box-orient:vertical;max-height:41px;display:-webkit-box}.fxs-hover-card-heading{font-weight:600;font-size:14px;line-height:20px;margin:4px 0 4px 0}.fxs-hover-card-padbottom{padding-bottom:10px}.fxs-hover-card-section{padding:10px 0;margin:0 20px;border-top:1px solid #f3f2f1}.fxs-hover-card-description{display:block;display:-webkit-box;line-height:18px;max-height:90px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:5;-webkit-box-orient:vertical;max-width:263px}.fxs-hover-card-expanded-description{max-height:100%;overflow-y:auto;-webkit-line-clamp:initial;-webkit-box-orient:vertical}.fxs-hover-card-seemore-link{display:flex}.fxs-hover-card-see-more-less{padding-right:5px}.fxs-hover-card-expand-icon{cursor:pointer;background-color:transparent;border:0;margin:0;padding:0;height:10px;width:10px}.fxs-hover-card-icon-vertical-transform{transform:scale(-1,-1);padding-bottom:8px}.fxs-hover-card-resource-property{padding:5px 0}.fxs-hover-card-property-name{color:#605e5c}.fxs-hover-card-property-value{display:flex}.fxs-hover-card-no-border{border:0}",moduleId:n.id}}));
define("MsPortalImpl/Widgets/Widgets.HoverCard",["require","exports","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","Viva.Controls/Controls/Viva.Balloon","MsPortalImpl/UI/UI.PopupPositioningMethods","MsPortalImpl/UI/Hubs/UI.FavoritesManager","MsPortalImpl/Base/Base.KeyboardHelper","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.HoverCard.css","Weave"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function l(n,t){return!n||!t?!1:t===n||$.contains(n,t)}function y(n,t,i){MsPortalFx.Base.Diagnostics.Telemetry.trace({source:"HoverCard",name:t,action:n,actionModifier:"mark",data:i})}function b(n,t,i,r,u){if(u.get(FxImpl.Features).isEnabled("showhovercard")){var e=!1,f=new MsPortalFx.Base.Debouncer(function(n,i){return(n||[]).concat(i.filter((function(n){return l(t[0],n.currentTarget)})))},function(n){var t=MsPortalFx.last(n),i,u;return!n.length||t.type==="programmatic"?Q(null):(i=a(),u=i&&i.options.dockingElement[0],u&&i.ltm.isDisposed()&&(u=null),(t.type==="open"||$(t.currentTarget).is(":hover")||l(t.currentTarget,document.activeElement))&&!l(u,t.currentTarget)&&a(r(t)),Q(null))},500,!0),o=function(t){var i=a(),r=document.activeElement;if(i&&l(i.options.dockingElement[0],t))return i.options.focusContent.fxAwaitAndRun(n).then((function(){i.element.find("a").first().focus();a.fxOnce(n,(function(){$(r).focus()}))}));a(null);a.fxAwait(n).then((function(t){var i=document.activeElement;t&&t.options.focusContent.fxAwaitAndRun(n).then((function(){t.element.find("a").first().focus();a.fxOnce(n,(function(){$(i).focus()}))}))}));f.execute([$.Event("open",{currentTarget:t,target:t}),]);f.flush()};return n.registerForDispose(t.setEvents(["click",i,function(n){f.flush().then((function(){var i=$(n.target).parents("a")[0],t;(i||n.target.tagName.toLowerCase()==="a")&&(t=a(),t&&t.dispose(),e=!0)}))},],["mouseenter",i,function(n){$(n.currentTarget).find("[title]").each((function(n,t){$(t).attr("data-title",$(t).attr("title"));$(t).removeAttr("title")}));n.stopPropagation()},],["programmatic",i,function(n){f.execute([n])},],["mouseleave",i,function(n){e=!1;$(n.currentTarget).find("[data-title]").each((function(n,t){$(t).attr("title",$(t).attr("data-title"));$(t).removeAttr("data-title")}));n.stopPropagation()},],["mousemove",i,function(n){e||($(n.currentTarget).attr("aria-describedby","hoverCardDescriptionId"),f.execute([n]),n.stopPropagation())},],["keydown",i,function(n){$(n.currentTarget).attr("aria-describedby","hoverCardDescriptionId");n.keyCode===112&&(o(n.currentTarget),n.stopImmediatePropagation(),n.preventDefault())},])),o}return MsPortalFx.identity}function k(){var t="fxs-hover-cards-main-container",n=$.querySelectorAll("."+t);return(n===null||n===void 0?void 0:n.length)||(n=$(FxImpl.createElement("div",{"class":t})),$.querySelectorAll("body").append(n)),n}function d(n,t,i){var r=$.querySelectorAll(".fxs-hover-card-balloon[data-name='"+n+"']");return(r===null||r===void 0?void 0:r.length)||(r=$(FxImpl.createElement("div",{style:"display: none","class":"fxs-hover-card-balloon"})),r.attr("data-name",n),r.attr("data-source",t),i&&r.attr("data-assetid",i),k().append(r)),r}var v,p,w,a;Object.defineProperty(t,"__esModule",{value:!0});t.getBalloonElement=t.attach=t.Widget=t.ViewModel=t.logTelemetry=void 0;s.injectCss(h);v="fxs-home-hover-card";t.logTelemetry=y;p=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.positionHint=1,t.favoriteOnDismiss=!1,t}return __extends(t,n),t})(i.ViewModel);t.ViewModel=p;w=(function(n){function t(t,i,r){var u=n.call(this,t,i)||this;return u._diContainer=r,i.onFavoritesChange&&c.subscribeAndRun(u.ltm,[u._diContainer.get(e.FavoritesManager).favorites],(function(n){i.onFavoritesChange(n)})),i.widget=u,u.element.addClass(v),u._initializeBalloonWidget(),u}return __extends(t,n),t.prototype._initializeBalloonWidget=function(){var n=this,s=this.element,i=new u.ViewModel({ltm:this.ltm}),h={htmlTemplate:this.options.template,viewModel:this.options},e,t;i.visible(!0);i.closeOtherBalloons=!0;i.renderMode(0);i.positionHint=this.options.positionHint;i.box((function(){return f.getBox(n.options.dockingElement)}));i.content(h);e=new u.Widget(s,i,{isTrusted:!0},new u.WidgetUIState);t=new MsPortalFx.Base.Debouncer(function(t,i){return(t||[]).concat(i.filter((function(t){return l(s[0],t.currentTarget)||l(n.options.dockingElement[0],t.currentTarget)})))},function(t){if(!t.length)return Q(null);var i=MsPortalFx.last(t);return["focusout","mouseleave","mouseout"].includes(i.type)&&!l(e.element[0],document.activeElement)&&(n.ltm.isDisposed()||n.dispose()),Q(null)},500,!0);this.ltm.registerForDispose([e,function(){n.options.dockingElement[0].addEventListener("click",(function(t){l(n.element[0],t.currentTarget)&&(n.dispose(),t.stopPropagation())}),!0)},e.element.setEvents(["animationend",".fxs-hover-card",function(n){var o=$(window).height()+$(document).scrollTop(),t=e.element[0],i=f.getBox(t),r=i.top+i.height+30-o,u;i.height>150&&(u=f.getBox($(n.currentTarget).find(".fxs-hover-card-padless-header")[0]),e.element.find(".fxs-hover-card-border").css({width:u.width}).animate({opacity:1}));r>0&&$(t).animate({top:i.top-r+"px"});y("FullyRevealed",t.getAttribute("data-assetid")||t.getAttribute("data-name"),{hoverCardLocation:t.getAttribute("data-source")})},],["click",function(t){if(l(s[0],t.target)){var i=$(t.target).parents("a")[0];(i||t.target.tagName.toLowerCase()==="a")&&n.dispose();t.stopPropagation()}},],["mouseleave",function(n){t.execute([n]);n.stopPropagation()},],["focusout",function(n){t.execute([n]);n.stopPropagation()},],["mouseenter",function(n){t.execute([n]);n.stopPropagation()},],["focusin",function(n){t.execute([n]);n.stopPropagation()},],["keydown",function(t){(t.keyCode===27||t.keyCode===112)&&(n.dispose(),t.stopPropagation(),t.preventDefault());t.keyCode===32&&o.getModifierKeys(t)===4&&(n.options.setFavorite&&n.options.setFavorite(),t.stopPropagation(),t.preventDefault())},],["focusin",".fxs-hover-card-favoriteicon",function(t){var i=$(t.currentTarget).attr("aria-pressed")==="true";$(t.currentTarget).attr("aria-pressed",!i);t&&!l(e.element[0],t.relatedTarget)&&(n.options.dockingElement.blur(),$(t.relatedTarget).focus())},]),this.options.dockingElement.setEvents(["mouseleave",function(n){t.execute([n]);n.stopPropagation()},],["focusout",function(n){t.execute([n]);n.stopPropagation()},],["mouseenter",function(n){t.execute([n]);n.stopPropagation()},],["focusin",function(n){t.execute([n]);n.stopPropagation()},]),$(document).setEvents(["keydown",function(t){t.keyCode===27&&(n.dispose(),t.stopPropagation(),t.preventDefault());t.keyCode===32&&o.getModifierKeys(t)===4&&(n.options.setFavorite(),t.stopPropagation(),t.preventDefault())},]),]);new r.KeyboardNavigation(this.ltm,{element:this.element,tabTriggers:2})},t.prototype.dispose=function(){var t=this;l(this.options.dockingElement[0],document.activeElement)&&(this.options.dockingElement.findFirstTabbable().focus(),this.options.dockingElement.trigger("programmatic"),this.element.find(".fxs-hover-card-container").animate({height:0},501));this.element.removeAttr("tabindex");setTimeout((function(){n.prototype.dispose.call(t);t.options.favoriteOnDismiss&&t.options.updateFavorite&&t.options.updateFavorite();t.options.dockingElement.removeAttr("title");t._cleanElement();a(undefined)}),501)},t})(i.Widget);t.Widget=w;a=ko.observable();t.attach=b;t.getBalloonElement=d}))