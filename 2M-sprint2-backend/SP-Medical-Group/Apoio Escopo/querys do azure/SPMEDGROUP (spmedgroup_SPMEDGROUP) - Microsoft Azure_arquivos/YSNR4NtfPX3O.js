define("_generated/Less/MsPortalImpl.Controls/Fields/OAuthButton.css",["module"],(function(n){"use strict";return{css:"div.azc-oauthButton-invalid.azc-button{border:1px solid #a4262c}.azc-oAuthButton-hidden-textbox{display:none}",moduleId:n.id}}));
define("MsPortalImpl.Controls/Fields/OAuthButtonField",["require","exports","MsPortalImpl.Controls/Fields/Base/Field","MsPortalImpl/Commands/Commands.OAuthCommand","Viva.Controls/Controls/Forms/Viva.TextBox","Viva.Controls/Controls/Base/ValidationPlacements/Viva.DockedBalloon","Viva.Controls/Controls/Base/ValidationPlacements/Viva.Css","Viva.Controls/Controls/Forms/Viva.Button","FxInternal/Css","_generated/Less/MsPortalImpl.Controls/Fields/OAuthButton.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";s.injectCss(h);var c;return (function(t){var v=MsPortalFx.Base.Diagnostics,y=MsPortalFx.Base.Resources,p=MsPortalFx.isNullOrUndefined,w=window,h=v.createLog(n),c="azc-oauthButtonField",l="fxc-OAuthButtonField",a="azc-oauthButton-invalid",s="azc-oauthButton",b='<link rel="stylesheet" href="'+y.getContentUri("Content/Css/Stable/splashscreen.css")+'">',k=(function(n){function t(t,i,r){return n.call(this,t,i,r)||this}return __extends(t,n),t.prototype._initializeField=function(){n.prototype._initializeField.call(this);this.element.addClass(c+" "+l);this.buttonInit();this.textBoxInit()},t.prototype.dispose=function(){this._disposeGlobals();var t=this._buttonWidget,i=this._textBoxWidget;t&&t.dispose();i&&(i.dispose(),this._textBoxViewModel=null);this._cleanElement(c,l);n.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"validatableViewModel",{get:function(){return this._textBoxViewModel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"validatableWidget",{get:function(){return this._textBoxWidget},enumerable:!1,configurable:!0}),t.prototype._createLabelAndSubLabel=function(){this._attachLabelAndSubLabel({controlClassName:s});this._attachAriaBindings({controlClassName:s,ariaLabel:this.options.ariaLabel})},t.prototype.buttonInit=function(){var f=this,t=this.options,i=new o.ViewModel(this.vmBasicOption),u,n;i.click=function(){var n=f.options,i=f._getInvertedSplashScreen(),t=r.executeOAuthCommand(n.value,"",n.popupWidth(),n.popupHeight());if(t){try{t.document.write(""+b+i)}catch(u){h.warning("oauthChildWindow.document.write: "+u)}n.beforeRequest().then((function(){t.location.href=n.requestUrl();t.focus()}))}else h.error("failed to open oauth popup")};i.disabled=t.disabled;i.isDefault=t.primary;u=$(FxImpl.createElement("div"));u.addClass(s+" msportalfx-font-semibold").attr("aria-haspopup","dialog");this.appendControl(u);n=this._buttonWidget=new o.Widget(u,i);p(t.buttonText())?(n.element.text(t.label()),t.label.subscribe(this.ltm,(function(t){n.element.text()!==t&&n.element.text(t)}))):(n.element.text(t.buttonText()),t.buttonText.subscribe(this.ltm,(function(t){n.element.text()!==t&&n.element.text(t)})));this._addWidget(n)},t.prototype.textBoxInit=function(){var r=this,t=this._textBoxViewModel=new u.ViewModel(this.vmBasicOption),n=this.ltm,i;t.validationPlacements.push(new e.Css(n),new f.DockedBalloon(this._diContainer,n,f.DockedBalloon.defaultOptions));t.validators.filter(n,(function(n){return!n.valid()&&!!n.message()})).map(n,(function(n,t){return t.message()})).subscribeAndRun(n,(function(n){var t=r._container.find("."+s);n.length>0?t.addClass(a):t.removeClass(a)}));i=$(FxImpl.createElement("div"));i.addClass("azc-oAuthButton-hidden-textbox");this.appendControl(i);this.options.value.subscribeAndRun(n,(function(n){t.value()!==n&&t.value(n)}));this.linkValidatableControlViewModels();this._textBoxWidget=new u.Widget(i,t);this._addWidget(this._textBoxWidget);this.setupValidationBindings()},t.prototype._disposeGlobals=function(){delete w[r.oauthCallbackName]},t.prototype._getInvertedSplashScreen=function(){var n="outerHTML",t=".fxs-splashscreen",i="background-color",r="#2e80ab";return $($.querySelectorAll(t).prop(n)).removeAttr("style").find("svg").css("fill",r).end().find(t+"-loader-container>div").css(i,r).end().css(i,"#fff").prop(n)},t})(i.FieldWidget);t.Widget=k})(c||(c={})),c}))