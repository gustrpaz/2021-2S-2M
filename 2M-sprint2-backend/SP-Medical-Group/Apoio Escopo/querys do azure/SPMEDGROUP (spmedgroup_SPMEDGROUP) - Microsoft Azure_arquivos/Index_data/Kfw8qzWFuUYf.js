define("@fluentui/react-focus",["@uifabric/set-version","tslib","react","@uifabric/merge-styles","@uifabric/styling","@uifabric/utilities"],(function(n,t,i,r,u,f){return (function(){"use strict";function e(n){var i=s[n],t;return void 0!==i?i.exports:(t=s[n]={exports:{}},h[n](t,t.exports,e),t.exports)}var h={2840:function(n){n.exports=r},5978:function(t){t.exports=n},4204:function(n){n.exports=u},1867:function(n){n.exports=f},9297:function(n){n.exports=i},4780:function(n){n.exports=t}},s={},o;return e.d=function(n,t){for(var i in t)e.o(t,i)&&!e.o(n,i)&&Object.defineProperty(n,i,{enumerable:!0,get:t[i]})},e.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},e.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})},o={},(function(){e.r(o);e.d(o,{FocusZone:function(){return nt},FocusZoneDirection:function(){return t},FocusZoneTabbableElements:function(){return l}});e(5978).setVersion("@fluentui/react-focus","7.17.5");var t,b=e(4780),c=e(9297),k=e(2840),d=e(4204),n=e(1867),l={none:0,all:1,inputOnly:2};!(function(n){n[n.vertical=0]="vertical";n[n.horizontal=1]="horizontal";n[n.bidirectional=2]="bidirectional";n[n.domOrder=3]="domOrder"})(t||(t={}));var a,h="data-is-focusable",v="data-focuszone-id",i="tabindex",y="data-no-vertical-wrap",p="data-no-horizontal-wrap",w=999999999,f=-999999999,s={},u=new Set,g=["text","number","password","email","tel","url","search"],r=!1,nt=(function(e){function o(i){var u=e.call(this,i)||this;return u._root=c.createRef(),u._mergedRef=n.createMergedRef(),u._onFocus=function(t){var f,o,h;if(!u._portalContainsElement(t.target)){var i,e=u.props,c=e.onActiveElementChanged,y=e.doNotAllowFocusEventToPropagate,p=e.stopFocusPropagation,l=e.onFocusNotification,a=e.onFocus,w=e.shouldFocusInnerElementWhenReceivedFocus,s=e.defaultTabbableElement,v=u._isImmediateDescendantOfZone(t.target);if(v)i=t.target;else for(f=t.target;f&&f!==u._root.current;){if(n.isElementTabbable(f)&&u._isImmediateDescendantOfZone(f)){i=f;break}f=n.getParent(f,r)}w&&t.target===u._root.current&&(o=s&&"function"==typeof s&&s(u._root.current),o&&n.isElementTabbable(o)?(i=o,o.focus()):(u.focus(!0),u._activeElement&&(i=null)));h=!u._activeElement;i&&i!==u._activeElement&&((v||h)&&u._setFocusAlignment(i,!0,!0),u._activeElement=i,h&&u._updateTabIndexes());c&&c(u._activeElement,t);(p||y)&&t.stopPropagation();a?a(t):l&&l()}},u._onBlur=function(){u._setParkedFocus(!1)},u._onMouseDown=function(t){if(!u._portalContainsElement(t.target)&&!u.props.disabled){for(var i=t.target,f=[];i&&i!==u._root.current;)f.push(i),i=n.getParent(i,r);for(;f.length&&((i=f.pop())&&n.isElementTabbable(i)&&u._setActiveElement(i,!0),!n.isElementFocusZone(i)););}},u._onKeyDown=function(i,r){var o,s,h,y;if(!u._portalContainsElement(i.target)){var f=u.props,e=f.direction,w=f.disabled,c=f.isInnerZoneKeystroke,a=f.pagingSupportDisabled,v=f.shouldEnterInnerZone;if(!(w||(u.props.onKeyDown&&u.props.onKeyDown(i),i.isDefaultPrevented()||u._getDocument().activeElement===u._root.current&&u._isInnerZone))){if((v&&v(i)||c&&c(i))&&u._isImmediateDescendantOfZone(i.target))if(o=u._getFirstInnerZone(),o){if(!o.focus(!0))return}else{if(!n.isElementFocusSubZone(i.target))return;if(!u.focusElement(n.getNextElement(i.target,i.target.firstChild,!0)))return}else{if(i.altKey)return;switch(i.which){case n.KeyCodes.space:if(u._tryInvokeClickForFocusable(i.target))break;return;case n.KeyCodes.left:if(e!==t.vertical&&(u._preventDefaultWhenHandled(i),u._moveFocusLeft(r)))break;return;case n.KeyCodes.right:if(e!==t.vertical&&(u._preventDefaultWhenHandled(i),u._moveFocusRight(r)))break;return;case n.KeyCodes.up:if(e!==t.horizontal&&(u._preventDefaultWhenHandled(i),u._moveFocusUp()))break;return;case n.KeyCodes.down:if(e!==t.horizontal&&(u._preventDefaultWhenHandled(i),u._moveFocusDown()))break;return;case n.KeyCodes.pageDown:if(!a&&u._moveFocusPaging(!0))break;return;case n.KeyCodes.pageUp:if(!a&&u._moveFocusPaging(!1))break;return;case n.KeyCodes.tab:if(u.props.allowTabKey||u.props.handleTabKey===l.all||u.props.handleTabKey===l.inputOnly&&u._isElementInput(i.target)){if(s=!1,u._processingTabKey=!0,s=e!==t.vertical&&u._shouldWrapFocus(u._activeElement,p)?(n.getRTL(r)?!i.shiftKey:i.shiftKey)?u._moveFocusLeft(r):u._moveFocusRight(r):i.shiftKey?u._moveFocusUp():u._moveFocusDown(),u._processingTabKey=!1,s)break;u.props.shouldResetActiveElementWhenTabFromZone&&(u._activeElement=null)}return;case n.KeyCodes.home:if(u._isContentEditableElement(i.target)||u._isElementInput(i.target)&&!u._shouldInputLoseFocus(i.target,!1))return!1;if(h=u._root.current&&u._root.current.firstChild,u._root.current&&h&&u.focusElement(n.getNextElement(u._root.current,h,!0)))break;return;case n.KeyCodes.end:if(u._isContentEditableElement(i.target)||u._isElementInput(i.target)&&!u._shouldInputLoseFocus(i.target,!0))return!1;if(y=u._root.current&&u._root.current.lastChild,u._root.current&&u.focusElement(n.getPreviousElement(u._root.current,y,!0,!0,!0)))break;return;case n.KeyCodes.enter:if(u._tryInvokeClickForFocusable(i.target))break;return;default:return}}i.preventDefault();i.stopPropagation()}}},u._getHorizontalDistanceFromCenter=function(n,t,i){var r=u._focusAlignment.left||u._focusAlignment.x||0,e=Math.floor(i.top),o=Math.floor(t.bottom),s=Math.floor(i.bottom),h=Math.floor(t.top);return n&&e>o||!n&&s<h?r>=i.left&&r<=i.left+i.width?0:Math.abs(i.left+i.width/2-r):u._shouldWrapFocus(u._activeElement,y)?w:f},n.initializeComponentRef(u),u._id=n.getId("FocusZone"),u._focusAlignment={left:0,top:0},u._processingTabKey=!1,u}return b.__extends(o,e),o.getOuterZones=function(){return u.size},o._onKeyDownCapture=function(t){t.which===n.KeyCodes.tab&&u.forEach((function(n){return n._updateTabIndexes()}))},o.prototype.componentDidMount=function(){var i=this._root.current,t;if(s[this._id]=this,i){for(this._windowElement=n.getWindow(i),t=n.getParent(i,r);t&&t!==this._getDocument().body&&1===t.nodeType;){if(n.isElementFocusZone(t)){this._isInnerZone=!0;break}t=n.getParent(t,r)}this._isInnerZone||(u.add(this),this._windowElement&&1===u.size&&this._windowElement.addEventListener("keydown",o._onKeyDownCapture,!0));this._root.current&&this._root.current.addEventListener("blur",this._onBlur,!0);this._updateTabIndexes();this.props.defaultTabbableElement&&"string"==typeof this.props.defaultTabbableElement?this._activeElement=this._getDocument().querySelector(this.props.defaultTabbableElement):this.props.defaultActiveElement&&(this._activeElement=this._getDocument().querySelector(this.props.defaultActiveElement));this.props.shouldFocusOnMount&&this.focus()}},o.prototype.componentDidUpdate=function(){var r=this._root.current,t=this._getDocument(),i;t&&this._lastIndexPath&&(t.activeElement===t.body||null===t.activeElement||!this.props.preventFocusRestoration&&t.activeElement===r)&&(i=n.getFocusableByIndexPath(r,this._lastIndexPath),i?(this._setActiveElement(i,!0),i.focus(),this._setParkedFocus(!1)):this._setParkedFocus(!0))},o.prototype.componentWillUnmount=function(){delete s[this._id];this._isInnerZone||(u.delete(this),this._windowElement&&0===u.size&&this._windowElement.removeEventListener("keydown",o._onKeyDownCapture,!0));this._root.current&&this._root.current.removeEventListener("blur",this._onBlur,!0);this._activeElement=null;this._defaultFocusElement=null},o.prototype.render=function(){var r=this,t=this.props,u=t.as,f=t.elementType,e=t.rootProps,o=t.ariaDescribedBy,s=t.ariaLabelledBy,h=t.className,l=n.getNativeProps(this.props,n.htmlElementProperties),v=u||f||"div",i;return this._evaluateFocusBeforeRender(),i=d.getTheme(),c.createElement(v,b.__assign({"aria-labelledby":s,"aria-describedby":o},l,e,{className:n.css((a||(a=k.mergeStyles({selectors:{":focus":{outline:"none"}}},"ms-FocusZone")),a),h),ref:this._mergedRef(this.props.elementRef,this._root),"data-focuszone-id":this._id,onKeyDown:function(n){return r._onKeyDown(n,i)},onFocus:this._onFocus,onMouseDownCapture:this._onMouseDown}),this.props.children)},o.prototype.focus=function(t){var i,r,u;return(void 0===t&&(t=!1),this._root.current)?!t&&"true"===this._root.current.getAttribute(h)&&this._isInnerZone?(i=this._getOwnerZone(this._root.current),i!==this._root.current)?(r=s[i.getAttribute(v)],!!r&&r.focusElement(this._root.current)):!1:!t&&this._activeElement&&n.elementContains(this._root.current,this._activeElement)&&n.isElementTabbable(this._activeElement)?(this._activeElement.focus(),!0):(u=this._root.current.firstChild,this.focusElement(n.getNextElement(this._root.current,u,!0))):!1},o.prototype.focusLast=function(){if(this._root.current){var t=this._root.current&&this._root.current.lastChild;return this.focusElement(n.getPreviousElement(this._root.current,t,!0,!0,!0))}return!1},o.prototype.focusElement=function(n,t){var i=this.props,r=i.onBeforeFocus,u=i.shouldReceiveFocus;return!(u&&!u(n)||r&&!r(n)||!n||(this._setActiveElement(n,t),this._activeElement&&this._activeElement.focus(),0))},o.prototype.setFocusAlignment=function(n){this._focusAlignment=n},o.prototype._evaluateFocusBeforeRender=function(){var i=this._root.current,r=this._getDocument(),t,u;r&&(t=r.activeElement,t!==i&&(u=n.elementContains(i,t,!1),this._lastIndexPath=u?n.getElementIndexPath(i,t):void 0))},o.prototype._setParkedFocus=function(n){var t=this._root.current;t&&this._isParked!==n&&(this._isParked=n,n?(this.props.allowFocusRoot||(this._parkedTabIndex=t.getAttribute("tabindex"),t.setAttribute("tabindex","-1")),t.focus()):this.props.allowFocusRoot||(this._parkedTabIndex?(t.setAttribute("tabindex",this._parkedTabIndex),this._parkedTabIndex=void 0):t.removeAttribute("tabindex")))},o.prototype._setActiveElement=function(t,i){var r=this._activeElement;this._activeElement=t;r&&(n.isElementFocusZone(r)&&this._updateTabIndexes(r),r.tabIndex=-1);this._activeElement&&(this._focusAlignment&&!i||this._setFocusAlignment(t,!0,!0),this._activeElement.tabIndex=0)},o.prototype._preventDefaultWhenHandled=function(n){this.props.preventDefaultWhenHandled&&n.preventDefault()},o.prototype._tryInvokeClickForFocusable=function(t){if(t===this._root.current||!this.props.shouldRaiseClicks)return!1;do{if("BUTTON"===t.tagName||"A"===t.tagName||"INPUT"===t.tagName||"TEXTAREA"===t.tagName)return!1;if(this._isImmediateDescendantOfZone(t)&&"true"===t.getAttribute(h)&&"true"!==t.getAttribute("data-disable-click-on-enter"))return n.raiseClick(t),!0;t=n.getParent(t,r)}while(t!==this._root.current);return!1},o.prototype._getFirstInnerZone=function(t){var i,r;if(!(t=t||this._activeElement||this._root.current))return null;if(n.isElementFocusZone(t))return s[t.getAttribute(v)];for(i=t.firstElementChild;i;){if(n.isElementFocusZone(i))return s[i.getAttribute(v)];if(r=this._getFirstInnerZone(i),r)return r;i=i.nextElementSibling}return null},o.prototype._moveFocus=function(i,r,u,f){var a,s;void 0===f&&(f=!0);var e=this._activeElement,h=-1,o=void 0,c=!1,l=this.props.direction===t.bidirectional;if(!e||!this._root.current||this._isElementInput(e)&&!this._shouldInputLoseFocus(e,i))return!1;a=l?e.getBoundingClientRect():null;do{if(e=i?n.getNextElement(this._root.current,e):n.getPreviousElement(this._root.current,e),!l){o=e;break}if(e){if(s=r(a,e.getBoundingClientRect()),-1===s&&-1===h){o=e;break}if(s>-1&&(-1===h||s<h)&&(h=s,o=e),h>=0&&s<0)break}}while(e);if(o&&o!==this._activeElement)c=!0,this.focusElement(o);else if(this.props.isCircularNavigation&&f)return i?this.focusElement(n.getNextElement(this._root.current,this._root.current.firstElementChild,!0)):this.focusElement(n.getPreviousElement(this._root.current,this._root.current.lastElementChild,!0,!0,!0));return c},o.prototype._moveFocusDown=function(){var i=this,n=-1,t=this._focusAlignment.left||this._focusAlignment.x||0;return!!this._moveFocus(!0,(function(r,u){var o=-1,e=Math.floor(u.top),s=Math.floor(r.bottom);return e<s?i._shouldWrapFocus(i._activeElement,y)?w:f:((-1===n&&e>=s||e===n)&&(n=e,o=t>=u.left&&t<=u.left+u.width?0:Math.abs(u.left+u.width/2-t)),o)}))&&(this._setFocusAlignment(this._activeElement,!1,!0),!0)},o.prototype._moveFocusUp=function(){var i=this,n=-1,t=this._focusAlignment.left||this._focusAlignment.x||0;return!!this._moveFocus(!1,(function(r,u){var e=-1,o=Math.floor(u.bottom),s=Math.floor(u.top),h=Math.floor(r.top);return o>h?i._shouldWrapFocus(i._activeElement,y)?w:f:((-1===n&&o<=h||s===n)&&(n=s,e=t>=u.left&&t<=u.left+u.width?0:Math.abs(u.left+u.width/2-t)),e)}))&&(this._setFocusAlignment(this._activeElement,!1,!0),!0)},o.prototype._moveFocusLeft=function(i){var u=this,r=this._shouldWrapFocus(this._activeElement,p);return!!this._moveFocus(n.getRTL(i),(function(e,o){var s=-1;return(n.getRTL(i)?parseFloat(o.top.toFixed(3))<parseFloat(e.bottom.toFixed(3)):parseFloat(o.bottom.toFixed(3))>parseFloat(e.top.toFixed(3)))&&o.right<=e.right&&u.props.direction!==t.vertical?s=e.right-o.right:r||(s=f),s}),void 0,r)&&(this._setFocusAlignment(this._activeElement,!0,!1),!0)},o.prototype._moveFocusRight=function(i){var u=this,r=this._shouldWrapFocus(this._activeElement,p);return!!this._moveFocus(!n.getRTL(i),(function(e,o){var s=-1;return(n.getRTL(i)?parseFloat(o.bottom.toFixed(3))>parseFloat(e.top.toFixed(3)):parseFloat(o.top.toFixed(3))<parseFloat(e.bottom.toFixed(3)))&&o.left>=e.left&&u.props.direction!==t.vertical?s=o.left-e.left:r||(s=f),s}),void 0,r)&&(this._setFocusAlignment(this._activeElement,!0,!1),!0)},o.prototype._moveFocusPaging=function(t,i){var r,o,a;if((void 0===i&&(i=!0),r=this._activeElement,!r||!this._root.current)||this._isElementInput(r)&&!this._shouldInputLoseFocus(r,t)||(o=n.findScrollableParent(r),!o))return!1;var f=-1,u=void 0,v=-1,y=-1,p=o.clientHeight,s=r.getBoundingClientRect();do if(r=t?n.getNextElement(this._root.current,r):n.getPreviousElement(this._root.current,r)){var h=r.getBoundingClientRect(),c=Math.floor(h.top),w=Math.floor(s.bottom),l=Math.floor(h.bottom),b=Math.floor(s.top),e=this._getHorizontalDistanceFromCenter(t,s,h);if(t&&c>w+p||!t&&l<b-p)break;e>-1&&(t&&c>v?(v=c,f=e,u=r):!t&&l<y?(y=l,f=e,u=r):(-1===f||e<=f)&&(f=e,u=r))}while(r);if(a=!1,u&&u!==this._activeElement)a=!0,this.focusElement(u),this._setFocusAlignment(u,!1,!0);else if(this.props.isCircularNavigation&&i)return t?this.focusElement(n.getNextElement(this._root.current,this._root.current.firstElementChild,!0)):this.focusElement(n.getPreviousElement(this._root.current,this._root.current.lastElementChild,!0,!0,!0));return a},o.prototype._setFocusAlignment=function(n,i,r){if(this.props.direction===t.bidirectional&&(!this._focusAlignment||i||r)){var u=n.getBoundingClientRect(),f=u.left+u.width/2,e=u.top+u.height/2;this._focusAlignment||(this._focusAlignment={left:f,top:e});i&&(this._focusAlignment.left=f);r&&(this._focusAlignment.top=e)}},o.prototype._isImmediateDescendantOfZone=function(n){return this._getOwnerZone(n)===this._root.current},o.prototype._getOwnerZone=function(t){for(var i=n.getParent(t,r);i&&i!==this._root.current&&i!==this._getDocument().body;){if(n.isElementFocusZone(i))return i;i=n.getParent(i,r)}return i},o.prototype._updateTabIndexes=function(t){var u,f,r;for(!this._activeElement&&this.props.defaultTabbableElement&&"function"==typeof this.props.defaultTabbableElement&&(this._activeElement=this.props.defaultTabbableElement(this._root.current)),!t&&this._root.current&&(this._defaultFocusElement=null,t=this._root.current,this._activeElement&&!n.elementContains(t,this._activeElement)&&(this._activeElement=null)),this._activeElement&&!n.isElementTabbable(this._activeElement)&&(this._activeElement=null),u=t&&t.children,f=0;u&&f<u.length;f++)r=u[f],n.isElementFocusZone(r)?"true"===r.getAttribute(h)&&(this._isInnerZone||(this._activeElement||this._defaultFocusElement)&&this._activeElement!==r?"-1"!==r.getAttribute(i)&&r.setAttribute(i,"-1"):(this._defaultFocusElement=r,"0"!==r.getAttribute(i)&&r.setAttribute(i,"0"))):(r.getAttribute&&"false"===r.getAttribute(h)&&r.setAttribute(i,"-1"),n.isElementTabbable(r)?this.props.disabled?r.setAttribute(i,"-1"):this._isInnerZone||(this._activeElement||this._defaultFocusElement)&&this._activeElement!==r?"-1"!==r.getAttribute(i)&&r.setAttribute(i,"-1"):(this._defaultFocusElement=r,"0"!==r.getAttribute(i)&&r.setAttribute(i,"0")):"svg"===r.tagName&&"false"!==r.getAttribute("focusable")&&r.setAttribute("focusable","false")),this._updateTabIndexes(r)},o.prototype._isContentEditableElement=function(n){return n&&"true"===n.getAttribute("contenteditable")},o.prototype._isElementInput=function(n){return!(!n||!n.tagName||"input"!==n.tagName.toLowerCase()&&"textarea"!==n.tagName.toLowerCase())},o.prototype._shouldInputLoseFocus=function(n,t){if(!this._processingTabKey&&n&&n.type&&g.indexOf(n.type.toLowerCase())>-1){var i=n.selectionStart,u=i!==n.selectionEnd,f=n.value,r=n.readOnly;if(u||i>0&&!t&&!r||i!==f.length&&t&&!r||this.props.handleTabKey&&(!this.props.shouldInputLoseFocusOnArrowKey||!this.props.shouldInputLoseFocusOnArrowKey(n)))return!1}return!0},o.prototype._shouldWrapFocus=function(t,i){return!this.props.checkForNoWrap||n.shouldWrapFocus(t,i)},o.prototype._portalContainsElement=function(t){return t&&!!this._root.current&&n.portalContainsElement(t,this._root.current)},o.prototype._getDocument=function(){return n.getDocument(this._root.current)},o.defaultProps={isCircularNavigation:!1,direction:t.bidirectional,shouldRaiseClicks:!0},o})(c.Component)})(),o})()}))