define("MsPortalImpl/Weave/SandboxDomAgents/Button",["require","exports","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/UI/UI.LinkHandler","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Widgets/Widgets.Common"],(function(n,t,i,r,u,f){"use strict";function h(t,s,h,c){var l=$(t).parent(),b=e+o++,y=i.getFxClickSelectable(h,s,l,e,b),p=function(){return!0},a,w="",v;ko.reactor(s,(function(){var t,i;a&&a.dispose();a=s.createChildLifetime();t=ko.unwrap(c.onClick);w=t&&t.telemetryName||"";!ko.unwrap(c.aggregatedDisabled)&&t&&(i=l.find(".fxs-button"),ko.ignoreDependencies((function(){var v,e,o;typeof t=="function"?(e=t,v=function(t){t.stopPropagation();Q.isPromiseAlike(e)&&u.logToExtension(n,l,2,FxImpl.createError("SimpleButton binding argument is not a callback function. The click handler is "+e));y.invokeClick(undefined,e,t)}):v=t;f.isLink(t)?i.attr("role","link"):i.attr("role","button");o=r.getUriAndHandler(a,h,v,!0);o.errorMessage.subscribeAndRun(a,(function(t){t&&u.logToExtension(n,l,1,FxImpl.createError("SimpleButton failure: "+MsPortalFx.getLogFriendlyMessage(t)))}));o.uri.subscribeAndRun(s,(function(n){c.selfDisabled(!n)}));p=o.handler})))}));v=function(t){if(t.stopPropagation(),t.preventDefault(),!ko.unwrap(c.aggregatedDisabled))try{p(t,y,w)}catch(i){u.logToExtension(n,l,2,FxImpl.createError("Button control failed to execute click handler",{innerErrors:i,data:{databind:$(l).attr("data-bind")}}))}};s.registerForDispose(l.setEvents(["click",v,],["keydown",function(n){(n.keyCode===13||n.keyCode===32)&&(v(n),n.keyCode===32&&(n.preventDefault(),n.stopPropagation()))},]))}var s,e,o;Object.defineProperty(t,"__esModule",{value:!0});t.attachDomAgent=void 0;s=MsPortalFx.Base.Diagnostics;t.attachDomAgent=h;e="simplebutton";o=0}))