define("FxInternal/Controls/BaseResourceDropDown",["require","exports","Fx/Controls/CustomHtml","Fx/Controls/DropDown","FxInternal/Utils/ValidationHelper","FxInternal/ResourceManagement/Policies"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function s(n,t,i){var f=n&&n.createChildLifetime(),o=t.observable(),s=i.observable(),r,u,e=function(){r&&!r.isDisposed||(r=t.observable.subscribe(f,(function(n){var u=t.map(n);u!==i.observable()&&(r.dispose(),i.observable(t.map(n)),e())}),i));u&&!u.isDisposed||(u=i.observable.subscribe(f,(function(n){var r=i.map(n);r!==t.observable()&&(u.dispose(),t.observable(i.map(n)),e())}),i))},h=function(n){return!MsPortalFx.isUndefined(n)};return h(o)?i.observable(t.map(o)):h(s)&&t.observable(i.map(s)),e(),f}var t=MsPortalFx.Resources.Strings,e=t.ViewModels.Controls.CreatorAndComboBox,o=(function(){function n(n,t,u,f,o){var h=this,y,p,d,l,c,w,tt,k,it,rt;this.controlType=124;this.vmKind="Fx";this.labelPosition=ko.observable();this._msPortalFxRequired=ko.observable();this._msPortalFxLeftLabelWidth=ko.observable();this._fetching=ko.observable(!0);this._fetchingId=0;this.fetchedValues=ko.observableArray();this.outerCssClass=o;this._valueKeyMap=f;this._value=ko.isObservable(t.value)?t.value:ko.observable(t.value);y=ko.observable();p=ko.pureComputed((function(){var n=ko.unwrap(t.topItemValue);return(n?[n]:[]).concat(h.fetchedValues())}));s(n,{observable:this._value,map:function(n){return h._valueKeyMap(n)}},{observable:y,map:function(n){return MsPortalFx.find(p().concat([h.value()]),(function(t){return t&&h._valueKeyMap(t)===n}))}});this._validations=ko.isObservable(t.validations)?t.validations:ko.observableArray(t.validations||[]);ko.computed(n,(function(){var n=ko.unwrap(t.noWrapValidations)||[];return ko.unwrap(h._validations).map((function(t){if(t.type===21&&!n.includes(t)){var i=t;return i.wrappedValidate||(i.wrappedValidate=i.validate,i.validate=function(){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return i.wrappedValidate.apply(i,__spreadArray([h._value.peek()],t))}),i}return t}))})).subscribeAndRun(n,t.validations=ko.observableArray());t.grouping&&(l=t.grouping.map,c=t.grouping.sort,d=t.grouping.mapToHtml);t.onFetchedValues&&this.fetchedValues.subscribe(n,(function(n){return t.onFetchedValues([].concat(n))}));w=t.disable;c=c||function(){return 0};var a=ko.observableArray(),ut=t.hiding&&t.hiding.hide||MsPortalFx.wrap(!1),b=ko.observable(),g=t.sort?null:function(n,t){return MsPortalFx.compare(n.text,t.text)},ft=t.sort||MsPortalFx.wrap(0),et=t.cssClass||ko.observable(""),ot=function(n){return ut(n)?(b(t.hiding.reason),!1):!0},v=l,nt=c;w&&(l=l||function(){return""},v=function(n){var t;return(t=w(n))&&a.push(t),t||l(n)},nt=function(n,t){var i=a.indexOf(n),r=a.indexOf(t);return~i&&!~r?1:!~i&&~r?-1:c&&c(n,t)||0});tt=ko.pureComputed((function(){var r=ko.unwrap(t.topItemValue),c=ko.unwrap(d)||{},n,i,o,f,s;return(b(null),n=p().filter(ot).sort((function(n,t){return n===r?-1:t===r?1:ft(n,t)})).map((function(n){var t=u(n);return n===r&&(t.text=e.newItemText.format(t.text)),t})),n=g?n.sort(g):n,v)?(i=n.reduce((function(n,t){var i=v(t.value);return(n[i]=n[i]||[]).push(t),t.value=h._valueKeyMap(t.value),n}),{}),o=Object.keys(i).sort(nt).reduce((function(n,t){return t?(n.push({children:i[t],text:c[t]||t,disabled:!!~a.indexOf(t)}),n):n.concat(i[t])}),[]),a([]),o):(f=ko.unwrap(t.header),s=f?[f]:[],s.concat(v?n:n.map((function(n){return n.value=h._valueKeyMap(n.value),n}))))})).extend({deferred:!0});k=ko.observableArray();tt.subscribeAndRun(n,(function(n){k(n)}));this.subLabel=MsPortalFx.initObservable(t.subLabel);it=t.subLabel;rt={htmlTemplate:'\n                        <!--ko if: fxSubLabel-->\n                           <div data-bind="pcCustomHtmlField: fxSubLabel"><\/div>\n                        <!-- /ko -->\n                        <!--ko if: reason-->\n                            <div data-bind="text: reason"><\/div>\n                        <!-- /ko -->\n                        <!--ko if: subLabel-->\n                           <div data-bind="pcCustomHtmlField: subLabel"><\/div>\n                        <!-- /ko -->\n                ',viewModel:{reason:b,fxSubLabel:t.fxSublabel,subLabel:ko.pureComputed((function(){var t=ko.unwrap(it);if(typeof t=="string")return i.create(n,{htmlTemplate:t});var r=t||{},f=r.viewModel,u=r.htmlTemplate;return u?i.create(n,{htmlTemplate:u,innerViewModel:f,isolated:!0}):null}))}};delete t.subLabel;this._fxDropDown=r.create(n,MsPortalFx.extend(t,{cssClass:et,items:k,loading:this._fetching,value:y,subLabel:rt}));this.control=ko.observable(this._fxDropDown);this.valid=ko.computed(n,{read:function(){return h.control().valid()},write:function(n){return h.control().valid(n)}});this.labelPosition=ko.computed(n,{read:function(){return h.control().labelPosition()},write:function(n){return h.control().labelPosition(n)}});this._msPortalFxRequired=ko.computed(n,{read:function(){return h.control()._msPortalFxRequired()},write:function(n){return h.control()._msPortalFxRequired(n)}});this._msPortalFxLeftLabelWidth=ko.computed(n,{read:function(){return h.control()._msPortalFxLeftLabelWidth()},write:function(n){return h.control()._msPortalFxLeftLabelWidth(n)}});t.onIsPopUpOpen&&this._fxDropDown.isPopUpOpen.subscribe(n,t.onIsPopUpOpen)}return Object.defineProperty(n.prototype,"dirty",{get:function(){return this._fxDropDown.dirty},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"label",{get:function(){return this._fxDropDown.label},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"validations",{get:function(){return this._validations},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"validationResults",{get:function(){return this._fxDropDown.validationResults},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"disabled",{get:function(){return this._fxDropDown.disabled},enumerable:!1,configurable:!0}),n.prototype.triggerValidation=function(n){return u.tryOnTriggerValidation(this),this._fxDropDown.triggerValidation(n)},Object.defineProperty(n.prototype,"value",{get:function(){return this._value},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"loading",{get:function(){return this._fxDropDown.loading},enumerable:!1,configurable:!0}),n.prototype.selectInitialOrCurrent=function(n,t,i,r,u){var f=this;return i===void 0&&(i=!0),r===void 0&&(r=!0),u===void 0&&(u=!1),this._initialPromise.then((function(e){var s=f.value(),l=s&&[f._valueKeyMap(s)]||[],o=l.concat(e||[]).filter((function(n){return!!n})),h,c;u&&(h=o.map((function(n){return n.toLowerCase()})),o=h);f.fetchedValues(n.slice(0));(o.length||i)&&(c=n.filter((function(n){var t=f._valueKeyMap(n);return u&&(t=(t!==null&&t!==void 0?t:"").toLowerCase()),!!~o.indexOf(t)})).sort((function(n,t){return MsPortalFx.compare(MsPortalFx.findIndex(o,(function(t){var i=f._valueKeyMap(n);return u&&(t=(t!==null&&t!==void 0?t:"").toLowerCase(),i=i.toLowerCase()),t===i})),MsPortalFx.findIndex(o,(function(n){var i=f._valueKeyMap(t);return u&&(n=(n!==null&&n!==void 0?n:"").toLowerCase(),i=i.toLowerCase()),n===i})))})).concat(n)[0],r&&f.value(c));~[null,undefined].indexOf(f.value())&&f.value(t)}))},n.createPolicyValidation=f.PolicyValidationFactoryImpl.createPolicyValidation,n})();n.ViewModel=o})(e||(e={})),e}));
define("FxInternal/ResourceManagement/Locations",["require","exports","FxHubs/ArmHelpers/ArmApis","FxHubs/ArmHelpers/ArmApisStartup","Fx/Ajax"],(function(n,t,i,r,u){"use strict";function a(n){var t=r.listLocationsAtScopeApi(n);return Q(u.batch({uri:t,type:"GET",setTelemetryHeader:e+".getLocForSub"}).then((function(t){if(t.content&&t.content.value)return t.content.value;throw new Error("Error getting locations at scope "+n);})))}function v(n){var t=r.listSubscriptionLocationsApi(n);return Q(u.batch({uri:t,type:"GET",setTelemetryHeader:e+".getLocForSub"}).then((function(t){if(t.content&&t.content.value)return t.content.value;throw new Error("Error getting locations for subscription "+n);})))}function s(n,t,u){return t===void 0&&(t=[]),u===void 0&&(u=""),__awaiter(this,void 0,void 0,(function(){var b,s,g,nt,h,y,p,o,k,w,d;return __generator(this,(function(tt){switch(tt.label){case 0:return b=[],s=[],g=t.map((function(t){t=t.toLowerCase();var r=t.indexOf("/"),f=t.substr(0,r);return b.push(t.substr(r+1)),{uri:n?i.getResourceProviderWithSubscriptionApi(n,f):i.getResourceProviderAtScope(u,f),arrayResponse:!1,telemetry:e+".getLocForResTypes"}})),nt=r.callBatchWithContinuation(g,(function(n){s.push(n)}),(function(n){var r=t[s.length],u=n.reason&&n.reason.content,i=n.reason&&n.reason.httpStatusCode;if(i>=400){f.warning("Could not get locations for resource type '"+r+"': ("+i+") "+JSON.stringify(u));return}s.push(null)}),!1),h={},[4,Q.all([n?v(n):a(u),nt])];case 1:return(y=tt.sent()[0],!!t.length)?[3,3]:[4,Q(y.filter((function(n){return!n.metadata||n.metadata.regionType.toLowerCase()==="physical"})))];case 2:return p=tt.sent(),p=p.length?p:y,[2,{locations:p,resourceTypeApis:h}];case 3:try{s.forEach((function(n,i){var e,r,u;if(!n)return null;if(e=t[i],r=n&&MsPortalFx.find(n.resourceTypes,(function(n){return n.resourceType.toLowerCase()===b[i]})),!r){f.warning("Resource type '"+e+"' not found in list of returned resource types.");o=[];return}h[n.namespace+"/"+r.resourceType]=r.apiVersions;u=r.locations;o=o?o.filter((function(n){return!!~u.indexOf(n)})):u}));o=(o||[]).sort()}catch(it){it=it||{};f.warning("Falling back to subscription locations. Error: "+(it.message||JSON.stringify(it)))}return(k=[],w=o.map((function(n){return n.replace(/ /g,"").toLowerCase()})),d=(y||[]).filter((function(n){var t=l(n.name).toLowerCase();if(w.includes(t))return k.push(t),!0})).concat(w.filter((function(n){return!k.includes(n)})).map((function(i){var r=o[w.indexOf(i)],u="The following resource types returned '"+r+"' as a valid location which was not in list of all locations returned from ARM: ["+t.join(", ")+"]";return c.trace({source:e,action:"RPLocsMissingForUser",data:{message:u,subscriptionId:n,resourceTypes:t}}),{name:i,displayName:r,regionalDisplayName:r,metadata:{regionCategory:"ServiceProvided",regionType:"Manifest"}}}))),!d.length)?(f.warning("No locations returned for resource types: '"+t.join(", ")+"'. Falling back to subscription locations."),[2,{locations:y,resourceTypeApis:h}]):[2,{locations:d,resourceTypeApis:h}]}}))}))}function y(n,t,i){return t===void 0&&(t=[]),i===void 0&&(i=""),Q(s(n,t,i).then((function(n){return n.locations})))}Object.defineProperty(t,"__esModule",{value:!0});t.getLocationsForCreate=t.getLocationsAndResourceTypesForCreate=void 0;var h=MsPortalFx.Base,o=h.Diagnostics,c=o.Telemetry,f=o.createLog(n),e="Services.ArmLocations",l=ko.unwrap;t.getLocationsAndResourceTypesForCreate=s;t.getLocationsForCreate=y}));
define("FxInternal/Controls/LocationDropDown",["require","exports","FxInternal/Controls/BaseResourceDropDown","Fx/Controls/InfoBalloon","Fx","Fx/ResourceManagement","FxInternal/ResourceManagement/Locations"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){function s(n,t){var i=h[n],u=c[n];return{htmlTemplate:'<span data-bind="text: text"><\/span><span data-bind="pcControl: infoBalloon"><\/span>',viewModel:{text:i,infoBalloon:r.create(t,{content:u})}}}var t=MsPortalFx.Resources.Strings.Azure.Locations.DropDown,h={Recommended:t.groupRecommended,Other:t.groupOther,ServiceProvided:t.groupServiceProvided},c={Recommended:t.groupRecommendedBubble,Other:t.groupOtherBubble,ServiceProvided:t.groupServiceProvidedBubble},o=u.isFeatureEnabled("regionSegments"),l=(function(n){function r(r,u){var e=this,a={Recommended:s("Recommended",r),Other:s("Other",r),ServiceProvided:s("ServiceProvided",r)},h=[],l=MsPortalFx.extend({label:ko.observable(t.defaultLabel),filter:!0,initialLocationName:null,subscriptionId:null,grouping:o&&{mapToHtml:a,map:function(n){var t=n.metadata;return t?(h.includes(t.regionCategory)||h.push(t.regionCategory),t.regionCategory):"ServiceProvided"},sort:function(n,t){return MsPortalFx.compare(h.indexOf(n),h.indexOf(t))}},sort:o&&MsPortalFx.wrap(0)},u),v=i.ViewModel.createPolicyValidation({container:r,buildResourceDetails:function(n,t){var r=t===null||t===void 0?void 0:t.name,i=n.resourceContent=n.resourceContent||{};return i.location=r,i.type=(ko.unwrap(u.resourceTypes)||[])[0],n.apiVersion=((e._resourceTypeApis()||{})[i.type]||[])[0],n},pendingValues:{field:"location",valueToField:function(n){return n.name},fieldToDisplay:function(n,i){return{displayValue:(o?i.regionalDisplayName||i.displayName:i.displayName)||i.name,displayField:t.defaultLabel}}}}),c;return ko.computed(r,(function(){return(ko.unwrap(u.validations)||[]).concat(v||[])})).subscribeAndRun(r,l.validations=ko.observableArray()),e=n.call(this,r,l,(function(n){return{text:(o?n.regionalDisplayName||n.displayName:n.displayName)||n.name,value:n}}),(function(n){return n&&n.name}))||this,c=u.initialLocationName,e._locationsFromArm=ko.observableArray(),e._resourceTypeApis=ko.observable(),e._initialPromise=ko.isObservable(c)?c.fxAwaitAndRun(r):Q(c),e._scope=ko.computed(r,(function(){var n=ko.unwrap(u.subscriptionId);return n?typeof n=="string"?f.ArmId.stringify({subscription:n,kind:1},1):f.ArmId.stringify({subscription:n.subscriptionId,kind:1},1):ko.unwrap(u.scope)})),e._scope.fxAwaitAndRun(r,(function(n){return!!n||n===""})).then((function(){return ko.computed(r,(function(){return[e._scope(),ko.unwrap(u.resourceTypes),]})).extend({deferred:!0}).subscribe(r,(function(){e.triggerValidation()}))})),Q.nextTick((function(){return ko.computed(r,(function(){return[e._scope(),ko.unwrap(u.resourceTypes)]})).subscribeAndRun(r,(function(n){!n[0]&&n[0]!==""||e._fetchItems(u)}))})),ko.computed(r,(function(){var n=e._locationsFromArm();return u.customizeItems?u.customizeItems(n):n})).subscribe(r,(function(n){return e.selectInitialOrCurrent(n)})),e}return __extends(r,n),r.prototype._fetchItems=function(n){return __awaiter(this,void 0,void 0,(function(){var i,r,t;return __generator(this,(function(u){switch(u.label){case 0:i=++this._fetchingId;u.label=1;case 1:return u.trys.push([1,,3,4]),r=!o&&n.customFetch,this._fetching(!0),[4,r?r():e.getLocationsAndResourceTypesForCreate(null,ko.unwrap(n.resourceTypes)||[],this._scope())];case 2:return t=u.sent(),i===this._fetchingId&&("locations"in t?(this._locationsFromArm([].concat(t.locations)),this._resourceTypeApis(t.resourceTypeApis)):this._locationsFromArm(t)),[3,4];case 3:return i===this._fetchingId&&(this._fetchingId=0,this._fetching(!1)),[7];case 4:return[2]}}))}))},r})(i.ViewModel);n.ViewModel=l})(o||(o={})),o}));
define("Fx/Controls/LocationDropDown",["require","exports","FxInternal/Controls/LocationDropDown"],(function(n,t,i){"use strict";function r(n,t){var i;return ko.ignoreDependencies((function(){i=new u(n,t)})),i}function f(n,t){return r(n,t)}Object.defineProperty(t,"__esModule",{value:!0});t.createCustom=t.create=void 0;var u=(function(n){function t(t,i){return n.call(this,t,i)||this}return __extends(t,n),t})(i.ViewModel);t.create=r;t.createCustom=f}));
define("FxInternal/ResourceManagement/ResourceGroups",["require","exports","FxHubs/ArmHelpers/ArmApisStartup"],(function(n,t,i){"use strict";function u(n){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(){return[2,r(n).then((function(n){return n.map((function(n){var t;return{name:n.name,location:n.location,provisioningState:(t=n===null||n===void 0?void 0:n.properties)===null||t===void 0?void 0:t.provisioningState}}))}))]}))}))}function r(n){return __awaiter(this,void 0,void 0,(function(){var r,t;return __generator(this,(function(u){switch(u.label){case 0:return(r=(n||[]).filter((function(n){return!!n})).map((function(n){return{uri:i.resourceGroupsInSubscriptionApi(n),arrayResponse:!0,telemetry:"GetSubRGs"}})),!r.length)?[2,[]]:(t=[],[4,i.callBatchWithContinuation(r,(function(n){t.push.apply(t,n.filter(MsPortalFx.identity))}),(function(n){throw n;}),!1)]);case 1:return u.sent(),[2,t]}}))}))}Object.defineProperty(t,"__esModule",{value:!0});t.getArmResourceGroups=t.getResourceGroups=void 0;t.getResourceGroups=u;t.getArmResourceGroups=r}));
define("FxInternal/Controls/ResourceGroupDropDown",["require","exports","Fx/DependencyInjection","Fx/Controls/TextBox","Fx/Controls/CustomHtml","Fx/Controls/Validations","FxInternal/Controls/BaseResourceDropDown","Fx/ResourceManagement","FxHubs/ArmHelpers/ArmLocks","FxInternal/Utils/ValidationHelper","FxInternal/ResourceManagement/Permissions","FxInternal/ResourceManagement/ResourceGroups"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";function tt(n,t){return n===t}function lt(n,t){var i=!~[undefined,null].indexOf(n),r=!~[undefined,null].indexOf(t);return n=i?n:"",t=r?t:"",n===t}function y(n){var t=ko.unwrap(n);if(t)return t.subscriptionId||t}function et(n,t){return n?"/subscriptions/"+n+(t?"/resourceGroups/"+t:""):""}function b(n,t){return t?(Object.defineProperty(t,"resourceId",{get:function(){return et(y(n),t.name)}}),t):null}function ot(n){return n===1?1:0}function st(n,t){var i=ko.unwrap(t)||a.defaultLabel;switch(n){case 1:return a.createNewAriaLabel.format(i);case 0:return a.useExistingAriaLabel.format(i);default:return a.defaultAriaLabel.format(i)}}var ht;Object.defineProperty(t,"__esModule",{value:!0});t.ViewModel=void 0;var it=MsPortalFx.Base,d=it.Constants,v=MsPortalFx.ViewModels,rt=it.Diagnostics,g=MsPortalFx.Resources.Strings,ct=FxImpl.Rpc,k=MsPortalFx.Azure,ut=k.ResourceGroups.Internal,p=v.getValidationResult,a=g.Azure.ResourceGroups.DropDown,nt=g.ViewModels.Controls.CreatorAndComboBox,w=g.ResourceGroup.Validation,ft=Q(p());ht=(function(n){function t(t,h){var l=this,g=MsPortalFx.extend({label:a.defaultLabel,sort:function(n,t){return MsPortalFx.compare(n.value.name,t.value.name)},filter:!0,filterPlaceholder:h.filterPlaceholder||nt.selectExisting},h),yt,ei,at,ht,vt,vi,ii,oi,ri,ni,yi,pi,it,wi,bi,fi;g.cssClass=h.nested?"msportalfx-nested-control":h.cssClass;yt=ko.isObservable(h.allowedMode)?h.allowedMode:ko.observable(typeof h.allowedMode!="undefined"?h.allowedMode:2);g.allowedMode=yt;g.subscriptionId=null||h.subscriptionId;var ti={name:"",location:"",provisioningState:""},wt={mode:1,value:ti},kt={mode:0,value:{name:"",location:""}},gt=ko.isWritableObservable(h.value)?h.value:ko.observable(h.value),bt=gt(),hi=bt||wt,ci={mode:0,value:{name:""}};bt&&(ei=yt(),(ei===2||ei===0&&bt.mode===0)&&(ci=bt));at=ko.observable(ci);g.value=at;at.equalityComparer=tt;ht=ko.observable(ot(yt()));ht.equalityComparer=tt;var li=h.validations,dt,ki=[new v.CustomValidationV(w.invalidMessage,function(n){return(wi.isFulfilled()?bi:Q(l._fetchItems(h,!!h.initialResourceGroupName))).then((function(){return l._fetching.fxAwaitAndRun(t,(function(n){return n===!1}))})).then((function(){return ut.validateResourceGroupName(n,y(h.subscriptionId),l.fetchedValues().map((function(n){return n.value.name})))}))}),new v.CustomValidationV(w.invalidMessage,function(n){return dt||(dt=new k.ReservedResourceNameValidator(d.ResourceTypes.ResourceGroups)),dt.validate(n)})],ai=ko.observableArray(),pt=ko.observable(at()||MsPortalFx.clone(wt,!0));pt.equalityComparer=tt;ko.computed(t,[at],(function(n){n&&(ht(n.mode),pt&&pt(n))}));ko.computed(t,(function(){return(ko.unwrap(li)||[]).map((function(n){if(n.type===21){var t=n;return new f.CustomV({message:t.message,validate:function(){return t.validate(pt())}})}return n})).concat(ki)})).subscribeAndRun(t,ai);vt=ko.observable(yt()===2&&bt&&bt.mode===1?bt:null);vi=function(n){if(!n)return vt(null);var t=MsPortalFx.clone(wt,!0);t.value.name=n;t.value=b(h.subscriptionId,t.value);vt(t);at(t)};g.topItemValue=vt;ii=ko.observable(null);g.fxSublabel=ii;oi=ko.pureComputed((function(){return st(1,h.ariaLabel)}));g.ariaLabel=ko.pureComputed((function(){return st(yt(),h.ariaLabel)}));ri=FxImpl.lowerCaseStringMap();g.onFetchedValues=function(n){n.forEach((function(n){var t=n.value.name;t&&ri.set(t.toLowerCase(),n)}))};yi=MsPortalFx.memoize((function(){return u.create(t,{cssClass:"fxt-resourcegroup-create-container",htmlTemplate:'<a class="fxt-resourcegroup-create" role="button" data-bind="attr: { aria-label: createNewAria }, text: createNew, fxclick: openSubCreate"><\/a>',innerViewModel:{createNew:nt.createNew,createNewAria:ko.pureComputed((function(){return l.label()+": "+nt.createNew})),openSubCreate:function(){ni&&ni.dispose();ni=t.createChildLifetime();var u=[new v.RequiredValidation,new v.CustomValidationV(w.invalidMessage,function(n){return ut.validateResourceGroupName(n,y(h.subscriptionId),l.fetchedValues().map((function(n){return n.value.name})))}),new v.CustomValidationV(w.invalidMessage,function(n){return dt||(dt=new k.ReservedResourceNameValidator(d.ResourceTypes.ResourceGroups)),dt.validate(n)})],n=r.create(ni,{ariaLabel:oi,label:a.name,placeHolderText:g.createNewPlaceholder,validations:u,value:vt()&&vt().value.name}),i=ko.observable(!1);ko.computed(ni,[n.valid,n.value],(function(){i(!(n.valid()&&n.value()&&n.value().length))}));t.openDialog({telemetryName:"ResourceGroupCreateNewDialog",content:{htmlTemplate:'<div style="max-width: 320px"><div data-bind="text: description" style="margin-bottom: 25px"><\/div><div data-bind="pcControl: textbox"><\/div><\/div>',viewModel:{description:a.description,textbox:n}},buttons:[{button:4,disabled:i},{button:1},],target:".fxt-resourcegroup-create",title:null,onClosed:function(t){t.button===4&&vi(n.value())}})}}})}));yt.subscribeAndRun(t,(function(n){var i=ht(),t;return(ht(ot(n)),!n)?(vt(null),ii(null)):(i===1&&it&&it()&&ui.valid()&&(t=MsPortalFx.clone(wt,!0),t.value.name=it(),vt(t)),n===1&&!vt()&&it&&it(""),!n&&at&&at(kt),ii(yi()))}));pi=ht()&&hi.value&&hi.value.name;it=ko.observable(pi||"");it.equalityComparer=lt;ko.computed(t,it,(function(n){if(ht()===1){var t=MsPortalFx.clone(wt,!0);t.value.name=n;t.value=b(h.subscriptionId,t.value);pt&&pt(t)}}));Object.defineProperty(ti,"name",{get:it,set:it});b(h.subscriptionId,ti);var ui=r.create(t,{ariaLabel:oi,cssClass:g.cssClass,infoBalloonContent:g.infoBalloonContent,label:h.label||a.defaultLabel,placeHolderText:g.createNewPlaceholder,value:it,validations:ai}),di=h.requiredPermissions,gi=new v.CustomValidation("",function(n){if(!n)return ft;var t=et(y(g.subscriptionId),n.value.name);return s.getIsLocked({lockLevel:"ReadOnly",resourceId:t}).then((function(n){return p(n&&a.lockedValidationMessage)})).catch((function(){return rt.Log.writeEntry(1,"ResourceGroupValidation","Error checking read permissions. Defaulting to false."),p()}))}),nr=new v.CustomValidation("",function(n){return n.mode===0?ft:Q.spread([i.container.get(c.PermissionChecker).hasPermission("/subscriptions/"+y(h.subscriptionId),["Microsoft.Resources/subscriptions/resourcegroups/write"]),k.getSubscriptionInfo(y(h.subscriptionId)).then((function(n){return n.displayName})),],(function(n,t){return n?p():p(w.subscriptionHasNoPermissionsMessage.format(t))})).catch((function(){return rt.Log.writeEntry(1,"ResourceGroupValidation","Error checking resource group create permissions. Defaulting to true."),p()}))}),tr=e.ViewModel.createPolicyValidation({container:t,buildResourceDetails:function(n,t){var i,r=n.scope,u=o.ArmId.parse(r,!0).subscription;return n.scope=o.ArmId.stringify({resourceGroup:(i=t===null||t===void 0?void 0:t.value)===null||i===void 0?void 0:i.name,subscription:u,kind:4},4),(t===null||t===void 0?void 0:t.mode)===1?{requestScope:r,resourceDetails:n}:{requestScope:n.scope,resourceDetails:n}}});ko.computed(t,(function(){return(ko.unwrap(li)||[]).concat([gi,nr].concat(tr||[])).map((function(n){return n.type!==21&&(n.map=n.map||function(){return pt().value.name}),n}))})).subscribeAndRun(t,g.validations=ko.observableArray());l=n.call(this,t,g,(function(n){return{text:n.value.name,value:n}}),(function(n){var t;if((t=n===null||n===void 0?void 0:n.value)!==null&&t!==void 0)return t.name}),"fxt-resourcegroup-dropdown")||this;yt.subscribeAndRun(t,(function(n){return l.control(n===1?ui:l._fxDropDown)}));wi=l._fetching.fxAwait(t);bi=l._fetching.fxAwait(t,(function(n){return!n}));l._textBox=ui;l._emptyControlValue=wt;l._emptyDropdownValue=kt;l._exposedValue=gt;l._baseOptions=g;l._selectedMode=ht;l._newResourceGroup=vt;var si=g.initialResourceGroupName,ir=ko.isObservable(si)?si.fxAwaitAndRun(t):Q(si),rr=FxImpl.Extension.getLastResourceIdInJourneyEndPoint.invoke(ct.client,d.Shell,null).then((function(n){var t=o.ArmId.parse(n,!0).resourceGroup;return t?[t]:[]}));return l._initialPromise=Q.all([ir.then((function(n){return[].concat(n||[])})),rr]).spread((function(n,t){return n.concat(t)})),ko.computed(t,[h.subscriptionId,yt],(function(){return yt()!==1||ui.value()?[ko.unwrap(h.subscriptionId)]:[]})).subscribeAndRun(t,(function(n){return n[0]&&l._fetchItems(h,yt()!==1)})),h.subscriptionId.fxAwaitAndRun(t).then((function(){return ko.computed(t,(function(){return[ko.unwrap(di),ko.unwrap(h.subscriptionId),ko.unwrap(l._fetching)===!1&&ht()&&vt(),]})).extend({deferred:!0}).subscribe(t,(function(){var n=pt();n&&n.value.name&&l.triggerValidation()}))})),fi=gt.subscribe(t,(function(n){var t,i;if(n=n||{mode:ht(),value:{name:it(),location:"",provisioningState:""}},ht()!==n.mode&&l.switchMode(n.mode),t=ko.unwrap(l._baseOptions.allowedMode),t===1)it(n.value.name);else{if(!n)return at(kt);l._fetching()||(i=ri.get(""+n.value.name),i||t!==2?n=i:vt(n));at(n!==null&&n!==void 0?n:kt)}})),ko.computed(t,pt,(function(n){var i,r;if(n=n||{mode:ht(),value:{name:it(),location:"",provisioningState:""}},ht(n.mode),n.mode===1)wt.value=ti,it(n.value.name);else{if(!n)return at(kt);l._fetching.peek()||(i=ri.get(n?""+n.value.name:null),i&&(n=i));at(n!==null&&n!==void 0?n:kt)}fi.dispose();r=MsPortalFx.clone(n,!0);b(h.subscriptionId,r.value);gt(r);fi=gt.subscribe(t,fi.callback)})),l._fxDropDown.visibleItemLimit=50,l}return __extends(t,n),Object.defineProperty(t.prototype,"value",{get:function(){return this._exposedValue},enumerable:!1,configurable:!0}),t.prototype.triggerValidation=function(){return h.tryOnTriggerValidation(this),ko.unwrap(this._baseOptions.allowedMode)===1?this._textBox.triggerValidation():this._fxDropDown.triggerValidation()},t.prototype.switchMode=function(n){var i=this._selectedMode,t=ko.unwrap(this._baseOptions.allowedMode),r;if(t!==2&&t!==undefined)return t===0?this._exposedValue(this._emptyDropdownValue):this._exposedValue(this._newResourceGroup()||this._emptyControlValue),i(t);r=n===undefined?!i():!!n;n=r?1:0;i(n)},t.prototype._fetchItems=function(n,t){return t===void 0&&(t=!0),__awaiter(this,void 0,void 0,(function(){var i,r,u,f,e=this;return __generator(this,(function(o){switch(o.label){case 0:this._fetching(!0);i=++this._fetchingId;r=n.customFetch||function(){return Q(l.getResourceGroups([y(n.subscriptionId)]))};o.label=1;case 1:return o.trys.push([1,,4,5]),[4,r()];case 2:return(u=o.sent(),i!==this._fetchingId)?[2]:(f=u.filter((function(n){return!!n})).map((function(n){return{mode:0,value:b(e._baseOptions.subscriptionId,n)}})),[4,this.selectInitialOrCurrent(f,MsPortalFx.clone(this._emptyControlValue,!0),!1,t,!0)]);case 3:return o.sent(),[3,5];case 4:return ko.unwrap(this._baseOptions.allowedMode)===2&&this._newResourceGroup()&&this._fxDropDown.value(this._newResourceGroup().value.name),i===this._fetchingId&&(this._fetchingId=0,this._fetching(!1)),[7];case 5:return[2]}}))}))},t})(e.ViewModel);t.ViewModel=ht}));
define("Fx/Controls/ResourceGroupDropDown",["require","exports","FxInternal/Controls/ResourceGroupDropDown"],(function(n,t,i){"use strict";function u(n,t){var i;return ko.ignoreDependencies((function(){i=new r(n,t)})),i}Object.defineProperty(t,"__esModule",{value:!0});t.create=void 0;var r=(function(n){function t(t,i){return n.call(this,t,i)||this}return __extends(t,n),t})(i.ViewModel);t.create=u}));
define("FxInternal/Controls/SubscriptionDropDown",["require","exports","Fx/DependencyInjection","FxInternal/Controls/BaseResourceDropDown","FxHubs/RpcEndPoints","Fx/ResourceManagement"],(function(n,t,i,r,u,f){"use strict";function k(n,t){return p.Rpc.invokeCallback("Microsoft_Azure_Marketplace","validateSubscriptions",{galleryItem:t,subscriptions:n})}function c(n){var t=n.status||n.state||"";return!b.includes(t.toLowerCase())}function d(n,t){if(t&&t.invalidSubscriptions.length)return MsPortalFx.find(t.invalidSubscriptions,(function(t){return t.subscriptionId===n.subscriptionId}))}function g(n){if(!n.isPartialSet)return null;var t=n.subscriptions.length,r=!MsPortalFx.isFeatureEnabled("removesubsdropdownlimit")&&t>1e3,i="border-bottom: 1px solid; font-weight: normal; width: calc(100% + 8px);margin-left: -8px; padding: 0 8px; white-space: normal;";return{htmlTemplate:'<div style="'+i+'"><!-- ko if: selectedOnly --><p data-bind="attr: { title: selectedSubsTitle }"><span data-bind="text: selectedSubsPrefix"><\/span><a style="white-space: nowrap" href="#menu/directory" data-bind="text: globalSubscriptionFilter"><\/a><span data-bind="text: selectedSubsSuffix"><\/span><\/p><!-- /ko --><!-- ko if: tooManyToDisplay --><p data-bind="text: tooManyToDisplayMessage, attr: { title: tooManyToDisplayMessage }"><\/p><!-- /ko --><\/div>',viewModel:{selectedOnly:n.isPartialSet,selectedSubsTitle:e.showingSelectedSubsMessagePrefix+e.globalSubscriptionFilter+e.showingSelectedSubsMessageSuffix,selectedSubsPrefix:e.showingSelectedSubsMessagePrefix,selectedSubsSuffix:e.showingSelectedSubsMessageSuffix,globalSubscriptionFilter:e.globalSubscriptionFilter,tooManyToDisplay:r,tooManyToDisplayMessage:e.tooManyToDisplay.format(1e3,t),headerCss:i}}}function l(n,t){return __awaiter(this,void 0,void 0,(function(){var i,r;return __generator(this,(function(f){switch(f.label){case 0:return[4,u.Impl.getInSessionDisplayedSubscriptions(s.client)];case 1:return(i=f.sent(),t||!n)?[2,i]:[4,u.Impl.getSubscriptionsForSelectedDirectories(s.client,i.subscriptions)];case 2:return r=f.sent(),[2,__assign(__assign({},i),{subscriptions:r})]}}))}))}var a;Object.defineProperty(t,"__esModule",{value:!0});t.ViewModel=t.getDisplayedSubscriptions=void 0;var v=MsPortalFx.Base,y=v.Constants,h=MsPortalFx.ViewModels,p=MsPortalFx.Services,w=FxImpl.Azure,s=FxImpl.Rpc,o=h.getValidationResultPromise,b=["enabled","active","pastdue"],e=MsPortalFx.Resources.Strings.Azure.Subscriptions.DropDown;t.getDisplayedSubscriptions=l;a=(function(n){function t(t,u){var l=this,g=ko.observable(null),a=ko.observable(!1),v=ko.observable(!1),it=function(n){a()&&n&&l._fetchItems(u,!1)},nt=MsPortalFx.isFeatureEnabled("mspfilter"),p=MsPortalFx.extend({label:ko.observable(e.defaultLabel),filter:!0,header:g,onIsPopUpOpen:it,grouping:nt?{map:function(n){var t=n.tenantId;if(!v())return"";var u=(t||"").toLowerCase(),i=l._directoryNameMap,r=v()&&i&&i[u];return r&&r.displayName||t||e.unknownTenant}}:undefined},u),tt=u.requiredPermissions,rt=r.ViewModel.createPolicyValidation({container:t,buildResourceDetails:function(n,t){var i=t===null||t===void 0?void 0:t.subscriptionId;return n.scope=f.ArmId.stringify({subscription:i,kind:1},1),n}}),ut=new h.CustomValidation(e.disabledSubscriptionValidationMessage,function(n){if(!n)return o();if(c(n))return o(e.disabledSubscriptionValidationMessage);var t=d(n,l._marketplaceValidation());return t?o(t.displayText||e.subscriptionNotAllowedForGalleryItemValidationMessage):w.canRegisterSubscriptionWithRPs(n.subscriptionId,ko.unwrap(u.resourceProviders)).then((function(t){if(!t.success){var i=n.uniqueDisplayName||n.subscriptionId,r=t.disallowedRPs||[];return r.length?o(e.subDisallowedRP.format(i,r.join(", "))):o(e.subCantRegisterWithRP.format(i,t.failedRPs.join(", ")))}})).then((function(t){return t?t:MsPortalFx.require("FxInternal/ResourceManagement/ArmTemplate").then((function(t){return t.hasPermission(i.container,"/subscriptions/"+n.subscriptionId,tt,e.requiredPermissionsValidationMessage)}))})).catch((function(){return o()}))}),k;ko.computed(t,(function(){return(ko.unwrap(u.validations)||[]).concat(ut).concat(rt||[])})).subscribeAndRun(t,p.validations=ko.observableArray());l=n.call(this,t,p,(function(n){return{text:n.uniqueDisplayName||n.displayName||n.subscriptionId,value:n,disabled:c(n)}}),(function(n){return n&&n.subscriptionId}))||this;l._marketplaceValidation=ko.observable(null);l._headerGroup=g;l._directoryNameMap=null;l._enableMspFilter=nt;var b=p.initialSubscriptionId,ft=ko.isObservable(b)?b.fxAwaitAndRun(t):Q(b),et=FxImpl.Extension.getLastResourceIdInJourneyEndPoint.invoke(s.client,y.Shell,null).then((function(n){var t=f.ArmId.parse(n,!0).subscription;return t?[t]:[]}));if(l._initialPromise=Q.all([ft.then((function(n){return[].concat(n||[])})),et,]).spread((function(n,t){return n.concat(t)})),l._updateOnOpen=a,l._groupByDirectories=v,l._usingGlobalResourceFiltersPromise=new Promise(function(n){k=n}),!u.customFetch&&MsPortalFx.isFeatureEnabled("settingsflyout")&&MsPortalFx.isFeatureEnabled("globalresourcefilter")&&!FxImpl.internalEnv.isShell)f.onGlobalResourceFilterChange(t,(function(){k(!0);a(!0)}));else k(!1);return ko.computed(t,(function(){return[ko.unwrap(tt),ko.unwrap(u.resourceProviders),]})).extend({deferred:!0}).subscribe(t,(function(){return l.triggerValidation()})),l._fetchItems(u),l}return __extends(t,n),t.prototype._getSubscriptions=function(){return __awaiter(this,void 0,void 0,(function(){var i,n,t;return __generator(this,(function(r){switch(r.label){case 0:return[4,this._usingGlobalResourceFiltersPromise];case 1:return i=r.sent(),[4,l(this._enableMspFilter,i)];case 2:return n=r.sent(),this._updateOnOpen(n.isPartialSet),t=g(n),t?this._headerGroup({text:t}):this._headerGroup()&&this._headerGroup().text&&this._headerGroup(null),[2,n.subscriptions]}}))}))},t.prototype._fetchItems=function(n,t){var i=this,o=typeof t!="undefined"?t:!0;this._fetching(o);var r=n.customFetch,f=[],e,s=this._enableMspFilter?u.Impl.getDirectoriesMap(FxImpl.Rpc.client).then((function(n){i._directoryNameMap=n})):Q();return Q.all([r&&r()||this._getSubscriptions(),s,]).then((function(t){var r=t[0],h=t[1],o=i._directoryNameMap,s,u;return i._enableMspFilter&&o&&(s=r.some((function(n){var i=n.tenantId,t=o[(i||"").toLowerCase()];return!t||!(t.tenantCategory||"").toLowerCase().includes("home")})),i._groupByDirectories(s)),f=r,u=ko.unwrap(n.filterByGalleryItem),u?k(r,u).then((function(n){e=n})):void 0})).finally((function(){i._marketplaceValidation(e||{invalidSubscriptions:[]});Q.nextTick((function(){i.selectInitialOrCurrent(f);i._fetching(!1)}))}))},t})(r.ViewModel);t.ViewModel=a}));
define("Fx/Controls/SubscriptionDropDown",["require","exports","FxInternal/Controls/SubscriptionDropDown"],(function(n,t,i){"use strict";function u(n,t){var i;return ko.ignoreDependencies((function(){i=new r(n,t)})),i}Object.defineProperty(t,"__esModule",{value:!0});t.create=void 0;var r=(function(n){function t(t,i){return n.call(this,t,i)||this}return __extends(t,n),t})(i.ViewModel);t.create=u}));
define("FxInternal/Controls/Summary",["require","exports","FxInternal/Controls/Base/Base"],(function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ViewModel=void 0;var r=(function(n){function t(t,i){var r=n.call(this,t)||this;return i=i||{},r.controlType=134,r.visible=MsPortalFx.initObservable(i.visible,!0),r.cssClass=MsPortalFx.initObservable(i.cssClass,""),r.name=MsPortalFx.initObservable(i.name,""),r.children=MsPortalFx.initObservableArray(i.children,[]),r}return __extends(t,n),t})(i.ViewModel);t.ViewModel=r}));
define("Fx/Controls/Summary",["require","exports","FxInternal/Controls/Summary"],(function(n,t,i){"use strict";function r(n,t){var r;return ko.ignoreDependencies((function(){r=new i.ViewModel(n,t)})),r}Object.defineProperty(t,"__esModule",{value:!0});t.create=void 0;t.create=r}));
define("FxInternal/WeaveControls/Section.Component.Internal",["require","exports","Weave/SandboxMode","Weave","FxInternal/Weave/Util","FxInternal/_generated/Less/WeaveControls/Section.Component.css"],(function(n,t,i,r,u,f){"use strict";function o(n,t){var o=n.disabled;return t=n.children||t,i(r.Fragment,null,i(r.Css,{css:f}),u.mapValueOrComputation(n.name,s),i(r.GetContext,{fn:function(f){return i(r.SetContext,{labelPosition:n.leftLabelPosition&&!n.leftLabelWidth&&!n.smartAlignLabel?e.Left:e.Top,leftLabelWidth:n.leftLabelWidth,disabled:u.aggregateDisabled([f.disabled,o]),tabIndex:u.aggregateTabindex([f.tabIndex],o)},r.isComputation(t)?i(r.ForEach,{collection:t,fn:function(n){return n.item}}):t)}}))}function s(n){return MsPortalFx.isNullOrUndefined(n)?null:i("div",{className:"fxc-section-legend azc-br-muted fxc-section-name"},n)}Object.defineProperty(t,"__esModule",{value:!0});t.SectionInner=void 0;var e=MsPortalFx.ViewModels.Forms.LabelPosition;t.SectionInner=o}));
define("Fx/Weave/Components/Section",["require","exports","Weave/SandboxMode","Weave","FxInternal/Weave/Util","FxInternal/WeaveControls/Section.Component.Internal","FxInternal/WeaveControls/ComponentHandleCore"],(function(n,t,i,r,u,f,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Section=void 0;var o=function(n,t){var s,o;n||(n={children:t});s=n.handle||e.makeSimpleComponentHandle();o=["fxc-section","fxc-section-wrapper"];(n.leftLabelWidth||n.smartAlignLabel)&&o.push("msportalfx-form");n.smartAlignLabel&&o.push("fxc-smart-labels");var h=r.makeWritableComputation(0),c=n.smartAlignLabel?h.compose((function(n){return n>480})):n.leftLabelWidth?u.trueComputation:u.falseComputation,l=i("div",{visible:n.visible,className:[o,{"msportalfx-form-regular":c,"fxc-left-label-fixed":c},n.className,],style:{"min-height":n.minHeight?n.minHeight+"px":undefined},onResize:function(n){var t=n.width;h(t)}},f.SectionInner(n,t));return e.wrapInsideAggregationNode(l,s,n.visible)};t.Section=o}));
define("FxHubs/ArmHelpers/ArmResources",["require","exports","Fx/Ajax"],(function(n,t,i){"use strict";function e(n){var t=n&&n.properties||{};return(t.provisioningState||"").toLowerCase()}function f(n,t){return Q(i.batch({uri:n,type:"GET",options:0,setTelemetryHeader:t}))}function o(n,t){return f(n,t).then((function(n){return n.content}))}function s(n){return n&&(n.jqXHR&&(n=r.buildSimplifiedError(n.jqXHR)),n.httpStatusCode&&(n=r.buildSimplifiedError(n)),n.status!==0||n.code||(n.code=u)),n}var r,u;Object.defineProperty(t,"__esModule",{value:!0});t.buildError=t.getArmResource=t.getRawArmResource=t.getProvisioningState=t.rpRegistrationCheckRetries=t.rpRegistrationCheckDelay=void 0;r=FxImpl.Azure;t.rpRegistrationCheckDelay=1e3;t.rpRegistrationCheckRetries=3;u="ClientNetworkError";t.getProvisioningState=e;t.getRawArmResource=f;t.getArmResource=o;t.buildError=s}));
define("FxHubs/ArmHelpers/ArmResourceGroups",["require","exports","Fx/Ajax","FxHubs/ArmHelpers/ArmApisStartup","FxHubs/ArmHelpers/ArmResources","Fx","FxHubs/RpcEndPoints"],(function(n,t,i,r,u,f,e){"use strict";function l(n,i,r,f){return f===void 0&&(f=t.resourceGroupCheckRetries),Q.promise((function(e,o){var v=u.getProvisioningState(n);switch(v){case s.Succeeded:case s.Failed:return a.verbose("Creating resource group "+r+" "+v+"."),e(n);default:return f?Q.delay(t.resourceGroupCheckDelay).then((function(){return u.getArmResource(i,""+h+c+".attempt"+(t.resourceGroupCheckRetries-f))})).then((function(n){return l(n,i,r,f-1)})).then(e,o):(a.warning("Creating resource group "+r+": Status unknown after "+t.resourceGroupCheckRetries+" attempts."),e(n))}}))}function v(n,u,s,a,v){var p="/subscriptions/"+n+"/resourceGroups/"+u,y=r.resourceGroupApi(p);return Q.Promise((function(n,r){return f.isFeatureEnabled("armTokenTest")||t.allowlistedExtensions[FxImpl.postBootEnv.extensionName]?e.ResourceManager.internalDeploymentHelper.invoke(FxImpl.Rpc.client,o.Constants.Shell,{uri:y,type:"PUT",content:{name:u,location:s,tags:v},setTelemetryHeader:h+c,options:0}).then(n).catch(r):i.batch({uri:y,type:"PUT",content:{name:u,location:s,tags:v},setTelemetryHeader:h+c,options:0}).then(n).catch(r)})).then((function(n){return l(n.content,y,u)}))}function y(n){return"#asset/HubsExtension/ResourceGroups"+n}var o,s;Object.defineProperty(t,"__esModule",{value:!0});t.getDeepLinkToResourceGroup=t.createResourceGroup=t.allowlistedExtensions=t.checkResourceGroupStatus=t.resourceGroupCheckDelay=t.resourceGroupCheckRetries=t.rpRegistrationCheckRetries=void 0;o=MsPortalFx.Base;s=MsPortalFx.Azure.ResourceManager.DeploymentStates;t.rpRegistrationCheckRetries=3;t.resourceGroupCheckRetries=5;t.resourceGroupCheckDelay=1e3;var a=o.Diagnostics.createLog(n),h="Deploy.",c="createRG";t.checkResourceGroupStatus=l;t.allowlistedExtensions={VMCP:!0,Citrix_XenApp_Essentials:!0,Citrix_XenDesktop_Essentials:!0,CloudSimpleExtension:!0,SendGrid_EmailService:!0};t.createResourceGroup=v;t.getDeepLinkToResourceGroup=y}));
define("FxInternal/Composition/ViewModelAdapters.DoesProvisioning",["require","exports","Fx/DependencyInjection","FxHubs/RpcEndPoints","Fx/Composition/Selectable","FxInternal/Composition/ViewModel","FxHubs/ProvisioningRpc","FxInternal/ResourceManagement/Policies"],(function(n,t,i,r,u,f,e,o){"use strict";function b(n,t){var r=c.start({source:n&&MsPortalFx.last(n.id.split("/")),name:"ProvisioningBladeAdapter",action:"ProvisioningBladeOpen"}),i=!1;return function(u){if(!i){i=!0;var f=t.marketplaceItem||{};return c.endTrace(r,u?"Success":"Abandon",{action:"ProvisioningBladeClose",data:MsPortalFx.extend({bladeContext:n&&n.id,bladeInstanceId:n&&n.bladeInstanceId,telemetryId:t.telemetryId,marketplaceItemId:f.id,launchingContext:f.launchingContext},u)})}}}function s(n){return n&&{galleryItem:n,launchingContext:n&&n.launchingContext,subscriptionId:null,subscriptionDisplayName:null,resourceGroupName:null,resourceGroupLocation:null,resourceGroupLocationDisplayName:null,deploymentName:n&&n.deploymentName,deploymentTemplateFileUris:n&&n.deploymentTemplateFileUris,deploymentFragmentFileUris:n&&n.deploymentFragmentFileUris}}function l(n){return{managementGroupId:n.managementGroupId,resourceGroupLocation:n.resourceGroupLocation,location:n.location,resourceProviders:n.resourceProviders,parameters:n.parameters,referenceParameters:n.referenceParameters,marketplaceItemId:n.marketplaceItemId,parametersLinkUri:n.parametersLinkUri,provisioningHash:n.provisioningHash,templateLinkUri:n.templateLinkUri,templateJson:n.templateJson,templateLink:n.templateLink,deploymentMode:n.deploymentMode,validateTemplate:n.validateTemplate,validationResult:n.validationResult,subscriptionId:n.subscriptionId,deploymentName:n.deploymentName,resourceGroupName:n.resourceGroupName,resourceId:n.resourceId,launchingContext:n.launchingContext,debug:n.debug,validateRetry:n.validateRetry}}function k(n,t,i,r,u){var e,f=new h.Provisioner(n,null,{supplyTemplateDeploymentOptions:function(){return Q(e)},supplyGalleryCreateOptions:function(){return s(t.marketplaceItem)}}),c=t.provisioningConfig,o,a=s(t.marketplaceItem),v={dontDiscardJourney:c&&c.dontDiscardJourney,galleryCreateOptions:a,supplyDashboardPartReference:function(n){return o&&o(n)||i(n)},provisioningEnabled:!0,launchPostCreate:!0};return f.provisioningConfig(v),function(t){o=t.supplyPartReference;e=l(t);r()||e.validateTemplate||f.traceValidation("DeployWithoutValidate");var i=Q(f.startProvisioning(t.parameters));return f.deploymentStartedPromise.fxAwait(n).then((function(t){u(t);n.closeCurrentBlade()})),i}}function d(n){return function(t){var i;return new u.PdlBladeReference("TemplateViewerBlade","HubsExtension",{parameters:{options:{templateLink:t.templateLinkUri||((i=t.templateLink)===null||i===void 0?void 0:i.uri),templateJson:t.templateJson,parameters:t.parameters,telemetryId:n.telemetryId}}})}}function g(){return function(n){return new u.PdlBladeReference("ArmErrorsBlade","HubsExtension",{parameters:n})}}function nt(n,t,i){var r,u=new w.Provisioner(n,{supplyProvisioningPromise:function(){return r},supplyStartboardInfo:function(){return null}}),f=t.provisioningConfig,e={dontDiscardJourney:f&&f.dontDiscardJourney,provisioningEnabled:!0};return u.provisioningConfig(e),function(n){r=n.provisioningPromise;var t=Q(u.startProvisioning(null));return t.then((function(){return i(!0)})),t}}function tt(n,t,i){var u,r=new h.Provisioner(n,null,{supplyTemplateDeploymentOptions:function(){return Q(u)},supplyGalleryCreateOptions:function(){return s(t.marketplaceItem)}}),f=t.provisioningConfig,e={dontDiscardJourney:f&&f.dontDiscardJourney,galleryCreateOptions:s(t.marketplaceItem),provisioningEnabled:!0};return r.provisioningConfig(e),function(t){var f,e,o,s;return(i(!1),u=l(t),f=t.formValidationOptions||{},e=MsPortalFx.initValue(f.validateForm,!0),e)?(o=MsPortalFx.initValue(f.focusOnFirstInvalid,!1),s=!!f.validateHidden,n.form.triggerValidation(o,s).then((function(n){return n?r.validateTemplate(u).catch((function(n){r.traceValidation("FailedArmValidation");throw n;})).then((function(n){return i(!0),r.traceValidation("PassedValidation"),n})):(r.traceValidation("FailedFormValidation"),u)}))):Q(r.validateTemplate(u))}}function a(n,t,i,r,u){if(!t)throw new Error("This provisioning blade has been launched with invalid inputs from marketplace. Please ensure the $schema property in your gallery package UIDefinition.json is updated to 'https://gallery.azure.com/schemas/2018-02-12/UIDefinition.json#'");var f=t.provisioningConfig,h=function(n){var t;return f&&f.dashboardPartReference&&new MsPortalFx.Composition.PartReference(f.dashboardPartReference.partName,(t={},t[f.dashboardPartReference.dashboardPartKeyId]=n,t),f.dashboardPartReference.options)},s=ko.observable(!1),e=b(r,t);MsPortalFx.extend(n,{initialValues:t.initialValues,marketplaceItem:t.marketplaceItem,telemetryId:t.telemetryId,validateTemplate:tt(i,t,s),deployTemplate:k(i,t,h,s,e),deployCustom:nt(i,t,e),getAutomationBladeReference:d(t),getArmErrorsBladeReference:g(),policyValidationFactory:(u?i:{})[o.ltmPolicyFactoryKey]=new o.PolicyValidationFactoryImpl(i)});i.registerForDispose((function(){e(!1)}))}var v;Object.defineProperty(t,"__esModule",{value:!0});t.DoesProvisioningContext=t.setProvisioning=t.policyExperimentFlag=void 0;var y=MsPortalFx.Base,p=MsPortalFx.ViewModels,w=MsPortalFx.ViewModels.ParameterCollectionV3,h=FxImpl.Azure.ResourceManager,c=MsPortalFx.Base.Diagnostics.Telemetry;t.policyExperimentFlag=MsPortalFx.memoizeQ((function(){return Q(MsPortalFx.isFeatureEnabled("policyawarecontrols")||r.Experimentation.expirimentationEndpoint.invoke(FxImpl.Rpc.client,y.Constants.ExtensionNames.Hubs,["policyawarecreateflight"]).then((function(n){return n[0]})))}));t.setProvisioning=a;v=(function(){function r(n,i,r){this.value=Q.all([e.provisioningContextEndpoint.invoke(n,"fx",{}),t.policyExperimentFlag()]).spread((function(n,t){var u={};return a(u,n.provisioningInputs._provisioningContext,r,i,t),u}))}return r.DoesProvisioningContext=!0,__decorate([__metadata("fx:diagnostics",[n,"DoesProvisioningContext"]),i.Class("viewModel"),__metadata("design:paramtypes",[FxImpl.Rpc.Client,f.PartContext,p.ContainerContract])],r)})();t.DoesProvisioningContext=v}));
define("FxInternal/WeaveControls/Tab.Component",["require","exports","Fx/Weave/Components/Tab"],(function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});__exportStar(i,t)}))