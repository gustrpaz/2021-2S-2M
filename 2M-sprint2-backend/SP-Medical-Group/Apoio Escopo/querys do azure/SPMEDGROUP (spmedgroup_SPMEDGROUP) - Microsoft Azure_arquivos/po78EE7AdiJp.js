define("MsPortalImpl.Controls/Controls/Visualization/MonitorChartV2/Utils/LocaleFormatter",["require","exports","_oss/d3","MsPortalImpl.Controls/Controls/Visualization/MonitorChartV2/Strings","MsPortalImpl.Controls/Controls/Visualization/MonitorChartV2/AI/ME/Utilities/TimeUnits","MsPortalFx/Globalization"],(function(n,t,i,r,u,f){"use strict";function c(){var n,t;if(o.length<=0||s.length<=0)for(n=0;n<h.length;n++)o.push(f.DateTimeFormat.create(h[n])),t=h[n],t.timeZone="UTC",s.push(f.DateTimeFormat.create(t))}function v(n,t){for(var r=a,i=0;i<r.length;){if(r[i](n,t))return i;i++}return i-1}function y(n,t){c();var i=t?s[4]:o[4],r=i.format(n);return i=t?s[2]:o[2],r+(" "+i.format(n))}function p(n,t,i,f){var o=u.getDisplayUnit(n,t,i),h=r.TimeUnitsDisplay,s=u.convert(n,t,o);return{value:s!==0?e(s,f):"0",unit:h[o]}}function w(n,t){var r,u,f;if(c(),r=v(n,t),r===0)return t?i.time.format.utc(".%L")(n):i.time.format(".%L")(n);if(r!==-1){u="";f=void 0;try{f=t?s[r]:o[r];u=f.format(n)}catch(e){console.error("Intl failure. Given format: "+f+"; Date: "+n.toString()+"; Exception: "+e);u=t?i.time.format.utc(".%L")(n):i.time.format(".%L")(n)}return u}return null}function l(n,t){var f=i.formatPrefix(n),u=f.symbol,o;switch(u){case"G":u=r.billionUnit;break;case"M":u=r.millionUnit;break;case"k":u=r.kiloUnit}return o=f.scale(n),{value:e(o,t),unit:u}}function e(n,t){t===void 0&&(t=2);var i={minimumFractionDigits:0,maximumFractionDigits:t},r=f.NumberFormat.create(i);return r.format(n)}function b(n,t,i,u,f,o){var s=t?1e3:1024,c,h=u?r.bits:f?r.byteFull:r.bytes,l;return n<s?c=n:n<s*s?(c=n/s,h=r.infoUnit.replace("{0}",i?r.kilo:r.kibi).replace("{1}",h)):n<s*s*s?(c=n/s/s,h=r.infoUnit.replace("{0}",i?r.mega:r.mebi).replace("{1}",h)):n<s*s*s*s?(c=n/s/s/s,h=r.infoUnit.replace("{0}",i?r.giga:r.gibi).replace("{1}",h)):n<s*s*s*s*s?(c=n/s/s/s/s,h=r.infoUnit.replace("{0}",i?r.tera:r.tebi).replace("{1}",h)):(c=n/s/s/s/s/s,h=r.infoUnit.replace("{0}",i?r.peta:r.pebi).replace("{1}",h)),l=Math.round(c*10)%10!=0,{value:l?e(c,o):e(c),unit:h}}function k(n,t){if(Math.floor(n/1e3)>0){n=Math.floor(n/100)*100;var i=l(n);return{value:i.value+i.unit,unit:"%"}}return n=Math.round(n*1e4)/1e4,{value:e(n,t||4),unit:"%"}}function d(n,t,u){var o=i.formatPrefix(n),f=o.symbol,s;return f=t?r.abbvCoresDisplayUnit.replace("{0}",f).replace("{1}",r.abbvCoreUnit):r.coresDisplayUnit.replace("{0}",f).replace("{1}",r.coreUnit),s=o.scale(n),{value:e(s,u),unit:f}}Object.defineProperty(t,"__esModule",{value:!0});t.formatCores=t.formatPercentages=t.formatData=t.formatCounts=t.formatAxisTime=t.formatTime=t.formatTickTime=void 0;var a=[function(n,t){return t?!!n.getUTCMilliseconds():!!n.getMilliseconds()},function(n,t){return t?!!n.getUTCSeconds():!!n.getSeconds()},function(n,t){return t?!!n.getUTCMinutes():!!n.getMinutes()},function(n,t){return t?!!n.getUTCHours():!!n.getHours()},function(n,t){return t?n.getUTCDay()&&n.getUTCDate()!==1:n.getDay()&&n.getDate()!==1},function(n,t){return t?n.getUTCDate()!==1:n.getDate()!==1},function(n,t){return t?!!n.getUTCMonth():!!n.getMonth()},function(){return!0},],h=[{second:"2-digit"},{second:"2-digit"},{hour:"numeric",minute:"2-digit"},{hour:"numeric"},{month:"short",day:"numeric"},{month:"short",day:"numeric"},{month:"long"},{year:"numeric"},],o=[],s=[];t.formatTickTime=y;t.formatTime=p;t.formatAxisTime=w;t.formatCounts=l;t.formatData=b;t.formatPercentages=k;t.formatCores=d}));
define("MsPortalImpl.Controls/Controls/Visualization/MonitorChartV2/AI/ME/Utilities/UxUtil",["require","exports","MsPortalImpl.Controls/Controls/Visualization/MonitorChartV2/Strings","MsPortalImpl.Controls/Controls/Visualization/MonitorChartV2/Utils/LocaleFormatter","MsPortalImpl.Controls/Controls/Visualization/MonitorChartV2/Utils/MappedUtils","MsPortalImpl.Controls/Controls/Visualization/MonitorChartV2/AI/ME/DataModels/MetricsExplorerItemDataModel","MsPortalImpl.Controls/Controls/Visualization/MonitorChartV2/AI/ME/Utilities/MetricsExplorerItemDataModelUtil"],(function(n,t,i,r,u,f,e){"use strict";function p(n){var t=new f.MetricsExplorerItemDataModel(u.clone(e.toMetricsExplorerItemDataObject(n),!0));return t.titleKind=n.titleKind,t}function w(n,t,u,f,e){var o={value:"",unit:""},s,h,c,l;switch(t){case 7:o=r.formatTime(n,1,!1,e);break;case 6:o=r.formatTime(n,1e3,!1,e);break;case 5:o=r.formatPercentages(n,e);break;case 2:o=r.formatData(n,f,u,!1,!1,e);break;case 8:s=r.formatData(n,f,u,!1,!0,e);o={value:s.value,unit:s.unit+" "+i.secondsFull};break;case 9:h=r.formatData(n,f,u,!0,!1,e);o={value:h.value,unit:h.unit+i.perSecond};break;case 4:c=r.formatData(n,f,u,!1,!1,e);o={value:c.value,unit:c.unit+i.perSecond};break;case 3:l=r.formatCounts(n,e);o={value:l.value,unit:l.unit+i.perSecond};break;case 10:o=r.formatCores(n,!1,e);break;case 11:o=r.formatCores(n*.001,!1,e);break;case 12:o=r.formatCores(n*.001*.001*.001,!1,e);break;default:o=r.formatCounts(n,e)}return o}function b(n){switch(n){case"Auto":return 1;case"PT1M":return 2;case"PT5M":return 7;case"PT15M":return 8;case"PT30M":return 9;case"PT1H":return 3;case"PT6H":return 10;case"PT12H":return 11;case"P1D":return 4;case"P1W":return 5;case"P1M":return 6;default:return 1}}function k(n,t,i,r,u,f){var o=[],h=[],a,c,e,l;return r||(r=0),n&&n.length>0&&t&&(a=!!(t&&t[0]&&t[0].segment&&t[0].segment[0]),c=n.length>1?n[1].getTime()-n[0].getTime():0,t.length>0?t.forEach((function(t){var w=0,l=[],k=[],p,nt,b,it,rt,tt,y;if(t&&t.dataPoints&&t.dataPoints.length>0)for(var d=a?t.segment[0].value:i.displayName,v=0,g=void 0;v<n.length;)e=r===1?0:undefined,g=!0,w<t.dataPoints.length?(p=t.dataPoints[w],nt=n[v].getTime()-p.timestamp.getTime(),nt>=0?(nt<=c?(k.push({timestamp:n[v],value:p.value,missingValue:!1}),l.push({x:n[v],y:p.value,y0:0,metric:d,metricUnit:i.unit,segment:undefined,missingValue:!1})):g=!1,w++):((r===2||r===3)&&(w===0?e=p.value:(b=t.dataPoints[w-1],r===2?(it=Math.round((p.timestamp.getTime()-b.timestamp.getTime())/c),rt=(p.value-b.value)/it,e=b.value+rt*Math.floor((n[v].getTime()-b.timestamp.getTime())/c)):e=b.value)),w===0&&u||r!==0&&(k.push({timestamp:n[v],value:e,missingValue:!0}),l.push({x:n[v],y:e,y0:0,metric:d,metricUnit:i.unit,segment:undefined,missingValue:!0})))):((r===2||r===3)&&(e=t.dataPoints[t.dataPoints.length-1].value),r!==0&&(k.push({timestamp:n[v],value:e,missingValue:!0}),l.push({x:n[v],y:e,y0:0,metric:d,metricUnit:i.unit,segment:undefined,missingValue:!0}))),g&&v++;else f&&(tt=s(n,i),l=tt.d3DataPoints,k=tt.metricDataPoints);if(t&&t.dataPoints&&n.length>t.dataPoints.length)for(y=0;y<l.length;)l[y].previousValueMissing=y>0?l[y-1].missingValue:undefined,l[y].nextValueMissing=y<l.length-1?l[y+1].missingValue:undefined,y++;h.push(l);o.push(k)})):f?(l=s(n,i),h.push(l.d3DataPoints),o.push(l.metricResultDataPoints)):(h.push([]),o.push([]))),{d3StackDataSet:h,transformedMetricResult:o}}function d(n,t){if(!n)return t;switch(n.userDataStatus){case 8:return i.tooManyDataPoints;case 9:return i.grainNotSupported;case 10:return i.noCommonGrain;case 12:return i.invalidConfigMessage;default:return g(n.error,t)}}function g(n,t){var b=nt(n),p,u,r,f,e,w,s;switch(b){case 429:return i.throttledMessage;case 401:return p=JSON.stringify(n),p.indexOf("InvalidAuthenticationTokenTenant")>=0?i.forbiddenMessage:i.unauthorizedMessage;case 403:return i.forbiddenMessage;case 404:return i.resourceNotfoundMessage;case 400:if(u=void 0,r=o(n,["content","message"])||o(n,["message"])||o(n,["responseText"]),r){if(r.indexOf(c)>=0)return u=i.dimensionNotSupported,f=r.indexOf(h),f>=0&&(e=r.substr(f+h.length+1),e&&(u+=" "+i.supportedDimensions.replace("{0}",e))),u;if(r.indexOf(l)>=0)return i.grainNotSupported;if(r.indexOf(a)>=0||r.indexOf(v)>=0)return i.tooMuchDataReturnedError;if(r.indexOf(y)>=0)return i.queryOutof93DaysRetentionError}if(w=o(n,["body","error","code"]),w==="BadArgumentError"&&(s=JSON.stringify(n),s&&s.indexOf("dimensions are not valid")>=0))return i.dimensionNotSupported}return t}function nt(n){var i=0,t;return n&&(t=o(n,["status"])||o(n,["jqXHR","status"])||o(n,["httpStatusCode"])||o(n,["reason","status"])||o(n,["reason","jqXHR","status"])||o(n,["reason","httpStatusCode"]),t&&(i=Number(t))),i}function o(n,t){var i=n;return t.forEach((function(n){i=i&&tt(i,n.toLowerCase())})),i}function tt(n,t){if(n)for(var i in n)if(n.hasOwnProperty(i)&&i.toLowerCase()===t)return n[i]}function s(n,t){var i=[],r=[];return n&&n.length>0&&n.forEach((function(n){i.push({x:n,y:0,y0:0,metric:t.displayName,metricUnit:t.unit,segment:undefined,missingValue:!0});r.push({timestamp:n,value:0,missingValue:!0})})),{d3DataPoints:i,metricDataPoints:r}}function it(n,t){var i=document.createElement("div"),f=u.createElement("div",{"class":"fxc-monitorchartv2-progress",id:"spinner-"+n},u.createElement("div",{"class":"fxs-progress-dots"},u.createElement("div",{"class":"fxs-progress-dots-dot"}),u.createElement("div",{"class":"fxs-progress-dots-dot"}),u.createElement("div",{"class":"fxs-progress-dots-dot"}))),r;return i.appendChild(f),t.appendChild(i),r=i.getElementsByClassName("fxc-monitorchartv2-progress")[0],r.style.display="none",r}function rt(n,t){var r="fxc-monitorchart-watermark-text",f="fxc-monitorchart-watermark-text-id-"+n,s=u.createElement("div",{"class":r,id:f}),i=u.createElement("div",{"class":"fxc-monitorchart-watermark-container"},u.createElement("div",{id:"watermark"+n,"class":"fxc-monitorchart-watermark"},s)),e=t,o=i.getElementsByClassName(r)[0],h=function(){i.style.display="none"},c=function(n){o.textContent=n;o.title=n;i.style.display="flex";var t=i.children[0].children[0];t.setAttribute("aria-label",n);t.setAttribute("title",n);t.textContent=n;e.setAttribute("aria-activedescendant",f);e.appendChild(i)};return{hide:h,show:c}}Object.defineProperty(t,"__esModule",{value:!0});t.UxUtilDEV=t.CreateWaterMark=t.getSpinner=t.createEmptyD3StackDataPoints=t.getErrorMessage=t.transformMetricResultForD3=t.ToGrain=t.GetFormattedValue=t.cloneDataModel=t.RefreshTypeConst=void 0;var c="does not support requested dimension",h="supported ones are:",l="invalid time grain",a="response size of 8000000 bytes exceeded",v="exceeded maximum limit of 8MB",y="is out of the Max metrics retention period: 93.00";t.RefreshTypeConst=["None","Manual","Auto","NewInputs","Resize","Initial","TimeContextChanged","LoadMore","ItemDataModelChanged","VisualChanged","TimeBrush","MetricAdded","MetricUpdated","RemovedMetric","GroupingUpdated","FiltersUpdated","ShowEverything","InitialQueryWarmup",];t.cloneDataModel=p;t.GetFormattedValue=w;t.ToGrain=b;t.transformMetricResultForD3=k;t.getErrorMessage=d;t.createEmptyD3StackDataPoints=s;t.getSpinner=it;t.CreateWaterMark=rt}))