define("MsPortalImpl/UI/UI.DeepLink",["require","exports","Fx/ResourceManagement","MsPortalImpl/Base/Base.ArmIdHelpers","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding"],(function(n,t,i,r,u,f,e){"use strict";function l(n,t,f,e,s){s===void 0&&(s={});var b=h(t,f.name,e),c=s.assetId,k=s.assetType,v=typeof c,d=ko.unwrap(c),p=i.ArmId.parse(d,!0),w=s.selectedMenuItemId,y=s.setDeepLinkContext||$.noop,l,g=!1;return b?l=u.getGalleryDeepLink(b,{model:e}):v==="string"&&(r.isResourceAtAnyLevel(p)||p.kind===4||p.kind===1)?l=o(n,c,{selectedMenuItemId:w}):c&&v==="object"&&c.id&&MsPortalFx.keysLength(c)===1&&r.isResourceAtAnyLevel(i.ArmId.parse(c.id,!0))?l=o(n,c.id,{selectedMenuItemId:w}):(v==="string"||v==="number")&&k?l=u.getAssetDeepLink(n,{extensionName:t,assetType:k,assetId:d}):(f.outputs&&f.outputs.length>0?y("",!1,"BladeHasOutputs"):f.pinnable||a(e)?l=u.getBladeDeepLink(t,f.name,e,{allowObjectsInLinks:!0,selectedMenuItemId:w,setDeepLinkContext:y}):y("",!1,"BladeNotPinnableWithModel"),g=!0),g||y(l,!0),l}function o(n,t,i){var r,u,e;return i===void 0&&(i={}),r=encodeURI(t),i.selectedMenuItemId&&(r+="/"+i.selectedMenuItemId),u=n.get(f.AuthStateManager).getSignedInUserTenant(),e=new s.UriBuilder(i.baseUri),e.fragment=(u&&"@"+u+"/")+"resource"+r,e.toString()}function h(n,t,i){var s=null,h=n==="Microsoft_Azure_Marketplace",l=t===c.BladeNames.Hubs.CreateHubBlade,f,u,r,o;if(i){if(h&&l)return typeof i.package=="function"?i.package():null;if(f=e.getModelValue(i,"_provisioningContext.marketplaceItem.launchingContext.galleryItemId").value,f)return f;u=i.internal_bladeCallerParams&&i.internal_bladeCallerParams();r=void 0;u?r=e.getModelValue(u.providerConfig&&FxImpl.fromSerializableObject(u.providerConfig),"provisioningConfig.galleryCreateOptions.galleryItem").value:(o=i["collectorBindingInternals-inputs"],o&&(r=(((o._latestValue||{}).options||{}).galleryOptions||{}).galleryItem));s=r&&r.id&&r.version&&r.id.replace("."+r.version,"")}return s}function a(n){return MsPortalFx.isNullOrUndefined(n)||MsPortalFx.isEmptyObject(n)?!0:!1}Object.defineProperty(t,"__esModule",{value:!0});t.getGalleryItemIdFromBladeComposition=t.getResourceDeepLink=t.getDeepLink=void 0;var s=MsPortalFx.Base,c=s.Constants;t.getDeepLink=l;t.getResourceDeepLink=o;t.getGalleryItemIdFromBladeComposition=h}))