define("office-ui-fabric-react/lib/Selection",["@uifabric/utilities","tslib","react"],(function(n,t,i){return (function(){"use strict";function r(n){var i=f[n],t;return void 0!==i?i.exports:(t=f[n]={exports:{}},e[n](t,t.exports,r),t.exports)}var e={1867:function(t){t.exports=n},9297:function(n){n.exports=i},4780:function(n){n.exports=t}},f={},u;return r.d=function(n,t){for(var i in t)r.o(t,i)&&!r.o(n,i)&&Object.defineProperty(n,i,{enumerable:!0,get:t[i]})},r.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},r.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})},u={},(function(){r.r(u);r.d(u,{SELECTION_CHANGE:function(){return n.SELECTION_CHANGE},Selection:function(){return n.Selection},SelectionDirection:function(){return n.SelectionDirection},SelectionMode:function(){return n.SelectionMode},SelectionZone:function(){return h}});var n=r(1867),e=r(4780),i=r(9297),o="data-selection-index",t="data-selection-toggle",f="data-selection-invoke",s="data-selection-all-toggle",h=(function(r){function u(u){var e=r.call(this,u)||this,o,h;return e._root=i.createRef(),e.ignoreNextFocus=function(){e._handleNextFocus(!1)},e._onSelectionChange=function(){var n=e.props.selection,t=n.isModal&&n.isModal();e.setState({isModal:t})},e._onMouseDownCapture=function(t){var i=t.target;if(document.activeElement===i||n.elementContains(document.activeElement,i)){if(n.elementContains(i,e._root.current))for(;i!==e._root.current;){if(e._hasAttribute(i,f)){e.ignoreNextFocus();break}i=n.getParent(i)}}else e.ignoreNextFocus()},e._onFocus=function(i){var o=i.target,r=e.props.selection,h=e._isCtrlPressed||e._isMetaPressed,c=e._getSelectionMode(),s,f,u;e._shouldHandleFocus&&c!==n.SelectionMode.none&&(s=e._hasAttribute(o,t),f=e._findItemRoot(o),!s&&f&&(u=e._getItemIndex(f),h?(r.setIndexSelected(u,r.isIndexSelected(u),!0),e.props.enterModalOnTouch&&e._isTouch&&r.setModal&&(r.setModal(!0),e._setIsTouch(!1))):e.props.isSelectedOnFocus&&e._onItemSurfaceClick(i,u)));e._handleNextFocus(!1)},e._onMouseDown=function(i){e._updateModifiers(i);var r=i.target,u=e._findItemRoot(r);if(!e._isSelectionDisabled(r))for(;r!==e._root.current&&!e._hasAttribute(r,s);){if(u){if(e._hasAttribute(r,t))break;if(e._hasAttribute(r,f))break;if(!(r!==u&&!e._shouldAutoSelect(r)||e._isShiftPressed||e._isCtrlPressed||e._isMetaPressed)){e._onInvokeMouseDown(i,e._getItemIndex(u));break}if(e.props.disableAutoSelectOnInputElements&&("A"===r.tagName||"BUTTON"===r.tagName||"INPUT"===r.tagName))return}r=n.getParent(r)}},e._onTouchStartCapture=function(){e._setIsTouch(!0)},e._onClick=function(i){var c=e.props.enableTouchInvocationTarget,l=void 0!==c&&c,u;e._updateModifiers(i);for(var r=i.target,o=e._findItemRoot(r),h=e._isSelectionDisabled(r);r!==e._root.current;){if(e._hasAttribute(r,s)){h||e._onToggleAllClick(i);break}if(o){if(u=e._getItemIndex(o),e._hasAttribute(r,t)){h||(e._isShiftPressed?e._onItemSurfaceClick(i,u):e._onToggleClick(i,u));break}if(e._isTouch&&l&&e._hasAttribute(r,"data-selection-touch-invoke")||e._hasAttribute(r,f)){e._onInvokeClick(i,u);break}if(r===o){h||e._onItemSurfaceClick(i,u);break}if("A"===r.tagName||"BUTTON"===r.tagName||"INPUT"===r.tagName)return}r=n.getParent(r)}},e._onContextMenu=function(n){var f=n.target,r=e.props,u=r.onItemContextMenu,o=r.selection,i,t;u&&(i=e._findItemRoot(f),i&&(t=e._getItemIndex(i),e._onInvokeMouseDown(n,t),u(o.getItems()[t],t,n.nativeEvent)||n.preventDefault()))},e._onDoubleClick=function(i){var r=i.target,s=e.props.onItemInvoked,u=e._findItemRoot(r),o;if(u&&s&&!e._isInputElement(r)){for(o=e._getItemIndex(u);r!==e._root.current&&!e._hasAttribute(r,t)&&!e._hasAttribute(r,f);){if(r===u){e._onInvokeClick(i,o);break}r=n.getParent(r)}r=n.getParent(r)}},e._onKeyDownCapture=function(n){e._updateModifiers(n);e._handleNextFocus(!0)},e._onKeyDown=function(i){var h,o,s;e._updateModifiers(i);var r=i.target,u=e._isSelectionDisabled(r),f=e.props.selection,c=i.which===n.KeyCodes.a&&(e._isCtrlPressed||e._isMetaPressed),l=i.which===n.KeyCodes.escape;if(!e._isInputElement(r)){if(h=e._getSelectionMode(),c&&h===n.SelectionMode.multiple&&!f.isAllSelected())return u||f.setAllSelected(!0),i.stopPropagation(),void i.preventDefault();if(l&&f.getSelectedCount()>0)return u||f.setAllSelected(!1),i.stopPropagation(),void i.preventDefault();if(o=e._findItemRoot(r),o)for(s=e._getItemIndex(o);r!==e._root.current&&!e._hasAttribute(r,t);){if(e._shouldAutoSelect(r)){u||e._onInvokeMouseDown(i,s);break}if(!(i.which!==n.KeyCodes.enter&&i.which!==n.KeyCodes.space||"BUTTON"!==r.tagName&&"A"!==r.tagName&&"INPUT"!==r.tagName))return!1;if(r===o){if(i.which===n.KeyCodes.enter)return e._onInvokeClick(i,s),void i.preventDefault();if(i.which===n.KeyCodes.space)return u||e._onToggleClick(i,s),void i.preventDefault();break}r=n.getParent(r)}}},e._events=new n.EventGroup(e),e._async=new n.Async(e),n.initializeComponentRef(e),o=e.props.selection,h=o.isModal&&o.isModal(),e.state={isModal:h},e}return e.__extends(u,r),u.getDerivedStateFromProps=function(n,t){var i=n.selection.isModal&&n.selection.isModal();return e.__assign(e.__assign({},t),{isModal:i})},u.prototype.componentDidMount=function(){var t=n.getWindow(this._root.current);this._events.on(t,"keydown, keyup",this._updateModifiers,!0);this._events.on(document,"click",this._findScrollParentAndTryClearOnEmptyClick);this._events.on(document.body,"touchstart",this._onTouchStartCapture,!0);this._events.on(document.body,"touchend",this._onTouchStartCapture,!0);this._events.on(this.props.selection,"change",this._onSelectionChange)},u.prototype.render=function(){var t=this.state.isModal;return i.createElement("div",{className:n.css("ms-SelectionZone",this.props.className,{"ms-SelectionZone--modal":!!t}),ref:this._root,onKeyDown:this._onKeyDown,onMouseDown:this._onMouseDown,onKeyDownCapture:this._onKeyDownCapture,onClick:this._onClick,role:"presentation",onDoubleClick:this._onDoubleClick,onContextMenu:this._onContextMenu,onMouseDownCapture:this._onMouseDownCapture,onFocusCapture:this._onFocus,"data-selection-is-modal":!!t||void 0},this.props.children,i.createElement(n.FocusRects,null))},u.prototype.componentDidUpdate=function(n){var t=this.props.selection;t!==n.selection&&(this._events.off(n.selection),this._events.on(t,"change",this._onSelectionChange))},u.prototype.componentWillUnmount=function(){this._events.dispose();this._async.dispose()},u.prototype._isSelectionDisabled=function(t){if(this._getSelectionMode()===n.SelectionMode.none)return!0;for(;t!==this._root.current;){if(this._hasAttribute(t,"data-selection-disabled"))return!0;t=n.getParent(t)}return!1},u.prototype._onToggleAllClick=function(t){var i=this.props.selection;this._getSelectionMode()===n.SelectionMode.multiple&&(i.toggleAllSelected(),t.stopPropagation(),t.preventDefault())},u.prototype._onToggleClick=function(t,i){var r=this.props.selection,u=this._getSelectionMode(),f,e;if(r.setChangeEvents(!1),this.props.enterModalOnTouch&&this._isTouch&&!r.isIndexSelected(i)&&r.setModal&&(r.setModal(!0),this._setIsTouch(!1)),u===n.SelectionMode.multiple)r.toggleIndexSelected(i);else{if(u!==n.SelectionMode.single)return void r.setChangeEvents(!0);f=r.isIndexSelected(i);e=r.isModal&&r.isModal();r.setAllSelected(!1);r.setIndexSelected(i,!f,!0);e&&r.setModal&&r.setModal(!0)}r.setChangeEvents(!0);t.stopPropagation()},u.prototype._onInvokeClick=function(n,t){var i=this.props,u=i.selection,r=i.onItemInvoked;r&&(r(u.getItems()[t],t,n.nativeEvent),n.preventDefault(),n.stopPropagation())},u.prototype._onItemSurfaceClick=function(t,i){var r=this.props.selection,u=this._isCtrlPressed||this._isMetaPressed,f=this._getSelectionMode();f===n.SelectionMode.multiple?this._isShiftPressed&&!this._isTabPressed?r.selectToIndex(i,!u):u?r.toggleIndexSelected(i):this._clearAndSelectIndex(i):f===n.SelectionMode.single&&this._clearAndSelectIndex(i)},u.prototype._onInvokeMouseDown=function(n,t){this.props.selection.isIndexSelected(t)||this._clearAndSelectIndex(t)},u.prototype._findScrollParentAndTryClearOnEmptyClick=function(t){var i=n.findScrollableParent(this._root.current);this._events.off(document,"click",this._findScrollParentAndTryClearOnEmptyClick);this._events.on(i,"click",this._tryClearOnEmptyClick);(i&&t.target instanceof Node&&i.contains(t.target)||i===t.target)&&this._tryClearOnEmptyClick(t)},u.prototype._tryClearOnEmptyClick=function(n){!this.props.selectionPreservedOnEmptyClick&&this._isNonHandledClick(n.target)&&this.props.selection.setAllSelected(!1)},u.prototype._clearAndSelectIndex=function(n){var t=this.props.selection,i;1===t.getSelectedCount()&&t.isIndexSelected(n)||(i=t.isModal&&t.isModal(),t.setChangeEvents(!1),t.setAllSelected(!1),t.setIndexSelected(n,!0,!0),(i||this.props.enterModalOnTouch&&this._isTouch)&&(t.setModal&&t.setModal(!0),this._isTouch&&this._setIsTouch(!1)),t.setChangeEvents(!0))},u.prototype._updateModifiers=function(t){this._isShiftPressed=t.shiftKey;this._isCtrlPressed=t.ctrlKey;this._isMetaPressed=t.metaKey;var i=t.keyCode;this._isTabPressed=!!i&&i===n.KeyCodes.tab},u.prototype._findItemRoot=function(t){for(var i,r,u=this.props.selection;t!==this._root.current;){if(i=t.getAttribute(o),r=Number(i),null!==i&&r>=0&&r<u.getItems().length)break;t=n.getParent(t)}if(t!==this._root.current)return t},u.prototype._getItemIndex=function(n){return Number(n.getAttribute(o))},u.prototype._shouldAutoSelect=function(n){return this._hasAttribute(n,"data-selection-select")},u.prototype._hasAttribute=function(t,i){for(var r=!1;!r&&t!==this._root.current;)r="true"===t.getAttribute(i),t=n.getParent(t);return r},u.prototype._isInputElement=function(n){return"INPUT"===n.tagName||"TEXTAREA"===n.tagName},u.prototype._isNonHandledClick=function(t){var i=n.getDocument();if(i&&t)for(;t&&t!==i.documentElement;){if(n.isElementTabbable(t))return!1;t=n.getParent(t)}return!0},u.prototype._handleNextFocus=function(n){var t=this;this._shouldHandleFocusTimeoutId&&(this._async.clearTimeout(this._shouldHandleFocusTimeoutId),this._shouldHandleFocusTimeoutId=void 0);this._shouldHandleFocus=n;n&&this._async.setTimeout((function(){t._shouldHandleFocus=!1}),100)},u.prototype._setIsTouch=function(n){var t=this;this._isTouchTimeoutId&&(this._async.clearTimeout(this._isTouchTimeoutId),this._isTouchTimeoutId=void 0);this._isTouch=!0;n&&this._async.setTimeout((function(){t._isTouch=!1}),300)},u.prototype._getSelectionMode=function(){var t=this.props.selection,i=this.props.selectionMode;return void 0===i?t?t.mode:n.SelectionMode.none:i},u.defaultProps={isSelectedOnFocus:!0,selectionMode:n.SelectionMode.multiple},u})(i.Component)})(),u})()}))