define("MsPortalImpl.Controls/Controls/Visualization/MonitorChartV2/AI/ME/DataModels/MetricsExplorerItemDataModel",["require","exports","MsPortalImpl.Controls/Controls/Visualization/MonitorChartV2/AI/ME/Telemetry","MsPortalImpl.Controls/Controls/Visualization/MonitorChartV2/AI/ME/Utilities/FilterTreeHelper","MsPortalImpl.Controls/Controls/Visualization/MonitorChartV2/AI/ME/Utilities/Util"],(function(n,t,i,r,u){"use strict";function a(n,t,i,u,f){return(i===void 0&&(i=!0),u===void 0&&(u=!1),f===void 0&&(f=!0),!n&&!t)?!0:n&&t?f&&n.id!==t.id||n.title!==t.title?!1:s(n.grouping,t.grouping)?i&&!e(n.visualization,t.visualization)?!1:r.FiltersEqual(n.filters,t.filters)?o(n.metrics,t.metrics,u):!1:!1:!1}function e(n,t){return!n&&!t?!0:n&&t&&JSON.stringify(n)===JSON.stringify(t)}function v(n,t){return n=n||{},t=t||{},y(n.simpleThreshold,t.simpleThreshold)&&p(n.dynamicThreshold,t.dynamicThreshold)}function y(n,t){return u.isEqualWrapper(n,t,(function(){return n.alertThresholdHigh===t.alertThresholdHigh&&n.operator===t.operator&&n.isLocked===t.isLocked}))}function p(n,t){return u.isEqualWrapper(n,t,(function(){return n.consecutivePeriods===t.consecutivePeriods&&n.consecutiveViolations===t.consecutiveViolations&&n.operator===t.operator&&n.sensitivity===t.sensitivity&&n.startTime===t.startTime&&n.doNotUpdate===t.doNotUpdate&&n.historyOffsetInDays===t.historyOffsetInDays}))}function s(n,t){return u.isEqualWrapper(n,t,(function(){return!n.dimension&&!t.dimension?!0:n.dimension&&t.dimension&&n.dimension.dimensionName.id===t.dimension.dimensionName.id&&n.sort===t.sort&&n.top===t.top}))}function o(n,t,i){var e,r,u;if(i===void 0&&(i=!0),!n&&!t)return!0;if(n&&t){if(n.length!==t.length)return!1;for(e=0;e<n.length;e++){if(r=n[e],u=t[e],r&&!u||!r&&u)return!1;if(r&&u)if(f(r.id,u.id)){if(!i&&(r.metricAggregation!==u.metricAggregation||r.color&&!u.color||!r.color&&u.color||r.color!==u.color))return!1}else return!1}}else return!1;return!0}function h(n,t){return u.isEqualWrapper(n,t,(function(){return n.maxValue===t.maxValue&&n.minValue===t.minValue&&n.options===t.options}))}function w(n,t){return u.isEqualWrapper(n,t,(function(n,t){return n.id&&t.id&&n.id.toLowerCase()===t.id.toLowerCase()}))}function f(n,t){return u.isEqualWrapper(n,t,(function(t,i){var r=u.ResourceEquals(t.resourceDefinition,i.resourceDefinition)&&w(t.name,i.name);return r&&(t.namespace&&i.namespace?n.namespace.name===i.namespace.name:!0)}))}function b(n,t){switch(n){case 1:return"Auto";case 2:return"Custom";case 0:return"None"}return t?"Custom":"None"}function c(n,t){switch(n){case"Auto":return 1;case"Custom":return 2;case"None":return 0}return t?2:0}function k(n){return n.metrics.map((function(n){return u.getResourceDefinitionUniqueId(n.id.resourceDefinition)})).filter((function(n,t,i){return i.indexOf(n)===t})).length===1}function d(n){var t=n.metrics.map((function(n){return nt(n.id.namespace)}));return t.filter((function(n,i){return t.indexOf(n)===i})).length===1}function g(n){var t=n.metrics.map((function(n){return n.id.name&&n.id.name.id}));return t.filter((function(n,i){return t.indexOf(n)===i})).length===1}function nt(n){return n&&(n.displayName||n.name)}function tt(n,t){var i=t.filter((function(t){return f(n.metricId,t.id)&&n.aggregation===t.metricAggregation}));return i&&i.length!==0||(i=t.filter((function(t){return f(n.metricId,t.id)&&!t.metricAggregation})),i&&i.length>0&&i.map((function(t){t.metricAggregation=n.aggregation}))),i}Object.defineProperty(t,"__esModule",{value:!0});t.findMetricDataModelMatches=t.MEItemDEV=t.HasSingleMetric=t.HasSingleNamespace=t.HasSingleResource=t.ConvertTitleKindToEnum=t.ConvertTitleKindToString=t.MetricIdEquals=t.AxisOptionsEquals=t.MetricsEquals=t.VisualizationEquals=t.Equals=t.MetricsExplorerItemDataModel=void 0;var l=(function(){function n(n){this.sortIndex=1;this.version=n.version;this.id=n.id||u.GUID();this.grouping=n.grouping;this.filters=r.hydrateFilter(n.filters);this.localColorIndex=0;this.yAxisOptions=n.yAxisOptions||{options:1};this.appliedISOGrain=n.appliedISOGrain;this.visualization=n.visualization;this.alertThresholdOptions=n.alertThresholdOptions;this._updateMetric(n.metrics);this.titleKind=c(n.titleKind,n.title);this.title=n.title;this._telemetryContext=i.getOrCreateTelemetryContext(this)}return n.prototype.MetricCount=function(){return this.metrics.length},n.prototype.HasMetrics=function(){return this.metrics.length>0},n.prototype.IsSegmented=function(){return!!this.grouping&&!!this.grouping.dimension&&!!this.grouping.dimension.dimensionName&&!!this.grouping.dimension.dimensionName.id},n.prototype.Update=function(n){var o,f,t;if(n)for(o={ChartId:this.id},f=Object.keys(n),t=0;t<f.length;t++)switch(f[t]){case"grouping":s(this.grouping,n.grouping)||(this.grouping=n.grouping);break;case"filters":r.FiltersEqual(this.filters,n.filters)||(this.filters=n.filters);break;case"metrics":this._updateMetric(n.metrics);break;case"id":n.id&&this.id!==n.id&&(this.id=n.id);break;case"yAxisOptions":h(this.yAxisOptions,n.yAxisOptions)||(this.yAxisOptions=n.yAxisOptions);break;case"alertThresholdOptions":v(this.alertThresholdOptions,n.alertThresholdOptions)||(this.alertThresholdOptions=n.alertThresholdOptions);break;case"title":this.title!==n.title&&(this.title=n.title,this.titleKind=2);break;case"appliedISOGrain":this.appliedISOGrain=n.appliedISOGrain;break;case"visualization":this.visualization&&!e(this.visualization,n.visualization)?u.extendVisualization(this.visualization,n.visualization):this.visualization=n.visualization;break;case"name":case"localColorIndex":break;default:o.Name=f[t];i.traceMessage("Unknown property name.",this._telemetryContext,o)}},n.prototype._updateMetric=function(n){o(this.metrics,n,!1)||(this.metrics=n);this.metrics||(this.metrics=[])},n})();t.MetricsExplorerItemDataModel=l;t.Equals=a;t.VisualizationEquals=e;t.MetricsEquals=o;t.AxisOptionsEquals=h;t.MetricIdEquals=f;t.ConvertTitleKindToString=b;t.ConvertTitleKindToEnum=c;t.HasSingleResource=k;t.HasSingleNamespace=d;t.HasSingleMetric=g;t.findMetricDataModelMatches=tt}))