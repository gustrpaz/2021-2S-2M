define("_generated/Less/MsPortalImpl.Controls/Controls/Toolbars/Toolbar.css",["module"],(function(n){"use strict";return{css:".azc-toolbar ul{margin:0;padding:0;width:100%}.azc-toolbar-container{display:flex;padding:0;user-select:none}a.azc-toolbarButton-container{text-decoration:none !important}.azc-toolbar-group{display:flex;flex-wrap:nowrap}.azc-toolbarButton{display:inline-block;box-sizing:border-box;position:relative;height:36px}.azc-toolbarSeparator{display:flex;align-items:center}.azc-toolbarSeparator .azc-toolbarButton-icon{height:20px;width:17px}.azc-toolbarButton-groupPopup .azc-toolbarSeparator,.azc-toolbarButton-overflowPopup .azc-toolbarSeparator{height:0;width:100%;border-width:1px 0 0 0;border-style:solid;margin:auto;border-color:#d2d0ce}.azc-toolbarButton-groupPopup .azc-toolbarButton-container,.azc-toolbarButton-overflowPopup .azc-toolbarButton-container{height:auto;min-height:32px;box-sizing:border-box;padding:7px 8px}.azc-toolbarButton-groupPopup .azc-toolbarButton-label,.azc-toolbarButton-overflowPopup .azc-toolbarButton-label{white-space:normal}.azc-toolbarButton-groupPopup .azc-toolbarButton-icon,.azc-toolbarButton-overflowPopup .azc-toolbarButton-icon{align-self:flex-start;margin-top:1px}.azc-toolbar-item.azc-toolbarSeparator{fill:#d2d0ce !important}.azc-toolbarButton-container{position:relative;display:flex;align-items:center;padding:0 8px;height:36px}.azc-toolbar-container.azc-toolbarButton-small .azc-toolbarButton-container{padding-left:2px;padding-right:2px;height:16px}.azc-toolbarButton-container.fxs-portal-hover:hover .azc-toolbarButton-icon-chevron,.azc-toolbarButton-container.fxs-portal-hover:hover .azc-toolbarButton-icon-overflow{fill:#323130}.azc-toolbarButton-icon{flex:0 0 auto;height:16px;width:16px}.azc-toolbarButton-icon img,.azc-toolbarButton-icon svg{height:100%;width:100%}.azc-toolbarButton-icon-chevron{padding-left:8px;height:12px;width:12px;fill:#605e5c}.azc-toolbarButton-icon-overflow{fill:#605e5c}.azc-toolbarButton-label{flex:1 1 auto;font-family:az_ea_font,'Segoe UI',az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif;font-weight:400;font-size:13px;line-height:normal;padding-left:8px;align-self:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.azc-toolbarButton-label.azc-toolbarButton-icon-hidden{padding-left:0}.azc-toolbarButton{cursor:pointer}.azc-toolbarItem-disabled{cursor:default !important;color:#a19f9d !important;fill:#a19f9d !important}.azc-toolbarItem-disabled .fxs-portal-text{color:#a19f9d !important}.azc-toolbarItem-disabled .azc-toolbarButton-container{cursor:default !important}.azc-toolbarButton-groupPopup,.azc-toolbarButton-overflowPopup{z-index:200;position:fixed;box-sizing:border-box;overflow-y:auto;overflow-x:hidden;max-width:320px}.fxc-groupPopup-hidden{visibility:hidden;left:-10000px;top:-10000px}.azc-toolbarButton-fileUpload-overlay{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;font-size:0;display:block;cursor:pointer;overflow:hidden}.azc-toolbarButton-fileUpload-overlay:disabled{cursor:default}.azc-toolbarButton-container.azc-toolbarButton-menuItemCustomButton{display:flex;flex:1 1 auto;flex-direction:row;align-self:flex-start;height:100%;padding:8px 11px 9px 9px;box-sizing:border-box;border-bottom:1px solid #e1dfdd}.azc-toolbarButton-menuItemCustomButtonIcon{flex:0 0 auto;height:25px;width:25px;padding-top:5px;padding-right:9px;align-self:flex-start}.azc-toolbarButton-menuItemCustomButtonContentContainer{display:flex;flex:1 1 auto;flex-direction:column;overflow:hidden}.azc-toolbarButton-menuItemCustomButtonContentContainer .azc-toolbarButton-label,.azc-toolbarButton-menuItemCustomButtonContentContainer .fxs-commandBar-item-text{min-height:20px;width:100%;line-height:20px;padding-left:0;color:#323130;font-weight:600;align-self:flex-start}.azc-toolbarButton-menuItemCustomButtonContentContainer .azc-toolbarButton-menuItemCustomButtonContent{flex:1 1 auto;color:#605e5c;font-size:12px}.fxs-mode-dark .azc-toolbarButton-icon-chevron,.fxs-mode-dark .azc-toolbarButton-icon-overflow{fill:#fff}.fxs-mode-dark .azc-toolbarButton-container.fxs-portal-hover:hover .azc-toolbarButton-icon-chevron,.fxs-mode-dark .azc-toolbarButton-container.fxs-portal-hover:hover .azc-toolbarButton-icon-overflow{fill:#fff}.fxs-mode-dark .azc-toolbarButton-menuItemCustomButtonContentContainer .azc-toolbarButton-label,.fxs-mode-dark .azc-toolbarButton-menuItemCustomButtonContentContainer .fxs-commandBar-item-text,.fxs-mode-dark .azc-toolbarButton-menuItemCustomButtonContentContainer .azc-toolbarButton-menuItemCustomButtonContent{color:#fff}.fxs-highcontrast-light a.azc-toolbarButton-container{color:#000 !important}.fxs-highcontrast-light .fxs-notificationspane-button-unreadcount{border:1px solid #000}.fxs-highcontrast-dark a.azc-toolbarButton-container{color:#fff !important}",moduleId:n.id}}));
define("MsPortalImpl.Controls/Controls/Toolbars/Toolbar.Component",["require","exports","Weave","Weave/DirectMode","Fx/Weave","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Weave/Util","SharedUtilities/ClipboardUtils","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","FxInternal","MsPortalImpl/Weave/Components","_generated/Less/MsPortalImpl.Controls/Controls/Toolbars/Toolbar.css","MsPortalImpl/UI/UI.PopupPositioningMethods","Viva.Controls/Controls/Viva.Balloon","Viva.Controls/Controls/Viva.Balloon.Component","MsPortalImpl/Interactions/Interactions.PortalReader"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){"use strict";function pt(n){var l=n.vm,t=n.state,o=u.toComputation(l.showLabels),v=u.toComputation(l.smallItemSize,e.falseComputation),y=k(t.overflowButton,t),nt=u.toComputation(t.mappedToolbarItems).composeArray(c.identity).cMap((function(n){var t=i.makeWritableComputation(0),r=n.visible,f=ko.isObservable(r)?u.toComputation(r):e.trueComputation,s={item:n,measuredWidth:t},h=i.composeComputation([v,o,u.toComputation(n.label),u.toComputation(n.icon),],(function(t,i,r,u){return yt({type:n.type,hasIcon:!!u,showLabel:i,label:r,smallItemSize:t})}));return i.composeComputation([f,h,t],(function(n,t,i){return{itemRenderInfo:s,visible:n,estimatedWidth:t,lastMeasuredFullWidth:i}}))})).cFilter((function(n){return n.visible})),tt=v.compose(ui),p=i.makeWritableComputation(1048576),w=i.composeComputation([p,nt,o,tt],(function(n,t,i,r){var f=t.map((function(n){return i?n.lastMeasuredFullWidth||n.estimatedWidth:n.estimatedWidth})),o=f.reduce((function(n,t){return n+t}),0),e,u;if(o<=n)return{itemsInBar:t.map(it),itemsInOverflowMenu:[]};for(e=n-r,u=0;(e-=f[u])>=0;)++u;return{itemsInBar:t.slice(0,u).map(it),itemsInOverflowMenu:t.slice(u).map(it)}})),d=w.compose((function(n){return n.itemsInBar})),g=w.compose((function(n){return n.itemsInOverflowMenu}));return r(i.GetContext,{fn:function(c){return r(i.SetContext,{tabIndex:i.makeConstantComputation(-1)},r(i.Css,{css:a}),r("ul",{role:"toolbar",className:["azc-toolbar-container fxs-commandBar-itemList",{"azc-toolbarButton-small":v},],onResize:function(n){var i=n.width;p(i);s.dismissByLogName(t.menuPopupLogName)},afterMount:function(n,t){var r=new h.KeyboardNavigation(t,{element:$(n.parentElement||n),tabTriggers:12,itemSelector:".azc-toolbar-item > .azc-toolbarButton-container",parentTabIndexContextObservable:u.toObservable(t,c.tabIndex)});i.subscribe(t,[d],(function(){r.correctState()}))}},r(i.ForEach,{collection:d,fn:function(f){var w=f.item,e=w.item,g=w.measuredWidth,y=u.toComputation(t.itemAriaLabel(e)),a=u.toComputation(t.itemAriaDisabled(e)),p=u.toComputation(t.itemEnabled(e)),v=u.toComputation(t.itemTitle(e)),h=k(e,t),c=u.toComputation(t.itemDisabled(e)),s=e.type,d=function(n){var t=n.width;l.showLabels()&&g(t)};return r(i.SetContext,{disabled:c},e.type!=="Group"&&s!==12?r("li",{role:"presentation",className:["azc-toolbar-item azc-toolbarButton fxs-commandBar-item",{"azc-toolbarItem-disabled fxs-commandBar-itemDisabled msportalfx-svg-disabled":c,"fxs-commandBar-item-checked":u.toComputation(e.checked),"azc-toolbarMenuButton":s===17},u.toComputation(e.cssClass),],title:v,"aria-disabled":a,onResize:d},s!==14&&s!==15&&s!==20&&s!==21&&s!==22?r(i.Fragment,null,r("div",{data:e,className:["azc-toolbarButton-container",{"fxs-portal-hover":p,"azc-toggleCommandButton-checked fxs-portal-selected":u.toComputation(e.checked)},],"aria-disabled":a,"aria-label":y,title:v,role:t.itemRole(e),"aria-checked":u.toComputation(t.itemChecked(e)),id:t.itemAriaLabelId(e),"aria-labelledby":t.itemGroupedByIds(e),"aria-haspopup":t.itemAriaHasPopup(e)?!0:null,"aria-expanded":t.itemAriaHasPopup(e)?!1:null,tabindex:"-1",onClick:h,onKeyDown:h},r(b,{item:e,showLabel:o}),r(at,{item:e,inOverflowPopup:!1}),r(vt,{item:e})),r(ut,{item:e}),r(ft,{item:e,state:t,className:"azc-toolbar-menuItem"})):null,s===14?r("div",{onClick:h,onKeyDown:h,data:e,fxclick:e.onClick,"aria-disabled":a,"aria-label":y,title:v,role:t.itemRole(e),className:["azc-toolbarButton-container",{"fxs-portal-hover":p},]},r(b,{item:e,showLabel:o})):null,s===15?r("a",{onClick:h,onKeyDown:h,data:e,fxclick:e.onClick,"aria-disabled":a,"aria-label":y,title:v,role:t.itemRole(e),className:["azc-toolbarButton-container",{"fxs-portal-hover":p,"azc-toolbarItem-disabled":c},]},r(b,{item:e,showLabel:o})):null,s===20?r(ht,{item:e,state:n.state,itemDisabled:c}):null,s===21?r(ct,{item:e,state:n.state,itemDisabled:c}):null):null,e.type===12?r("li",{className:"azc-toolbar-item azc-toolbarButton azc-toolbarSeparator fxs-commandBar-item fxs-commandBar-item-separator",role:"separator",onResize:d},r("div",{className:"azc-toolbarButton-icon",image:MsPortalFx.Base.Images.Line()})):null)}}),r(i.If,{condition:g.compose(e.isNonEmptyArray),trueFn:function(){return r("li",{className:"azc-toolbar-item azc-toolbarButton azc-toolbar-item-overflow fxs-commandBar-item fxs-commandBar-item-expandList",role:"presentation"},r("div",{"aria-label":u.toComputation(t.overflowButton.ariaLabel),title:u.toComputation(t.overflowButton.ariaLabel),role:"button","aria-haspopup":"true","aria-expanded":"false",data:t.overflowButton,className:["azc-toolbarButton-container",{"fxs-portal-hover":u.toComputation(t.itemEnabled(t.overflowButton))},],onClick:y,onKeyDown:y},r("div",{className:"azc-toolbarButton-icon azc-toolbarButton-icon-overflow",image:u.toComputation(t.overflowButton.icon)})),r("div",{className:["azc-toolbarButton-overflowPopup","fxs-dropmenu-content","msportalfx-shadow-level2","fxs-portal-bg-txt-br","fxc-groupPopup-hidden"],role:"menu",id:t.overflowButton.menuId},r(i.ForEach,{collection:g,fn:function(f){var e=f.item.item,o=u.toComputation(t.itemDisabled(e));return r(i.SetContext,{disabled:o},r(et,{item:e,state:n.state,className:"azc-toolbar-item fxs-commandBar-item",itemDisabled:o,inOverflowPopup:!0}),r(ft,{item:e,state:n.state,className:"azc-toolbar-menuItem"}),r(ot,{item:e,state:n.state,className:"azc-toolbar-item fxs-commandBar-item",itemDisabled:o}),r(ht,{item:e,state:n.state,className:"azc-toolbar-item fxs-commandBar-item",itemDisabled:o}),r(ct,{item:e,state:n.state,className:"azc-toolbar-item fxs-commandBar-item",itemDisabled:o}),r(lt,{item:e,className:"azc-toolbar-item fxs-commandBar-item"}))}})))}})),r(i.ForEach,{collection:u.toComputation(t.optionsGroupNames),fn:function(n){var i,u=n.item;return r("div",{className:"fxs-hide-accessible-label",id:(i=t.getGroup(u))===null||i===void 0?void 0:i.id},f.Controls.Toolbar.optionsGroupAriaDesc.format(u))}}))}})}function b(n){var f=n.item,t=u.toComputation(f.icon);return r(i.Fragment,null,r(i.If,{condition:t,trueFn:function(){return r("div",{className:"azc-toolbarButton-icon",image:t})}}),r(i.If,{condition:n.showLabel||e.trueComputation,trueFn:function(){return r("div",{className:["azc-toolbarButton-label fxs-commandBar-item-text",{"azc-toolbarButton-icon-hidden":t?t.compose(e.negation):!0},]},u.toComputation(f.label))}}))}function ut(n){var t=n.item;return rt.indexOf(t.type)>=0?r("div",{className:"azc-toolbarButton-dialogContainer fxs-commandBar-listpopup"}):null}function ft(n){var t=n.item;return t.type===17?r("div",{className:["azc-toolbarButton-groupPopup","msportalfx-shadow-level2","fxs-portal-bg-txt-br","fxc-groupPopup-hidden"],role:"menu",id:t.menuId,style:{width:u.toComputation(t.popupWidthString),"max-width":u.toComputation(t.popupWidthString)}},r(i.ForEach,{collection:u.toComputation(t.buttons),fn:function(t){var f=t.item,e=u.toComputation(n.state.itemDisabled(f));return r(i.SetContext,{disabled:e},r(et,{item:f,state:n.state,className:n.className,itemDisabled:e,inOverflowPopup:!1}),r(ot,{item:f,state:n.state,className:n.className,itemDisabled:e}),r(lt,{item:f,className:n.className}),r(bt,{item:f,state:n.state,className:n.className,itemDisabled:e}))}})):null}function et(n){var t=n.item,e=t.type;if(e!==14&&e!==15&&e!==12&&e!==20&&e!==21&&e!==22){var f=n.state,o=k(t,f),s=u.toComputation(f.itemAriaLabel(t)),h=u.toComputation(f.itemAriaDisabled(t));return r(i.Fragment,null,r("div",{onClick:o,onKeyDown:o,data:t,className:["azc-toolbarButton-container",n.className,{"fxs-portal-hover":u.toComputation(f.itemEnabled(t)),"azc-toolbarItem-disabled fxs-commandBar-itemDisabled msportalfx-svg-disabled":n.itemDisabled,"azc-toggleCommandButton-checked fxs-commandBar-item-checked fxs-portal-selected":u.toComputation(t.checked),"azc-toolbarMenuButton":e===17},u.toComputation(t.cssClass),],"aria-disabled":h,"aria-label":s,title:u.toComputation(f.itemTitle(t)),role:e===6?"menuitemradio":"menuitem","aria-checked":u.toComputation(f.itemChecked(t)),id:f.itemAriaLabelId(t),"aria-labelledby":f.itemGroupedByIds(t),"aria-haspopup":f.itemAriaHasPopup(t)?!0:null,"aria-expanded":f.itemAriaHasPopup(t)?!1:null},r(b,{item:t}),r(at,{item:t,inOverflowPopup:n.inOverflowPopup}),r(vt,{item:t})),r(ut,{item:t}))}return null}function ot(n){var t=n.item,f=t.type;if(f===14||f===15){var i=n.state,e=t,o=k(t,i),h=u.toComputation(i.itemAriaDisabled(t)),s={data:t,onClick:o,onKeyDown:o,className:["azc-toolbarButton-container",n.className,{"fxs-portal-hover":u.toComputation(i.itemEnabled(t)),"azc-toolbarItem-disabled fxs-commandBar-itemDisabled msportalfx-svg-disabled":n.itemDisabled},u.toComputation(e.cssClass),],fxclick:e.onClick,"aria-disabled":h,"aria-label":u.toComputation(i.itemAriaLabel(t)),title:u.toComputation(i.itemTitle(t)),role:"menuitem"};return f===14?r("div",__assign({},s),r(b,{item:t})):r("a",__assign({},s),r(b,{item:t}))}return null}function wt(t){var f=t.item,e=u.toComputation(f.icon),o=u.toComputation(f.label),s=u.toValueOrComputation(f.content);return r(i.Fragment,null,r(i.If,{condition:e,trueFn:function(){return r("div",{className:"azc-toolbarButton-menuItemCustomButtonIcon",image:e})}}),r("div",{className:"azc-toolbarButton-menuItemCustomButtonContentContainer"},r(i.If,{condition:o,trueFn:function(){return r("div",{className:"azc-toolbarButton-label fxs-commandBar-item-text"},o)}}),r(i.If,{condition:s,trueFn:function(){return r("div",{className:"azc-toolbarButton-menuItemCustomButtonContent"},r(l.TextOrKo,{content:s,require:n}))}})))}function bt(n){var t=n.item,o=t.type;if(o===22){var i=n.state,f=t,e=k(t,i),s=u.toComputation(i.itemAriaDisabled(t));return r("div",{onClick:e,onKeyDown:e,data:t,className:["azc-toolbarButton-container","azc-toolbarButton-menuItemCustomButton",n.className,{"fxs-portal-hover":u.toComputation(i.itemEnabled(t)),"azc-toolbarItem-disabled fxs-commandBar-itemDisabled msportalfx-svg-disabled":n.itemDisabled},u.toComputation(f.cssClass),],fxclick:f.onClick,"aria-disabled":s,"aria-label":u.toComputation(i.itemAriaLabel(t)),title:u.toComputation(i.itemTitle(t)),role:"menuitem"},r(wt,{item:t}))}return null}function st(n){return r(i.GetContext,{fn:function(t){return r(i.LifetimeManagerScoped,{fn:function(i){var u,f;return d||(d=new w.PortalReader(i,{idPrefix:"toolbar"})),u=new y.ViewModel(__assign(__assign({},n.options),{ltm:i})),u.renderMode(1),u.box((function(){return v.getBox("#"+n.boxId)})),f=new y.WidgetUIState,r("div",{className:["azc-dockedballoon-balloon","fxs-copyButton-balloon"],afterMount:function(n,i){i.registerForDispose(f);i.registerForDispose(new y.Widget($(n),u,{weaveContext:t,diContainer:t.diContainer},f))}},r(p.BalloonInner,{state:f,vm:u}))}})}})}function ht(n){var t=n.item,c=t.type;if(c===20){var f=n.state,l=t,e=kt(t,f),a=u.toComputation(f.itemAriaDisabled(t)),o=MsPortalFx.getUniqueId(),s=t,h=gt(t,f),v={id:o,data:t,onClick:e,onKeyDown:e,onMouseLeave:h,onFocusOut:h,className:["azc-toolbarButton-container",n.className,{"fxs-portal-hover":u.toComputation(f.itemEnabled(t)),"azc-toolbarItem-disabled fxs-commandBar-itemDisabled msportalfx-svg-disabled":n.itemDisabled},u.toComputation(l.cssClass),],"aria-disabled":a,"aria-label":u.toComputation(f.itemAriaLabel(t)),title:u.toComputation(f.itemTitle(t)),role:"menuitem"};return r(i.Fragment,null,r("div",__assign({},v),r(b,{item:t})),r(st,{boxId:o,options:{ltm:undefined,content:s.statusText,visible:s.statusBalloonVisible}}))}return null}function ct(n){var t=n.item,c=t.type;if(c===21){var f=n.state,l=t,e=dt(t,f),a=u.toComputation(f.itemAriaDisabled(t)),o=MsPortalFx.getUniqueId(),s=t,h=ni(t,f),v={id:o,data:t,onClick:e,onKeyDown:e,onMouseLeave:h,onFocusOut:h,className:["azc-toolbarButton-container",n.className,{"fxs-portal-hover":u.toComputation(f.itemEnabled(t)),"azc-toolbarItem-disabled fxs-commandBar-itemDisabled msportalfx-svg-disabled":n.itemDisabled},u.toComputation(l.cssClass),],"aria-disabled":a,"aria-label":u.toComputation(f.itemAriaLabel(t)),title:u.toComputation(f.itemTitle(t)),role:"menuitem"};return r(i.Fragment,null,r("div",__assign({},v),r(b,{item:t})),r(st,{boxId:o,options:{ltm:undefined,content:s.statusText,visible:s.statusBalloonVisible}}))}return null}function lt(n){var t=n.item,i=t.type;return i===12?r("div",{className:["azc-toolbarButton azc-toolbarSeparator",n.className],role:"separator"}):null}function at(n){var t=n.item;return t.type===17?r("div",{className:"azc-toolbarButton-icon azc-toolbarButton-icon-chevron",image:n.inOverflowPopup?MsPortalFx.Base.Images.Chevron():MsPortalFx.Base.Images.CaretDown()}):null}function vt(n){var t=n.item;return t.type===18||t.type===8?r("input",{type:"file",data:t,className:"azc-toolbarButton-fileUpload-overlay fxs-commandBar-fileUpload-overlay",accept:t.accept,multiple:t.maxFiles>1,tabindex:"-1",disabled:u.toComputation(t.disabled).compose((function(n){return!!n}))}):null}function k(n,t){return function(i){return t.logTelemetry(n,i.event)}}function kt(n){var t=this;return function(i){return __awaiter(t,void 0,void 0,(function(){var t,r,u;return __generator(this,(function(f){switch(f.label){case 0:return(t=i.keyCode,!(!t||t===32||t===13))?[3,3]:(r=n,[4,Q(n.onClick())]);case 1:return u=f.sent(),[4,ii(u)];case 2:f.sent();r.statusText(g);r.statusBalloonVisible(!0);d.read(g);f.label=3;case 3:return[2]}}))}))}}function dt(n){var t=this;return function(i){return __awaiter(t,void 0,void 0,(function(){var t,u,r;return __generator(this,(function(f){switch(f.label){case 0:return(t=i.keyCode,!(!t||t===32||t===13))?[3,2]:[4,ti()];case 1:u=f.sent();r=n;r.statusText(nt);r.statusBalloonVisible(!0);d.read(nt);n.onClick(u);f.label=2;case 2:return[2]}}))}))}}function gt(n){return function(){n.statusBalloonVisible(!1);n.statusText("")}}function ni(n){return function(){n.statusBalloonVisible(!1);n.statusText("")}}function ti(){return __awaiter(this,void 0,void 0,(function(){var t,n;return __generator(this,(function(i){switch(i.label){case 0:return[4,o.readFromClipBoard()];case 1:t=i.sent();try{if(n=JSON.parse(t),n.hasOwnProperty("typeName")&&n.hasOwnProperty("data"))return[2,n]}catch(r){}return[2,t]}}))}))}function ii(n){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(i){switch(i.label){case 0:return t=JSON.stringify(n),t=typeof n=="string"?n:JSON.stringify(n),[4,o.writeToClipboard(t)];case 1:return i.sent(),[2]}}))}))}function ri(n){return Math.max(0,tt.measureText((""+(n||"")).trim()).width-2)}function yt(n){return n.type===12?17:(n.smallItemSize?2:8)*2+(n.hasIcon?16:0)+(n.showLabel?ri(n.label):0)+(n.hasIcon&&n.showLabel?8:0)+(n.type===17?20:0)}function ui(n){return yt({type:14,hasIcon:!0,showLabel:!1,label:"",smallItemSize:n})}function it(n){return n.itemRenderInfo}var g,nt,d,rt,tt;Object.defineProperty(t,"__esModule",{value:!0});t.DEV=t.ToolbarInner=void 0;g=f.Clipboard.copied;nt=f.Clipboard.pasted;t.ToolbarInner=pt;rt=[5,11,19,16,7,17,];tt=document.createElement("canvas").getContext("2d");tt.font='13px az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif'}));
define("MsPortalImpl.Controls/Controls/Toolbars/Toolbar",["require","exports","MsPortalImpl.Controls/Controls/Base/Loadable","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl/Commands/Commands.OAuthCommand","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/Base/Base.Selectable2","Fx/DependencyInjection","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/UI/UI.PopupPositioningMethods","FxInternal/Controls/ToolbarItems/MenuButton","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl.Controls/Controls/Toolbars/Toolbar.Component","WeaveDOM/DirectRender/DataAttribute"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){"use strict";function ut(n){var t=FxImpl.Po.getMetadataId(n);return t?t.split("-")[0]:""}function g(n,t,i,r,u){var s=u?n.width:0,e=i.offset().left+i.width()-(n.left+s),o=n.left+n.width-s,h=t.width()<=e||o<=e,f=0;switch(r){case 1:case 2:default:h&&t.width()<=e?f=2:t.width()<=o&&(f=1);break;case 3:case 4:h&&t.width()<=e?f=4:t.width()<=o&&(f=3)}return f}function ft(n,t,i,r){var u=r?0:n.height,f=r?n.height:0;return n.top+u+t.height()<=i.offset().top+i.height()?2:n.top+f-32>=t.height()?4:0}function nt(n,t,i,r,u){var f=0;return u!==0?f=u===4||u===2?r?n.left+n.width:n.left:r?n.left-i.width():n.left+n.width-i.width():(r&&(f=n.left+n.width-i.width()),f<0&&t.width>=i.width()&&(f=(t.width-i.width())/2),f=Math.max(0,f)),f}function et(n,t,i,r){var e=32,u=l.getBox(n),f=l.getBox(i),o=ft(u,t,i,r),s,h,c,y;if(o!==0)s=0,s=o===1||o===2?r?u.top:u.top+u.height:r?u.top+u.height-t.height():u.top-t.height(),h=g(u,t,i,o,r),c=nt(u,f,t,r,h),t.css({top:s,left:c});else{var h=g(u,t,i,2,r),c=nt(u,f,t,r,h),a=f.top+e,v=f.height-e;f.height-e>t.height()&&(y=(f.height-e-t.height())/2,a=f.top+e+y,v=t.height());t.css({top:a,left:c,height:v})}t.removeClass("fxc-groupPopup-hidden");t.addClass("fxs-dropmenu-is-open");n.attr("aria-expanded",!0)}function ot(n,t){t.addClass("fxc-groupPopup-hidden");t.removeClass("fxs-dropmenu-is-open");t.css({top:"",left:"",right:"",bottom:"",height:"auto"});n.attr("aria-expanded",!1)}var tt,it;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.InnerTsxComponent=t.WidgetUIState=void 0;var rt=MsPortalFx.Base.Diagnostics.Telemetry,b=FxImpl.TelemetryContext,k="fxc-toolbar azc-toolbar",d=".azc-toolbarButton-fileUpload-overlay";tt=(function(n){function t(t){var i=n.call(this)||this,r,u;return i.menuPopupLogName=MsPortalFx.getUniqueId(),i.mappedToolbarItems=ko.observable([]),i.optionsGroupNames=ko.observableArray([]),i.overflowButton=new a.MenuButton(i._ltm,{isOverflowButton:!0,icon:MsPortalFx.Base.Images.Ellipsis(),label:v.CommandBar.more,ariaLabel:v.CommandBar.more,telemetryName:"ToolbarOverflowButton"}),i._vm=t.vm,t.diContainer.scope==="composition"?(u=t.diContainer.get(y.CompositionProvenance),i.locator=u.locator,r={locationString:i.locator.toFriendlyString(),extensionName:i.locator.getExtensionLocator().name,instanceId:u.instanceId}):r={},i.telemetryContext=MsPortalFx.extend2({locationString:"Toolbar",extensionName:ut(i._vm),instanceId:null},r),t.vm.items.subscribeAndRun(i._ltm,(function(n){var t=[];i._groups={};n.forEach((function(n){var r=n,u;r.type===17?(u=r.buttons()||[],u.forEach((function(n){i._processOptionsGroup(n)}))):i._processOptionsGroup(r);t.push(r)}));i.optionsGroupNames(Object.keys(i._groups));i.mappedToolbarItems(t)})),i}return __extends(t,n),t.prototype.logTelemetry=function(n,t){var u=this,i,r,f;(t.type!=="keydown"||t.keyCode===13||t.keyCode===32)&&(i=n,(i.type===14||i.type===15||i.type===22)&&c.dismissByLogName(this.menuPopupLogName),r=i.name||i.telemetryName||ko.unwrap(i.label)||ko.unwrap(i.ariaLabel)||"No identifiable information",f={id:this.telemetryContext.locationString,instanceId:this.telemetryContext.instanceId},b.setContextValue(FxImpl.TelemetryContext.ContextType.Blade,f),b.provideContext((function(){rt.trace({action:"CommandExecuted",source:u.telemetryContext.locationString,name:r,extension:u.telemetryContext.extensionName,data:{invokedFromToolbar:!0}})}),b.ContextType.CompositionItem,{id:"toolbarItem",instanceId:r}))},t.prototype.getGroup=function(n){return this._groups&&this._groups[n]},t.prototype.itemDisabled=function(n){var t=this;return ko.pureComputed((function(){return t._itemDisabled(n)}))},t.prototype.itemEnabled=function(n){var t=this;return ko.pureComputed((function(){return!t._itemDisabled(n)}))},t.prototype.itemAriaDisabled=function(n){var t=this;return ko.pureComputed((function(){return t._itemDisabled(n)?"true":undefined}))},t.prototype.itemAriaLabel=function(n){var i=this,t=n;return ko.pureComputed((function(){return i._itemDisabledOrUnauthorizedMessage(t)||ko.unwrap(t.ariaLabel)||ko.unwrap(t.label)}))},t.prototype.itemTitle=function(n){var i=this,t=n;return ko.pureComputed((function(){return i._itemDisabledOrUnauthorizedMessage(t)||ko.unwrap(t.tooltip)||ko.unwrap(t.ariaLabel)||ko.unwrap(t.label)}))},t.prototype.itemChecked=function(n){return n.type===6?ko.pureComputed((function(){return n.checked()?"true":"false"})):undefined},t.prototype.itemGroupedByIds=function(n){return n.type===6&&n.optionGroupName?[n.ariaLabelId,this._groups[n.optionGroupName].id].join(" "):undefined},t.prototype.itemAriaLabelId=function(n){return n.type===6&&n.optionGroupName?n.ariaLabelId:undefined},t.prototype.itemRole=function(n){return n.type===6?n.optionGroupName?"radio":"switch":n.type===15||n.type===2?"link":"button"},t.prototype.itemAriaHasPopup=function(n){if(n.type===17)return!0;var t=n;return t.type===5&&!MsPortalFx.isNullOrUndefined(t.dialogOptions&&t.dialogOptions.type)&&t.dialogOptions.type===4?!0:!1},t.prototype._itemDisabled=function(n){var t=ko.unwrap(this._vm.disabled),i=ko.unwrap(n.disabled),r=ko.unwrap(n.unauthorizedMessage),u=n.command&&!MsPortalFx.isNullOrUndefined(n.command.canExecute)&&!ko.unwrap(n.command.canExecute);return!!(t||i||r||u)},t.prototype._itemDisabledOrUnauthorizedMessage=function(n){var t=ko.unwrap(n.disabled),i;return t&&typeof t=="string"&&this._itemDisabled(n)?t:(i=ko.unwrap(n.unauthorizedMessage),i)?i:undefined},t.prototype._processOptionsGroup=function(n){var t=n,i=t.optionGroupName;t.type===6&&i&&(t.ariaLabelId||(t.ariaLabelId=MsPortalFx.getUniqueId()),this._groups[i]?this._groups[i].items.push(t):this._groups[i]={type:"Group",id:MsPortalFx.getUniqueId(),optionGroupName:i,items:[t]})},t})(r.WidgetUIState);t.WidgetUIState=tt;t.InnerTsxComponent=p.ToolbarInner;it=(function(t){function i(i,r,l,a){var y=t.call(this,i,r,l,a)||this,p,b,g;return y._downloadCommandMap=new Map,y._fileUploadMap=new Map,y._optionsGroupFormatter=v.Controls.Toolbar.optionsGroupAriaDesc,p=y.state.menuPopupLogName,b=a.locator,y.element.addClass(k),g=function(t,i){var lt,tt,a,k,r,at,g,v,ft,st,nt,ht,it,ct,pt;if(i.stopPropagation(),i.preventDefault(),t.type===17&&t.isOverflowButton||(lt=t.command&&!MsPortalFx.isNullOrUndefined(t.command.canExecute)&&!ko.unwrap(t.command.canExecute),!y.options.disabled()&&!t.disabled()&&!ko.unwrap(t.unauthorizedMessage)&&!lt)){tt={getForm:function(){return $(i.currentTarget).siblings(".azc-toolbarButton-dialogContainer")[0]},showForm:function(){},hideForm:function(){}};switch(t.type){case 6:a=t;a.command?a.command.canExecute()&&(y._handleCheckedState(a),a.command.execute({checked:a.checked(),context:ko.unwrap(a.commandContext)})):y._handleCheckedState(a);break;case 16:case 7:c.dismissByLogName(p);k=t;r=y._downloadCommandMap.get(k);r?r.canExecute()&&r.execute(null):(at=t.type===16?"MsPortalImpl/Commands/Commands.FxFileDownloadCommand":"MsPortalImpl/Commands/Commands.FileDownloadCommand",MsPortalFx.Base.Promises.cancelOnDispose(y.ltm,MsPortalFx.require(at)).then((function(n){r=t.type===16?new n.FxFileDownloadCommand(k,h.container,tt,i.currentTarget,b):new n.FileDownloadCommand(k.context(),h.container,tt,i.currentTarget,b);y._downloadCommandMap.set(k,r);r.canExecute()&&r.execute(null)})));break;case 18:case 8:var d=t,wt=i.target,bt=wt.files;MsPortalFx.Base.Promises.cancelOnDispose(y.ltm,MsPortalFx.require("MsPortalImpl.Controls/Controls/Toolbars/FileUploader")).then((function(n){var i=y._fileUploadMap.get(d);i||(t.type===18?(i=new n.FileUploader(y.ltm,d,y.state.telemetryContext.extensionName),d._msPortalFxUploadActionCallback((function(){return i.reset()}))):i=new n.LegacyFileUploader(y.ltm,d),y._fileUploadMap.set(d,i));i.processFiles(bt)}));break;case 9:c.dismissByLogName(p);g=t;u.executeOAuthCommand(g.value,g.requestUrl(),g.popupWidth(),g.popupHeight());break;case 11:case 5:v=t;y._diContainer.getAsync(o.DialogManager).then((function(n){return t.type!==5||MsPortalFx.isNullOrUndefined(v.dialogOptions&&v.dialogOptions.type)||v.dialogOptions.type===4||c.dismissByLogName(p),n.showDialog(v.dialogOptions,tt,i.currentTarget,{locator:b})})).then((function(n){v.command&&v.command.canExecute()&&v.command.execute(n)}));break;case 3:ft=t;ft.selectable.isSelected()||ft.selectable.isSelected(!0);break;case 10:st=s.getOrCreate(y._diContainer,t.selectable);st&&st.onClick();break;case 2:nt=t.clickableLink;ht=f.sanitizeLinkUri(nt.uri(),{diContainer:y._diContainer,localRequire:n,windowContext:y.state.telemetryContext.extensionName,contextData:{locator:y.state.telemetryContext.locationString}});ht&&(window.open(ht,nt.target()),nt.onLinkOpened&&nt.onLinkOpened(i.type==="keypress"));break;case 4:it=t;it.command.canExecute()&&(c.dismissByLogName(p),Q(it.command.execute(ko.unwrap(it.commandContext))).catch((function(n){var t=n===null||n===void 0?void 0:n.extension;if(!t||t==="fx")return Q.reject(n)})));break;case 17:var l=$(i.currentTarget),kt="#"+t.menuId,w=l.siblings(kt),dt=l.parent().hasClass("azc-toolbarButton-overflowPopup"),gt=l.closest(".fxs-portal-content")[0]||l.closest(".fxs-contextpane")[0]||l.closest("#web-container")[0]||l.closest("body")[0];et(l,w,$(gt),dt);var vt=y.ltm.createChildLifetime(),rt=l[0],yt=function(n){return $.contains(w[0],n)||w[0]===n?0:2},ut={dismissFn:function(n){ot(l,w);c.unregister(ut);vt.dispose();n===p&&c.validatePreviousFocusedElement(ut,rt)&&rt.focus()},shouldDismissOnFocusOutFn:function(n){return $.contains(w[0],document.activeElement)||w[0]===n?0:1},shouldDismissOnMouseDownFn:yt,shouldDismissOnMouseWheelFn:yt,restoreFocus:function(){c.validatePreviousFocusedElement(ut,rt)&&rt.focus()},logName:p};c.register(ut);new e.KeyboardNavigation(vt,{element:w,tabTriggers:12,itemSelector:"> .azc-toolbarButton-container"});ct=w.children(".azc-toolbarButton-container:not(.azc-toolbarItem-disabled)")[0];ct&&ct.focus();break;case 19:pt=t;y.trigger("itemSelected",null,{item:pt.command,popupTarget:$(i.currentTarget).siblings(".azc-toolbarButton-dialogContainer")[0]});break;case 20:case 21:c.dismissByLogName(p)}}},y.ltm.registerForDispose(y.element.setEvents(["click",".azc-toolbarButton-container",function(n){g(w.getElementData(n.currentTarget),n)},],["keydown",".azc-toolbarButton-container",function(n){if((n.keyCode===13||n.keyCode===32)&&$(n.target).attr("aria-disabled")!=="true"){var t=$(n.target).find(d)[0];t?t.click():g(w.getElementData(n.currentTarget),n)}},],["change",d,function(n){g(w.getElementData(n.currentTarget),n)},],["click",d,function(n){n.stopPropagation();$(n.target).val("")},])),y}return __extends(i,t),i.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(t.prototype.dispose)||(this._cleanElement(k),this.element.removeClass(k),t.prototype.dispose.call(this))},Object.defineProperty(i.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),i.prototype.trigger=function(n,t,i){var u=this.options[n],r=this.element;return i=i||{},t=t||$.Event(n),t.type=n,t.target=r[0],r.trigger(t,i),!($.isFunction(u)&&u.apply(r[0],[t].concat(i))===!1||t.isDefaultPrevented())},i.prototype._handleCheckedState=function(n){n.optionGroupName?n.checked()?n.checked(!1):(n.checked(!0),this.state.getGroup(n.optionGroupName).items.forEach((function(t){t!==n&&t.checked(!1)}))):n.checked(!n.checked())},i})(i.Widget);t.Widget=it}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.CommandBar.css",["module"],(function(n){"use strict";return{css:".fxs-commandBar{position:relative}",moduleId:n.id}}));
define("MsPortalImpl/Widgets/Widgets.CommandBar",["require","exports","Weave/DirectMode","Weave","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.CommandBarBase","FxInternal/Controls/ToolbarItems/BaseButton","MsPortalImpl.Controls/Controls/Toolbars/Toolbar","_generated/Less/MsPortalImpl/Widgets/Widgets.CommandBar.css","MsPortalImpl.Controls/Controls/Toolbars/Toolbar.Component"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";function dt(){p={};w={};w[5]=h.DialogButton;w[7]=tt;w[11]=lt;w[10]=at;p[4]=rt;p[3]=g;p[2]=d;p[6]=ut;p[8]=nt;p[9]=it;p[14]=ft;p[15]=et}function gt(n,t,i,r,u){var f=t.type,e,o;return f===12?new y(n,new pt.ToolbarButton(12,{type:12,icon:ht.Images.Line(),disabled:!0}),i,u):(p||dt(),e=p[f],e)?new e(n,t,i,u):(o=w[f],o)?new o(n,t,i,r,u):new y(n,t,i,u)}function ni(n){return i(r.GetContext,{fn:function(t){return i(r.LifetimeManagerScoped,{fn:function(){var f=n.vm,u=new ot({vm:n.vm,diContainer:t.diContainer});return i("div",{className:["fxs-commandBar",n.className],afterMount:function(i,r){r.registerForDispose(u);r.registerForDispose(new st($(i),n.vm,{weaveContext:t,diContainer:t.diContainer},u))}},i(r.Css,{css:a}),i(v.ToolbarInner,{state:u.toolbarState,vm:f}))}})}})}var d,lt,g,at,nt,vt,tt,it,rt,ut,ft,et,yt,ot,st;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.WidgetUIState=t.CommandBar=t.ViewModel=t.AmdLinkButton=t.AmdButton=t.ToggleButton=t.CommandButton=t.OAuthButton=t.FileDownloadButton=t.PdlCommandButton=t.FileUploadButton=t.OpenBladeButton=t.OpenLinkButton=t.createItem=void 0;var ht=MsPortalFx.Base,b=ht.Promises,pt=MsPortalFx.ViewModels.Toolbars,y=h.ItemViewModel,ct=window,wt=MsPortalFx.forEachKey,k=MsPortalFx.require,bt=".fxs-commandBar-item:not(.fxs-commandBar-itemDisabled)>.azc-toolbarButton-container",kt=".fxs-commandBar-item:not(.fxs-commandBar-item-separator)>.azc-toolbarButton-container",p,w;t.createItem=gt;d=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.execute=function(t){var r=this._model,i=r&&r.clickableLink,u;i&&ko.isObservable(i.uri)&&(u=ko.unwrap(i.target)||"_blank",ct.open(i.uri(),u),i.onLinkOpened&&i.onLinkOpened(!1));n.prototype.execute.call(this,t)},t})(y);t.OpenLinkButton=d;lt=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(h.DialogButton);g=(function(n){function t(t,i,r,u){var f=n.call(this,t,i,r,u)||this,e=f.model;return e&&e.selectable&&ko.isObservable(e.selectable.isSelected)&&ko.computed(f._ltm,(function(){f.pressed(f.model.selectable.isSelected())})),f}return __extends(t,n),t.prototype.execute=function(t){var i=this.model.selectable;i&&ko.isObservable(i.isCommandSelected)&&i.isSelected(!0);n.prototype.execute.call(this,t)},t})(y);t.OpenBladeButton=g;at=(function(n){function t(t,i,r,f,e){var o=n.call(this,t,i,r,e)||this,s=u.getOrCreate(f,i.selectable);return o.pressed=s.isSelected,o.execute=function(t){s.onClick();n.prototype.execute.call(o,t)},o}return __extends(t,n),t})(y);nt=(function(n){function t(t,i,r,u){var f=n.call(this,t,i,r,u)||this,e;return f._fileUploaderMap={},e=f.model,f.fileInputOptions(new o.FileInputOptions(e.accept,e.maxFiles)),f.model.cancelAllUploads.subscribe(f._ltm,(function(n){n&&(f._cancelAllUploads(),e.cancelAllUploads(!1))})),f}return __extends(t,n),t.prototype.execute=function(t){var i=this;n.prototype.execute.call(this,t);b.cancelOnDispose(this._executeLifetime,k("MsPortalImpl/Services/Services.FileUpload")).then((function(n){i._execute(n,t)}))},t.prototype._execute=function(n){var f=[],t=this.fileInputOptions().files(),i,e,r,u;if(t&&t.length>0){for(i=this.model,i.cancelAllUploadsOnFileSelection()&&this._cancelAllUploads(),e=Math.min(t.length,i.maxFiles),r=0;r<e;r++)u=this._fileUploaderMap[t[r].name],u&&u.dispose(),u=new n.FileUploader(this._ltm,this._fileUploaderMap,t[r],i),this._fileUploaderMap[t[r].name]=u,f.push(u.uploadTask);i.uploadTasks.push.apply(i.uploadTasks,f)}},t.prototype._cancelAllUploads=function(){var n=this._fileUploaderMap;this._fileUploaderMap={};wt(n,(function(n,t){t.cancel();t.dispose()}))},t})(y);t.FileUploadButton=nt;vt=(function(n){function t(t,i){var r=n.call(this,t,{label:i.text,ariaLabel:i.ariaLabel,icon:i.icon,tooltip:i.tooltip,disabled:ko.pureComputed((function(){return!i.fxEnabled()||!i.enabled()||i.unauthorized()}))})||this;return r.type=19,r.command=i,r.visible=MsPortalFx.initObservable(i.visible,!0),r.checked=MsPortalFx.initObservable(i.pressed,!1),r}return __extends(t,n),t})(c.BaseButton);t.PdlCommandButton=vt;tt=(function(n){function t(t,i,r,u,o){var s=n.call(this,t,i,r,o)||this;return s._diContainer=u,s.visible(!0),f.isSafari&&f.webKitVersion<f.safari_11_webKitVersion&&(s.fxEnabled(!1),s.tooltip(e.FileDownloadCommand.safariDownload)),s}return __extends(t,n),t.prototype.execute=function(t){var i=this;n.prototype.execute.call(this,t);this.fxEnabled()&&b.cancelOnDispose(this._executeLifetime,k("MsPortalImpl/Commands/Commands.FileDownloadCommand")).then((function(n){if(i._instance)i._instance.execute(i.model.context());else return i._currentContext.getFormTarget().then((function(t){i._instance=new n.FileDownloadCommand(i.model.context(),i._diContainer,t,i._currentContext.target,i._locator);i._instance.execute(i.model.context())}))}))},t})(y);t.FileDownloadButton=tt;it=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.execute=function(t){var i=this;n.prototype.execute.call(this,t);b.cancelOnDispose(this._executeLifetime,k("MsPortalImpl/Commands/Commands.OAuthCommand")).then((function(n){var t=i.model;i.childWindow=n.executeOAuthCommand(t.value,t.requestUrl(),t.popupWidth(),t.popupHeight())}))},t})(y);t.OAuthButton=it;rt=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.execute=function(t){var i=this._model;i.command&&Q(i.command.execute(ko.unwrap(i.commandContext))).catch((function(n){var t=n===null||n===void 0?void 0:n.extension;if(!t||t==="fx")return Q.reject(n)}));n.prototype.execute.call(this,t)},t})(y);t.CommandButton=rt;ut=(function(n){function t(t,i,r,u){var f=n.call(this,t,i,r,u)||this;return f.checked=ko.observable(!1),f.model&&ko.isObservable(f.model.checked)&&ko.computed(f._ltm,(function(){f.checked(f.model.checked())})),f}return __extends(t,n),t.prototype.execute=function(t){var i=this.model,r=!i.checked();i.checked(r);i.command&&i.command.execute({checked:r,context:i.commandContext&&i.commandContext()});n.prototype.execute.call(this,t)},t})(y);t.ToggleButton=ut;ft=(function(n){function t(t,i,r,u){var f=n.call(this,t,i,r,u)||this;return f.buttonViewModel=i,f}return __extends(t,n),t.prototype.execute=function(t){var i;if(typeof this.buttonViewModel.onClick=="function")this.buttonViewModel.onClick({target:u.getOrCreateCachedFxElement((i=this===null||this===void 0?void 0:this._currentContext)===null||i===void 0?void 0:i.target)});n.prototype.execute.call(this,t)},t})(y);t.AmdButton=ft;et=(function(n){function t(t,i,r,u){var f=n.call(this,t,i,r,u)||this;return f.buttonViewModel=i,f}return __extends(t,n),t.prototype.execute=function(t){var i,r;this.buttonViewModel.onClick.uri&&(i=this.buttonViewModel.onClick,ko.isObservable(i.uri)&&(r=ko.unwrap(i.target)||"_blank",ct.open(i.uri(),r),i.onLinkOpened&&i.onLinkOpened(!1)));n.prototype.execute.call(this,t)},t})(y);t.AmdLinkButton=et;yt=(function(){function n(){this.controlType=62;this.vmKind="MsPortalFx";this.disabled=ko.observable(!1);this.showLabels=ko.observable(!0);this.loading=ko.observable(!1);this.items=ko.observable([]);this.itemSelected=$.noop;this.locator=null;this.menuItems=ko.observableArray([])}return n.prototype.setItems=function(n){this.items(n)},n})();t.ViewModel=yt;t.CommandBar=ni;ot=(function(){function n(n){this.toolbarState=new l.WidgetUIState({vm:n.vm,diContainer:n.diContainer})}return n.prototype.dispose=function(){this.toolbarState.dispose()},n})();t.WidgetUIState=ot;st=(function(n){function t(t,i,r,u){var f=n.call(this,t,i)||this;return f.ltm.registerForDispose(new l.Widget(t,i,r,u.toolbarState)),f}return __extends(t,n),t.prototype.setFocus=function(){var n=this.element.find(kt).filter("[tabindex='0']")[0]||this.element.find(bt)[0];n&&n.focus()},t})(s.Widget);t.Widget=st}))