define("MsPortalImpl.Controls/Controls/Lists/Menu.Component",["require","exports","Weave/DirectMode","Weave","MsPortalImpl.Controls/Controls/Lists/List1/ListView.Component","MsPortalImpl.Controls/Controls/SearchBox.Component","Fx/Weave"],(function(n,t,i,r,u,f,e){"use strict";function o(n){var t=n.state;return i(r.Fragment,null,t.searchBoxViewModel?i("div",{className:"fxc-menu-search"},i(f.SearchBoxInner,{vm:t.searchBoxViewModel,state:t.searchBoxState})):i("div",{className:"fxc-menu-nosearch-placeholder"}),i("div",{className:"fxc-menu-scrollarea"},i("div",{className:"fxc-menu-grid"},i(u.ListViewInner,{vm:t.listViewModel,state:t.listState}))))}function s(n){var t=n.value!==MsPortalFx.Resources.Strings.Part.SettingList.Group.quickAccess;return i("div",{className:["ext-fxc-menu-groupheader",t?"":"fxs-display-none"]},n.value)}function h(n){return i(r.Fragment,null,i("div",{image:e.toValueOrComputation(n.icon),className:"ext-fxc-menu-icon msportalfx-svg-c07"}),i("div",{className:"ext-fxc-menu-listView-item"},e.toValueOrComputation(n.displayText)))}Object.defineProperty(t,"__esModule",{value:!0});t.menuItem=t.menuGroupHeader=t.MenuInner=void 0;t.MenuInner=o;t.menuGroupHeader=s;t.menuItem=h}));
define("_generated/Less/MsPortalImpl.Controls/Controls/Lists/Menu.css",["module"],(function(n){"use strict";return{css:".fxc-menu{display:flex;flex-direction:column}.ext-fxc-menu-groupheader{padding:0;font-size:13px;line-height:1.385;line-height:32px;border-bottom-color:inherit;border-bottom-style:solid;border-bottom-width:1px}.ext-menublade-part{height:100%}.fxc-menu-search{flex:0 0 auto;min-height:23px;margin:7px 35px 7px 20px}.fxc-menu-nosearch-placeholder{display:block;flex:0 0 24px}.fxc-menu-scrollarea{overflow:auto;flex:1 1 auto}.ext-fxc-menu-icon{height:15px;width:15px;flex:0 0 auto}.fxc-menu-grid{padding:0}.fxc-menu-grid .azc-listView-item{display:flex;font-size:13px;margin:0}.fxc-menu-grid .azc-listView-item[aria-disabled=true] .ext-fxc-menu-listView-item,.fxc-menu-grid .azc-listView-item[aria-disabled=true] .ext-fxc-menu-icon{opacity:.5}.fxc-menu-grid .ext-fxc-menu-item{display:flex;align-items:center;width:100%;padding:7px 20px;box-sizing:border-box;min-height:32px;overflow:hidden}.fxc-menu-grid .ext-fxc-menu-item:hover,.fxc-menu-grid .ext-fxc-menu-item:focus,.fxc-menu-grid .ext-fxc-menu-item:active{text-decoration:none}.fxc-menu-grid .ext-fxc-menu-icon{position:relative;padding-right:10px;align-self:flex-start;margin-top:2px}.fxc-menu-grid .ext-fxc-menu-listView-item{overflow:hidden;text-overflow:ellipsis}.fxc-menu-grid .azc-listView-groupheader{margin:0 20px}.fxs-menublade .fxs-blade-content-container .fxs-blade-content-container-default{display:none}.fxs-menublade .fxs-blade-content-container .fxs-blade-content-container-default .fxs-part{overflow:hidden !important}.fxc-menu .azc-listView-group{margin-bottom:8px}@media(min-width:640px) and (min-height:500px){.fxs-menublade .fxs-blade-content-container .fxs-blade-content-container-default{display:flex}}",moduleId:n.id}}));
define("MsPortalImpl.Controls/Controls/Lists/Menu",["require","exports","MsPortalImpl.Controls/Controls/Base/Loadable","MsPortalImpl/Base/Base.Selectable2","Fx/Controls/SearchBox","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl.Controls/Controls/Lists/Menu.Component","MsPortalImpl.Controls/Controls/Lists/List1/ListView","MsPortalImpl.Controls/Controls/SearchBox","MsPortalImpl.Controls/Controls/Lists/List1/ListView.InternalViewModel","_oss/fuse","FxInternal/Css","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Menu.css","FxInternal/Controls/ListView1"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";function st(n,t){var i,r,u;return n=n.trim(),i=ut(n,t),r=n.split(" "),r.length>1&&(u=ut(n,t,!0),i.push.apply(i,u),i.sort((function(n,t){return n.score-t.score})),i=MsPortalFx.unique(i,(function(n,t){return MsPortalFx.areEqual(n.item.id,t.item.id)}))),i.map((function(n){return ko.unwrap(n.item.displayText)}))}function d(n,t,i,r){var u=FxImpl.defer(),e=n.createChildLifetime(),f;return t.enabled?t.enabled.subscribeAndRun(e,(function(n){n&&u.resolve(!0)})):u.resolve(!0),i!==-1&&(f=setTimeout((function(){u.resolve(!1)}),i)),u.promise.finally((function(){f&&clearTimeout(f);e.dispose()})).then((function(n){return r(t,n),n}))}function g(n,t){var i=t?t.toLowerCase():"";return MsPortalFx.find(n,(function(n){return n.id.toLowerCase()===i}))||MsPortalFx.find(n,(function(n){return n.id.toLowerCase()===i.replace(/\s/g,"")}))}function ut(n,t,i){var r=i?MsPortalFx.extend({matchAllTokens:!0},it):it,e=new y(t,r),u=e.search(n),f;return u=u.filter((function(n){return n.score<=r.threshold})),f=u.reduce((function(n,t){return t.score<=r.threshold&&n.push(t),n}),[]),f.sort((function(n,t){return n.score-t.score}))||[]}var rt;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.InnerTsxComponent=t.WidgetUIState=void 0;p.injectCss(w);var ft=MsPortalFx.Base.Promises,k=r.getOrCreate,nt="fxc-menu",et="fxs-menu-show-search",tt=500,it={shouldSort:!0,includeScore:!0,includeMatches:!0,tokenize:!0,threshold:.3,location:0,distance:100,maxPatternLength:32,minMatchCharLength:2,keys:[{name:"displayText",weight:.8},{name:"keywords",weight:.3}],getFn:function(n,t){var i=ko.unwrap(n[t]);switch(t){case"displayText":return i;default:return typeof i=="string"?i.split(","):i}}},ot=(function(n){function t(t){var i=n.call(this)||this,e,r;return i.queryString=ko.observable(""),i.searchMissCallbacks=$.Callbacks(),i.ariaLabel=ko.observable(""),e=t.vm,r=i.listViewModel=new v.ViewModel(i._ltm,b.Extensions.Selectable|b.Extensions.Groupable|b.Extensions.ContextMenu,{ariaLabel:i.ariaLabel,groupable:{groupKey:ko.observable("group"),order:ko.observable(b.GroupOrder.Collection),headerTsxFn:c.menuGroupHeader}},c.menuItem),r.outlineStyle(!1),r.extensionOptions.selectable.activateOnSelected=!0,i.listState=new l.WidgetUIState({vm:r,isTrusted:!0,sanitizationContext:t.sanitizationContext}),e.showSearch&&(i.searchBoxViewModel=u.create(i._ltm,{resultLimit:0,placeHolderText:o.isMac?f.Menu.queryStringForMac:f.Menu.queryString,hideSuggestions:!0,update:function(n){i.queryString(n);var t=[];return n.trim()?(t=st(n.toLowerCase(),r.items()),t.length===0?(i.searchMissCallbacks.fire({query:i.queryString()}),r.items().forEach((function(n){var i=ko.unwrap(n.displayText);n.metadata.hidden(t.indexOf(i)<0)}))):r.items().forEach((function(n){var i=ko.unwrap(n.displayText);n.metadata.hidden(t.indexOf(i)<0)}))):r.items().forEach((function(n){n.metadata.hidden(!1)})),Q(t)},submit:function(n){return i.queryString(n),Q(!0)}}),i.searchBoxState=new a.WidgetUIState({diContainer:t.diContainer,vm:i.searchBoxViewModel})),i}return __extends(t,n),t})(h.WidgetUIState);t.WidgetUIState=ot;t.InnerTsxComponent=c.MenuInner;rt=(function(n){function t(t,i,r,u){var f=n.call(this,t,i,r,u)||this,o,v,c,h,d,g,tt,p;f._overview=ko.observable();f._callbacks=$.Callbacks();f._noDefaultIdDeferred=Q.defer();f.selectedItemText=ko.observable();f._partContainer=t.parent();t.addClass(nt);i.showSearch&&t.parents(".fxs-blade-content-wrapper").addClass(et);o=f.ltm;u.ariaLabel()||u.ariaLabel(t.closest(".fxs-blade").find(".fxs-blade-title-titleText").text());var y=f._data=i._msPortalFxData,it=y.items,rt=y.selectableMap,w=y.options,b=f._data.menuDeepLink||ko.observable("");f.getResourceType=function(){var n=w.peek()||{};return n.resourceType};v=ko.observableArray([]);c={};ko.explicitComputed(o,[it,f._overview],(function(n){var t=f._overview(),i=[];t&&i.push(t);v(i.concat(n))}));b.subscribe(o,(function(n){n&&v().forEach((function(t){var i=t.id;c[i](s.replaceMenuIdFromDeepLink(n,i))}))}));f._visibleItems=v.map(o,(function(n,t){var r=t.id,i;return ko.ignoreDependencies((function(){if(!c[r]){var n=b();c[r]=ko.observable(n&&f._selectedItem&&s.replaceMenuIdFromDeepLink(n,r)||"#")}})),i=MsPortalFx.extend({metadata:{},url:c[r]},t),i.metadata.disabled||(i.metadata.disabled=ko.observable(!1)),i.metadata.hidden=ko.observable(!1),i.enabled&&i.enabled.subscribeAndRun(n,(function(n){return i.metadata.disabled(!n)})),i})).filter(o,(function(n){return!n.visible||n.visible()}));h=f.state.listViewModel;f._visibleItems.subscribeAndRun(o,h.items);d=h.extensionOptions.selectable.selectedItem;g=new ft.CancelationToken;d.subscribe(o,(function(n){var r,u,t,e,i;f.resetStartupLifetimeManager();g.cancel();n&&(u=rt()[n.id],t=k(f._diContainer,u),t.isSelected()||(f._clickSelectable(n.id,t),f._selectedItem=n,e=t.isSelected.subscribe(t.createChildLifetime(),(function(){n===h.extensionOptions.selectable.selectedItem()&&h.extensionOptions.selectable.selectedItem(null);e.dispose()}))),i=f._overview(),r=(i&&i.id)===n.id?null:ko.unwrap(n.displayText));f.selectedItemText(r)}));t.on("click",".ext-fxc-menu-item",(function(n){if(e.isCtrlOrCommandOnly(n)||n.shiftKey)return!0;n.preventDefault()}));return f.delayRendering=MsPortalFx.isFeatureEnabled("earlymenucontentvm")?function(n){tt=Q.any([n,f._noDefaultIdDeferred.promise])}:MsPortalFx.noop,t.trigger("fxregistermenu",f),MsPortalFx.tryImmediateFinally(tt||Q(),(function(){h.startDelayedListRender()})),p={weaveContext:f.weaveContext},f.ltm.registerForDispose(new l.Widget(t.findByClassName("fxc-menu-grid"),h,p,f.state.listState)),f.state.searchBoxViewModel&&f.ltm.registerForDispose(new a.Widget(t.findByClassName("fxc-menu-search"),f.state.searchBoxViewModel,p,f.state.searchBoxState)),f.getTelemetryInfo=function(){var t=w.peek()||{},n={itemCount:f._visibleItems.peek().length};return MsPortalFx.extendStringMapIntoMap(n,t,(function(n){return MsPortalFx.isPrimitive(n)?n:undefined}),!0),n},f}return __extends(t,n),t.prototype.onItemClick=function(n){this._callbacks.add(n)},t.prototype.onSearchMiss=function(n){this.state.searchMissCallbacks.add(n)},t.prototype.resetStartupLifetimeManager=function(){this._startupLifetimeManager&&this._startupLifetimeManager.dispose()},t.prototype.setDefaultId=function(n){var t=this,u=this.state.listViewModel,e=n.recommendedId,o=u.extensionOptions.selectable.selectedItem,c;o()&&o(null);var s=this._data,l=s.selectableMap,h=s.options;this.resetStartupLifetimeManager();var i=this._startupLifetimeManager=this.ltm.createChildLifetime(),f=ko.observable(),r=function(n,i){i===void 0&&(i=!0);i?u.extensionOptions.selectable.selectedItem(n):f()?u.extensionOptions.selectable.selectedItem(g(t._visibleItems(),f())):u.extensionOptions.selectable.selectedItem(MsPortalFx.first(t._visibleItems()))};ko.computed(i,[l,this._visibleItems,f,],(function(u,f,o){var h,s,c;u&&o&&(n.bladeReference&&u[e]&&(h=k(t._diContainer,u[e]),h.referenceOverride=n.bladeReference,n.bladeReference=null),s=MsPortalFx.find(f,(function(n){return t._selectedItem&&n.id===t._selectedItem.id})),c=s?d(i,s,tt,r):Promise.resolve(!1),c.then((function(n){var e,s,h;n||i.isDisposed()||(e=g(f,o.toLowerCase()),e?d(i,e,tt,r):u[o]?(h=!1,MsPortalFx.forEachKey(u,(function(n){if(!h){var o=k(t._diContainer,u[n]),e=MsPortalFx.find(f,(function(t){return t.id===n}));e&&(o.isSelected()&&(!e.enabled||e.enabled())?(h=!0,r(e),Q.nextTick((function(){return t.resetStartupLifetimeManager()}))):ko.computed(i,[o.isSelected,e.enabled||ko.observable(!0)],(function(n,i){n&&i&&(r(e),t.resetStartupLifetimeManager())})))}}))):(s=MsPortalFx.first(f),s&&d(i,s,-1,r)))})))}));c=h.subscribe(i,(function(n){if(n){var r=n.overview,i=n.defaultId;r?(t._overview(MsPortalFx.extend2(r,{group:MsPortalFx.Assets.QuickAccessGroupId,aggregatedKeywords:[r.displayText].concat(r.keywords).join(" ")})),i||(i=r.id)):t._overview(null);i=e||i;i?f(i):t._noDefaultIdDeferred.resolve()}}));n.rebinding||c.callback(h())},t.prototype.switchItem=function(n){var t=this._visibleItems(),i=g(t,n),r=i?i:MsPortalFx.first(t);r&&this.state.listViewModel.extensionOptions.selectable.selectedItem(r)},t.prototype.getSelectedItem=function(){return this._selectedItem},t.prototype.getPartContainer=function(){return this._partContainer},t.prototype.dispose=function(){this._cleanElement(nt);n.prototype.dispose.call(this)},t.prototype.selectDefaultItem=function(){this.state.listViewModel.extensionOptions.selectable.selectedItem(this._visibleItems.peek()[0])},t.prototype.getDefaultItem=function(){return this._visibleItems.peek()[0]},t.prototype._clickSelectable=function(n,t){t.onClick();this._callbacks.fire(n,{query:this.state.queryString()})},t.flightNewRender=!0,t})(i.Widget);t.Widget=rt}))