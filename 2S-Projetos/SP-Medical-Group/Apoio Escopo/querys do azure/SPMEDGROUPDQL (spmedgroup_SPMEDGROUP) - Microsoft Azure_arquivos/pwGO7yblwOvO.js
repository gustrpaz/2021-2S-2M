define("_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.FocusableExtension.css",["module"],(function(n){"use strict";return{css:'.azc-treeView-focusable.azc-treeView-mousedown{outline:none}.azc-treeView-focusable ul li[aria-disabled="true"]>.azc-treeView-node{opacity:.5}',moduleId:n.id}}));
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.LoadByContinuationToken.css",["module"],(function(n){"use strict";return{css:".azc-treeView-loadByContinuationToken .azc-treeView-loadMore-icon svg{width:10px;height:10px;margin-right:10px}",moduleId:n.id}}));
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.OnDemandLoadableExtension.css",["module"],(function(n){"use strict";return{css:".azc-treeView-onDemandLoadable .azc-treeView-icon-loading{position:absolute;width:10px;height:10px;border:2px solid #758393;border-right-color:transparent;border-radius:50%;animation:azc-treeView-loading 1s linear infinite}.azc-treeView-onDemandLoadable .azc-treeView-icon-expanded{animation:none}@keyframes azc-treeView-loading{from{transform:rotate(0deg)}50%{transform:rotate(180deg)}to{transform:rotate(360deg)}}",moduleId:n.id}}));
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.RightClickable.css",["module"],(function(n){"use strict";return{css:".azc-treeView-rightClickable .azc-treeView-node-contextButton{flex:0 0 auto;width:16px;height:16px;padding-left:3px;padding-right:3px;cursor:pointer}",moduleId:n.id}}));
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.Selectable.css",["module"],(function(n){"use strict";return{css:".azc-treeView-multiselectBox{flex:0 0 auto;height:11px;width:11px;border-width:1px;border-style:solid}.ext-treeView-svg{display:block}",moduleId:n.id}}));
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.css",["module"],(function(n){"use strict";return{css:".azc-treeView ul{margin:0;padding:0}.azc-treeView .azc-treeView-node-group{margin-left:0;list-style-type:none}.azc-treeView .azc-treeView-node-group li.azc-treeView-item:focus{outline:none}.azc-treeView .azc-treeView-node-group li.azc-treeView-item:focus .fxs-treeitem-focused{outline-offset:-1px;outline-width:1px;outline-style:solid}.azc-treeView .azc-treeView-node-group .fxs-treeitem-focused{background-clip:padding-box}.azc-treeView .azc-treeView-node-group div.azc-treeView-node{position:relative;cursor:default;border-width:1px;border-style:solid;border-color:transparent;display:flex;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;align-items:center}.azc-treeView .azc-treeView-node-group div.azc-treeView-node .azc-treeView-icon{flex:0 0 auto;width:16px;height:16px;display:inline-block;top:3px}.azc-treeView .azc-treeView-node-group div.azc-treeView-node .azc-treeView-icon .azc-treeView-icon-collapsed{margin-left:2px;width:12px;height:12px}.azc-treeView .azc-treeView-node-group div.azc-treeView-node .azc-treeView-icon .azc-treeView-icon-expanded{margin-left:4px;margin-top:2px;width:12px;height:12px;transform:rotate(90deg)}.azc-treeView .azc-treeView-node-group div.azc-treeView-node .azc-treeView-node-icon{flex:0 0 auto;width:16px;height:16px}.azc-treeView .azc-treeView-node-group div.azc-treeView-node .azc-treeView-node-content{flex:1 1 auto;position:relative;padding:3px}.azc-treeView .azc-treeView-node-group div.azc-treeView-node.azc-treeView-node-has-icon .azc-treeView-node-content{padding-left:3px}.azc-treeView.azc-treeView-always-expanded .azc-treeView-node-group .azc-treeView-node .azc-treeView-node-icon{margin-left:1px}.azc-treeView.azc-treeView-always-expanded .azc-treeView-node-group .azc-treeView-node .azc-treeView-node-content{margin:3px}.azc-treeView.azc-treeView-always-expanded .azc-treeView-node-group .azc-treeView-node.azc-treeView-node-has-icon .azc-treeView-node-content{margin-left:19px}.azc-treeView.azc-control-disabled{opacity:.5;cursor:default;pointer-events:none}.azc-treeView>.azc-treeView-node-group{padding:1px}.fxs-mode-light .azc-treeView .azc-treeView-node-group li.azc-treeView-item:focus .fxs-treeitem-focused{outline-color:#000}.fxs-mode-dark .azc-treeView .azc-treeView-node-group li.azc-treeView-item:focus .fxs-treeitem-focused{outline-color:#fff}.azc-treeView.azc-treeView-reflow{overflow-x:auto}.azc-treeView.azc-treeView-reflow .azc-treeView-node-content{min-width:140px;white-space:normal;overflow:hidden}.azc-treeView:not(.azc-treeView-reflow) .azc-treeView-node-content{min-width:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;word-wrap:break-word}",moduleId:n.id}}));
define("Viva.Controls/Controls/Lists/Tree1/Viva.Tree",["require","exports","Viva.Controls/Controls/Base/Viva.ExtensibleControl","MsPortalImpl/Resources/ImplScriptResources","Viva.Controls/Util/Viva.TemplateEngine","Viva.Controls/Util/Viva.Util","_generated/MsPortalImpl/Svg/Startup/Refresh.svg","MsPortalImpl/Base/Base.SvgHelper","FxInternal/Css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.FocusableExtension.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.LoadByContinuationToken.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.OnDemandLoadableExtension.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.RightClickable.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.Selectable.css","MsPortalImpl/Base/Base.KnockoutExtensions.Image"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){"use strict";var p,b;Object.defineProperty(t,"__esModule",{value:!0});t.Widget=t.ViewModel=t.Extension=void 0;s.injectCss(h,c,l,a,v,y);var w="azc-treeView",k="<!-- ko template: 'treeRoot' --><!-- /ko -->",d=MsPortalFx.Base.Images.Chevron(),g='<!-- ko if: data.items().length > 0 && ($vm.alwaysExpanded() || !data.metadata || (data.metadata.expanded() !== undefined)) --><ul role=\'tree\' class=\'azc-treeView-node-group\' data-bind=\'visible: $vm.alwaysExpanded() || !data.metadata || data.metadata.expanded(), attr: { "tabindex": $ctl._treeTabindex($context), "aria-multiselectable": $vm.multiselectable(), "aria-label":$vm.ariaLabel() }\'><!-- ko template: { name: \'nodes\', foreach: data.items } --><!-- /ko --><li role="treeitem" class="azc-treeView-loadMoreRoot-btn" data-bind=\'attr: {"aria-disabled": $disabled(), "tabindex": $tabIndex()}, visible: $vm.canLoadMoreRootItems\'><a tabindex="-1" role="button" data-bind=\'style: { "paddingLeft": $ctl._paddingValue($context) }, attr: { "aria-disabled": $disabled() }\' href=\'#\'>'+("<span class='azc-treeView-loadMore-icon'>"+o.getSvgReferenceOrFallBackToData(e).outerHTML+"<\/span>"+MsPortalFx.encodeHtml(r.Grid.loadMore))+"<\/a> <\/li><\/ul><!-- /ko -->",nt='<!-- ko if: data.items().length > 0 && ($vm.alwaysExpanded() || !data.metadata || (data.metadata.expanded() !== undefined)) --><ul role=\'group\' class=\'azc-treeView-node-group\' data-bind=\'visible: $vm.alwaysExpanded() || !data.metadata || data.metadata.expanded(), attr: { "tabindex": $ctl._treeTabindex($context) }\'><!-- ko template: { name: \'nodes\', foreach: data.items } --><!-- /ko --><!-- ko if: data.nextLink && data.nextLink() !== null && data.nextLink() !== undefined --><li role="treeitem" class="azc-treeView-loadMore-btn" data-bind=\'attr: {"aria-disabled": $disabled(), "tabindex": $tabIndex()}\'><a tabindex="-1" role="button" data-bind=\'style: { "paddingLeft": $ctl._paddingValue($context) }, attr: { "aria-disabled": $disabled() }\' href=\'#\'>'+("<span class='azc-treeView-loadMore-icon'>"+o.getSvgReferenceOrFallBackToData(e).outerHTML+"<\/span>"+MsPortalFx.encodeHtml(r.Grid.loadMore))+"<\/a> <\/li><!-- /ko --><\/ul><!-- /ko -->",tt="<!-- ko template: { name: 'nodesCore', data: $ctl._ensureItemInitialized($data) } --><!-- /ko -->",it="<li role='treeitem' class='azc-treeView-item' data-bind='keyedCss: { treeNodeCore: $data.cssClass}, attr: { \"aria-disabled\": metadata.disabled() || $disabled(), \"aria-label\": $ctl._itemAriaLabel($data), \"aria-expanded\": metadata.expandable() ? (metadata.expanded() ? \"true\" : \"false\") : undefined,  \"title\": $ctl._itemAriaLabel($data) }'><div class='azc-treeView-node azc-node' data-bind='css: { \"azc-treeView-node-has-icon\": $data.icon && icon(), \"azc-row-disabled\": metadata.disabled() || $disabled() }, style: { \"paddingLeft\": $ctl._paddingValue($parentContext) }'><!-- ko template: 'treeIcon' --><!-- /ko --><!-- ko template: 'nodeIcon' --><!-- /ko --><!-- ko template: 'nodeContent' --><!-- /ko --><\/div><!-- ko template: { name: 'treeItem', data: { data: $data, level: true } } --><!-- /ko --><\/li>",rt="<div class='azc-treeView-icon'><div data-bind='css: { \"azc-treeView-icon-expanded\": metadata.expanded(), \"azc-treeView-icon-collapsed\": !metadata.expanded() }, visible: items().length > 0 && !$vm.alwaysExpanded(), image: $ctl._collapsedImage '><\/div><\/div>",ut="<!-- ko if: $data.icon && icon() --><!-- ko if: typeof(icon()) === \"string\" --><img class='azc-treeView-node-icon' data-bind='attr: { src: icon }' alt='' /><!-- /ko --><!-- ko if: typeof(icon()) !== \"string\" --><div class='azc-treeView-node-icon' data-bind='image: icon'><\/div><!-- /ko --><!-- /ko -->",ft="<div class='azc-treeView-node-content' data-bind='trustedHtml: $ctl._itemFormat($data)'><\/div>",et=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(i.Extension);t.Extension=et;p=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.items=ko.observableArray(),t.events=MsPortalFx.noop,t.padding=ko.observable(16),t.pathSeparator="/",t.alwaysExpanded=ko.observable(!1),t.htmlTemplates=[],t.multiselectable=ko.observable(!1),t.canLoadMoreRootItems=ko.observable(!1),t.ariaLabel=ko.observable(""),t}return __extends(t,n),t})(i.ViewModel);t.ViewModel=p;b=(function(n){function t(t,i,r){var f=this;return r=r||{},r.viewModelType=r.viewModelType||p,f=n.call(this,t,i,r)||this,f.templateEngine=new u.HtmlTemplateEngine,f.treeTabIdx=ko.observable(-1),f._collapsedImage=d,f.options.extensionTrigger("beforeCreate"),f._setTemplates(),f.element.addClass(w).addClass("azc-fabric").html(k),f._initializeComputeds(),f._bindDescendants(),f._attachEvents(),f.options.extensionTrigger("afterCreate"),f}return __extends(t,n),t.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this.options.extensionTrigger("beforeDestroy"),this._detachEvents(),this._cleanElement(w,"azc-fabric","azc-treeView-always-expanded","azc-treeView-reflow"),n.prototype.dispose.call(this),this.options.extensionTrigger("afterDestroy"))},Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),t.prototype.getElementFromItem=function(n){return this.element.find(".azc-treeView-node").filter((function(t,i){return ko.dataFor(i)===n}))},t.prototype.toggleNodeExpansion=function(n,t,i){if(!this.$disabled()&&n&&!n.metadata.disabled()&&!this.options.alwaysExpanded()){var r="itemExpand",u=typeof i=="boolean"?i:!n.metadata.expanded(),e={expanding:u,item:n,cancel:!1};n.metadata.expanded()!==u&&(this.trigger(r,f.cloneEvent(t,r),e),this.options.events(r,e),t.isDefaultPrevented()||n.metadata.expanded(u))}},t.prototype._expandNode=function(n,t,i){n.length&&this.toggleNodeExpansion(ko.dataFor(n[0]),t,i)},t.prototype._buildPath=function(n){var t=this.element.find(".azc-treeView-node").filter((function(t,i){return n===ko.dataFor(i)}));return t?t.parentsUntil(".azc-treeView","li").map((function(n,t){return ko.dataFor(t).text()})).get().reverse().join(this.options.pathSeparator):""},t.prototype._initializeComputeds=function(){var n=this;ko.computed(this.ltm,(function(){n.element.toggleClass("azc-treeView-always-expanded",n.options.alwaysExpanded());n.element.toggleClass("azc-treeView-reflow",ko.unwrap(n.options.reflow))}))},t.prototype._treeTabindex=function(n){return n.$data.level?undefined:this.treeTabIdx().toString()},t.prototype._paddingValue=function(n){for(var i=0,t=n;t&&t.$ctl===this;)!t.$data.level||i++,t=t.$parentContext;return i*this.options.padding()+"px"},t.prototype._ensureItemInitialized=function(n){return n.items=n.items||ko.observableArray(),n.metadata=n.metadata||{},n.metadata.expanded=n.metadata.expanded||ko.observable(),n.metadata.disabled=n.metadata.disabled||ko.observable(!1),n.metadata.expandable=ko.computed(this.ltm,(function(){return n.items().length!==0})),this.options.extensionTrigger("defaultItemMetadataProperties",n),n},t.prototype._attachEvents=function(){var n=this;this.options.extensionTrigger("beforeAttachEvents");this.ltm.registerForDispose(this.element.setEvents(["click.azcTreeView",".azc-treeView-icon",function(t){n._expandNode($(t.target),t)},]));this.options.extensionTrigger("afterAttachEvents")},t.prototype._detachEvents=function(){this.options.extensionTrigger("beforeDetachEvents");this.options.extensionTrigger("afterDetachEvents")},t.prototype._itemAriaLabel=function(n){var t=n.ariaLabel,i=(ko.unwrap(t)||"").trim();return i||(n.text()||"").trim()||undefined},t.prototype._itemFormat=function(n){var i=n.templateKey?n.templateKey():null,t;return i&&(t=MsPortalFx.find(this.options.htmlTemplates,(function(n){return MsPortalFx.localeCompareIgnoreCase(i,n.key)===0})),t&&t.html)?t.html:MsPortalFx.encodeHtml(n.text()||"")},t.prototype._setTemplates=function(){var n=this.templateEngine;this.options.extensionTrigger("beforeSetTemplates",n);n.setTemplate({treeRoot:g,treeItem:nt,nodes:tt,nodesCore:it,treeIcon:rt,nodeIcon:ut,nodeContent:ft});this.options.extensionTrigger("afterSetTemplates",n)},t})(i.Widget);t.Widget=b}));
define("Viva.Controls/Controls/Lists/Tree1/Viva.Tree.Focusable",["require","exports","MsPortalImpl/Base/JQueryHelper","Viva.Controls/Util/Viva.Util","Viva.Controls/Controls/Lists/Tree1/Viva.Tree","MsPortalImpl/Base/Base.KeyboardHelper"],(function(n,t,i,r,u,f){"use strict";function o(n){return i.filterVisible(n,e+s)}var h;Object.defineProperty(t,"__esModule",{value:!0});t.FocusableExtension=void 0;var c=window,l='attr: { "data-treeView-focusable": true, tabindex: !metadata.disabled() && metadata.focused() ? $tabIndex() : null }',a='css: {"fxs-treeitem-focused": metadata.focused() }',s="[data-treeView-focusable=true]:not([aria-disabled=true])",e="li[role=treeitem]";h=(function(n){function t(t){var i=n.call(this)||this;return i._options=t||{},i}return __extends(t,n),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),t.prototype.afterCreate=function(){var n=this;this._widget.$tabIndex.subscribeAndRun(this._widget.ltm,(function(t){n._widget.treeTabIdx(t)}))},t.prototype.afterSetTemplates=function(n){var t=n.getHtmlTemplate("nodesCore"),i=n.getHtmlTemplate("treeItem"),r=n.getHtmlTemplate("treeRoot");r.addAttribute(".azc-treeView-loadMoreRoot-btn","data-treeView-focusable",["true"]);i.addAttribute(".azc-treeView-loadMore-btn","data-treeView-focusable",["true"]);t.addAttribute("li[role=treeitem]","data-treeView-focusable",["true"]);t.addAttribute(null,"data-bind",[l]);t.addAttribute(">div","data-bind",[a])},t.prototype.defaultItemMetadataProperties=function(n){n.metadata.focused=n.metadata.focused||ko.observable(!1)},t.prototype.getOrder=function(){return 10},t.prototype.afterAttachEvents=function(){var n=this,t=this._widget,i=function(t){var i=$(t.target).closest(e);i.is(s)&&i.length>0&&n._focusNode(i,ko.dataFor(i[0]),t)},r=function(i){var r=$(i.target).closest(e),u,s=r.is(".azc-treeView-loadMore-btn")||r.is(".azc-treeView-loadMoreRoot-btn"),l=!s&&r.is("[data-treeView-focusable=true]"),o=l&&ko.dataFor(r[0]).metadata.expanded(),a=f.getModifierKeys(i),h,c;if(a===0)switch(i.which){case 38:u=n._findPreviousFocusable(r);i.preventDefault();break;case 40:u=n._findNextFocusable(r);i.preventDefault();break;case 37:o?t._expandNode(r,i,!1):(h=r.parent().closest(e),h[0]&&(u=h));i.preventDefault();i.stopPropagation();break;case 39:o?(c=r.find(e).first(),c[0]&&(u=c)):l&&t._expandNode(r,i,!0);i.preventDefault();i.stopPropagation();break;case 32:s&&(u=n._findPreviousFocusable(r),i.preventDefault());break;case 13:s?(u=n._findPreviousFocusable(r),i.preventDefault()):o?(t._expandNode(r,i,!1),i.preventDefault()):o||(t._expandNode(r,i,!0),i.preventDefault());break;case 36:u=n._findFirstFocusable();break;case 35:u=n._findLastFocusable()}u&&u.length>0&&n._focusNode(u,ko.dataFor(u.get(0)),i)},u=function(i,r){var u=t.getElementFromItem(r.item).closest(e);u&&u.length>0&&n._focusNode(u,ko.dataFor(u[0]),i)},o=function(){t.element.addClass("azc-treeView-mousedown");$.querySelectorAll("body").one("mouseup",(function(){t&&t.element&&t.element.removeClass("azc-treeView-mousedown")}))};this._widget.ltm.registerForDispose(this._widget.element.setEvents(["click.azcTreeView",i],["keydown.azcTreeView",r],["itemExpand.azcTreeView",u],["mousedown.azcTreeView",o]))},t.prototype.beforeDestroy=function(){var n=this._widget.element;this._lastTabbableItemMetadata=null;n.removeAttr("tabindex").removeClass("azc-treeView-mousedown")},t.prototype.getName=function(){return t.Name},t.prototype._findPreviousFocusable=function(n){var r=n[0],i=o(this._widget.element[0]),t;if(r)for(t=i.length-1;t>=0;t--)if(r===i[t]&&t>0)return $(i[t-1]);return $(i[i.length-1])},t.prototype._findNextFocusable=function(n){var r=n[0],i=o(this._widget.element[0]),t;if(r)for(t=0;t<i.length;t++)if(r===i[t]&&t<i.length-1)return $(i[t+1]);return $(i[0])},t.prototype._findFirstFocusable=function(){var n=o(this._widget.element[0]);return $(n[0])},t.prototype._findLastFocusable=function(){var n=o(this._widget.element[0]);return $(n[n.length-1])},t.prototype._focusElement=function(n){var t=n.get(0);t.focus();t.focus()},t.prototype._focusNode=function(n,t,i){var u=$(n).closest(e),f,o;t&&u[0]!==c.document.activeElement&&(this._lastTabbableItemMetadata&&this._lastTabbableItemMetadata.focused(!1),u.is(".azc-treeView-loadMore-btn")?(this._lastTabbableItemMetadata=null,this._focusElement(u)):u.is(".azc-treeView-loadMoreRoot-btn")?(this._lastTabbableItemMetadata=null,this._focusElement(u)):(f=t.metadata,this._lastTabbableItemMetadata=f,f.focused(!0),this._focusElement(u),o={focused:t},this._widget.trigger("itemFocus",r.cloneEvent(i,"itemFocus"),o),this._widget.options.events("focus",o)))},t.Name="azc-treeView-focusable",t})(u.Extension);t.FocusableExtension=h}));
define("Viva.Controls/Controls/Lists/Tree1/Viva.Tree.LoadByContinuationToken",["require","exports","Viva.Controls/Controls/Lists/Tree1/Viva.Tree","Viva.Controls/Util/Viva.Util"],(function(n,t,i,r){"use strict";var u;return (function(n){var t=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.afterAttachEvents=function(){var n=this._widget,t=function(t){var i=ko.dataFor(t.target).data,u={item:i,path:n._buildPath(i)};n.trigger("loadMoreItems",r.cloneEvent(t,"loadMoreItems"),u);n.options.events("loadMoreItems",u);t.preventDefault()},u=function(n){switch(n.which){case 32:case 13:t(n)}},i=function(t){n.trigger("loadMoreRootItems",r.cloneEvent(t));n.options.events("loadMoreRootItems");t.preventDefault()},f=function(n){switch(n.which){case 32:case 13:i(n)}};this._widget.ltm.registerForDispose(this._widget.element.setEvents(["click.azcTreeView",".azc-treeView-loadMore-btn",t],["keydown.azcTreeView",".azc-treeView-loadMore-btn",u],["click.azcTreeView",".azc-treeView-loadMoreRoot-btn",i],["keydown.azcTreeView",".azc-treeView-loadMoreRoot-btn",f]))},t.prototype.getName=function(){return t.Name},t.Name="azc-treeView-loadByContinuationToken",t})(i.Extension);n.LoadByContinuationTokenExtension=t})(u||(u={})),u}));
define("Viva.Controls/Controls/Lists/Tree1/Viva.Tree.OnDemandLoadable",["require","exports","Viva.Controls/Controls/Lists/Tree1/Viva.Tree","Viva.Controls/Util/Viva.Util"],(function(n,t,i,r){"use strict";var u;return (function(n){var t="azc-treeView-onDemandLoadable",u="<div class='azc-treeView-icon'>"+('<div data-bind=\'css: { "azc-treeView-icon-expanded": $ctl.getPlugin("'+t+'")._isExpanded($data), "azc-treeView-icon-collapsed": $ctl.getPlugin("'+t+'")._isCollapsed($data), "azc-treeView-icon-loading": $ctl.getPlugin("'+t+'")._isLoading($data) }, visible: $data.metadata.expandable(), image: $ctl.getPlugin("'+t+"\")._isLoading($data) ? null : $ctl._collapsedImage '><\/div>")+"<\/div>",f=(function(n){function i(){return n!==null&&n.apply(this,arguments)||this}return __extends(i,n),i.prototype.afterSetTemplates=function(n){n.setTemplate("treeIcon",u)},i.prototype.defaultItemMetadataProperties=function(n){var t=n.metadata.loadable||ko.observable();n.metadata.loadable=t;n.metadata.expandable=ko.computed(this.ltm,(function(){return n.items().length>0||t()!==undefined}))},i.prototype.afterAttachEvents=function(){var i=this,n,t=this._widget,u=function(u,f){var e=f.item.metadata;e.expanded()||(f.expanding?e.loadable()&&(e.loadable(!1),i._observeChildrenRemoval(f.item),n={item:f.item,path:t._buildPath(f.item)},t.trigger("itemLoading",r.cloneEvent(u,"itemLoading"),n),t.options.events("loading",n)):u.preventDefault())};this._widget.ltm.registerForDispose(this._widget.element.setEvents(["itemExpand.azcTreeView",u]))},i.prototype.getOrder=function(){return 30},i.prototype.getName=function(){return i.Name},i.prototype._observeChildrenRemoval=function(n){n.items.subscribeArrayDeletes(this._widget.ltm,(function(){n.items().length===0&&(n.metadata.expanded(!1),n.metadata.loadable(undefined))}))},i.prototype._isExpanded=function(n){return n.items().length>0&&n.metadata.expanded()&&!n.metadata.disabled()},i.prototype._isCollapsed=function(n){return!n.metadata.expanded()||n.metadata.disabled()||n.metadata.loadable()},i.prototype._isLoading=function(n){return n.items().length===0&&!n.metadata.loadable()},i.Name=t,i})(i.Extension);n.OnDemandLoadableExtension=f})(u||(u={})),u}));
define("Viva.Controls/Controls/Lists/Tree1/Viva.Tree.RightClickable",["require","exports","Viva.Controls/Util/Viva.Util","Viva.Controls/Controls/Lists/Tree1/Viva.Tree","MsPortalImpl/Base/Base.KeyboardHelper"],(function(n,t,i,r,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RightClickableExtension=void 0;var f="<div class='azc-treeView-node-contextButton' data-bind='image: MsPortalFx.Base.Images.Ellipsis(), visible: $ctl.getPlugin(\"azc-treeView-rightClickable\")._contextCommandsEnabled($data)'><\/div>",e=(function(n){function t(t){var i=n.call(this)||this;return i._hasDynamicCommands=t,i}return __extends(t,n),t.prototype.afterSetTemplates=function(n){n.setTemplate("nodeContent",n.getTemplate("nodeContent")+f)},t.prototype.afterAttachEvents=function(){var n=this._widget,t=function(t){var r=$(t.target).closest("li[role=treeitem]"),f,e;u.isCtrlOrCommandOnly(t)||r.is(".azc-treeView-loadMore-btn")||r.is(".azc-treeView-loadMoreRoot-btn")||r.is("[aria-disabled=true]")||(n.trigger("selectTreeItem",i.cloneEvent(t,"selectTreeItem"),r),f=ko.dataFor(r[0]),f.noContextMenu&&f.noContextMenu())||(e={item:f,path:n._buildPath(f),clientX:t.clientX||r.offset().left+r.width()/2,clientY:t.clientY||r.offset().top+r.height()/2},n.trigger("itemRightClick",i.cloneEvent(t,"itemRightClick"),e),n.options.events("itemRightClick",e))};n.ltm.registerForDispose(n.element.setEvents(["fxcontextmenurequest.azcTreeView",t],["keydown.azcTreeView",function(n){n.which===121&&u.getModifierKeys(n)===4&&t(n)}],["click.azcTreeView",".azc-treeView-node-contextButton",t]))},t.prototype.getName=function(){return t.Name},t.prototype._contextCommandsEnabled=function(n){return(n.commandGroup||this._hasDynamicCommands)&&!(n.noContextMenu&&n.noContextMenu())},t.Name="azc-treeView-rightClickable",t})(r.Extension);t.RightClickableExtension=e}));
define("Viva.Controls/Controls/Lists/Tree1/Viva.Tree.Selectable",["require","exports","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.Focusable","Viva.Controls/Util/Viva.Util","Viva.Controls/Controls/Lists/Tree1/Viva.Tree"],(function(n,t,i,r,u){"use strict";var f;return (function(n){var f=window,t="[data-treeView-selectable=true]:not([aria-disabled=true])",e='attr: { "data-treeView-selectable": metadata.selectable(), "aria-selected": !metadata.disabled() && metadata.selected() ? "true" : "false" }',o='keyedCss: { treeNodeSelected: { "fxs-portal-activated": metadata.selected() }}',s='keyedCss: { treenodefocusedcolor: {"fxs-portal-selected":  metadata.selectable() && metadata.selected() }}',h='keyedCss:{ treeNodeFocus: {"fxs-portal-focus": metadata.selectable()}}',c='keyedCss:{ treeNodeHover: {"fxs-portal-hover": metadata.selectable()}}',l="<!-- ko if: $ctl.getPlugin(\"azc-treeView-selectable\")._selectionMode === 1 --><div class='azc-treeView-multiselectBox fxs-portal-border'><div style='height: 11px; width: 11px;' data-bind='image: $ctl.getPlugin(\"azc-treeView-selectable\")._selectionCheckSvg, visible: metadata.selected()'><\/div><\/div><!-- /ko -->",a=(function(n){function u(t){var i=n.call(this)||this;return i._selectionMode=t||0,i._selectionMode===1&&(i._selectionCheckSvg=MsPortalFx.Base.Images.Check({palette:99,customClass:"ext-treeView-svg"})),i}return __extends(u,n),u.prototype.getSelected=function(){return this._findSelectedItem(this._widget.options.items())},u.prototype.select=function(n){this._selectionMode!==1&&this.unselect();n.metadata.selected(!0)},u.prototype.unselect=function(n){var t=n||this.getSelected();t&&t.metadata.selected(!1)},u.prototype.afterSetTemplates=function(n){n.setTemplate("nodeIcon",l+n.getTemplate("nodeIcon"));var t=n.getHtmlTemplate("nodesCore");t.addAttribute(">div","data-bind",[o,c,s]);t.addAttribute(null,"data-bind",[e,h])},u.prototype.defaultItemMetadataProperties=function(n){n.metadata.selected=n.metadata.selected||ko.observable(!1);n.metadata.selectable=n.metadata.selectable||ko.observable(!0)},u.prototype.afterAttachEvents=function(){var i=this,n=this._widget,u=function(n,t){i._changeSelection(t,n)},e=function(i){var u=$(i.target).closest("li[role=treeitem]"),f;u.is(t)&&(f=u.find(".azc-treeView-icon"),f.length!==0&&(f[0]===i.target||$.contains(f[0],i.target))||(n.trigger("selectTreeItem",r.cloneEvent(i,"selectTreeItem"),u),n.trigger("clickTreeItem",r.cloneEvent(i,"selectTreeItem"),ko.dataFor(u[0]))))},o=function(i){var u=$(i.target),e=u.closest("li[role=treeitem]");switch(i.which){case 32:e.is(t)&&i.target===f.document.activeElement&&(n.trigger("selectTreeItem",r.cloneEvent(i,"selectTreeItem"),e),i.preventDefault());break;case 13:e.is(t)&&i.target===f.document.activeElement&&"LI"===u[0].tagName&&"treeitem"===u.attr("role")?(n.trigger("clickTreeItem",r.cloneEvent(i,"selectTreeItem"),ko.dataFor(e[0])),i.preventDefault()):(u.click(),i.stopPropagation())}};this._widget.ltm.registerForDispose(this._widget.element.setEvents(["selectTreeItem.azcTreeView",u,],["click.azcTreeView",e,],["keydown.azcTreeView",o,]))},u.prototype.getOrder=function(){return 20},u.prototype.getDependencies=function(){return[new i.FocusableExtension]},u.prototype.getName=function(){return u.Name},u.prototype._findSelectedItem=function(n){var i,u,r,t,f=function(n){return n.metadata&&n.metadata.selected&&n.metadata.selected()};if(t=MsPortalFx.find(n,f),!t)for(i=0,u=n.length;i<u;i++)if(r=n[i],r.items&&r.items().length>0&&(t=this._findSelectedItem(r.items())),t)break;return t},u.prototype._changeSelection=function(n,t){var i=ko.dataFor(n),f,u,e,o;(!i.metadata.selectable||i.metadata.selectable())&&i&&(this._selectionMode!==1?(u=this.getSelected(),i!==u&&this.select(i),f=i):(o=i.metadata.selected(),o?(this.unselect(i),u=i):(this.select(i),f=i)),e={selected:f,unselected:u},this._widget.trigger("itemSelect",r.cloneEvent(t,"itemSelect"),e),this._widget.options.events("select",e))},u.Name="azc-treeView-selectable",u})(u.Extension);n.SelectableExtension=a})(f||(f={})),f}));
define("MsPortalImpl.Controls/Controls/Lists/Tree1/TreeView",["require","exports","MsPortalImpl.Controls/Controls/Base/Loadable","Viva.Controls/Controls/Lists/Tree1/Viva.Tree","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.Selectable","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.OnDemandLoadable","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.RightClickable","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.Focusable","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.LoadByContinuationToken","MsPortalImpl/Base/Base.Selectable2.ClickContext","FxInternal/Controls/TreeView"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Widget=void 0;var c=FxImpl.shellInterface,l="fxc-treeView",a=(function(n){function t(t,i,r){var u=n.call(this,t,i,$.extend({fillBehavior:3},r))||this;return u.element.addClass(l),u._initializeWidgets(),u}return __extends(t,n),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(n.prototype.dispose.call(this),this.element.removeClass(l))},t.prototype._initializeWidgets=function(){var i=this,w=!1,b=!1,k=!1,t=new r.ViewModel(this.vmBasicOption),n=this.options,d=n.htmlTemplates,a=n.onDemandLoadableData,l=n.selectableData,y,p,v;t.reflow=n.reflow;t.padding=n.padding;t.pathSeparator=n.pathSeparator;t.alwaysExpanded=n.alwaysExpanded;t.items=n.items;t.disabled=n.disabled;t.htmlTemplates=[];t.canLoadMoreRootItems=n.canLoadMoreRootItems;t.multiselectable(n.extensionsOptions&&n.extensionsOptions.selectable?n.extensionsOptions.selectable.selectionMode===1:!1);t.ariaLabel=MsPortalFx.initObservable(n.ariaLabel,"");d&&d.forEach((function(n){t.htmlTemplates.push({key:n.key,html:i.sanitizeTemplate(n.html)})}));a&&a.loadingPath&&a.loadingPath.extend({notify:"always"});t.events=function(t,r){if(t==="select")if(n.extensionsOptions.selectable.selectionMode===1){var u=l.selectedPaths();r.unselected&&MsPortalFx.remove(u,i._getPathByItem(r.unselected));r.selected&&u.push(i._getPathByItem(r.selected));l.selectedPaths(u)}else l.selectedPath(i._getPathByItem(r.selected));else t==="loading"&&a.loadingPath(i._getPathByItem(r.item))};(n.extensions&1)>0&&!!n.extensionsOptions.selectable&&(y=new u.SelectableExtension(n.extensionsOptions.selectable.selectionMode),t.extensions.push(y),l.selectedItem.subscribe(this.ltm,(function(n){n||(y.unselect(),l.selectedPath(""))})),n.extensionsOptions.selectable.initialPath&&this._ensureInitialPathSelected(n.items,n.extensionsOptions.selectable.initialPath),b=!0);(n.extensions&2)>0&&t.extensions.push(new f.OnDemandLoadableExtension);(n.extensions&4)>0&&(t.extensions.push(new e.RightClickableExtension(!!c(this.options).SupplyCommands)),b||t.extensions.push(new o.FocusableExtension),w=!0);(n.extensions&8)>0&&(t.extensions.push(new s.LoadByContinuationTokenExtension),k=!0,this._tokenStorage={});p=new r.Widget(this.element,t);n.toggleNodeCallback((function(n,t){p.toggleNodeExpansion(n,$.Event("TreeViewModelExpandNode"),t)}));this._widgets.push(p);k&&this.ltm.registerForDispose(this.element.setEvents(["loadMoreItems",function(t,r){if(!r.item.metadata||r.item.metadata.disabled&&r.item.metadata.disabled())return!1;n.loadMoreNode(r.item,i._tokenStorage[r.path]).then((function(t){i._tokenStorage[r.path]=t.continuationToken;n.syncToken(r.path,t.continuationToken)}))}],["loadMoreRootItems",function(){n.loadMoreRootItems()}]));w&&this.ltm.registerForDispose(this.element.setEvents(["itemRightClick",function(n,t){var r,f,u;return t.item.metadata.disabled()?!1:(r=i._widgets[0],r.getPlugin(o.FocusableExtension.Name)._focusNode(r.getElementFromItem(t.item),t.item,n),f=$.Event("rightclick",{target:n.target,clientX:t.clientX,clientY:t.clientY}),u=c(i.options).SupplyCommands,i.element.trigger(f,{entityType:0,commandGroup:ko.unwrap(t.item.commandGroup),commandGroupOwner:ko.unwrap(t.item.commandGroupOwner),supplyCommands:u,viewModel:u?t.item:{item:t.item,path:t.path}}),!1)}]));c(this.options).OnItemClicked&&(v=h.getListSelectableWithClickHandler(this._diContainer,this.options,this.element,c(this.options).OnItemClicked),ko.reactor(this.ltm,(function(){var t=v.activationState(),n=t.previous;n&&ko.ignoreDependencies((function(){n.metadata.selected(!1)}))})),this.ltm.registerForDispose(this.element.setEvents(["clickTreeItem",function(n,t){v&&v.onClick({item:t,metadata:t.metadata})}])))},t.prototype._getPathByItem=function(n){return this._widgets[0]._buildPath(n)},t.prototype.getTokenByPath=function(n){return this._tokenStorage[n]},t.prototype._ensureInitialPathSelected=function(n,t){var i,u,e,f,o=n,s=[],r=null;if(t)for(f=t.split(this.options.pathSeparator),i=0,u=f.length;i<u;i++)if(e=f[i].toLowerCase(),r=o().filter((function(n){return e===n.text().toLowerCase()}))[0],r)o=r.items||ko.observableArray(),s.push(r);else break;if(r){for(i=0;i<u-1;i++)s[i].metadata.expanded(!0);r.metadata.selected(!0)}},t})(i.Widget);t.Widget=a}))